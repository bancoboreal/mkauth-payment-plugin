# Boreal Pay - Plugin de Pagamentos para MK-Auth

Integra√ß√£o oficial do gateway de pagamentos **Boreal** para o sistema **MK-Auth**. Este plugin permite gerar Boletos e Pix com baixa autom√°tica diretamente pelo painel do provedor e central do assinante.

## üöÄ Funcionalidades

- **Pix H√≠brido/Nativo:** Gera QR Code e c√≥digo "Copia e Cola" instantaneamente.
- **Boleto Banc√°rio:** Redirecionamento autom√°tico para o PDF do boleto.
- **Baixa Autom√°tica:**
  - **Webhook (IPN):** Baixa em tempo real assim que o pagamento √© confirmado.
  - **Cron Job:** Varredura autom√°tica de seguran√ßa a cada 5 minutos.
- **Interface Integrada:** Bot√µes injetados nativamente na tela de detalhes do cliente.
- **Logs Detalhados:** Hist√≥rico completo de comunica√ß√£o com a API para auditoria.

## üìã Pr√©-requisitos

- MK-Auth (Vers√£o 24.x ou superior recomendada).
- Acesso SSH (Root) ao servidor MK-Auth.
- Credenciais de API da Boreal (Client ID, Secret e Token).

## üì¶ Instala√ß√£o R√°pida

Acesse o terminal do seu servidor MK-Auth e execute **apenas um** dos comandos abaixo:

**Via curl:**
```bash
curl -sL https://raw.githubusercontent.com/bancoboreal/mkauth-payment-plugin/main/setup.sh | bash

```

**Ou via wget:**

```bash
wget -qO- https://raw.githubusercontent.com/bancoboreal/mkauth-payment-plugin/main/setup.sh | bash

```

*O instalador ir√° baixar os arquivos, configurar o banco de dados, ajustar permiss√µes e configurar o agendamento (cron) automaticamente.*

## ‚öôÔ∏è Configura√ß√£o

Ap√≥s a instala√ß√£o:

1. Acesse o painel administrativo do MK-Auth.
2. Limpe o cache do navegador (**CTRL + F5**).
3. No menu superior, localize e clique em **Boreal Pay** > **Configura√ß√µes**.
4. Preencha os campos:
* **Client ID** (Sua identifica√ß√£o de Workspace)
* **Client Secret** (Sua chave de Webhook)
* **Token** (Seu Token de API Bearer)
* **Ambiente:** Selecione `Produ√ß√£o` para valer.


5. Marque a op√ß√£o **Ativar Integra√ß√£o**.
6. Clique em **Salvar**.

## üîÑ Webhook (Retorno Autom√°tico)

Para que as faturas sejam baixadas instantaneamente, configure a URL de notifica√ß√£o no painel da Boreal:

```text
https://SEU_DOMINIO_MKAUTH/admin/addons/boreal-pay/boreal/ipn.php

```

## üõ† Suporte e Troubleshooting

Se o menu n√£o aparecer ap√≥s a instala√ß√£o:

1. Verifique se limpou o cache do navegador.
2. Verifique os logs de instala√ß√£o na pasta `/opt/mk-auth/admin/addons/boreal-pay/`.
3. Acesse **Boreal Pay > Logs** para ver erros de comunica√ß√£o com a API.

---

Desenvolvido para Boreal.

```

---

### 2. O Comando de Instala√ß√£o (curl / wget)

Para que o comando funcione, voc√™ deve pegar o script que criamos no passo anterior (o `install_boreal.sh`), renome√°-lo para **`setup.sh`** e coloc√°-lo na **raiz** do seu reposit√≥rio GitHub (`main` branch).

O comando para os seus clientes ou t√©cnicos usarem ser√°:

**Op√ß√£o 1 (Curl - Mais comum):**
```bash
curl -sL https://raw.githubusercontent.com/bancoboreal/mkauth-payment-plugin/main/setup.sh | bash

```

**Op√ß√£o 2 (Wget - Alternativa segura):**

```bash
wget -qO- https://raw.githubusercontent.com/bancoboreal/mkauth-payment-plugin/main/setup.sh | bash

```

### ‚ö†Ô∏è Importante para o Desenvolvedor:

Certifique-se de que a estrutura do seu reposit√≥rio GitHub esteja assim para que tudo funcione:

```text
/ (Raiz do Repo)
‚îú‚îÄ‚îÄ setup.sh           <-- O script bash que criamos anteriormente
‚îú‚îÄ‚îÄ README.md          <-- Este arquivo de documenta√ß√£o
‚îú‚îÄ‚îÄ addon_boreal.js    <-- O JS do menu
‚îî‚îÄ‚îÄ boreal/            <-- A pasta com os arquivos PHP (api.php, init.php, etc)