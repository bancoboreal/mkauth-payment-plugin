This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
payisp/
  bancos/
    bancodobrasil.php
    bancoefi.php
    cora.php
    inter.php
    paghiper.php
    sicoob.php
    sicredi.php
  css/
    fonts/
      bootstrap-icons.woff
      bootstrap-icons.woff2
    bootstrap-icons.min.css
    bootstrap.min.css
    css.css
    pgwmodal.min.css
    styles.css
    toastr.min.css
  custom/
    boleto.hhvm
    carne.hhvm
    central_prepara_boleto.hhvm
    central_prepara_carne.hhvm
    impressao_boletos.hhvm
    impressao_carnes.hhvm
    imprimir_boletos.hhvm
    imprimir_carnes.hhvm
    prepara_boleto.hhvm
    prepara_carne.hhvm
    send_bolpdf.hhvm
    send_carnepdf.hhvm
    titulo.hhvm
    to_form.php
  esquemas/
    PL_NFCOM_1.00/
      consReciNFCom_v1.00.xsd
      consReciNFComTiposBasico_v1.00.xsd
      consSitNFCom_v1.00.xsd
      consSitNFComTiposBasico_v1.00.xsd
      consStatServNFCom_v1.00.xsd
      consStatServNFComTiposBasico_v1.00.xsd
      enviNFCom_v1.00.xsd
      evCancNFCom_v1.00.xsd
      eventoNFCom_v1.00.xsd
      eventoNFComTiposBasico_v1.00.xsd
      nfcom_v1.00.xsd
      nfcomTiposBasico_v1.00.xsd
      procEventoNFCom_v1.00.xsd
      procNFCom_v1.00.xsd
      retConsReciNFCom_v1.00.xsd
      retConsSitNFCom_v1.00.xsd
      retConsStatServNFCom_v1.00.xsd
      retEnviNFCom_v1.00.xsd
      retEventoNFCom_v1.00.xsd
      retNFCom_v1.00.xsd
      tiposGeralNFCom_v1.00.xsd
      xmldsig-core-schema_v1.01.xsd
    PL_NFCOM_1.00_NT2024001/
      consSitNFCom_v1.00.xsd
      consSitNFComTiposBasico_v1.00.xsd
      consStatServNFCom_v1.00.xsd
      consStatServNFComTiposBasico_v1.00.xsd
      evCancNFCom_v1.00.xsd
      eventoNFCom_v1.00.xsd
      eventoNFComTiposBasico_v1.00.xsd
      nfcom_v1.00.xsd
      nfcomTiposBasico_v1.00.xsd
      procEventoNFCom_v1.00.xsd
      procNFCom_v1.00.xsd
      retConsSitNFCom_v1.00.xsd
      retConsStatServNFCom_v1.00.xsd
      retEventoNFCom_v1.00.xsd
      retNFCom_v1.00.xsd
      tiposGeralNFCom_v1.00.xsd
      xmldsig-core-schema_v1.01.xsd
    PL_NFCOM_1.00_NT2025.001_RTC_1.04/
      consSitNFCom_v1.00.xsd
      consSitNFComTiposBasico_v1.00.xsd
      consStatServNFCom_v1.00.xsd
      consStatServNFComTiposBasico_v1.00.xsd
      DFeTiposBasicos_v1.00.xsd
      evCancNFCom_v1.00.xsd
      eventoNFCom_v1.00.xsd
      eventoNFComTiposBasico_v1.00.xsd
      nfcom_v1.00.xsd
      nfcomTiposBasico_v1.00.xsd
      procEventoNFCom_v1.00.xsd
      procNFCom_v1.00.xsd
      retConsSitNFCom_v1.00.xsd
      retConsStatServNFCom_v1.00.xsd
      retEventoNFCom_v1.00.xsd
      retNFCom_v1.00.xsd
      tiposGeralNFCom_v1.00.xsd
      xmldsig-core-schema_v1.01.xsd
    PL_NFCOM_1.00_NT2025.001_RTC_1.10/
      consSitNFCom_v1.00.xsd
      consSitNFComTiposBasico_v1.00.xsd
      consStatServNFCom_v1.00.xsd
      consStatServNFComTiposBasico_v1.00.xsd
      DFeTiposBasicos_v1.00.xsd
      evCancNFCom_v1.00.xsd
      eventoNFCom_v1.00.xsd
      eventoNFComTiposBasico_v1.00.xsd
      nfcom_v1.00.xsd
      nfcomTiposBasico_v1.00.xsd
      procEventoNFCom_v1.00.xsd
      procNFCom_v1.00.xsd
      retConsSitNFCom_v1.00.xsd
      retConsStatServNFCom_v1.00.xsd
      retEventoNFCom_v1.00.xsd
      retNFCom_v1.00.xsd
      tiposGeralNFCom_v1.00.xsd
      xmldsig-core-schema_v1.01.xsd
  images/
    000.png
    001.png
    004.png
    033.png
    041.png
    077.png
    085.png
    104.png
    133.png
    136.png
    208.png
    224.png
    237.png
    336.png
    341.png
    364.png
    399.png
    403.png
    435.png
    633.png
    643.png
    712.png
    748.png
    756.png
    destinatario.gif
  js/
    bootbox.all.js
    bootbox.all.min.js
    bootbox.js
    bootbox.locales.js
    bootbox.locales.min.js
    bootbox.min.js
    bootstrap.bundle.min.js
    central.js
    jquery.blockUI.js
    pgwmodal.min.js
    scripts.js
    toastr.js.map
    toastr.min.js
  src/
    certificado.php
    MySQLDump.php
    MySQLImport.php
    nfcom_cert.php
    nfcom_engine.php
    nfcom_eventos.php
    nfcom_tools.php
    nfcom_xml.php
    nfcom_xsd.php
  vendor/
    composer/
      autoload_classmap.php
      autoload_namespaces.php
      autoload_psr4.php
      autoload_real.php
      autoload_static.php
      ClassLoader.php
      installed.json
      installed.php
      InstalledVersions.php
      LICENSE
      platform_check.php
    robrichards/
      xmlseclibs/
        .github/
          workflows/
            ci.yml
        src/
          Utils/
            XPath.php
          XMLSecEnc.php
          XMLSecurityDSig.php
          XMLSecurityKey.php
        CHANGELOG.txt
        composer.json
        LICENSE
        phpunit.xml
        README.md
        xmlseclibs.php
    autoload.php
  ajax.registrar.php
  api.php
  backup.php
  bancos.add.php
  bancos.certificados.php
  bancos.editar.php
  bancos.index.php
  bancos.licenca.php
  bancos.licensa.reset.php
  bancos.remover.php
  carnets.index.php
  cartao.mercadopago.pagar.php
  cartao.mercadopago.php
  changelog.php
  class.bank.php
  class.log.php
  class.qrcode.php
  cliente.carnet.php
  cliente.fatura.php
  composer.json
  composer.phar
  configuracoes.php
  cron.baixa.php
  cron.geral.php
  cron.mercadopago.php
  cron.registro.php
  cron.vencidos.php
  faturas.index.php
  faturas.logs.php
  funcoes.php
  imprimir.boleto.central.php
  imprimir.boleto.pdf.php
  imprimir.boleto.php
  imprimir.carnet.central.php
  imprimir.carnet.php
  index.php
  init_cliente.php
  init.php
  instalar.php
  ipn.php
  json.atualizado.php
  json.contador.php
  lay.footer.php
  lay.header.php
  lay.template_alerta.php
  login.hhvm
  login.php
  logs.php
  manifest.json
  nfcom_editar_servico.php
  nfcom_excluir_servico.php
  nfcom_novo_servico.php
  nfcom.ativar.php
  nfcom.cancelar.php
  nfcom.consultar.php
  nfcom.detalhes.php
  nfcom.emitir.php
  nfcom.erros.php
  nfcom.imprimir.php
  nfcom.index.php
  nfcom.licenca.php
  nfcom.licensa.reset.php
  nfcom.php
  nfcom.status.php
  nfcom.xml.php
  registro.manual.php
  template_alerta.php
  template_log.php
  whatsapp.php
addon_payisp.js
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="payisp/css/bootstrap-icons.min.css">
/*!
 * Bootstrap Icons v1.11.3 (https://icons.getbootstrap.com/)
 * Copyright 2019-2024 The Bootstrap Authors
 * Licensed under MIT (https://github.com/twbs/icons/blob/main/LICENSE)
 */@font-face{font-display:block;font-family:bootstrap-icons;src:url("fonts/bootstrap-icons.woff2?dd67030699838ea613ee6dbda90effa6") format("woff2"),url("fonts/bootstrap-icons.woff?dd67030699838ea613ee6dbda90effa6") format("woff")}.bi::before,[class*=" bi-"]::before,[class^=bi-]::before{display:inline-block;font-family:bootstrap-icons!important;font-style:normal;font-weight:400!important;font-variant:normal;text-transform:none;line-height:1;vertical-align:-.125em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.bi-123::before{content:"\f67f"}.bi-alarm-fill::before{content:"\f101"}.bi-alarm::before{content:"\f102"}.bi-align-bottom::before{content:"\f103"}.bi-align-center::before{content:"\f104"}.bi-align-end::before{content:"\f105"}.bi-align-middle::before{content:"\f106"}.bi-align-start::before{content:"\f107"}.bi-align-top::before{content:"\f108"}.bi-alt::before{content:"\f109"}.bi-app-indicator::before{content:"\f10a"}.bi-app::before{content:"\f10b"}.bi-archive-fill::before{content:"\f10c"}.bi-archive::before{content:"\f10d"}.bi-arrow-90deg-down::before{content:"\f10e"}.bi-arrow-90deg-left::before{content:"\f10f"}.bi-arrow-90deg-right::before{content:"\f110"}.bi-arrow-90deg-up::before{content:"\f111"}.bi-arrow-bar-down::before{content:"\f112"}.bi-arrow-bar-left::before{content:"\f113"}.bi-arrow-bar-right::before{content:"\f114"}.bi-arrow-bar-up::before{content:"\f115"}.bi-arrow-clockwise::before{content:"\f116"}.bi-arrow-counterclockwise::before{content:"\f117"}.bi-arrow-down-circle-fill::before{content:"\f118"}.bi-arrow-down-circle::before{content:"\f119"}.bi-arrow-down-left-circle-fill::before{content:"\f11a"}.bi-arrow-down-left-circle::before{content:"\f11b"}.bi-arrow-down-left-square-fill::before{content:"\f11c"}.bi-arrow-down-left-square::before{content:"\f11d"}.bi-arrow-down-left::before{content:"\f11e"}.bi-arrow-down-right-circle-fill::before{content:"\f11f"}.bi-arrow-down-right-circle::before{content:"\f120"}.bi-arrow-down-right-square-fill::before{content:"\f121"}.bi-arrow-down-right-square::before{content:"\f122"}.bi-arrow-down-right::before{content:"\f123"}.bi-arrow-down-short::before{content:"\f124"}.bi-arrow-down-square-fill::before{content:"\f125"}.bi-arrow-down-square::before{content:"\f126"}.bi-arrow-down-up::before{content:"\f127"}.bi-arrow-down::before{content:"\f128"}.bi-arrow-left-circle-fill::before{content:"\f129"}.bi-arrow-left-circle::before{content:"\f12a"}.bi-arrow-left-right::before{content:"\f12b"}.bi-arrow-left-short::before{content:"\f12c"}.bi-arrow-left-square-fill::before{content:"\f12d"}.bi-arrow-left-square::before{content:"\f12e"}.bi-arrow-left::before{content:"\f12f"}.bi-arrow-repeat::before{content:"\f130"}.bi-arrow-return-left::before{content:"\f131"}.bi-arrow-return-right::before{content:"\f132"}.bi-arrow-right-circle-fill::before{content:"\f133"}.bi-arrow-right-circle::before{content:"\f134"}.bi-arrow-right-short::before{content:"\f135"}.bi-arrow-right-square-fill::before{content:"\f136"}.bi-arrow-right-square::before{content:"\f137"}.bi-arrow-right::before{content:"\f138"}.bi-arrow-up-circle-fill::before{content:"\f139"}.bi-arrow-up-circle::before{content:"\f13a"}.bi-arrow-up-left-circle-fill::before{content:"\f13b"}.bi-arrow-up-left-circle::before{content:"\f13c"}.bi-arrow-up-left-square-fill::before{content:"\f13d"}.bi-arrow-up-left-square::before{content:"\f13e"}.bi-arrow-up-left::before{content:"\f13f"}.bi-arrow-up-right-circle-fill::before{content:"\f140"}.bi-arrow-up-right-circle::before{content:"\f141"}.bi-arrow-up-right-square-fill::before{content:"\f142"}.bi-arrow-up-right-square::before{content:"\f143"}.bi-arrow-up-right::before{content:"\f144"}.bi-arrow-up-short::before{content:"\f145"}.bi-arrow-up-square-fill::before{content:"\f146"}.bi-arrow-up-square::before{content:"\f147"}.bi-arrow-up::before{content:"\f148"}.bi-arrows-angle-contract::before{content:"\f149"}.bi-arrows-angle-expand::before{content:"\f14a"}.bi-arrows-collapse::before{content:"\f14b"}.bi-arrows-expand::before{content:"\f14c"}.bi-arrows-fullscreen::before{content:"\f14d"}.bi-arrows-move::before{content:"\f14e"}.bi-aspect-ratio-fill::before{content:"\f14f"}.bi-aspect-ratio::before{content:"\f150"}.bi-asterisk::before{content:"\f151"}.bi-at::before{content:"\f152"}.bi-award-fill::before{content:"\f153"}.bi-award::before{content:"\f154"}.bi-back::before{content:"\f155"}.bi-backspace-fill::before{content:"\f156"}.bi-backspace-reverse-fill::before{content:"\f157"}.bi-backspace-reverse::before{content:"\f158"}.bi-backspace::before{content:"\f159"}.bi-badge-3d-fill::before{content:"\f15a"}.bi-badge-3d::before{content:"\f15b"}.bi-badge-4k-fill::before{content:"\f15c"}.bi-badge-4k::before{content:"\f15d"}.bi-badge-8k-fill::before{content:"\f15e"}.bi-badge-8k::before{content:"\f15f"}.bi-badge-ad-fill::before{content:"\f160"}.bi-badge-ad::before{content:"\f161"}.bi-badge-ar-fill::before{content:"\f162"}.bi-badge-ar::before{content:"\f163"}.bi-badge-cc-fill::before{content:"\f164"}.bi-badge-cc::before{content:"\f165"}.bi-badge-hd-fill::before{content:"\f166"}.bi-badge-hd::before{content:"\f167"}.bi-badge-tm-fill::before{content:"\f168"}.bi-badge-tm::before{content:"\f169"}.bi-badge-vo-fill::before{content:"\f16a"}.bi-badge-vo::before{content:"\f16b"}.bi-badge-vr-fill::before{content:"\f16c"}.bi-badge-vr::before{content:"\f16d"}.bi-badge-wc-fill::before{content:"\f16e"}.bi-badge-wc::before{content:"\f16f"}.bi-bag-check-fill::before{content:"\f170"}.bi-bag-check::before{content:"\f171"}.bi-bag-dash-fill::before{content:"\f172"}.bi-bag-dash::before{content:"\f173"}.bi-bag-fill::before{content:"\f174"}.bi-bag-plus-fill::before{content:"\f175"}.bi-bag-plus::before{content:"\f176"}.bi-bag-x-fill::before{content:"\f177"}.bi-bag-x::before{content:"\f178"}.bi-bag::before{content:"\f179"}.bi-bar-chart-fill::before{content:"\f17a"}.bi-bar-chart-line-fill::before{content:"\f17b"}.bi-bar-chart-line::before{content:"\f17c"}.bi-bar-chart-steps::before{content:"\f17d"}.bi-bar-chart::before{content:"\f17e"}.bi-basket-fill::before{content:"\f17f"}.bi-basket::before{content:"\f180"}.bi-basket2-fill::before{content:"\f181"}.bi-basket2::before{content:"\f182"}.bi-basket3-fill::before{content:"\f183"}.bi-basket3::before{content:"\f184"}.bi-battery-charging::before{content:"\f185"}.bi-battery-full::before{content:"\f186"}.bi-battery-half::before{content:"\f187"}.bi-battery::before{content:"\f188"}.bi-bell-fill::before{content:"\f189"}.bi-bell::before{content:"\f18a"}.bi-bezier::before{content:"\f18b"}.bi-bezier2::before{content:"\f18c"}.bi-bicycle::before{content:"\f18d"}.bi-binoculars-fill::before{content:"\f18e"}.bi-binoculars::before{content:"\f18f"}.bi-blockquote-left::before{content:"\f190"}.bi-blockquote-right::before{content:"\f191"}.bi-book-fill::before{content:"\f192"}.bi-book-half::before{content:"\f193"}.bi-book::before{content:"\f194"}.bi-bookmark-check-fill::before{content:"\f195"}.bi-bookmark-check::before{content:"\f196"}.bi-bookmark-dash-fill::before{content:"\f197"}.bi-bookmark-dash::before{content:"\f198"}.bi-bookmark-fill::before{content:"\f199"}.bi-bookmark-heart-fill::before{content:"\f19a"}.bi-bookmark-heart::before{content:"\f19b"}.bi-bookmark-plus-fill::before{content:"\f19c"}.bi-bookmark-plus::before{content:"\f19d"}.bi-bookmark-star-fill::before{content:"\f19e"}.bi-bookmark-star::before{content:"\f19f"}.bi-bookmark-x-fill::before{content:"\f1a0"}.bi-bookmark-x::before{content:"\f1a1"}.bi-bookmark::before{content:"\f1a2"}.bi-bookmarks-fill::before{content:"\f1a3"}.bi-bookmarks::before{content:"\f1a4"}.bi-bookshelf::before{content:"\f1a5"}.bi-bootstrap-fill::before{content:"\f1a6"}.bi-bootstrap-reboot::before{content:"\f1a7"}.bi-bootstrap::before{content:"\f1a8"}.bi-border-all::before{content:"\f1a9"}.bi-border-bottom::before{content:"\f1aa"}.bi-border-center::before{content:"\f1ab"}.bi-border-inner::before{content:"\f1ac"}.bi-border-left::before{content:"\f1ad"}.bi-border-middle::before{content:"\f1ae"}.bi-border-outer::before{content:"\f1af"}.bi-border-right::before{content:"\f1b0"}.bi-border-style::before{content:"\f1b1"}.bi-border-top::before{content:"\f1b2"}.bi-border-width::before{content:"\f1b3"}.bi-border::before{content:"\f1b4"}.bi-bounding-box-circles::before{content:"\f1b5"}.bi-bounding-box::before{content:"\f1b6"}.bi-box-arrow-down-left::before{content:"\f1b7"}.bi-box-arrow-down-right::before{content:"\f1b8"}.bi-box-arrow-down::before{content:"\f1b9"}.bi-box-arrow-in-down-left::before{content:"\f1ba"}.bi-box-arrow-in-down-right::before{content:"\f1bb"}.bi-box-arrow-in-down::before{content:"\f1bc"}.bi-box-arrow-in-left::before{content:"\f1bd"}.bi-box-arrow-in-right::before{content:"\f1be"}.bi-box-arrow-in-up-left::before{content:"\f1bf"}.bi-box-arrow-in-up-right::before{content:"\f1c0"}.bi-box-arrow-in-up::before{content:"\f1c1"}.bi-box-arrow-left::before{content:"\f1c2"}.bi-box-arrow-right::before{content:"\f1c3"}.bi-box-arrow-up-left::before{content:"\f1c4"}.bi-box-arrow-up-right::before{content:"\f1c5"}.bi-box-arrow-up::before{content:"\f1c6"}.bi-box-seam::before{content:"\f1c7"}.bi-box::before{content:"\f1c8"}.bi-braces::before{content:"\f1c9"}.bi-bricks::before{content:"\f1ca"}.bi-briefcase-fill::before{content:"\f1cb"}.bi-briefcase::before{content:"\f1cc"}.bi-brightness-alt-high-fill::before{content:"\f1cd"}.bi-brightness-alt-high::before{content:"\f1ce"}.bi-brightness-alt-low-fill::before{content:"\f1cf"}.bi-brightness-alt-low::before{content:"\f1d0"}.bi-brightness-high-fill::before{content:"\f1d1"}.bi-brightness-high::before{content:"\f1d2"}.bi-brightness-low-fill::before{content:"\f1d3"}.bi-brightness-low::before{content:"\f1d4"}.bi-broadcast-pin::before{content:"\f1d5"}.bi-broadcast::before{content:"\f1d6"}.bi-brush-fill::before{content:"\f1d7"}.bi-brush::before{content:"\f1d8"}.bi-bucket-fill::before{content:"\f1d9"}.bi-bucket::before{content:"\f1da"}.bi-bug-fill::before{content:"\f1db"}.bi-bug::before{content:"\f1dc"}.bi-building::before{content:"\f1dd"}.bi-bullseye::before{content:"\f1de"}.bi-calculator-fill::before{content:"\f1df"}.bi-calculator::before{content:"\f1e0"}.bi-calendar-check-fill::before{content:"\f1e1"}.bi-calendar-check::before{content:"\f1e2"}.bi-calendar-date-fill::before{content:"\f1e3"}.bi-calendar-date::before{content:"\f1e4"}.bi-calendar-day-fill::before{content:"\f1e5"}.bi-calendar-day::before{content:"\f1e6"}.bi-calendar-event-fill::before{content:"\f1e7"}.bi-calendar-event::before{content:"\f1e8"}.bi-calendar-fill::before{content:"\f1e9"}.bi-calendar-minus-fill::before{content:"\f1ea"}.bi-calendar-minus::before{content:"\f1eb"}.bi-calendar-month-fill::before{content:"\f1ec"}.bi-calendar-month::before{content:"\f1ed"}.bi-calendar-plus-fill::before{content:"\f1ee"}.bi-calendar-plus::before{content:"\f1ef"}.bi-calendar-range-fill::before{content:"\f1f0"}.bi-calendar-range::before{content:"\f1f1"}.bi-calendar-week-fill::before{content:"\f1f2"}.bi-calendar-week::before{content:"\f1f3"}.bi-calendar-x-fill::before{content:"\f1f4"}.bi-calendar-x::before{content:"\f1f5"}.bi-calendar::before{content:"\f1f6"}.bi-calendar2-check-fill::before{content:"\f1f7"}.bi-calendar2-check::before{content:"\f1f8"}.bi-calendar2-date-fill::before{content:"\f1f9"}.bi-calendar2-date::before{content:"\f1fa"}.bi-calendar2-day-fill::before{content:"\f1fb"}.bi-calendar2-day::before{content:"\f1fc"}.bi-calendar2-event-fill::before{content:"\f1fd"}.bi-calendar2-event::before{content:"\f1fe"}.bi-calendar2-fill::before{content:"\f1ff"}.bi-calendar2-minus-fill::before{content:"\f200"}.bi-calendar2-minus::before{content:"\f201"}.bi-calendar2-month-fill::before{content:"\f202"}.bi-calendar2-month::before{content:"\f203"}.bi-calendar2-plus-fill::before{content:"\f204"}.bi-calendar2-plus::before{content:"\f205"}.bi-calendar2-range-fill::before{content:"\f206"}.bi-calendar2-range::before{content:"\f207"}.bi-calendar2-week-fill::before{content:"\f208"}.bi-calendar2-week::before{content:"\f209"}.bi-calendar2-x-fill::before{content:"\f20a"}.bi-calendar2-x::before{content:"\f20b"}.bi-calendar2::before{content:"\f20c"}.bi-calendar3-event-fill::before{content:"\f20d"}.bi-calendar3-event::before{content:"\f20e"}.bi-calendar3-fill::before{content:"\f20f"}.bi-calendar3-range-fill::before{content:"\f210"}.bi-calendar3-range::before{content:"\f211"}.bi-calendar3-week-fill::before{content:"\f212"}.bi-calendar3-week::before{content:"\f213"}.bi-calendar3::before{content:"\f214"}.bi-calendar4-event::before{content:"\f215"}.bi-calendar4-range::before{content:"\f216"}.bi-calendar4-week::before{content:"\f217"}.bi-calendar4::before{content:"\f218"}.bi-camera-fill::before{content:"\f219"}.bi-camera-reels-fill::before{content:"\f21a"}.bi-camera-reels::before{content:"\f21b"}.bi-camera-video-fill::before{content:"\f21c"}.bi-camera-video-off-fill::before{content:"\f21d"}.bi-camera-video-off::before{content:"\f21e"}.bi-camera-video::before{content:"\f21f"}.bi-camera::before{content:"\f220"}.bi-camera2::before{content:"\f221"}.bi-capslock-fill::before{content:"\f222"}.bi-capslock::before{content:"\f223"}.bi-card-checklist::before{content:"\f224"}.bi-card-heading::before{content:"\f225"}.bi-card-image::before{content:"\f226"}.bi-card-list::before{content:"\f227"}.bi-card-text::before{content:"\f228"}.bi-caret-down-fill::before{content:"\f229"}.bi-caret-down-square-fill::before{content:"\f22a"}.bi-caret-down-square::before{content:"\f22b"}.bi-caret-down::before{content:"\f22c"}.bi-caret-left-fill::before{content:"\f22d"}.bi-caret-left-square-fill::before{content:"\f22e"}.bi-caret-left-square::before{content:"\f22f"}.bi-caret-left::before{content:"\f230"}.bi-caret-right-fill::before{content:"\f231"}.bi-caret-right-square-fill::before{content:"\f232"}.bi-caret-right-square::before{content:"\f233"}.bi-caret-right::before{content:"\f234"}.bi-caret-up-fill::before{content:"\f235"}.bi-caret-up-square-fill::before{content:"\f236"}.bi-caret-up-square::before{content:"\f237"}.bi-caret-up::before{content:"\f238"}.bi-cart-check-fill::before{content:"\f239"}.bi-cart-check::before{content:"\f23a"}.bi-cart-dash-fill::before{content:"\f23b"}.bi-cart-dash::before{content:"\f23c"}.bi-cart-fill::before{content:"\f23d"}.bi-cart-plus-fill::before{content:"\f23e"}.bi-cart-plus::before{content:"\f23f"}.bi-cart-x-fill::before{content:"\f240"}.bi-cart-x::before{content:"\f241"}.bi-cart::before{content:"\f242"}.bi-cart2::before{content:"\f243"}.bi-cart3::before{content:"\f244"}.bi-cart4::before{content:"\f245"}.bi-cash-stack::before{content:"\f246"}.bi-cash::before{content:"\f247"}.bi-cast::before{content:"\f248"}.bi-chat-dots-fill::before{content:"\f249"}.bi-chat-dots::before{content:"\f24a"}.bi-chat-fill::before{content:"\f24b"}.bi-chat-left-dots-fill::before{content:"\f24c"}.bi-chat-left-dots::before{content:"\f24d"}.bi-chat-left-fill::before{content:"\f24e"}.bi-chat-left-quote-fill::before{content:"\f24f"}.bi-chat-left-quote::before{content:"\f250"}.bi-chat-left-text-fill::before{content:"\f251"}.bi-chat-left-text::before{content:"\f252"}.bi-chat-left::before{content:"\f253"}.bi-chat-quote-fill::before{content:"\f254"}.bi-chat-quote::before{content:"\f255"}.bi-chat-right-dots-fill::before{content:"\f256"}.bi-chat-right-dots::before{content:"\f257"}.bi-chat-right-fill::before{content:"\f258"}.bi-chat-right-quote-fill::before{content:"\f259"}.bi-chat-right-quote::before{content:"\f25a"}.bi-chat-right-text-fill::before{content:"\f25b"}.bi-chat-right-text::before{content:"\f25c"}.bi-chat-right::before{content:"\f25d"}.bi-chat-square-dots-fill::before{content:"\f25e"}.bi-chat-square-dots::before{content:"\f25f"}.bi-chat-square-fill::before{content:"\f260"}.bi-chat-square-quote-fill::before{content:"\f261"}.bi-chat-square-quote::before{content:"\f262"}.bi-chat-square-text-fill::before{content:"\f263"}.bi-chat-square-text::before{content:"\f264"}.bi-chat-square::before{content:"\f265"}.bi-chat-text-fill::before{content:"\f266"}.bi-chat-text::before{content:"\f267"}.bi-chat::before{content:"\f268"}.bi-check-all::before{content:"\f269"}.bi-check-circle-fill::before{content:"\f26a"}.bi-check-circle::before{content:"\f26b"}.bi-check-square-fill::before{content:"\f26c"}.bi-check-square::before{content:"\f26d"}.bi-check::before{content:"\f26e"}.bi-check2-all::before{content:"\f26f"}.bi-check2-circle::before{content:"\f270"}.bi-check2-square::before{content:"\f271"}.bi-check2::before{content:"\f272"}.bi-chevron-bar-contract::before{content:"\f273"}.bi-chevron-bar-down::before{content:"\f274"}.bi-chevron-bar-expand::before{content:"\f275"}.bi-chevron-bar-left::before{content:"\f276"}.bi-chevron-bar-right::before{content:"\f277"}.bi-chevron-bar-up::before{content:"\f278"}.bi-chevron-compact-down::before{content:"\f279"}.bi-chevron-compact-left::before{content:"\f27a"}.bi-chevron-compact-right::before{content:"\f27b"}.bi-chevron-compact-up::before{content:"\f27c"}.bi-chevron-contract::before{content:"\f27d"}.bi-chevron-double-down::before{content:"\f27e"}.bi-chevron-double-left::before{content:"\f27f"}.bi-chevron-double-right::before{content:"\f280"}.bi-chevron-double-up::before{content:"\f281"}.bi-chevron-down::before{content:"\f282"}.bi-chevron-expand::before{content:"\f283"}.bi-chevron-left::before{content:"\f284"}.bi-chevron-right::before{content:"\f285"}.bi-chevron-up::before{content:"\f286"}.bi-circle-fill::before{content:"\f287"}.bi-circle-half::before{content:"\f288"}.bi-circle-square::before{content:"\f289"}.bi-circle::before{content:"\f28a"}.bi-clipboard-check::before{content:"\f28b"}.bi-clipboard-data::before{content:"\f28c"}.bi-clipboard-minus::before{content:"\f28d"}.bi-clipboard-plus::before{content:"\f28e"}.bi-clipboard-x::before{content:"\f28f"}.bi-clipboard::before{content:"\f290"}.bi-clock-fill::before{content:"\f291"}.bi-clock-history::before{content:"\f292"}.bi-clock::before{content:"\f293"}.bi-cloud-arrow-down-fill::before{content:"\f294"}.bi-cloud-arrow-down::before{content:"\f295"}.bi-cloud-arrow-up-fill::before{content:"\f296"}.bi-cloud-arrow-up::before{content:"\f297"}.bi-cloud-check-fill::before{content:"\f298"}.bi-cloud-check::before{content:"\f299"}.bi-cloud-download-fill::before{content:"\f29a"}.bi-cloud-download::before{content:"\f29b"}.bi-cloud-drizzle-fill::before{content:"\f29c"}.bi-cloud-drizzle::before{content:"\f29d"}.bi-cloud-fill::before{content:"\f29e"}.bi-cloud-fog-fill::before{content:"\f29f"}.bi-cloud-fog::before{content:"\f2a0"}.bi-cloud-fog2-fill::before{content:"\f2a1"}.bi-cloud-fog2::before{content:"\f2a2"}.bi-cloud-hail-fill::before{content:"\f2a3"}.bi-cloud-hail::before{content:"\f2a4"}.bi-cloud-haze-fill::before{content:"\f2a6"}.bi-cloud-haze::before{content:"\f2a7"}.bi-cloud-haze2-fill::before{content:"\f2a8"}.bi-cloud-lightning-fill::before{content:"\f2a9"}.bi-cloud-lightning-rain-fill::before{content:"\f2aa"}.bi-cloud-lightning-rain::before{content:"\f2ab"}.bi-cloud-lightning::before{content:"\f2ac"}.bi-cloud-minus-fill::before{content:"\f2ad"}.bi-cloud-minus::before{content:"\f2ae"}.bi-cloud-moon-fill::before{content:"\f2af"}.bi-cloud-moon::before{content:"\f2b0"}.bi-cloud-plus-fill::before{content:"\f2b1"}.bi-cloud-plus::before{content:"\f2b2"}.bi-cloud-rain-fill::before{content:"\f2b3"}.bi-cloud-rain-heavy-fill::before{content:"\f2b4"}.bi-cloud-rain-heavy::before{content:"\f2b5"}.bi-cloud-rain::before{content:"\f2b6"}.bi-cloud-slash-fill::before{content:"\f2b7"}.bi-cloud-slash::before{content:"\f2b8"}.bi-cloud-sleet-fill::before{content:"\f2b9"}.bi-cloud-sleet::before{content:"\f2ba"}.bi-cloud-snow-fill::before{content:"\f2bb"}.bi-cloud-snow::before{content:"\f2bc"}.bi-cloud-sun-fill::before{content:"\f2bd"}.bi-cloud-sun::before{content:"\f2be"}.bi-cloud-upload-fill::before{content:"\f2bf"}.bi-cloud-upload::before{content:"\f2c0"}.bi-cloud::before{content:"\f2c1"}.bi-clouds-fill::before{content:"\f2c2"}.bi-clouds::before{content:"\f2c3"}.bi-cloudy-fill::before{content:"\f2c4"}.bi-cloudy::before{content:"\f2c5"}.bi-code-slash::before{content:"\f2c6"}.bi-code-square::before{content:"\f2c7"}.bi-code::before{content:"\f2c8"}.bi-collection-fill::before{content:"\f2c9"}.bi-collection-play-fill::before{content:"\f2ca"}.bi-collection-play::before{content:"\f2cb"}.bi-collection::before{content:"\f2cc"}.bi-columns-gap::before{content:"\f2cd"}.bi-columns::before{content:"\f2ce"}.bi-command::before{content:"\f2cf"}.bi-compass-fill::before{content:"\f2d0"}.bi-compass::before{content:"\f2d1"}.bi-cone-striped::before{content:"\f2d2"}.bi-cone::before{content:"\f2d3"}.bi-controller::before{content:"\f2d4"}.bi-cpu-fill::before{content:"\f2d5"}.bi-cpu::before{content:"\f2d6"}.bi-credit-card-2-back-fill::before{content:"\f2d7"}.bi-credit-card-2-back::before{content:"\f2d8"}.bi-credit-card-2-front-fill::before{content:"\f2d9"}.bi-credit-card-2-front::before{content:"\f2da"}.bi-credit-card-fill::before{content:"\f2db"}.bi-credit-card::before{content:"\f2dc"}.bi-crop::before{content:"\f2dd"}.bi-cup-fill::before{content:"\f2de"}.bi-cup-straw::before{content:"\f2df"}.bi-cup::before{content:"\f2e0"}.bi-cursor-fill::before{content:"\f2e1"}.bi-cursor-text::before{content:"\f2e2"}.bi-cursor::before{content:"\f2e3"}.bi-dash-circle-dotted::before{content:"\f2e4"}.bi-dash-circle-fill::before{content:"\f2e5"}.bi-dash-circle::before{content:"\f2e6"}.bi-dash-square-dotted::before{content:"\f2e7"}.bi-dash-square-fill::before{content:"\f2e8"}.bi-dash-square::before{content:"\f2e9"}.bi-dash::before{content:"\f2ea"}.bi-diagram-2-fill::before{content:"\f2eb"}.bi-diagram-2::before{content:"\f2ec"}.bi-diagram-3-fill::before{content:"\f2ed"}.bi-diagram-3::before{content:"\f2ee"}.bi-diamond-fill::before{content:"\f2ef"}.bi-diamond-half::before{content:"\f2f0"}.bi-diamond::before{content:"\f2f1"}.bi-dice-1-fill::before{content:"\f2f2"}.bi-dice-1::before{content:"\f2f3"}.bi-dice-2-fill::before{content:"\f2f4"}.bi-dice-2::before{content:"\f2f5"}.bi-dice-3-fill::before{content:"\f2f6"}.bi-dice-3::before{content:"\f2f7"}.bi-dice-4-fill::before{content:"\f2f8"}.bi-dice-4::before{content:"\f2f9"}.bi-dice-5-fill::before{content:"\f2fa"}.bi-dice-5::before{content:"\f2fb"}.bi-dice-6-fill::before{content:"\f2fc"}.bi-dice-6::before{content:"\f2fd"}.bi-disc-fill::before{content:"\f2fe"}.bi-disc::before{content:"\f2ff"}.bi-discord::before{content:"\f300"}.bi-display-fill::before{content:"\f301"}.bi-display::before{content:"\f302"}.bi-distribute-horizontal::before{content:"\f303"}.bi-distribute-vertical::before{content:"\f304"}.bi-door-closed-fill::before{content:"\f305"}.bi-door-closed::before{content:"\f306"}.bi-door-open-fill::before{content:"\f307"}.bi-door-open::before{content:"\f308"}.bi-dot::before{content:"\f309"}.bi-download::before{content:"\f30a"}.bi-droplet-fill::before{content:"\f30b"}.bi-droplet-half::before{content:"\f30c"}.bi-droplet::before{content:"\f30d"}.bi-earbuds::before{content:"\f30e"}.bi-easel-fill::before{content:"\f30f"}.bi-easel::before{content:"\f310"}.bi-egg-fill::before{content:"\f311"}.bi-egg-fried::before{content:"\f312"}.bi-egg::before{content:"\f313"}.bi-eject-fill::before{content:"\f314"}.bi-eject::before{content:"\f315"}.bi-emoji-angry-fill::before{content:"\f316"}.bi-emoji-angry::before{content:"\f317"}.bi-emoji-dizzy-fill::before{content:"\f318"}.bi-emoji-dizzy::before{content:"\f319"}.bi-emoji-expressionless-fill::before{content:"\f31a"}.bi-emoji-expressionless::before{content:"\f31b"}.bi-emoji-frown-fill::before{content:"\f31c"}.bi-emoji-frown::before{content:"\f31d"}.bi-emoji-heart-eyes-fill::before{content:"\f31e"}.bi-emoji-heart-eyes::before{content:"\f31f"}.bi-emoji-laughing-fill::before{content:"\f320"}.bi-emoji-laughing::before{content:"\f321"}.bi-emoji-neutral-fill::before{content:"\f322"}.bi-emoji-neutral::before{content:"\f323"}.bi-emoji-smile-fill::before{content:"\f324"}.bi-emoji-smile-upside-down-fill::before{content:"\f325"}.bi-emoji-smile-upside-down::before{content:"\f326"}.bi-emoji-smile::before{content:"\f327"}.bi-emoji-sunglasses-fill::before{content:"\f328"}.bi-emoji-sunglasses::before{content:"\f329"}.bi-emoji-wink-fill::before{content:"\f32a"}.bi-emoji-wink::before{content:"\f32b"}.bi-envelope-fill::before{content:"\f32c"}.bi-envelope-open-fill::before{content:"\f32d"}.bi-envelope-open::before{content:"\f32e"}.bi-envelope::before{content:"\f32f"}.bi-eraser-fill::before{content:"\f330"}.bi-eraser::before{content:"\f331"}.bi-exclamation-circle-fill::before{content:"\f332"}.bi-exclamation-circle::before{content:"\f333"}.bi-exclamation-diamond-fill::before{content:"\f334"}.bi-exclamation-diamond::before{content:"\f335"}.bi-exclamation-octagon-fill::before{content:"\f336"}.bi-exclamation-octagon::before{content:"\f337"}.bi-exclamation-square-fill::before{content:"\f338"}.bi-exclamation-square::before{content:"\f339"}.bi-exclamation-triangle-fill::before{content:"\f33a"}.bi-exclamation-triangle::before{content:"\f33b"}.bi-exclamation::before{content:"\f33c"}.bi-exclude::before{content:"\f33d"}.bi-eye-fill::before{content:"\f33e"}.bi-eye-slash-fill::before{content:"\f33f"}.bi-eye-slash::before{content:"\f340"}.bi-eye::before{content:"\f341"}.bi-eyedropper::before{content:"\f342"}.bi-eyeglasses::before{content:"\f343"}.bi-facebook::before{content:"\f344"}.bi-file-arrow-down-fill::before{content:"\f345"}.bi-file-arrow-down::before{content:"\f346"}.bi-file-arrow-up-fill::before{content:"\f347"}.bi-file-arrow-up::before{content:"\f348"}.bi-file-bar-graph-fill::before{content:"\f349"}.bi-file-bar-graph::before{content:"\f34a"}.bi-file-binary-fill::before{content:"\f34b"}.bi-file-binary::before{content:"\f34c"}.bi-file-break-fill::before{content:"\f34d"}.bi-file-break::before{content:"\f34e"}.bi-file-check-fill::before{content:"\f34f"}.bi-file-check::before{content:"\f350"}.bi-file-code-fill::before{content:"\f351"}.bi-file-code::before{content:"\f352"}.bi-file-diff-fill::before{content:"\f353"}.bi-file-diff::before{content:"\f354"}.bi-file-earmark-arrow-down-fill::before{content:"\f355"}.bi-file-earmark-arrow-down::before{content:"\f356"}.bi-file-earmark-arrow-up-fill::before{content:"\f357"}.bi-file-earmark-arrow-up::before{content:"\f358"}.bi-file-earmark-bar-graph-fill::before{content:"\f359"}.bi-file-earmark-bar-graph::before{content:"\f35a"}.bi-file-earmark-binary-fill::before{content:"\f35b"}.bi-file-earmark-binary::before{content:"\f35c"}.bi-file-earmark-break-fill::before{content:"\f35d"}.bi-file-earmark-break::before{content:"\f35e"}.bi-file-earmark-check-fill::before{content:"\f35f"}.bi-file-earmark-check::before{content:"\f360"}.bi-file-earmark-code-fill::before{content:"\f361"}.bi-file-earmark-code::before{content:"\f362"}.bi-file-earmark-diff-fill::before{content:"\f363"}.bi-file-earmark-diff::before{content:"\f364"}.bi-file-earmark-easel-fill::before{content:"\f365"}.bi-file-earmark-easel::before{content:"\f366"}.bi-file-earmark-excel-fill::before{content:"\f367"}.bi-file-earmark-excel::before{content:"\f368"}.bi-file-earmark-fill::before{content:"\f369"}.bi-file-earmark-font-fill::before{content:"\f36a"}.bi-file-earmark-font::before{content:"\f36b"}.bi-file-earmark-image-fill::before{content:"\f36c"}.bi-file-earmark-image::before{content:"\f36d"}.bi-file-earmark-lock-fill::before{content:"\f36e"}.bi-file-earmark-lock::before{content:"\f36f"}.bi-file-earmark-lock2-fill::before{content:"\f370"}.bi-file-earmark-lock2::before{content:"\f371"}.bi-file-earmark-medical-fill::before{content:"\f372"}.bi-file-earmark-medical::before{content:"\f373"}.bi-file-earmark-minus-fill::before{content:"\f374"}.bi-file-earmark-minus::before{content:"\f375"}.bi-file-earmark-music-fill::before{content:"\f376"}.bi-file-earmark-music::before{content:"\f377"}.bi-file-earmark-person-fill::before{content:"\f378"}.bi-file-earmark-person::before{content:"\f379"}.bi-file-earmark-play-fill::before{content:"\f37a"}.bi-file-earmark-play::before{content:"\f37b"}.bi-file-earmark-plus-fill::before{content:"\f37c"}.bi-file-earmark-plus::before{content:"\f37d"}.bi-file-earmark-post-fill::before{content:"\f37e"}.bi-file-earmark-post::before{content:"\f37f"}.bi-file-earmark-ppt-fill::before{content:"\f380"}.bi-file-earmark-ppt::before{content:"\f381"}.bi-file-earmark-richtext-fill::before{content:"\f382"}.bi-file-earmark-richtext::before{content:"\f383"}.bi-file-earmark-ruled-fill::before{content:"\f384"}.bi-file-earmark-ruled::before{content:"\f385"}.bi-file-earmark-slides-fill::before{content:"\f386"}.bi-file-earmark-slides::before{content:"\f387"}.bi-file-earmark-spreadsheet-fill::before{content:"\f388"}.bi-file-earmark-spreadsheet::before{content:"\f389"}.bi-file-earmark-text-fill::before{content:"\f38a"}.bi-file-earmark-text::before{content:"\f38b"}.bi-file-earmark-word-fill::before{content:"\f38c"}.bi-file-earmark-word::before{content:"\f38d"}.bi-file-earmark-x-fill::before{content:"\f38e"}.bi-file-earmark-x::before{content:"\f38f"}.bi-file-earmark-zip-fill::before{content:"\f390"}.bi-file-earmark-zip::before{content:"\f391"}.bi-file-earmark::before{content:"\f392"}.bi-file-easel-fill::before{content:"\f393"}.bi-file-easel::before{content:"\f394"}.bi-file-excel-fill::before{content:"\f395"}.bi-file-excel::before{content:"\f396"}.bi-file-fill::before{content:"\f397"}.bi-file-font-fill::before{content:"\f398"}.bi-file-font::before{content:"\f399"}.bi-file-image-fill::before{content:"\f39a"}.bi-file-image::before{content:"\f39b"}.bi-file-lock-fill::before{content:"\f39c"}.bi-file-lock::before{content:"\f39d"}.bi-file-lock2-fill::before{content:"\f39e"}.bi-file-lock2::before{content:"\f39f"}.bi-file-medical-fill::before{content:"\f3a0"}.bi-file-medical::before{content:"\f3a1"}.bi-file-minus-fill::before{content:"\f3a2"}.bi-file-minus::before{content:"\f3a3"}.bi-file-music-fill::before{content:"\f3a4"}.bi-file-music::before{content:"\f3a5"}.bi-file-person-fill::before{content:"\f3a6"}.bi-file-person::before{content:"\f3a7"}.bi-file-play-fill::before{content:"\f3a8"}.bi-file-play::before{content:"\f3a9"}.bi-file-plus-fill::before{content:"\f3aa"}.bi-file-plus::before{content:"\f3ab"}.bi-file-post-fill::before{content:"\f3ac"}.bi-file-post::before{content:"\f3ad"}.bi-file-ppt-fill::before{content:"\f3ae"}.bi-file-ppt::before{content:"\f3af"}.bi-file-richtext-fill::before{content:"\f3b0"}.bi-file-richtext::before{content:"\f3b1"}.bi-file-ruled-fill::before{content:"\f3b2"}.bi-file-ruled::before{content:"\f3b3"}.bi-file-slides-fill::before{content:"\f3b4"}.bi-file-slides::before{content:"\f3b5"}.bi-file-spreadsheet-fill::before{content:"\f3b6"}.bi-file-spreadsheet::before{content:"\f3b7"}.bi-file-text-fill::before{content:"\f3b8"}.bi-file-text::before{content:"\f3b9"}.bi-file-word-fill::before{content:"\f3ba"}.bi-file-word::before{content:"\f3bb"}.bi-file-x-fill::before{content:"\f3bc"}.bi-file-x::before{content:"\f3bd"}.bi-file-zip-fill::before{content:"\f3be"}.bi-file-zip::before{content:"\f3bf"}.bi-file::before{content:"\f3c0"}.bi-files-alt::before{content:"\f3c1"}.bi-files::before{content:"\f3c2"}.bi-film::before{content:"\f3c3"}.bi-filter-circle-fill::before{content:"\f3c4"}.bi-filter-circle::before{content:"\f3c5"}.bi-filter-left::before{content:"\f3c6"}.bi-filter-right::before{content:"\f3c7"}.bi-filter-square-fill::before{content:"\f3c8"}.bi-filter-square::before{content:"\f3c9"}.bi-filter::before{content:"\f3ca"}.bi-flag-fill::before{content:"\f3cb"}.bi-flag::before{content:"\f3cc"}.bi-flower1::before{content:"\f3cd"}.bi-flower2::before{content:"\f3ce"}.bi-flower3::before{content:"\f3cf"}.bi-folder-check::before{content:"\f3d0"}.bi-folder-fill::before{content:"\f3d1"}.bi-folder-minus::before{content:"\f3d2"}.bi-folder-plus::before{content:"\f3d3"}.bi-folder-symlink-fill::before{content:"\f3d4"}.bi-folder-symlink::before{content:"\f3d5"}.bi-folder-x::before{content:"\f3d6"}.bi-folder::before{content:"\f3d7"}.bi-folder2-open::before{content:"\f3d8"}.bi-folder2::before{content:"\f3d9"}.bi-fonts::before{content:"\f3da"}.bi-forward-fill::before{content:"\f3db"}.bi-forward::before{content:"\f3dc"}.bi-front::before{content:"\f3dd"}.bi-fullscreen-exit::before{content:"\f3de"}.bi-fullscreen::before{content:"\f3df"}.bi-funnel-fill::before{content:"\f3e0"}.bi-funnel::before{content:"\f3e1"}.bi-gear-fill::before{content:"\f3e2"}.bi-gear-wide-connected::before{content:"\f3e3"}.bi-gear-wide::before{content:"\f3e4"}.bi-gear::before{content:"\f3e5"}.bi-gem::before{content:"\f3e6"}.bi-geo-alt-fill::before{content:"\f3e7"}.bi-geo-alt::before{content:"\f3e8"}.bi-geo-fill::before{content:"\f3e9"}.bi-geo::before{content:"\f3ea"}.bi-gift-fill::before{content:"\f3eb"}.bi-gift::before{content:"\f3ec"}.bi-github::before{content:"\f3ed"}.bi-globe::before{content:"\f3ee"}.bi-globe2::before{content:"\f3ef"}.bi-google::before{content:"\f3f0"}.bi-graph-down::before{content:"\f3f1"}.bi-graph-up::before{content:"\f3f2"}.bi-grid-1x2-fill::before{content:"\f3f3"}.bi-grid-1x2::before{content:"\f3f4"}.bi-grid-3x2-gap-fill::before{content:"\f3f5"}.bi-grid-3x2-gap::before{content:"\f3f6"}.bi-grid-3x2::before{content:"\f3f7"}.bi-grid-3x3-gap-fill::before{content:"\f3f8"}.bi-grid-3x3-gap::before{content:"\f3f9"}.bi-grid-3x3::before{content:"\f3fa"}.bi-grid-fill::before{content:"\f3fb"}.bi-grid::before{content:"\f3fc"}.bi-grip-horizontal::before{content:"\f3fd"}.bi-grip-vertical::before{content:"\f3fe"}.bi-hammer::before{content:"\f3ff"}.bi-hand-index-fill::before{content:"\f400"}.bi-hand-index-thumb-fill::before{content:"\f401"}.bi-hand-index-thumb::before{content:"\f402"}.bi-hand-index::before{content:"\f403"}.bi-hand-thumbs-down-fill::before{content:"\f404"}.bi-hand-thumbs-down::before{content:"\f405"}.bi-hand-thumbs-up-fill::before{content:"\f406"}.bi-hand-thumbs-up::before{content:"\f407"}.bi-handbag-fill::before{content:"\f408"}.bi-handbag::before{content:"\f409"}.bi-hash::before{content:"\f40a"}.bi-hdd-fill::before{content:"\f40b"}.bi-hdd-network-fill::before{content:"\f40c"}.bi-hdd-network::before{content:"\f40d"}.bi-hdd-rack-fill::before{content:"\f40e"}.bi-hdd-rack::before{content:"\f40f"}.bi-hdd-stack-fill::before{content:"\f410"}.bi-hdd-stack::before{content:"\f411"}.bi-hdd::before{content:"\f412"}.bi-headphones::before{content:"\f413"}.bi-headset::before{content:"\f414"}.bi-heart-fill::before{content:"\f415"}.bi-heart-half::before{content:"\f416"}.bi-heart::before{content:"\f417"}.bi-heptagon-fill::before{content:"\f418"}.bi-heptagon-half::before{content:"\f419"}.bi-heptagon::before{content:"\f41a"}.bi-hexagon-fill::before{content:"\f41b"}.bi-hexagon-half::before{content:"\f41c"}.bi-hexagon::before{content:"\f41d"}.bi-hourglass-bottom::before{content:"\f41e"}.bi-hourglass-split::before{content:"\f41f"}.bi-hourglass-top::before{content:"\f420"}.bi-hourglass::before{content:"\f421"}.bi-house-door-fill::before{content:"\f422"}.bi-house-door::before{content:"\f423"}.bi-house-fill::before{content:"\f424"}.bi-house::before{content:"\f425"}.bi-hr::before{content:"\f426"}.bi-hurricane::before{content:"\f427"}.bi-image-alt::before{content:"\f428"}.bi-image-fill::before{content:"\f429"}.bi-image::before{content:"\f42a"}.bi-images::before{content:"\f42b"}.bi-inbox-fill::before{content:"\f42c"}.bi-inbox::before{content:"\f42d"}.bi-inboxes-fill::before{content:"\f42e"}.bi-inboxes::before{content:"\f42f"}.bi-info-circle-fill::before{content:"\f430"}.bi-info-circle::before{content:"\f431"}.bi-info-square-fill::before{content:"\f432"}.bi-info-square::before{content:"\f433"}.bi-info::before{content:"\f434"}.bi-input-cursor-text::before{content:"\f435"}.bi-input-cursor::before{content:"\f436"}.bi-instagram::before{content:"\f437"}.bi-intersect::before{content:"\f438"}.bi-journal-album::before{content:"\f439"}.bi-journal-arrow-down::before{content:"\f43a"}.bi-journal-arrow-up::before{content:"\f43b"}.bi-journal-bookmark-fill::before{content:"\f43c"}.bi-journal-bookmark::before{content:"\f43d"}.bi-journal-check::before{content:"\f43e"}.bi-journal-code::before{content:"\f43f"}.bi-journal-medical::before{content:"\f440"}.bi-journal-minus::before{content:"\f441"}.bi-journal-plus::before{content:"\f442"}.bi-journal-richtext::before{content:"\f443"}.bi-journal-text::before{content:"\f444"}.bi-journal-x::before{content:"\f445"}.bi-journal::before{content:"\f446"}.bi-journals::before{content:"\f447"}.bi-joystick::before{content:"\f448"}.bi-justify-left::before{content:"\f449"}.bi-justify-right::before{content:"\f44a"}.bi-justify::before{content:"\f44b"}.bi-kanban-fill::before{content:"\f44c"}.bi-kanban::before{content:"\f44d"}.bi-key-fill::before{content:"\f44e"}.bi-key::before{content:"\f44f"}.bi-keyboard-fill::before{content:"\f450"}.bi-keyboard::before{content:"\f451"}.bi-ladder::before{content:"\f452"}.bi-lamp-fill::before{content:"\f453"}.bi-lamp::before{content:"\f454"}.bi-laptop-fill::before{content:"\f455"}.bi-laptop::before{content:"\f456"}.bi-layer-backward::before{content:"\f457"}.bi-layer-forward::before{content:"\f458"}.bi-layers-fill::before{content:"\f459"}.bi-layers-half::before{content:"\f45a"}.bi-layers::before{content:"\f45b"}.bi-layout-sidebar-inset-reverse::before{content:"\f45c"}.bi-layout-sidebar-inset::before{content:"\f45d"}.bi-layout-sidebar-reverse::before{content:"\f45e"}.bi-layout-sidebar::before{content:"\f45f"}.bi-layout-split::before{content:"\f460"}.bi-layout-text-sidebar-reverse::before{content:"\f461"}.bi-layout-text-sidebar::before{content:"\f462"}.bi-layout-text-window-reverse::before{content:"\f463"}.bi-layout-text-window::before{content:"\f464"}.bi-layout-three-columns::before{content:"\f465"}.bi-layout-wtf::before{content:"\f466"}.bi-life-preserver::before{content:"\f467"}.bi-lightbulb-fill::before{content:"\f468"}.bi-lightbulb-off-fill::before{content:"\f469"}.bi-lightbulb-off::before{content:"\f46a"}.bi-lightbulb::before{content:"\f46b"}.bi-lightning-charge-fill::before{content:"\f46c"}.bi-lightning-charge::before{content:"\f46d"}.bi-lightning-fill::before{content:"\f46e"}.bi-lightning::before{content:"\f46f"}.bi-link-45deg::before{content:"\f470"}.bi-link::before{content:"\f471"}.bi-linkedin::before{content:"\f472"}.bi-list-check::before{content:"\f473"}.bi-list-nested::before{content:"\f474"}.bi-list-ol::before{content:"\f475"}.bi-list-stars::before{content:"\f476"}.bi-list-task::before{content:"\f477"}.bi-list-ul::before{content:"\f478"}.bi-list::before{content:"\f479"}.bi-lock-fill::before{content:"\f47a"}.bi-lock::before{content:"\f47b"}.bi-mailbox::before{content:"\f47c"}.bi-mailbox2::before{content:"\f47d"}.bi-map-fill::before{content:"\f47e"}.bi-map::before{content:"\f47f"}.bi-markdown-fill::before{content:"\f480"}.bi-markdown::before{content:"\f481"}.bi-mask::before{content:"\f482"}.bi-megaphone-fill::before{content:"\f483"}.bi-megaphone::before{content:"\f484"}.bi-menu-app-fill::before{content:"\f485"}.bi-menu-app::before{content:"\f486"}.bi-menu-button-fill::before{content:"\f487"}.bi-menu-button-wide-fill::before{content:"\f488"}.bi-menu-button-wide::before{content:"\f489"}.bi-menu-button::before{content:"\f48a"}.bi-menu-down::before{content:"\f48b"}.bi-menu-up::before{content:"\f48c"}.bi-mic-fill::before{content:"\f48d"}.bi-mic-mute-fill::before{content:"\f48e"}.bi-mic-mute::before{content:"\f48f"}.bi-mic::before{content:"\f490"}.bi-minecart-loaded::before{content:"\f491"}.bi-minecart::before{content:"\f492"}.bi-moisture::before{content:"\f493"}.bi-moon-fill::before{content:"\f494"}.bi-moon-stars-fill::before{content:"\f495"}.bi-moon-stars::before{content:"\f496"}.bi-moon::before{content:"\f497"}.bi-mouse-fill::before{content:"\f498"}.bi-mouse::before{content:"\f499"}.bi-mouse2-fill::before{content:"\f49a"}.bi-mouse2::before{content:"\f49b"}.bi-mouse3-fill::before{content:"\f49c"}.bi-mouse3::before{content:"\f49d"}.bi-music-note-beamed::before{content:"\f49e"}.bi-music-note-list::before{content:"\f49f"}.bi-music-note::before{content:"\f4a0"}.bi-music-player-fill::before{content:"\f4a1"}.bi-music-player::before{content:"\f4a2"}.bi-newspaper::before{content:"\f4a3"}.bi-node-minus-fill::before{content:"\f4a4"}.bi-node-minus::before{content:"\f4a5"}.bi-node-plus-fill::before{content:"\f4a6"}.bi-node-plus::before{content:"\f4a7"}.bi-nut-fill::before{content:"\f4a8"}.bi-nut::before{content:"\f4a9"}.bi-octagon-fill::before{content:"\f4aa"}.bi-octagon-half::before{content:"\f4ab"}.bi-octagon::before{content:"\f4ac"}.bi-option::before{content:"\f4ad"}.bi-outlet::before{content:"\f4ae"}.bi-paint-bucket::before{content:"\f4af"}.bi-palette-fill::before{content:"\f4b0"}.bi-palette::before{content:"\f4b1"}.bi-palette2::before{content:"\f4b2"}.bi-paperclip::before{content:"\f4b3"}.bi-paragraph::before{content:"\f4b4"}.bi-patch-check-fill::before{content:"\f4b5"}.bi-patch-check::before{content:"\f4b6"}.bi-patch-exclamation-fill::before{content:"\f4b7"}.bi-patch-exclamation::before{content:"\f4b8"}.bi-patch-minus-fill::before{content:"\f4b9"}.bi-patch-minus::before{content:"\f4ba"}.bi-patch-plus-fill::before{content:"\f4bb"}.bi-patch-plus::before{content:"\f4bc"}.bi-patch-question-fill::before{content:"\f4bd"}.bi-patch-question::before{content:"\f4be"}.bi-pause-btn-fill::before{content:"\f4bf"}.bi-pause-btn::before{content:"\f4c0"}.bi-pause-circle-fill::before{content:"\f4c1"}.bi-pause-circle::before{content:"\f4c2"}.bi-pause-fill::before{content:"\f4c3"}.bi-pause::before{content:"\f4c4"}.bi-peace-fill::before{content:"\f4c5"}.bi-peace::before{content:"\f4c6"}.bi-pen-fill::before{content:"\f4c7"}.bi-pen::before{content:"\f4c8"}.bi-pencil-fill::before{content:"\f4c9"}.bi-pencil-square::before{content:"\f4ca"}.bi-pencil::before{content:"\f4cb"}.bi-pentagon-fill::before{content:"\f4cc"}.bi-pentagon-half::before{content:"\f4cd"}.bi-pentagon::before{content:"\f4ce"}.bi-people-fill::before{content:"\f4cf"}.bi-people::before{content:"\f4d0"}.bi-percent::before{content:"\f4d1"}.bi-person-badge-fill::before{content:"\f4d2"}.bi-person-badge::before{content:"\f4d3"}.bi-person-bounding-box::before{content:"\f4d4"}.bi-person-check-fill::before{content:"\f4d5"}.bi-person-check::before{content:"\f4d6"}.bi-person-circle::before{content:"\f4d7"}.bi-person-dash-fill::before{content:"\f4d8"}.bi-person-dash::before{content:"\f4d9"}.bi-person-fill::before{content:"\f4da"}.bi-person-lines-fill::before{content:"\f4db"}.bi-person-plus-fill::before{content:"\f4dc"}.bi-person-plus::before{content:"\f4dd"}.bi-person-square::before{content:"\f4de"}.bi-person-x-fill::before{content:"\f4df"}.bi-person-x::before{content:"\f4e0"}.bi-person::before{content:"\f4e1"}.bi-phone-fill::before{content:"\f4e2"}.bi-phone-landscape-fill::before{content:"\f4e3"}.bi-phone-landscape::before{content:"\f4e4"}.bi-phone-vibrate-fill::before{content:"\f4e5"}.bi-phone-vibrate::before{content:"\f4e6"}.bi-phone::before{content:"\f4e7"}.bi-pie-chart-fill::before{content:"\f4e8"}.bi-pie-chart::before{content:"\f4e9"}.bi-pin-angle-fill::before{content:"\f4ea"}.bi-pin-angle::before{content:"\f4eb"}.bi-pin-fill::before{content:"\f4ec"}.bi-pin::before{content:"\f4ed"}.bi-pip-fill::before{content:"\f4ee"}.bi-pip::before{content:"\f4ef"}.bi-play-btn-fill::before{content:"\f4f0"}.bi-play-btn::before{content:"\f4f1"}.bi-play-circle-fill::before{content:"\f4f2"}.bi-play-circle::before{content:"\f4f3"}.bi-play-fill::before{content:"\f4f4"}.bi-play::before{content:"\f4f5"}.bi-plug-fill::before{content:"\f4f6"}.bi-plug::before{content:"\f4f7"}.bi-plus-circle-dotted::before{content:"\f4f8"}.bi-plus-circle-fill::before{content:"\f4f9"}.bi-plus-circle::before{content:"\f4fa"}.bi-plus-square-dotted::before{content:"\f4fb"}.bi-plus-square-fill::before{content:"\f4fc"}.bi-plus-square::before{content:"\f4fd"}.bi-plus::before{content:"\f4fe"}.bi-power::before{content:"\f4ff"}.bi-printer-fill::before{content:"\f500"}.bi-printer::before{content:"\f501"}.bi-puzzle-fill::before{content:"\f502"}.bi-puzzle::before{content:"\f503"}.bi-question-circle-fill::before{content:"\f504"}.bi-question-circle::before{content:"\f505"}.bi-question-diamond-fill::before{content:"\f506"}.bi-question-diamond::before{content:"\f507"}.bi-question-octagon-fill::before{content:"\f508"}.bi-question-octagon::before{content:"\f509"}.bi-question-square-fill::before{content:"\f50a"}.bi-question-square::before{content:"\f50b"}.bi-question::before{content:"\f50c"}.bi-rainbow::before{content:"\f50d"}.bi-receipt-cutoff::before{content:"\f50e"}.bi-receipt::before{content:"\f50f"}.bi-reception-0::before{content:"\f510"}.bi-reception-1::before{content:"\f511"}.bi-reception-2::before{content:"\f512"}.bi-reception-3::before{content:"\f513"}.bi-reception-4::before{content:"\f514"}.bi-record-btn-fill::before{content:"\f515"}.bi-record-btn::before{content:"\f516"}.bi-record-circle-fill::before{content:"\f517"}.bi-record-circle::before{content:"\f518"}.bi-record-fill::before{content:"\f519"}.bi-record::before{content:"\f51a"}.bi-record2-fill::before{content:"\f51b"}.bi-record2::before{content:"\f51c"}.bi-reply-all-fill::before{content:"\f51d"}.bi-reply-all::before{content:"\f51e"}.bi-reply-fill::before{content:"\f51f"}.bi-reply::before{content:"\f520"}.bi-rss-fill::before{content:"\f521"}.bi-rss::before{content:"\f522"}.bi-rulers::before{content:"\f523"}.bi-save-fill::before{content:"\f524"}.bi-save::before{content:"\f525"}.bi-save2-fill::before{content:"\f526"}.bi-save2::before{content:"\f527"}.bi-scissors::before{content:"\f528"}.bi-screwdriver::before{content:"\f529"}.bi-search::before{content:"\f52a"}.bi-segmented-nav::before{content:"\f52b"}.bi-server::before{content:"\f52c"}.bi-share-fill::before{content:"\f52d"}.bi-share::before{content:"\f52e"}.bi-shield-check::before{content:"\f52f"}.bi-shield-exclamation::before{content:"\f530"}.bi-shield-fill-check::before{content:"\f531"}.bi-shield-fill-exclamation::before{content:"\f532"}.bi-shield-fill-minus::before{content:"\f533"}.bi-shield-fill-plus::before{content:"\f534"}.bi-shield-fill-x::before{content:"\f535"}.bi-shield-fill::before{content:"\f536"}.bi-shield-lock-fill::before{content:"\f537"}.bi-shield-lock::before{content:"\f538"}.bi-shield-minus::before{content:"\f539"}.bi-shield-plus::before{content:"\f53a"}.bi-shield-shaded::before{content:"\f53b"}.bi-shield-slash-fill::before{content:"\f53c"}.bi-shield-slash::before{content:"\f53d"}.bi-shield-x::before{content:"\f53e"}.bi-shield::before{content:"\f53f"}.bi-shift-fill::before{content:"\f540"}.bi-shift::before{content:"\f541"}.bi-shop-window::before{content:"\f542"}.bi-shop::before{content:"\f543"}.bi-shuffle::before{content:"\f544"}.bi-signpost-2-fill::before{content:"\f545"}.bi-signpost-2::before{content:"\f546"}.bi-signpost-fill::before{content:"\f547"}.bi-signpost-split-fill::before{content:"\f548"}.bi-signpost-split::before{content:"\f549"}.bi-signpost::before{content:"\f54a"}.bi-sim-fill::before{content:"\f54b"}.bi-sim::before{content:"\f54c"}.bi-skip-backward-btn-fill::before{content:"\f54d"}.bi-skip-backward-btn::before{content:"\f54e"}.bi-skip-backward-circle-fill::before{content:"\f54f"}.bi-skip-backward-circle::before{content:"\f550"}.bi-skip-backward-fill::before{content:"\f551"}.bi-skip-backward::before{content:"\f552"}.bi-skip-end-btn-fill::before{content:"\f553"}.bi-skip-end-btn::before{content:"\f554"}.bi-skip-end-circle-fill::before{content:"\f555"}.bi-skip-end-circle::before{content:"\f556"}.bi-skip-end-fill::before{content:"\f557"}.bi-skip-end::before{content:"\f558"}.bi-skip-forward-btn-fill::before{content:"\f559"}.bi-skip-forward-btn::before{content:"\f55a"}.bi-skip-forward-circle-fill::before{content:"\f55b"}.bi-skip-forward-circle::before{content:"\f55c"}.bi-skip-forward-fill::before{content:"\f55d"}.bi-skip-forward::before{content:"\f55e"}.bi-skip-start-btn-fill::before{content:"\f55f"}.bi-skip-start-btn::before{content:"\f560"}.bi-skip-start-circle-fill::before{content:"\f561"}.bi-skip-start-circle::before{content:"\f562"}.bi-skip-start-fill::before{content:"\f563"}.bi-skip-start::before{content:"\f564"}.bi-slack::before{content:"\f565"}.bi-slash-circle-fill::before{content:"\f566"}.bi-slash-circle::before{content:"\f567"}.bi-slash-square-fill::before{content:"\f568"}.bi-slash-square::before{content:"\f569"}.bi-slash::before{content:"\f56a"}.bi-sliders::before{content:"\f56b"}.bi-smartwatch::before{content:"\f56c"}.bi-snow::before{content:"\f56d"}.bi-snow2::before{content:"\f56e"}.bi-snow3::before{content:"\f56f"}.bi-sort-alpha-down-alt::before{content:"\f570"}.bi-sort-alpha-down::before{content:"\f571"}.bi-sort-alpha-up-alt::before{content:"\f572"}.bi-sort-alpha-up::before{content:"\f573"}.bi-sort-down-alt::before{content:"\f574"}.bi-sort-down::before{content:"\f575"}.bi-sort-numeric-down-alt::before{content:"\f576"}.bi-sort-numeric-down::before{content:"\f577"}.bi-sort-numeric-up-alt::before{content:"\f578"}.bi-sort-numeric-up::before{content:"\f579"}.bi-sort-up-alt::before{content:"\f57a"}.bi-sort-up::before{content:"\f57b"}.bi-soundwave::before{content:"\f57c"}.bi-speaker-fill::before{content:"\f57d"}.bi-speaker::before{content:"\f57e"}.bi-speedometer::before{content:"\f57f"}.bi-speedometer2::before{content:"\f580"}.bi-spellcheck::before{content:"\f581"}.bi-square-fill::before{content:"\f582"}.bi-square-half::before{content:"\f583"}.bi-square::before{content:"\f584"}.bi-stack::before{content:"\f585"}.bi-star-fill::before{content:"\f586"}.bi-star-half::before{content:"\f587"}.bi-star::before{content:"\f588"}.bi-stars::before{content:"\f589"}.bi-stickies-fill::before{content:"\f58a"}.bi-stickies::before{content:"\f58b"}.bi-sticky-fill::before{content:"\f58c"}.bi-sticky::before{content:"\f58d"}.bi-stop-btn-fill::before{content:"\f58e"}.bi-stop-btn::before{content:"\f58f"}.bi-stop-circle-fill::before{content:"\f590"}.bi-stop-circle::before{content:"\f591"}.bi-stop-fill::before{content:"\f592"}.bi-stop::before{content:"\f593"}.bi-stoplights-fill::before{content:"\f594"}.bi-stoplights::before{content:"\f595"}.bi-stopwatch-fill::before{content:"\f596"}.bi-stopwatch::before{content:"\f597"}.bi-subtract::before{content:"\f598"}.bi-suit-club-fill::before{content:"\f599"}.bi-suit-club::before{content:"\f59a"}.bi-suit-diamond-fill::before{content:"\f59b"}.bi-suit-diamond::before{content:"\f59c"}.bi-suit-heart-fill::before{content:"\f59d"}.bi-suit-heart::before{content:"\f59e"}.bi-suit-spade-fill::before{content:"\f59f"}.bi-suit-spade::before{content:"\f5a0"}.bi-sun-fill::before{content:"\f5a1"}.bi-sun::before{content:"\f5a2"}.bi-sunglasses::before{content:"\f5a3"}.bi-sunrise-fill::before{content:"\f5a4"}.bi-sunrise::before{content:"\f5a5"}.bi-sunset-fill::before{content:"\f5a6"}.bi-sunset::before{content:"\f5a7"}.bi-symmetry-horizontal::before{content:"\f5a8"}.bi-symmetry-vertical::before{content:"\f5a9"}.bi-table::before{content:"\f5aa"}.bi-tablet-fill::before{content:"\f5ab"}.bi-tablet-landscape-fill::before{content:"\f5ac"}.bi-tablet-landscape::before{content:"\f5ad"}.bi-tablet::before{content:"\f5ae"}.bi-tag-fill::before{content:"\f5af"}.bi-tag::before{content:"\f5b0"}.bi-tags-fill::before{content:"\f5b1"}.bi-tags::before{content:"\f5b2"}.bi-telegram::before{content:"\f5b3"}.bi-telephone-fill::before{content:"\f5b4"}.bi-telephone-forward-fill::before{content:"\f5b5"}.bi-telephone-forward::before{content:"\f5b6"}.bi-telephone-inbound-fill::before{content:"\f5b7"}.bi-telephone-inbound::before{content:"\f5b8"}.bi-telephone-minus-fill::before{content:"\f5b9"}.bi-telephone-minus::before{content:"\f5ba"}.bi-telephone-outbound-fill::before{content:"\f5bb"}.bi-telephone-outbound::before{content:"\f5bc"}.bi-telephone-plus-fill::before{content:"\f5bd"}.bi-telephone-plus::before{content:"\f5be"}.bi-telephone-x-fill::before{content:"\f5bf"}.bi-telephone-x::before{content:"\f5c0"}.bi-telephone::before{content:"\f5c1"}.bi-terminal-fill::before{content:"\f5c2"}.bi-terminal::before{content:"\f5c3"}.bi-text-center::before{content:"\f5c4"}.bi-text-indent-left::before{content:"\f5c5"}.bi-text-indent-right::before{content:"\f5c6"}.bi-text-left::before{content:"\f5c7"}.bi-text-paragraph::before{content:"\f5c8"}.bi-text-right::before{content:"\f5c9"}.bi-textarea-resize::before{content:"\f5ca"}.bi-textarea-t::before{content:"\f5cb"}.bi-textarea::before{content:"\f5cc"}.bi-thermometer-half::before{content:"\f5cd"}.bi-thermometer-high::before{content:"\f5ce"}.bi-thermometer-low::before{content:"\f5cf"}.bi-thermometer-snow::before{content:"\f5d0"}.bi-thermometer-sun::before{content:"\f5d1"}.bi-thermometer::before{content:"\f5d2"}.bi-three-dots-vertical::before{content:"\f5d3"}.bi-three-dots::before{content:"\f5d4"}.bi-toggle-off::before{content:"\f5d5"}.bi-toggle-on::before{content:"\f5d6"}.bi-toggle2-off::before{content:"\f5d7"}.bi-toggle2-on::before{content:"\f5d8"}.bi-toggles::before{content:"\f5d9"}.bi-toggles2::before{content:"\f5da"}.bi-tools::before{content:"\f5db"}.bi-tornado::before{content:"\f5dc"}.bi-trash-fill::before{content:"\f5dd"}.bi-trash::before{content:"\f5de"}.bi-trash2-fill::before{content:"\f5df"}.bi-trash2::before{content:"\f5e0"}.bi-tree-fill::before{content:"\f5e1"}.bi-tree::before{content:"\f5e2"}.bi-triangle-fill::before{content:"\f5e3"}.bi-triangle-half::before{content:"\f5e4"}.bi-triangle::before{content:"\f5e5"}.bi-trophy-fill::before{content:"\f5e6"}.bi-trophy::before{content:"\f5e7"}.bi-tropical-storm::before{content:"\f5e8"}.bi-truck-flatbed::before{content:"\f5e9"}.bi-truck::before{content:"\f5ea"}.bi-tsunami::before{content:"\f5eb"}.bi-tv-fill::before{content:"\f5ec"}.bi-tv::before{content:"\f5ed"}.bi-twitch::before{content:"\f5ee"}.bi-twitter::before{content:"\f5ef"}.bi-type-bold::before{content:"\f5f0"}.bi-type-h1::before{content:"\f5f1"}.bi-type-h2::before{content:"\f5f2"}.bi-type-h3::before{content:"\f5f3"}.bi-type-italic::before{content:"\f5f4"}.bi-type-strikethrough::before{content:"\f5f5"}.bi-type-underline::before{content:"\f5f6"}.bi-type::before{content:"\f5f7"}.bi-ui-checks-grid::before{content:"\f5f8"}.bi-ui-checks::before{content:"\f5f9"}.bi-ui-radios-grid::before{content:"\f5fa"}.bi-ui-radios::before{content:"\f5fb"}.bi-umbrella-fill::before{content:"\f5fc"}.bi-umbrella::before{content:"\f5fd"}.bi-union::before{content:"\f5fe"}.bi-unlock-fill::before{content:"\f5ff"}.bi-unlock::before{content:"\f600"}.bi-upc-scan::before{content:"\f601"}.bi-upc::before{content:"\f602"}.bi-upload::before{content:"\f603"}.bi-vector-pen::before{content:"\f604"}.bi-view-list::before{content:"\f605"}.bi-view-stacked::before{content:"\f606"}.bi-vinyl-fill::before{content:"\f607"}.bi-vinyl::before{content:"\f608"}.bi-voicemail::before{content:"\f609"}.bi-volume-down-fill::before{content:"\f60a"}.bi-volume-down::before{content:"\f60b"}.bi-volume-mute-fill::before{content:"\f60c"}.bi-volume-mute::before{content:"\f60d"}.bi-volume-off-fill::before{content:"\f60e"}.bi-volume-off::before{content:"\f60f"}.bi-volume-up-fill::before{content:"\f610"}.bi-volume-up::before{content:"\f611"}.bi-vr::before{content:"\f612"}.bi-wallet-fill::before{content:"\f613"}.bi-wallet::before{content:"\f614"}.bi-wallet2::before{content:"\f615"}.bi-watch::before{content:"\f616"}.bi-water::before{content:"\f617"}.bi-whatsapp::before{content:"\f618"}.bi-wifi-1::before{content:"\f619"}.bi-wifi-2::before{content:"\f61a"}.bi-wifi-off::before{content:"\f61b"}.bi-wifi::before{content:"\f61c"}.bi-wind::before{content:"\f61d"}.bi-window-dock::before{content:"\f61e"}.bi-window-sidebar::before{content:"\f61f"}.bi-window::before{content:"\f620"}.bi-wrench::before{content:"\f621"}.bi-x-circle-fill::before{content:"\f622"}.bi-x-circle::before{content:"\f623"}.bi-x-diamond-fill::before{content:"\f624"}.bi-x-diamond::before{content:"\f625"}.bi-x-octagon-fill::before{content:"\f626"}.bi-x-octagon::before{content:"\f627"}.bi-x-square-fill::before{content:"\f628"}.bi-x-square::before{content:"\f629"}.bi-x::before{content:"\f62a"}.bi-youtube::before{content:"\f62b"}.bi-zoom-in::before{content:"\f62c"}.bi-zoom-out::before{content:"\f62d"}.bi-bank::before{content:"\f62e"}.bi-bank2::before{content:"\f62f"}.bi-bell-slash-fill::before{content:"\f630"}.bi-bell-slash::before{content:"\f631"}.bi-cash-coin::before{content:"\f632"}.bi-check-lg::before{content:"\f633"}.bi-coin::before{content:"\f634"}.bi-currency-bitcoin::before{content:"\f635"}.bi-currency-dollar::before{content:"\f636"}.bi-currency-euro::before{content:"\f637"}.bi-currency-exchange::before{content:"\f638"}.bi-currency-pound::before{content:"\f639"}.bi-currency-yen::before{content:"\f63a"}.bi-dash-lg::before{content:"\f63b"}.bi-exclamation-lg::before{content:"\f63c"}.bi-file-earmark-pdf-fill::before{content:"\f63d"}.bi-file-earmark-pdf::before{content:"\f63e"}.bi-file-pdf-fill::before{content:"\f63f"}.bi-file-pdf::before{content:"\f640"}.bi-gender-ambiguous::before{content:"\f641"}.bi-gender-female::before{content:"\f642"}.bi-gender-male::before{content:"\f643"}.bi-gender-trans::before{content:"\f644"}.bi-headset-vr::before{content:"\f645"}.bi-info-lg::before{content:"\f646"}.bi-mastodon::before{content:"\f647"}.bi-messenger::before{content:"\f648"}.bi-piggy-bank-fill::before{content:"\f649"}.bi-piggy-bank::before{content:"\f64a"}.bi-pin-map-fill::before{content:"\f64b"}.bi-pin-map::before{content:"\f64c"}.bi-plus-lg::before{content:"\f64d"}.bi-question-lg::before{content:"\f64e"}.bi-recycle::before{content:"\f64f"}.bi-reddit::before{content:"\f650"}.bi-safe-fill::before{content:"\f651"}.bi-safe2-fill::before{content:"\f652"}.bi-safe2::before{content:"\f653"}.bi-sd-card-fill::before{content:"\f654"}.bi-sd-card::before{content:"\f655"}.bi-skype::before{content:"\f656"}.bi-slash-lg::before{content:"\f657"}.bi-translate::before{content:"\f658"}.bi-x-lg::before{content:"\f659"}.bi-safe::before{content:"\f65a"}.bi-apple::before{content:"\f65b"}.bi-microsoft::before{content:"\f65d"}.bi-windows::before{content:"\f65e"}.bi-behance::before{content:"\f65c"}.bi-dribbble::before{content:"\f65f"}.bi-line::before{content:"\f660"}.bi-medium::before{content:"\f661"}.bi-paypal::before{content:"\f662"}.bi-pinterest::before{content:"\f663"}.bi-signal::before{content:"\f664"}.bi-snapchat::before{content:"\f665"}.bi-spotify::before{content:"\f666"}.bi-stack-overflow::before{content:"\f667"}.bi-strava::before{content:"\f668"}.bi-wordpress::before{content:"\f669"}.bi-vimeo::before{content:"\f66a"}.bi-activity::before{content:"\f66b"}.bi-easel2-fill::before{content:"\f66c"}.bi-easel2::before{content:"\f66d"}.bi-easel3-fill::before{content:"\f66e"}.bi-easel3::before{content:"\f66f"}.bi-fan::before{content:"\f670"}.bi-fingerprint::before{content:"\f671"}.bi-graph-down-arrow::before{content:"\f672"}.bi-graph-up-arrow::before{content:"\f673"}.bi-hypnotize::before{content:"\f674"}.bi-magic::before{content:"\f675"}.bi-person-rolodex::before{content:"\f676"}.bi-person-video::before{content:"\f677"}.bi-person-video2::before{content:"\f678"}.bi-person-video3::before{content:"\f679"}.bi-person-workspace::before{content:"\f67a"}.bi-radioactive::before{content:"\f67b"}.bi-webcam-fill::before{content:"\f67c"}.bi-webcam::before{content:"\f67d"}.bi-yin-yang::before{content:"\f67e"}.bi-bandaid-fill::before{content:"\f680"}.bi-bandaid::before{content:"\f681"}.bi-bluetooth::before{content:"\f682"}.bi-body-text::before{content:"\f683"}.bi-boombox::before{content:"\f684"}.bi-boxes::before{content:"\f685"}.bi-dpad-fill::before{content:"\f686"}.bi-dpad::before{content:"\f687"}.bi-ear-fill::before{content:"\f688"}.bi-ear::before{content:"\f689"}.bi-envelope-check-fill::before{content:"\f68b"}.bi-envelope-check::before{content:"\f68c"}.bi-envelope-dash-fill::before{content:"\f68e"}.bi-envelope-dash::before{content:"\f68f"}.bi-envelope-exclamation-fill::before{content:"\f691"}.bi-envelope-exclamation::before{content:"\f692"}.bi-envelope-plus-fill::before{content:"\f693"}.bi-envelope-plus::before{content:"\f694"}.bi-envelope-slash-fill::before{content:"\f696"}.bi-envelope-slash::before{content:"\f697"}.bi-envelope-x-fill::before{content:"\f699"}.bi-envelope-x::before{content:"\f69a"}.bi-explicit-fill::before{content:"\f69b"}.bi-explicit::before{content:"\f69c"}.bi-git::before{content:"\f69d"}.bi-infinity::before{content:"\f69e"}.bi-list-columns-reverse::before{content:"\f69f"}.bi-list-columns::before{content:"\f6a0"}.bi-meta::before{content:"\f6a1"}.bi-nintendo-switch::before{content:"\f6a4"}.bi-pc-display-horizontal::before{content:"\f6a5"}.bi-pc-display::before{content:"\f6a6"}.bi-pc-horizontal::before{content:"\f6a7"}.bi-pc::before{content:"\f6a8"}.bi-playstation::before{content:"\f6a9"}.bi-plus-slash-minus::before{content:"\f6aa"}.bi-projector-fill::before{content:"\f6ab"}.bi-projector::before{content:"\f6ac"}.bi-qr-code-scan::before{content:"\f6ad"}.bi-qr-code::before{content:"\f6ae"}.bi-quora::before{content:"\f6af"}.bi-quote::before{content:"\f6b0"}.bi-robot::before{content:"\f6b1"}.bi-send-check-fill::before{content:"\f6b2"}.bi-send-check::before{content:"\f6b3"}.bi-send-dash-fill::before{content:"\f6b4"}.bi-send-dash::before{content:"\f6b5"}.bi-send-exclamation-fill::before{content:"\f6b7"}.bi-send-exclamation::before{content:"\f6b8"}.bi-send-fill::before{content:"\f6b9"}.bi-send-plus-fill::before{content:"\f6ba"}.bi-send-plus::before{content:"\f6bb"}.bi-send-slash-fill::before{content:"\f6bc"}.bi-send-slash::before{content:"\f6bd"}.bi-send-x-fill::before{content:"\f6be"}.bi-send-x::before{content:"\f6bf"}.bi-send::before{content:"\f6c0"}.bi-steam::before{content:"\f6c1"}.bi-terminal-dash::before{content:"\f6c3"}.bi-terminal-plus::before{content:"\f6c4"}.bi-terminal-split::before{content:"\f6c5"}.bi-ticket-detailed-fill::before{content:"\f6c6"}.bi-ticket-detailed::before{content:"\f6c7"}.bi-ticket-fill::before{content:"\f6c8"}.bi-ticket-perforated-fill::before{content:"\f6c9"}.bi-ticket-perforated::before{content:"\f6ca"}.bi-ticket::before{content:"\f6cb"}.bi-tiktok::before{content:"\f6cc"}.bi-window-dash::before{content:"\f6cd"}.bi-window-desktop::before{content:"\f6ce"}.bi-window-fullscreen::before{content:"\f6cf"}.bi-window-plus::before{content:"\f6d0"}.bi-window-split::before{content:"\f6d1"}.bi-window-stack::before{content:"\f6d2"}.bi-window-x::before{content:"\f6d3"}.bi-xbox::before{content:"\f6d4"}.bi-ethernet::before{content:"\f6d5"}.bi-hdmi-fill::before{content:"\f6d6"}.bi-hdmi::before{content:"\f6d7"}.bi-usb-c-fill::before{content:"\f6d8"}.bi-usb-c::before{content:"\f6d9"}.bi-usb-fill::before{content:"\f6da"}.bi-usb-plug-fill::before{content:"\f6db"}.bi-usb-plug::before{content:"\f6dc"}.bi-usb-symbol::before{content:"\f6dd"}.bi-usb::before{content:"\f6de"}.bi-boombox-fill::before{content:"\f6df"}.bi-displayport::before{content:"\f6e1"}.bi-gpu-card::before{content:"\f6e2"}.bi-memory::before{content:"\f6e3"}.bi-modem-fill::before{content:"\f6e4"}.bi-modem::before{content:"\f6e5"}.bi-motherboard-fill::before{content:"\f6e6"}.bi-motherboard::before{content:"\f6e7"}.bi-optical-audio-fill::before{content:"\f6e8"}.bi-optical-audio::before{content:"\f6e9"}.bi-pci-card::before{content:"\f6ea"}.bi-router-fill::before{content:"\f6eb"}.bi-router::before{content:"\f6ec"}.bi-thunderbolt-fill::before{content:"\f6ef"}.bi-thunderbolt::before{content:"\f6f0"}.bi-usb-drive-fill::before{content:"\f6f1"}.bi-usb-drive::before{content:"\f6f2"}.bi-usb-micro-fill::before{content:"\f6f3"}.bi-usb-micro::before{content:"\f6f4"}.bi-usb-mini-fill::before{content:"\f6f5"}.bi-usb-mini::before{content:"\f6f6"}.bi-cloud-haze2::before{content:"\f6f7"}.bi-device-hdd-fill::before{content:"\f6f8"}.bi-device-hdd::before{content:"\f6f9"}.bi-device-ssd-fill::before{content:"\f6fa"}.bi-device-ssd::before{content:"\f6fb"}.bi-displayport-fill::before{content:"\f6fc"}.bi-mortarboard-fill::before{content:"\f6fd"}.bi-mortarboard::before{content:"\f6fe"}.bi-terminal-x::before{content:"\f6ff"}.bi-arrow-through-heart-fill::before{content:"\f700"}.bi-arrow-through-heart::before{content:"\f701"}.bi-badge-sd-fill::before{content:"\f702"}.bi-badge-sd::before{content:"\f703"}.bi-bag-heart-fill::before{content:"\f704"}.bi-bag-heart::before{content:"\f705"}.bi-balloon-fill::before{content:"\f706"}.bi-balloon-heart-fill::before{content:"\f707"}.bi-balloon-heart::before{content:"\f708"}.bi-balloon::before{content:"\f709"}.bi-box2-fill::before{content:"\f70a"}.bi-box2-heart-fill::before{content:"\f70b"}.bi-box2-heart::before{content:"\f70c"}.bi-box2::before{content:"\f70d"}.bi-braces-asterisk::before{content:"\f70e"}.bi-calendar-heart-fill::before{content:"\f70f"}.bi-calendar-heart::before{content:"\f710"}.bi-calendar2-heart-fill::before{content:"\f711"}.bi-calendar2-heart::before{content:"\f712"}.bi-chat-heart-fill::before{content:"\f713"}.bi-chat-heart::before{content:"\f714"}.bi-chat-left-heart-fill::before{content:"\f715"}.bi-chat-left-heart::before{content:"\f716"}.bi-chat-right-heart-fill::before{content:"\f717"}.bi-chat-right-heart::before{content:"\f718"}.bi-chat-square-heart-fill::before{content:"\f719"}.bi-chat-square-heart::before{content:"\f71a"}.bi-clipboard-check-fill::before{content:"\f71b"}.bi-clipboard-data-fill::before{content:"\f71c"}.bi-clipboard-fill::before{content:"\f71d"}.bi-clipboard-heart-fill::before{content:"\f71e"}.bi-clipboard-heart::before{content:"\f71f"}.bi-clipboard-minus-fill::before{content:"\f720"}.bi-clipboard-plus-fill::before{content:"\f721"}.bi-clipboard-pulse::before{content:"\f722"}.bi-clipboard-x-fill::before{content:"\f723"}.bi-clipboard2-check-fill::before{content:"\f724"}.bi-clipboard2-check::before{content:"\f725"}.bi-clipboard2-data-fill::before{content:"\f726"}.bi-clipboard2-data::before{content:"\f727"}.bi-clipboard2-fill::before{content:"\f728"}.bi-clipboard2-heart-fill::before{content:"\f729"}.bi-clipboard2-heart::before{content:"\f72a"}.bi-clipboard2-minus-fill::before{content:"\f72b"}.bi-clipboard2-minus::before{content:"\f72c"}.bi-clipboard2-plus-fill::before{content:"\f72d"}.bi-clipboard2-plus::before{content:"\f72e"}.bi-clipboard2-pulse-fill::before{content:"\f72f"}.bi-clipboard2-pulse::before{content:"\f730"}.bi-clipboard2-x-fill::before{content:"\f731"}.bi-clipboard2-x::before{content:"\f732"}.bi-clipboard2::before{content:"\f733"}.bi-emoji-kiss-fill::before{content:"\f734"}.bi-emoji-kiss::before{content:"\f735"}.bi-envelope-heart-fill::before{content:"\f736"}.bi-envelope-heart::before{content:"\f737"}.bi-envelope-open-heart-fill::before{content:"\f738"}.bi-envelope-open-heart::before{content:"\f739"}.bi-envelope-paper-fill::before{content:"\f73a"}.bi-envelope-paper-heart-fill::before{content:"\f73b"}.bi-envelope-paper-heart::before{content:"\f73c"}.bi-envelope-paper::before{content:"\f73d"}.bi-filetype-aac::before{content:"\f73e"}.bi-filetype-ai::before{content:"\f73f"}.bi-filetype-bmp::before{content:"\f740"}.bi-filetype-cs::before{content:"\f741"}.bi-filetype-css::before{content:"\f742"}.bi-filetype-csv::before{content:"\f743"}.bi-filetype-doc::before{content:"\f744"}.bi-filetype-docx::before{content:"\f745"}.bi-filetype-exe::before{content:"\f746"}.bi-filetype-gif::before{content:"\f747"}.bi-filetype-heic::before{content:"\f748"}.bi-filetype-html::before{content:"\f749"}.bi-filetype-java::before{content:"\f74a"}.bi-filetype-jpg::before{content:"\f74b"}.bi-filetype-js::before{content:"\f74c"}.bi-filetype-jsx::before{content:"\f74d"}.bi-filetype-key::before{content:"\f74e"}.bi-filetype-m4p::before{content:"\f74f"}.bi-filetype-md::before{content:"\f750"}.bi-filetype-mdx::before{content:"\f751"}.bi-filetype-mov::before{content:"\f752"}.bi-filetype-mp3::before{content:"\f753"}.bi-filetype-mp4::before{content:"\f754"}.bi-filetype-otf::before{content:"\f755"}.bi-filetype-pdf::before{content:"\f756"}.bi-filetype-php::before{content:"\f757"}.bi-filetype-png::before{content:"\f758"}.bi-filetype-ppt::before{content:"\f75a"}.bi-filetype-psd::before{content:"\f75b"}.bi-filetype-py::before{content:"\f75c"}.bi-filetype-raw::before{content:"\f75d"}.bi-filetype-rb::before{content:"\f75e"}.bi-filetype-sass::before{content:"\f75f"}.bi-filetype-scss::before{content:"\f760"}.bi-filetype-sh::before{content:"\f761"}.bi-filetype-svg::before{content:"\f762"}.bi-filetype-tiff::before{content:"\f763"}.bi-filetype-tsx::before{content:"\f764"}.bi-filetype-ttf::before{content:"\f765"}.bi-filetype-txt::before{content:"\f766"}.bi-filetype-wav::before{content:"\f767"}.bi-filetype-woff::before{content:"\f768"}.bi-filetype-xls::before{content:"\f76a"}.bi-filetype-xml::before{content:"\f76b"}.bi-filetype-yml::before{content:"\f76c"}.bi-heart-arrow::before{content:"\f76d"}.bi-heart-pulse-fill::before{content:"\f76e"}.bi-heart-pulse::before{content:"\f76f"}.bi-heartbreak-fill::before{content:"\f770"}.bi-heartbreak::before{content:"\f771"}.bi-hearts::before{content:"\f772"}.bi-hospital-fill::before{content:"\f773"}.bi-hospital::before{content:"\f774"}.bi-house-heart-fill::before{content:"\f775"}.bi-house-heart::before{content:"\f776"}.bi-incognito::before{content:"\f777"}.bi-magnet-fill::before{content:"\f778"}.bi-magnet::before{content:"\f779"}.bi-person-heart::before{content:"\f77a"}.bi-person-hearts::before{content:"\f77b"}.bi-phone-flip::before{content:"\f77c"}.bi-plugin::before{content:"\f77d"}.bi-postage-fill::before{content:"\f77e"}.bi-postage-heart-fill::before{content:"\f77f"}.bi-postage-heart::before{content:"\f780"}.bi-postage::before{content:"\f781"}.bi-postcard-fill::before{content:"\f782"}.bi-postcard-heart-fill::before{content:"\f783"}.bi-postcard-heart::before{content:"\f784"}.bi-postcard::before{content:"\f785"}.bi-search-heart-fill::before{content:"\f786"}.bi-search-heart::before{content:"\f787"}.bi-sliders2-vertical::before{content:"\f788"}.bi-sliders2::before{content:"\f789"}.bi-trash3-fill::before{content:"\f78a"}.bi-trash3::before{content:"\f78b"}.bi-valentine::before{content:"\f78c"}.bi-valentine2::before{content:"\f78d"}.bi-wrench-adjustable-circle-fill::before{content:"\f78e"}.bi-wrench-adjustable-circle::before{content:"\f78f"}.bi-wrench-adjustable::before{content:"\f790"}.bi-filetype-json::before{content:"\f791"}.bi-filetype-pptx::before{content:"\f792"}.bi-filetype-xlsx::before{content:"\f793"}.bi-1-circle-fill::before{content:"\f796"}.bi-1-circle::before{content:"\f797"}.bi-1-square-fill::before{content:"\f798"}.bi-1-square::before{content:"\f799"}.bi-2-circle-fill::before{content:"\f79c"}.bi-2-circle::before{content:"\f79d"}.bi-2-square-fill::before{content:"\f79e"}.bi-2-square::before{content:"\f79f"}.bi-3-circle-fill::before{content:"\f7a2"}.bi-3-circle::before{content:"\f7a3"}.bi-3-square-fill::before{content:"\f7a4"}.bi-3-square::before{content:"\f7a5"}.bi-4-circle-fill::before{content:"\f7a8"}.bi-4-circle::before{content:"\f7a9"}.bi-4-square-fill::before{content:"\f7aa"}.bi-4-square::before{content:"\f7ab"}.bi-5-circle-fill::before{content:"\f7ae"}.bi-5-circle::before{content:"\f7af"}.bi-5-square-fill::before{content:"\f7b0"}.bi-5-square::before{content:"\f7b1"}.bi-6-circle-fill::before{content:"\f7b4"}.bi-6-circle::before{content:"\f7b5"}.bi-6-square-fill::before{content:"\f7b6"}.bi-6-square::before{content:"\f7b7"}.bi-7-circle-fill::before{content:"\f7ba"}.bi-7-circle::before{content:"\f7bb"}.bi-7-square-fill::before{content:"\f7bc"}.bi-7-square::before{content:"\f7bd"}.bi-8-circle-fill::before{content:"\f7c0"}.bi-8-circle::before{content:"\f7c1"}.bi-8-square-fill::before{content:"\f7c2"}.bi-8-square::before{content:"\f7c3"}.bi-9-circle-fill::before{content:"\f7c6"}.bi-9-circle::before{content:"\f7c7"}.bi-9-square-fill::before{content:"\f7c8"}.bi-9-square::before{content:"\f7c9"}.bi-airplane-engines-fill::before{content:"\f7ca"}.bi-airplane-engines::before{content:"\f7cb"}.bi-airplane-fill::before{content:"\f7cc"}.bi-airplane::before{content:"\f7cd"}.bi-alexa::before{content:"\f7ce"}.bi-alipay::before{content:"\f7cf"}.bi-android::before{content:"\f7d0"}.bi-android2::before{content:"\f7d1"}.bi-box-fill::before{content:"\f7d2"}.bi-box-seam-fill::before{content:"\f7d3"}.bi-browser-chrome::before{content:"\f7d4"}.bi-browser-edge::before{content:"\f7d5"}.bi-browser-firefox::before{content:"\f7d6"}.bi-browser-safari::before{content:"\f7d7"}.bi-c-circle-fill::before{content:"\f7da"}.bi-c-circle::before{content:"\f7db"}.bi-c-square-fill::before{content:"\f7dc"}.bi-c-square::before{content:"\f7dd"}.bi-capsule-pill::before{content:"\f7de"}.bi-capsule::before{content:"\f7df"}.bi-car-front-fill::before{content:"\f7e0"}.bi-car-front::before{content:"\f7e1"}.bi-cassette-fill::before{content:"\f7e2"}.bi-cassette::before{content:"\f7e3"}.bi-cc-circle-fill::before{content:"\f7e6"}.bi-cc-circle::before{content:"\f7e7"}.bi-cc-square-fill::before{content:"\f7e8"}.bi-cc-square::before{content:"\f7e9"}.bi-cup-hot-fill::before{content:"\f7ea"}.bi-cup-hot::before{content:"\f7eb"}.bi-currency-rupee::before{content:"\f7ec"}.bi-dropbox::before{content:"\f7ed"}.bi-escape::before{content:"\f7ee"}.bi-fast-forward-btn-fill::before{content:"\f7ef"}.bi-fast-forward-btn::before{content:"\f7f0"}.bi-fast-forward-circle-fill::before{content:"\f7f1"}.bi-fast-forward-circle::before{content:"\f7f2"}.bi-fast-forward-fill::before{content:"\f7f3"}.bi-fast-forward::before{content:"\f7f4"}.bi-filetype-sql::before{content:"\f7f5"}.bi-fire::before{content:"\f7f6"}.bi-google-play::before{content:"\f7f7"}.bi-h-circle-fill::before{content:"\f7fa"}.bi-h-circle::before{content:"\f7fb"}.bi-h-square-fill::before{content:"\f7fc"}.bi-h-square::before{content:"\f7fd"}.bi-indent::before{content:"\f7fe"}.bi-lungs-fill::before{content:"\f7ff"}.bi-lungs::before{content:"\f800"}.bi-microsoft-teams::before{content:"\f801"}.bi-p-circle-fill::before{content:"\f804"}.bi-p-circle::before{content:"\f805"}.bi-p-square-fill::before{content:"\f806"}.bi-p-square::before{content:"\f807"}.bi-pass-fill::before{content:"\f808"}.bi-pass::before{content:"\f809"}.bi-prescription::before{content:"\f80a"}.bi-prescription2::before{content:"\f80b"}.bi-r-circle-fill::before{content:"\f80e"}.bi-r-circle::before{content:"\f80f"}.bi-r-square-fill::before{content:"\f810"}.bi-r-square::before{content:"\f811"}.bi-repeat-1::before{content:"\f812"}.bi-repeat::before{content:"\f813"}.bi-rewind-btn-fill::before{content:"\f814"}.bi-rewind-btn::before{content:"\f815"}.bi-rewind-circle-fill::before{content:"\f816"}.bi-rewind-circle::before{content:"\f817"}.bi-rewind-fill::before{content:"\f818"}.bi-rewind::before{content:"\f819"}.bi-train-freight-front-fill::before{content:"\f81a"}.bi-train-freight-front::before{content:"\f81b"}.bi-train-front-fill::before{content:"\f81c"}.bi-train-front::before{content:"\f81d"}.bi-train-lightrail-front-fill::before{content:"\f81e"}.bi-train-lightrail-front::before{content:"\f81f"}.bi-truck-front-fill::before{content:"\f820"}.bi-truck-front::before{content:"\f821"}.bi-ubuntu::before{content:"\f822"}.bi-unindent::before{content:"\f823"}.bi-unity::before{content:"\f824"}.bi-universal-access-circle::before{content:"\f825"}.bi-universal-access::before{content:"\f826"}.bi-virus::before{content:"\f827"}.bi-virus2::before{content:"\f828"}.bi-wechat::before{content:"\f829"}.bi-yelp::before{content:"\f82a"}.bi-sign-stop-fill::before{content:"\f82b"}.bi-sign-stop-lights-fill::before{content:"\f82c"}.bi-sign-stop-lights::before{content:"\f82d"}.bi-sign-stop::before{content:"\f82e"}.bi-sign-turn-left-fill::before{content:"\f82f"}.bi-sign-turn-left::before{content:"\f830"}.bi-sign-turn-right-fill::before{content:"\f831"}.bi-sign-turn-right::before{content:"\f832"}.bi-sign-turn-slight-left-fill::before{content:"\f833"}.bi-sign-turn-slight-left::before{content:"\f834"}.bi-sign-turn-slight-right-fill::before{content:"\f835"}.bi-sign-turn-slight-right::before{content:"\f836"}.bi-sign-yield-fill::before{content:"\f837"}.bi-sign-yield::before{content:"\f838"}.bi-ev-station-fill::before{content:"\f839"}.bi-ev-station::before{content:"\f83a"}.bi-fuel-pump-diesel-fill::before{content:"\f83b"}.bi-fuel-pump-diesel::before{content:"\f83c"}.bi-fuel-pump-fill::before{content:"\f83d"}.bi-fuel-pump::before{content:"\f83e"}.bi-0-circle-fill::before{content:"\f83f"}.bi-0-circle::before{content:"\f840"}.bi-0-square-fill::before{content:"\f841"}.bi-0-square::before{content:"\f842"}.bi-rocket-fill::before{content:"\f843"}.bi-rocket-takeoff-fill::before{content:"\f844"}.bi-rocket-takeoff::before{content:"\f845"}.bi-rocket::before{content:"\f846"}.bi-stripe::before{content:"\f847"}.bi-subscript::before{content:"\f848"}.bi-superscript::before{content:"\f849"}.bi-trello::before{content:"\f84a"}.bi-envelope-at-fill::before{content:"\f84b"}.bi-envelope-at::before{content:"\f84c"}.bi-regex::before{content:"\f84d"}.bi-text-wrap::before{content:"\f84e"}.bi-sign-dead-end-fill::before{content:"\f84f"}.bi-sign-dead-end::before{content:"\f850"}.bi-sign-do-not-enter-fill::before{content:"\f851"}.bi-sign-do-not-enter::before{content:"\f852"}.bi-sign-intersection-fill::before{content:"\f853"}.bi-sign-intersection-side-fill::before{content:"\f854"}.bi-sign-intersection-side::before{content:"\f855"}.bi-sign-intersection-t-fill::before{content:"\f856"}.bi-sign-intersection-t::before{content:"\f857"}.bi-sign-intersection-y-fill::before{content:"\f858"}.bi-sign-intersection-y::before{content:"\f859"}.bi-sign-intersection::before{content:"\f85a"}.bi-sign-merge-left-fill::before{content:"\f85b"}.bi-sign-merge-left::before{content:"\f85c"}.bi-sign-merge-right-fill::before{content:"\f85d"}.bi-sign-merge-right::before{content:"\f85e"}.bi-sign-no-left-turn-fill::before{content:"\f85f"}.bi-sign-no-left-turn::before{content:"\f860"}.bi-sign-no-parking-fill::before{content:"\f861"}.bi-sign-no-parking::before{content:"\f862"}.bi-sign-no-right-turn-fill::before{content:"\f863"}.bi-sign-no-right-turn::before{content:"\f864"}.bi-sign-railroad-fill::before{content:"\f865"}.bi-sign-railroad::before{content:"\f866"}.bi-building-add::before{content:"\f867"}.bi-building-check::before{content:"\f868"}.bi-building-dash::before{content:"\f869"}.bi-building-down::before{content:"\f86a"}.bi-building-exclamation::before{content:"\f86b"}.bi-building-fill-add::before{content:"\f86c"}.bi-building-fill-check::before{content:"\f86d"}.bi-building-fill-dash::before{content:"\f86e"}.bi-building-fill-down::before{content:"\f86f"}.bi-building-fill-exclamation::before{content:"\f870"}.bi-building-fill-gear::before{content:"\f871"}.bi-building-fill-lock::before{content:"\f872"}.bi-building-fill-slash::before{content:"\f873"}.bi-building-fill-up::before{content:"\f874"}.bi-building-fill-x::before{content:"\f875"}.bi-building-fill::before{content:"\f876"}.bi-building-gear::before{content:"\f877"}.bi-building-lock::before{content:"\f878"}.bi-building-slash::before{content:"\f879"}.bi-building-up::before{content:"\f87a"}.bi-building-x::before{content:"\f87b"}.bi-buildings-fill::before{content:"\f87c"}.bi-buildings::before{content:"\f87d"}.bi-bus-front-fill::before{content:"\f87e"}.bi-bus-front::before{content:"\f87f"}.bi-ev-front-fill::before{content:"\f880"}.bi-ev-front::before{content:"\f881"}.bi-globe-americas::before{content:"\f882"}.bi-globe-asia-australia::before{content:"\f883"}.bi-globe-central-south-asia::before{content:"\f884"}.bi-globe-europe-africa::before{content:"\f885"}.bi-house-add-fill::before{content:"\f886"}.bi-house-add::before{content:"\f887"}.bi-house-check-fill::before{content:"\f888"}.bi-house-check::before{content:"\f889"}.bi-house-dash-fill::before{content:"\f88a"}.bi-house-dash::before{content:"\f88b"}.bi-house-down-fill::before{content:"\f88c"}.bi-house-down::before{content:"\f88d"}.bi-house-exclamation-fill::before{content:"\f88e"}.bi-house-exclamation::before{content:"\f88f"}.bi-house-gear-fill::before{content:"\f890"}.bi-house-gear::before{content:"\f891"}.bi-house-lock-fill::before{content:"\f892"}.bi-house-lock::before{content:"\f893"}.bi-house-slash-fill::before{content:"\f894"}.bi-house-slash::before{content:"\f895"}.bi-house-up-fill::before{content:"\f896"}.bi-house-up::before{content:"\f897"}.bi-house-x-fill::before{content:"\f898"}.bi-house-x::before{content:"\f899"}.bi-person-add::before{content:"\f89a"}.bi-person-down::before{content:"\f89b"}.bi-person-exclamation::before{content:"\f89c"}.bi-person-fill-add::before{content:"\f89d"}.bi-person-fill-check::before{content:"\f89e"}.bi-person-fill-dash::before{content:"\f89f"}.bi-person-fill-down::before{content:"\f8a0"}.bi-person-fill-exclamation::before{content:"\f8a1"}.bi-person-fill-gear::before{content:"\f8a2"}.bi-person-fill-lock::before{content:"\f8a3"}.bi-person-fill-slash::before{content:"\f8a4"}.bi-person-fill-up::before{content:"\f8a5"}.bi-person-fill-x::before{content:"\f8a6"}.bi-person-gear::before{content:"\f8a7"}.bi-person-lock::before{content:"\f8a8"}.bi-person-slash::before{content:"\f8a9"}.bi-person-up::before{content:"\f8aa"}.bi-scooter::before{content:"\f8ab"}.bi-taxi-front-fill::before{content:"\f8ac"}.bi-taxi-front::before{content:"\f8ad"}.bi-amd::before{content:"\f8ae"}.bi-database-add::before{content:"\f8af"}.bi-database-check::before{content:"\f8b0"}.bi-database-dash::before{content:"\f8b1"}.bi-database-down::before{content:"\f8b2"}.bi-database-exclamation::before{content:"\f8b3"}.bi-database-fill-add::before{content:"\f8b4"}.bi-database-fill-check::before{content:"\f8b5"}.bi-database-fill-dash::before{content:"\f8b6"}.bi-database-fill-down::before{content:"\f8b7"}.bi-database-fill-exclamation::before{content:"\f8b8"}.bi-database-fill-gear::before{content:"\f8b9"}.bi-database-fill-lock::before{content:"\f8ba"}.bi-database-fill-slash::before{content:"\f8bb"}.bi-database-fill-up::before{content:"\f8bc"}.bi-database-fill-x::before{content:"\f8bd"}.bi-database-fill::before{content:"\f8be"}.bi-database-gear::before{content:"\f8bf"}.bi-database-lock::before{content:"\f8c0"}.bi-database-slash::before{content:"\f8c1"}.bi-database-up::before{content:"\f8c2"}.bi-database-x::before{content:"\f8c3"}.bi-database::before{content:"\f8c4"}.bi-houses-fill::before{content:"\f8c5"}.bi-houses::before{content:"\f8c6"}.bi-nvidia::before{content:"\f8c7"}.bi-person-vcard-fill::before{content:"\f8c8"}.bi-person-vcard::before{content:"\f8c9"}.bi-sina-weibo::before{content:"\f8ca"}.bi-tencent-qq::before{content:"\f8cb"}.bi-wikipedia::before{content:"\f8cc"}.bi-alphabet-uppercase::before{content:"\f2a5"}.bi-alphabet::before{content:"\f68a"}.bi-amazon::before{content:"\f68d"}.bi-arrows-collapse-vertical::before{content:"\f690"}.bi-arrows-expand-vertical::before{content:"\f695"}.bi-arrows-vertical::before{content:"\f698"}.bi-arrows::before{content:"\f6a2"}.bi-ban-fill::before{content:"\f6a3"}.bi-ban::before{content:"\f6b6"}.bi-bing::before{content:"\f6c2"}.bi-cake::before{content:"\f6e0"}.bi-cake2::before{content:"\f6ed"}.bi-cookie::before{content:"\f6ee"}.bi-copy::before{content:"\f759"}.bi-crosshair::before{content:"\f769"}.bi-crosshair2::before{content:"\f794"}.bi-emoji-astonished-fill::before{content:"\f795"}.bi-emoji-astonished::before{content:"\f79a"}.bi-emoji-grimace-fill::before{content:"\f79b"}.bi-emoji-grimace::before{content:"\f7a0"}.bi-emoji-grin-fill::before{content:"\f7a1"}.bi-emoji-grin::before{content:"\f7a6"}.bi-emoji-surprise-fill::before{content:"\f7a7"}.bi-emoji-surprise::before{content:"\f7ac"}.bi-emoji-tear-fill::before{content:"\f7ad"}.bi-emoji-tear::before{content:"\f7b2"}.bi-envelope-arrow-down-fill::before{content:"\f7b3"}.bi-envelope-arrow-down::before{content:"\f7b8"}.bi-envelope-arrow-up-fill::before{content:"\f7b9"}.bi-envelope-arrow-up::before{content:"\f7be"}.bi-feather::before{content:"\f7bf"}.bi-feather2::before{content:"\f7c4"}.bi-floppy-fill::before{content:"\f7c5"}.bi-floppy::before{content:"\f7d8"}.bi-floppy2-fill::before{content:"\f7d9"}.bi-floppy2::before{content:"\f7e4"}.bi-gitlab::before{content:"\f7e5"}.bi-highlighter::before{content:"\f7f8"}.bi-marker-tip::before{content:"\f802"}.bi-nvme-fill::before{content:"\f803"}.bi-nvme::before{content:"\f80c"}.bi-opencollective::before{content:"\f80d"}.bi-pci-card-network::before{content:"\f8cd"}.bi-pci-card-sound::before{content:"\f8ce"}.bi-radar::before{content:"\f8cf"}.bi-send-arrow-down-fill::before{content:"\f8d0"}.bi-send-arrow-down::before{content:"\f8d1"}.bi-send-arrow-up-fill::before{content:"\f8d2"}.bi-send-arrow-up::before{content:"\f8d3"}.bi-sim-slash-fill::before{content:"\f8d4"}.bi-sim-slash::before{content:"\f8d5"}.bi-sourceforge::before{content:"\f8d6"}.bi-substack::before{content:"\f8d7"}.bi-threads-fill::before{content:"\f8d8"}.bi-threads::before{content:"\f8d9"}.bi-transparency::before{content:"\f8da"}.bi-twitter-x::before{content:"\f8db"}.bi-type-h4::before{content:"\f8dc"}.bi-type-h5::before{content:"\f8dd"}.bi-type-h6::before{content:"\f8de"}.bi-backpack-fill::before{content:"\f8df"}.bi-backpack::before{content:"\f8e0"}.bi-backpack2-fill::before{content:"\f8e1"}.bi-backpack2::before{content:"\f8e2"}.bi-backpack3-fill::before{content:"\f8e3"}.bi-backpack3::before{content:"\f8e4"}.bi-backpack4-fill::before{content:"\f8e5"}.bi-backpack4::before{content:"\f8e6"}.bi-brilliance::before{content:"\f8e7"}.bi-cake-fill::before{content:"\f8e8"}.bi-cake2-fill::before{content:"\f8e9"}.bi-duffle-fill::before{content:"\f8ea"}.bi-duffle::before{content:"\f8eb"}.bi-exposure::before{content:"\f8ec"}.bi-gender-neuter::before{content:"\f8ed"}.bi-highlights::before{content:"\f8ee"}.bi-luggage-fill::before{content:"\f8ef"}.bi-luggage::before{content:"\f8f0"}.bi-mailbox-flag::before{content:"\f8f1"}.bi-mailbox2-flag::before{content:"\f8f2"}.bi-noise-reduction::before{content:"\f8f3"}.bi-passport-fill::before{content:"\f8f4"}.bi-passport::before{content:"\f8f5"}.bi-person-arms-up::before{content:"\f8f6"}.bi-person-raised-hand::before{content:"\f8f7"}.bi-person-standing-dress::before{content:"\f8f8"}.bi-person-standing::before{content:"\f8f9"}.bi-person-walking::before{content:"\f8fa"}.bi-person-wheelchair::before{content:"\f8fb"}.bi-shadows::before{content:"\f8fc"}.bi-suitcase-fill::before{content:"\f8fd"}.bi-suitcase-lg-fill::before{content:"\f8fe"}.bi-suitcase-lg::before{content:"\f8ff"}.bi-suitcase::before{content:"\f900"}.bi-suitcase2-fill::before{content:"\f901"}.bi-suitcase2::before{content:"\f902"}.bi-vignette::before{content:"\f903"}
</file>

<file path="payisp/css/bootstrap.min.css">
@charset "UTF-8";/*!
 * Bootstrap  v5.3.3 (https://getbootstrap.com/)
 * Copyright 2011-2024 The Bootstrap Authors
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
 */:root,[data-bs-theme=light]{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-primary-text-emphasis:#052c65;--bs-secondary-text-emphasis:#2b2f32;--bs-success-text-emphasis:#0a3622;--bs-info-text-emphasis:#055160;--bs-warning-text-emphasis:#664d03;--bs-danger-text-emphasis:#58151c;--bs-light-text-emphasis:#495057;--bs-dark-text-emphasis:#495057;--bs-primary-bg-subtle:#cfe2ff;--bs-secondary-bg-subtle:#e2e3e5;--bs-success-bg-subtle:#d1e7dd;--bs-info-bg-subtle:#cff4fc;--bs-warning-bg-subtle:#fff3cd;--bs-danger-bg-subtle:#f8d7da;--bs-light-bg-subtle:#fcfcfd;--bs-dark-bg-subtle:#ced4da;--bs-primary-border-subtle:#9ec5fe;--bs-secondary-border-subtle:#c4c8cb;--bs-success-border-subtle:#a3cfbb;--bs-info-border-subtle:#9eeaf9;--bs-warning-border-subtle:#ffe69c;--bs-danger-border-subtle:#f1aeb5;--bs-light-border-subtle:#e9ecef;--bs-dark-border-subtle:#adb5bd;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-color-rgb:33,37,41;--bs-body-bg:#fff;--bs-body-bg-rgb:255,255,255;--bs-emphasis-color:#000;--bs-emphasis-color-rgb:0,0,0;--bs-secondary-color:rgba(33, 37, 41, 0.75);--bs-secondary-color-rgb:33,37,41;--bs-secondary-bg:#e9ecef;--bs-secondary-bg-rgb:233,236,239;--bs-tertiary-color:rgba(33, 37, 41, 0.5);--bs-tertiary-color-rgb:33,37,41;--bs-tertiary-bg:#f8f9fa;--bs-tertiary-bg-rgb:248,249,250;--bs-heading-color:inherit;--bs-link-color:#0d6efd;--bs-link-color-rgb:13,110,253;--bs-link-decoration:underline;--bs-link-hover-color:#0a58ca;--bs-link-hover-color-rgb:10,88,202;--bs-code-color:#d63384;--bs-highlight-color:#212529;--bs-highlight-bg:#fff3cd;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0, 0, 0, 0.175);--bs-border-radius:0.375rem;--bs-border-radius-sm:0.25rem;--bs-border-radius-lg:0.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-xxl:2rem;--bs-border-radius-2xl:var(--bs-border-radius-xxl);--bs-border-radius-pill:50rem;--bs-box-shadow:0 0.5rem 1rem rgba(0, 0, 0, 0.15);--bs-box-shadow-sm:0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);--bs-box-shadow-lg:0 1rem 3rem rgba(0, 0, 0, 0.175);--bs-box-shadow-inset:inset 0 1px 2px rgba(0, 0, 0, 0.075);--bs-focus-ring-width:0.25rem;--bs-focus-ring-opacity:0.25;--bs-focus-ring-color:rgba(13, 110, 253, 0.25);--bs-form-valid-color:#198754;--bs-form-valid-border-color:#198754;--bs-form-invalid-color:#dc3545;--bs-form-invalid-border-color:#dc3545}[data-bs-theme=dark]{color-scheme:dark;--bs-body-color:#dee2e6;--bs-body-color-rgb:222,226,230;--bs-body-bg:#212529;--bs-body-bg-rgb:33,37,41;--bs-emphasis-color:#fff;--bs-emphasis-color-rgb:255,255,255;--bs-secondary-color:rgba(222, 226, 230, 0.75);--bs-secondary-color-rgb:222,226,230;--bs-secondary-bg:#343a40;--bs-secondary-bg-rgb:52,58,64;--bs-tertiary-color:rgba(222, 226, 230, 0.5);--bs-tertiary-color-rgb:222,226,230;--bs-tertiary-bg:#2b3035;--bs-tertiary-bg-rgb:43,48,53;--bs-primary-text-emphasis:#6ea8fe;--bs-secondary-text-emphasis:#a7acb1;--bs-success-text-emphasis:#75b798;--bs-info-text-emphasis:#6edff6;--bs-warning-text-emphasis:#ffda6a;--bs-danger-text-emphasis:#ea868f;--bs-light-text-emphasis:#f8f9fa;--bs-dark-text-emphasis:#dee2e6;--bs-primary-bg-subtle:#031633;--bs-secondary-bg-subtle:#161719;--bs-success-bg-subtle:#051b11;--bs-info-bg-subtle:#032830;--bs-warning-bg-subtle:#332701;--bs-danger-bg-subtle:#2c0b0e;--bs-light-bg-subtle:#343a40;--bs-dark-bg-subtle:#1a1d20;--bs-primary-border-subtle:#084298;--bs-secondary-border-subtle:#41464b;--bs-success-border-subtle:#0f5132;--bs-info-border-subtle:#087990;--bs-warning-border-subtle:#997404;--bs-danger-border-subtle:#842029;--bs-light-border-subtle:#495057;--bs-dark-border-subtle:#343a40;--bs-heading-color:inherit;--bs-link-color:#6ea8fe;--bs-link-hover-color:#8bb9fe;--bs-link-color-rgb:110,168,254;--bs-link-hover-color-rgb:139,185,254;--bs-code-color:#e685b5;--bs-highlight-color:#dee2e6;--bs-highlight-bg:#664d03;--bs-border-color:#495057;--bs-border-color-translucent:rgba(255, 255, 255, 0.15);--bs-form-valid-color:#75b798;--bs-form-valid-border-color:#75b798;--bs-form-invalid-color:#ea868f;--bs-form-invalid-border-color:#ea868f}*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;border:0;border-top:var(--bs-border-width) solid;opacity:.25}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2;color:var(--bs-heading-color)}.h1,h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){.h1,h1{font-size:2.5rem}}.h2,h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){.h2,h2{font-size:2rem}}.h3,h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){.h3,h3{font-size:1.75rem}}.h4,h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){.h4,h4{font-size:1.5rem}}.h5,h5{font-size:1.25rem}.h6,h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}.small,small{font-size:.875em}.mark,mark{padding:.1875em;color:var(--bs-highlight-color);background-color:var(--bs-highlight-bg)}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,1));text-decoration:underline}a:hover{--bs-link-color-rgb:var(--bs-link-hover-color-rgb)}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:var(--bs-font-monospace);font-size:1em}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:var(--bs-code-color);word-wrap:break-word}a>code{color:inherit}kbd{padding:.1875rem .375rem;font-size:.875em;color:var(--bs-body-bg);background-color:var(--bs-body-color);border-radius:.25rem}kbd kbd{padding:0;font-size:1em}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-secondary-color);text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]:not([type=date]):not([type=datetime-local]):not([type=month]):not([type=week]):not([type=time])::-webkit-calendar-picker-indicator{display:none!important}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}::file-selector-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:calc(1.625rem + 4.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-1{font-size:5rem}}.display-2{font-size:calc(1.575rem + 3.9vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-2{font-size:4.5rem}}.display-3{font-size:calc(1.525rem + 3.3vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-3{font-size:4rem}}.display-4{font-size:calc(1.475rem + 2.7vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-4{font-size:3.5rem}}.display-5{font-size:calc(1.425rem + 2.1vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-5{font-size:3rem}}.display-6{font-size:calc(1.375rem + 1.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-6{font-size:2.5rem}}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;list-style:none}.list-inline-item{display:inline-block}.list-inline-item:not(:last-child){margin-right:.5rem}.initialism{font-size:.875em;text-transform:uppercase}.blockquote{margin-bottom:1rem;font-size:1.25rem}.blockquote>:last-child{margin-bottom:0}.blockquote-footer{margin-top:-1rem;margin-bottom:1rem;font-size:.875em;color:#6c757d}.blockquote-footer::before{content:""}.img-fluid{max-width:100%;height:auto}.img-thumbnail{padding:.25rem;background-color:var(--bs-body-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);max-width:100%;height:auto}.figure{display:inline-block}.figure-img{margin-bottom:.5rem;line-height:1}.figure-caption{font-size:.875em;color:var(--bs-secondary-color)}.container,.container-fluid,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{--bs-gutter-x:1.5rem;--bs-gutter-y:0;width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-right:auto;margin-left:auto}@media (min-width:576px){.container,.container-sm{max-width:540px}}@media (min-width:768px){.container,.container-md,.container-sm{max-width:720px}}@media (min-width:992px){.container,.container-lg,.container-md,.container-sm{max-width:960px}}@media (min-width:1200px){.container,.container-lg,.container-md,.container-sm,.container-xl{max-width:1140px}}@media (min-width:1400px){.container,.container-lg,.container-md,.container-sm,.container-xl,.container-xxl{max-width:1320px}}:root{--bs-breakpoint-xs:0;--bs-breakpoint-sm:576px;--bs-breakpoint-md:768px;--bs-breakpoint-lg:992px;--bs-breakpoint-xl:1200px;--bs-breakpoint-xxl:1400px}.row{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1 * var(--bs-gutter-y));margin-right:calc(-.5 * var(--bs-gutter-x));margin-left:calc(-.5 * var(--bs-gutter-x))}.row>*{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-top:var(--bs-gutter-y)}.col{flex:1 0 0%}.row-cols-auto>*{flex:0 0 auto;width:auto}.row-cols-1>*{flex:0 0 auto;width:100%}.row-cols-2>*{flex:0 0 auto;width:50%}.row-cols-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-4>*{flex:0 0 auto;width:25%}.row-cols-5>*{flex:0 0 auto;width:20%}.row-cols-6>*{flex:0 0 auto;width:16.66666667%}.col-auto{flex:0 0 auto;width:auto}.col-1{flex:0 0 auto;width:8.33333333%}.col-2{flex:0 0 auto;width:16.66666667%}.col-3{flex:0 0 auto;width:25%}.col-4{flex:0 0 auto;width:33.33333333%}.col-5{flex:0 0 auto;width:41.66666667%}.col-6{flex:0 0 auto;width:50%}.col-7{flex:0 0 auto;width:58.33333333%}.col-8{flex:0 0 auto;width:66.66666667%}.col-9{flex:0 0 auto;width:75%}.col-10{flex:0 0 auto;width:83.33333333%}.col-11{flex:0 0 auto;width:91.66666667%}.col-12{flex:0 0 auto;width:100%}.offset-1{margin-left:8.33333333%}.offset-2{margin-left:16.66666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.33333333%}.offset-5{margin-left:41.66666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.33333333%}.offset-8{margin-left:66.66666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.33333333%}.offset-11{margin-left:91.66666667%}.g-0,.gx-0{--bs-gutter-x:0}.g-0,.gy-0{--bs-gutter-y:0}.g-1,.gx-1{--bs-gutter-x:0.25rem}.g-1,.gy-1{--bs-gutter-y:0.25rem}.g-2,.gx-2{--bs-gutter-x:0.5rem}.g-2,.gy-2{--bs-gutter-y:0.5rem}.g-3,.gx-3{--bs-gutter-x:1rem}.g-3,.gy-3{--bs-gutter-y:1rem}.g-4,.gx-4{--bs-gutter-x:1.5rem}.g-4,.gy-4{--bs-gutter-y:1.5rem}.g-5,.gx-5{--bs-gutter-x:3rem}.g-5,.gy-5{--bs-gutter-y:3rem}@media (min-width:576px){.col-sm{flex:1 0 0%}.row-cols-sm-auto>*{flex:0 0 auto;width:auto}.row-cols-sm-1>*{flex:0 0 auto;width:100%}.row-cols-sm-2>*{flex:0 0 auto;width:50%}.row-cols-sm-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-sm-4>*{flex:0 0 auto;width:25%}.row-cols-sm-5>*{flex:0 0 auto;width:20%}.row-cols-sm-6>*{flex:0 0 auto;width:16.66666667%}.col-sm-auto{flex:0 0 auto;width:auto}.col-sm-1{flex:0 0 auto;width:8.33333333%}.col-sm-2{flex:0 0 auto;width:16.66666667%}.col-sm-3{flex:0 0 auto;width:25%}.col-sm-4{flex:0 0 auto;width:33.33333333%}.col-sm-5{flex:0 0 auto;width:41.66666667%}.col-sm-6{flex:0 0 auto;width:50%}.col-sm-7{flex:0 0 auto;width:58.33333333%}.col-sm-8{flex:0 0 auto;width:66.66666667%}.col-sm-9{flex:0 0 auto;width:75%}.col-sm-10{flex:0 0 auto;width:83.33333333%}.col-sm-11{flex:0 0 auto;width:91.66666667%}.col-sm-12{flex:0 0 auto;width:100%}.offset-sm-0{margin-left:0}.offset-sm-1{margin-left:8.33333333%}.offset-sm-2{margin-left:16.66666667%}.offset-sm-3{margin-left:25%}.offset-sm-4{margin-left:33.33333333%}.offset-sm-5{margin-left:41.66666667%}.offset-sm-6{margin-left:50%}.offset-sm-7{margin-left:58.33333333%}.offset-sm-8{margin-left:66.66666667%}.offset-sm-9{margin-left:75%}.offset-sm-10{margin-left:83.33333333%}.offset-sm-11{margin-left:91.66666667%}.g-sm-0,.gx-sm-0{--bs-gutter-x:0}.g-sm-0,.gy-sm-0{--bs-gutter-y:0}.g-sm-1,.gx-sm-1{--bs-gutter-x:0.25rem}.g-sm-1,.gy-sm-1{--bs-gutter-y:0.25rem}.g-sm-2,.gx-sm-2{--bs-gutter-x:0.5rem}.g-sm-2,.gy-sm-2{--bs-gutter-y:0.5rem}.g-sm-3,.gx-sm-3{--bs-gutter-x:1rem}.g-sm-3,.gy-sm-3{--bs-gutter-y:1rem}.g-sm-4,.gx-sm-4{--bs-gutter-x:1.5rem}.g-sm-4,.gy-sm-4{--bs-gutter-y:1.5rem}.g-sm-5,.gx-sm-5{--bs-gutter-x:3rem}.g-sm-5,.gy-sm-5{--bs-gutter-y:3rem}}@media (min-width:768px){.col-md{flex:1 0 0%}.row-cols-md-auto>*{flex:0 0 auto;width:auto}.row-cols-md-1>*{flex:0 0 auto;width:100%}.row-cols-md-2>*{flex:0 0 auto;width:50%}.row-cols-md-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-md-4>*{flex:0 0 auto;width:25%}.row-cols-md-5>*{flex:0 0 auto;width:20%}.row-cols-md-6>*{flex:0 0 auto;width:16.66666667%}.col-md-auto{flex:0 0 auto;width:auto}.col-md-1{flex:0 0 auto;width:8.33333333%}.col-md-2{flex:0 0 auto;width:16.66666667%}.col-md-3{flex:0 0 auto;width:25%}.col-md-4{flex:0 0 auto;width:33.33333333%}.col-md-5{flex:0 0 auto;width:41.66666667%}.col-md-6{flex:0 0 auto;width:50%}.col-md-7{flex:0 0 auto;width:58.33333333%}.col-md-8{flex:0 0 auto;width:66.66666667%}.col-md-9{flex:0 0 auto;width:75%}.col-md-10{flex:0 0 auto;width:83.33333333%}.col-md-11{flex:0 0 auto;width:91.66666667%}.col-md-12{flex:0 0 auto;width:100%}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.33333333%}.offset-md-2{margin-left:16.66666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.33333333%}.offset-md-5{margin-left:41.66666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.33333333%}.offset-md-8{margin-left:66.66666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.33333333%}.offset-md-11{margin-left:91.66666667%}.g-md-0,.gx-md-0{--bs-gutter-x:0}.g-md-0,.gy-md-0{--bs-gutter-y:0}.g-md-1,.gx-md-1{--bs-gutter-x:0.25rem}.g-md-1,.gy-md-1{--bs-gutter-y:0.25rem}.g-md-2,.gx-md-2{--bs-gutter-x:0.5rem}.g-md-2,.gy-md-2{--bs-gutter-y:0.5rem}.g-md-3,.gx-md-3{--bs-gutter-x:1rem}.g-md-3,.gy-md-3{--bs-gutter-y:1rem}.g-md-4,.gx-md-4{--bs-gutter-x:1.5rem}.g-md-4,.gy-md-4{--bs-gutter-y:1.5rem}.g-md-5,.gx-md-5{--bs-gutter-x:3rem}.g-md-5,.gy-md-5{--bs-gutter-y:3rem}}@media (min-width:992px){.col-lg{flex:1 0 0%}.row-cols-lg-auto>*{flex:0 0 auto;width:auto}.row-cols-lg-1>*{flex:0 0 auto;width:100%}.row-cols-lg-2>*{flex:0 0 auto;width:50%}.row-cols-lg-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-lg-4>*{flex:0 0 auto;width:25%}.row-cols-lg-5>*{flex:0 0 auto;width:20%}.row-cols-lg-6>*{flex:0 0 auto;width:16.66666667%}.col-lg-auto{flex:0 0 auto;width:auto}.col-lg-1{flex:0 0 auto;width:8.33333333%}.col-lg-2{flex:0 0 auto;width:16.66666667%}.col-lg-3{flex:0 0 auto;width:25%}.col-lg-4{flex:0 0 auto;width:33.33333333%}.col-lg-5{flex:0 0 auto;width:41.66666667%}.col-lg-6{flex:0 0 auto;width:50%}.col-lg-7{flex:0 0 auto;width:58.33333333%}.col-lg-8{flex:0 0 auto;width:66.66666667%}.col-lg-9{flex:0 0 auto;width:75%}.col-lg-10{flex:0 0 auto;width:83.33333333%}.col-lg-11{flex:0 0 auto;width:91.66666667%}.col-lg-12{flex:0 0 auto;width:100%}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.33333333%}.offset-lg-2{margin-left:16.66666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.33333333%}.offset-lg-5{margin-left:41.66666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.33333333%}.offset-lg-8{margin-left:66.66666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.33333333%}.offset-lg-11{margin-left:91.66666667%}.g-lg-0,.gx-lg-0{--bs-gutter-x:0}.g-lg-0,.gy-lg-0{--bs-gutter-y:0}.g-lg-1,.gx-lg-1{--bs-gutter-x:0.25rem}.g-lg-1,.gy-lg-1{--bs-gutter-y:0.25rem}.g-lg-2,.gx-lg-2{--bs-gutter-x:0.5rem}.g-lg-2,.gy-lg-2{--bs-gutter-y:0.5rem}.g-lg-3,.gx-lg-3{--bs-gutter-x:1rem}.g-lg-3,.gy-lg-3{--bs-gutter-y:1rem}.g-lg-4,.gx-lg-4{--bs-gutter-x:1.5rem}.g-lg-4,.gy-lg-4{--bs-gutter-y:1.5rem}.g-lg-5,.gx-lg-5{--bs-gutter-x:3rem}.g-lg-5,.gy-lg-5{--bs-gutter-y:3rem}}@media (min-width:1200px){.col-xl{flex:1 0 0%}.row-cols-xl-auto>*{flex:0 0 auto;width:auto}.row-cols-xl-1>*{flex:0 0 auto;width:100%}.row-cols-xl-2>*{flex:0 0 auto;width:50%}.row-cols-xl-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-xl-4>*{flex:0 0 auto;width:25%}.row-cols-xl-5>*{flex:0 0 auto;width:20%}.row-cols-xl-6>*{flex:0 0 auto;width:16.66666667%}.col-xl-auto{flex:0 0 auto;width:auto}.col-xl-1{flex:0 0 auto;width:8.33333333%}.col-xl-2{flex:0 0 auto;width:16.66666667%}.col-xl-3{flex:0 0 auto;width:25%}.col-xl-4{flex:0 0 auto;width:33.33333333%}.col-xl-5{flex:0 0 auto;width:41.66666667%}.col-xl-6{flex:0 0 auto;width:50%}.col-xl-7{flex:0 0 auto;width:58.33333333%}.col-xl-8{flex:0 0 auto;width:66.66666667%}.col-xl-9{flex:0 0 auto;width:75%}.col-xl-10{flex:0 0 auto;width:83.33333333%}.col-xl-11{flex:0 0 auto;width:91.66666667%}.col-xl-12{flex:0 0 auto;width:100%}.offset-xl-0{margin-left:0}.offset-xl-1{margin-left:8.33333333%}.offset-xl-2{margin-left:16.66666667%}.offset-xl-3{margin-left:25%}.offset-xl-4{margin-left:33.33333333%}.offset-xl-5{margin-left:41.66666667%}.offset-xl-6{margin-left:50%}.offset-xl-7{margin-left:58.33333333%}.offset-xl-8{margin-left:66.66666667%}.offset-xl-9{margin-left:75%}.offset-xl-10{margin-left:83.33333333%}.offset-xl-11{margin-left:91.66666667%}.g-xl-0,.gx-xl-0{--bs-gutter-x:0}.g-xl-0,.gy-xl-0{--bs-gutter-y:0}.g-xl-1,.gx-xl-1{--bs-gutter-x:0.25rem}.g-xl-1,.gy-xl-1{--bs-gutter-y:0.25rem}.g-xl-2,.gx-xl-2{--bs-gutter-x:0.5rem}.g-xl-2,.gy-xl-2{--bs-gutter-y:0.5rem}.g-xl-3,.gx-xl-3{--bs-gutter-x:1rem}.g-xl-3,.gy-xl-3{--bs-gutter-y:1rem}.g-xl-4,.gx-xl-4{--bs-gutter-x:1.5rem}.g-xl-4,.gy-xl-4{--bs-gutter-y:1.5rem}.g-xl-5,.gx-xl-5{--bs-gutter-x:3rem}.g-xl-5,.gy-xl-5{--bs-gutter-y:3rem}}@media (min-width:1400px){.col-xxl{flex:1 0 0%}.row-cols-xxl-auto>*{flex:0 0 auto;width:auto}.row-cols-xxl-1>*{flex:0 0 auto;width:100%}.row-cols-xxl-2>*{flex:0 0 auto;width:50%}.row-cols-xxl-3>*{flex:0 0 auto;width:33.33333333%}.row-cols-xxl-4>*{flex:0 0 auto;width:25%}.row-cols-xxl-5>*{flex:0 0 auto;width:20%}.row-cols-xxl-6>*{flex:0 0 auto;width:16.66666667%}.col-xxl-auto{flex:0 0 auto;width:auto}.col-xxl-1{flex:0 0 auto;width:8.33333333%}.col-xxl-2{flex:0 0 auto;width:16.66666667%}.col-xxl-3{flex:0 0 auto;width:25%}.col-xxl-4{flex:0 0 auto;width:33.33333333%}.col-xxl-5{flex:0 0 auto;width:41.66666667%}.col-xxl-6{flex:0 0 auto;width:50%}.col-xxl-7{flex:0 0 auto;width:58.33333333%}.col-xxl-8{flex:0 0 auto;width:66.66666667%}.col-xxl-9{flex:0 0 auto;width:75%}.col-xxl-10{flex:0 0 auto;width:83.33333333%}.col-xxl-11{flex:0 0 auto;width:91.66666667%}.col-xxl-12{flex:0 0 auto;width:100%}.offset-xxl-0{margin-left:0}.offset-xxl-1{margin-left:8.33333333%}.offset-xxl-2{margin-left:16.66666667%}.offset-xxl-3{margin-left:25%}.offset-xxl-4{margin-left:33.33333333%}.offset-xxl-5{margin-left:41.66666667%}.offset-xxl-6{margin-left:50%}.offset-xxl-7{margin-left:58.33333333%}.offset-xxl-8{margin-left:66.66666667%}.offset-xxl-9{margin-left:75%}.offset-xxl-10{margin-left:83.33333333%}.offset-xxl-11{margin-left:91.66666667%}.g-xxl-0,.gx-xxl-0{--bs-gutter-x:0}.g-xxl-0,.gy-xxl-0{--bs-gutter-y:0}.g-xxl-1,.gx-xxl-1{--bs-gutter-x:0.25rem}.g-xxl-1,.gy-xxl-1{--bs-gutter-y:0.25rem}.g-xxl-2,.gx-xxl-2{--bs-gutter-x:0.5rem}.g-xxl-2,.gy-xxl-2{--bs-gutter-y:0.5rem}.g-xxl-3,.gx-xxl-3{--bs-gutter-x:1rem}.g-xxl-3,.gy-xxl-3{--bs-gutter-y:1rem}.g-xxl-4,.gx-xxl-4{--bs-gutter-x:1.5rem}.g-xxl-4,.gy-xxl-4{--bs-gutter-y:1.5rem}.g-xxl-5,.gx-xxl-5{--bs-gutter-x:3rem}.g-xxl-5,.gy-xxl-5{--bs-gutter-y:3rem}}.table{--bs-table-color-type:initial;--bs-table-bg-type:initial;--bs-table-color-state:initial;--bs-table-bg-state:initial;--bs-table-color:var(--bs-emphasis-color);--bs-table-bg:var(--bs-body-bg);--bs-table-border-color:var(--bs-border-color);--bs-table-accent-bg:transparent;--bs-table-striped-color:var(--bs-emphasis-color);--bs-table-striped-bg:rgba(var(--bs-emphasis-color-rgb), 0.05);--bs-table-active-color:var(--bs-emphasis-color);--bs-table-active-bg:rgba(var(--bs-emphasis-color-rgb), 0.1);--bs-table-hover-color:var(--bs-emphasis-color);--bs-table-hover-bg:rgba(var(--bs-emphasis-color-rgb), 0.075);width:100%;margin-bottom:1rem;vertical-align:top;border-color:var(--bs-table-border-color)}.table>:not(caption)>*>*{padding:.5rem .5rem;color:var(--bs-table-color-state,var(--bs-table-color-type,var(--bs-table-color)));background-color:var(--bs-table-bg);border-bottom-width:var(--bs-border-width);box-shadow:inset 0 0 0 9999px var(--bs-table-bg-state,var(--bs-table-bg-type,var(--bs-table-accent-bg)))}.table>tbody{vertical-align:inherit}.table>thead{vertical-align:bottom}.table-group-divider{border-top:calc(var(--bs-border-width) * 2) solid currentcolor}.caption-top{caption-side:top}.table-sm>:not(caption)>*>*{padding:.25rem .25rem}.table-bordered>:not(caption)>*{border-width:var(--bs-border-width) 0}.table-bordered>:not(caption)>*>*{border-width:0 var(--bs-border-width)}.table-borderless>:not(caption)>*>*{border-bottom-width:0}.table-borderless>:not(:first-child){border-top-width:0}.table-striped>tbody>tr:nth-of-type(odd)>*{--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-striped-columns>:not(caption)>tr>:nth-child(2n){--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-active{--bs-table-color-state:var(--bs-table-active-color);--bs-table-bg-state:var(--bs-table-active-bg)}.table-hover>tbody>tr:hover>*{--bs-table-color-state:var(--bs-table-hover-color);--bs-table-bg-state:var(--bs-table-hover-bg)}.table-primary{--bs-table-color:#000;--bs-table-bg:#cfe2ff;--bs-table-border-color:#a6b5cc;--bs-table-striped-bg:#c5d7f2;--bs-table-striped-color:#000;--bs-table-active-bg:#bacbe6;--bs-table-active-color:#000;--bs-table-hover-bg:#bfd1ec;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-secondary{--bs-table-color:#000;--bs-table-bg:#e2e3e5;--bs-table-border-color:#b5b6b7;--bs-table-striped-bg:#d7d8da;--bs-table-striped-color:#000;--bs-table-active-bg:#cbccce;--bs-table-active-color:#000;--bs-table-hover-bg:#d1d2d4;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-success{--bs-table-color:#000;--bs-table-bg:#d1e7dd;--bs-table-border-color:#a7b9b1;--bs-table-striped-bg:#c7dbd2;--bs-table-striped-color:#000;--bs-table-active-bg:#bcd0c7;--bs-table-active-color:#000;--bs-table-hover-bg:#c1d6cc;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-info{--bs-table-color:#000;--bs-table-bg:#cff4fc;--bs-table-border-color:#a6c3ca;--bs-table-striped-bg:#c5e8ef;--bs-table-striped-color:#000;--bs-table-active-bg:#badce3;--bs-table-active-color:#000;--bs-table-hover-bg:#bfe2e9;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-warning{--bs-table-color:#000;--bs-table-bg:#fff3cd;--bs-table-border-color:#ccc2a4;--bs-table-striped-bg:#f2e7c3;--bs-table-striped-color:#000;--bs-table-active-bg:#e6dbb9;--bs-table-active-color:#000;--bs-table-hover-bg:#ece1be;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-danger{--bs-table-color:#000;--bs-table-bg:#f8d7da;--bs-table-border-color:#c6acae;--bs-table-striped-bg:#eccccf;--bs-table-striped-color:#000;--bs-table-active-bg:#dfc2c4;--bs-table-active-color:#000;--bs-table-hover-bg:#e5c7ca;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-light{--bs-table-color:#000;--bs-table-bg:#f8f9fa;--bs-table-border-color:#c6c7c8;--bs-table-striped-bg:#ecedee;--bs-table-striped-color:#000;--bs-table-active-bg:#dfe0e1;--bs-table-active-color:#000;--bs-table-hover-bg:#e5e6e7;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-dark{--bs-table-color:#fff;--bs-table-bg:#212529;--bs-table-border-color:#4d5154;--bs-table-striped-bg:#2c3034;--bs-table-striped-color:#fff;--bs-table-active-bg:#373b3e;--bs-table-active-color:#fff;--bs-table-hover-bg:#323539;--bs-table-hover-color:#fff;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-responsive{overflow-x:auto;-webkit-overflow-scrolling:touch}@media (max-width:575.98px){.table-responsive-sm{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:767.98px){.table-responsive-md{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:991.98px){.table-responsive-lg{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1199.98px){.table-responsive-xl{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1399.98px){.table-responsive-xxl{overflow-x:auto;-webkit-overflow-scrolling:touch}}.form-label{margin-bottom:.5rem}.col-form-label{padding-top:calc(.375rem + var(--bs-border-width));padding-bottom:calc(.375rem + var(--bs-border-width));margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg{padding-top:calc(.5rem + var(--bs-border-width));padding-bottom:calc(.5rem + var(--bs-border-width));font-size:1.25rem}.col-form-label-sm{padding-top:calc(.25rem + var(--bs-border-width));padding-bottom:calc(.25rem + var(--bs-border-width));font-size:.875rem}.form-text{margin-top:.25rem;font-size:.875em;color:var(--bs-secondary-color)}.form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-body-bg);background-clip:padding-box;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control[type=file]{overflow:hidden}.form-control[type=file]:not(:disabled):not([readonly]){cursor:pointer}.form-control:focus{color:var(--bs-body-color);background-color:var(--bs-body-bg);border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-control::-webkit-date-and-time-value{min-width:85px;height:1.5em;margin:0}.form-control::-webkit-datetime-edit{display:block;padding:0}.form-control::-moz-placeholder{color:var(--bs-secondary-color);opacity:1}.form-control::placeholder{color:var(--bs-secondary-color);opacity:1}.form-control:disabled{background-color:var(--bs-secondary-bg);opacity:1}.form-control::-webkit-file-upload-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control::file-selector-button{padding:.375rem .75rem;margin:-.375rem -.75rem;-webkit-margin-end:.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control::-webkit-file-upload-button{-webkit-transition:none;transition:none}.form-control::file-selector-button{transition:none}}.form-control:hover:not(:disabled):not([readonly])::-webkit-file-upload-button{background-color:var(--bs-secondary-bg)}.form-control:hover:not(:disabled):not([readonly])::file-selector-button{background-color:var(--bs-secondary-bg)}.form-control-plaintext{display:block;width:100%;padding:.375rem 0;margin-bottom:0;line-height:1.5;color:var(--bs-body-color);background-color:transparent;border:solid transparent;border-width:var(--bs-border-width) 0}.form-control-plaintext:focus{outline:0}.form-control-plaintext.form-control-lg,.form-control-plaintext.form-control-sm{padding-right:0;padding-left:0}.form-control-sm{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2));padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-control-sm::-webkit-file-upload-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-sm::file-selector-button{padding:.25rem .5rem;margin:-.25rem -.5rem;-webkit-margin-end:.5rem;margin-inline-end:.5rem}.form-control-lg{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2));padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.form-control-lg::-webkit-file-upload-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}.form-control-lg::file-selector-button{padding:.5rem 1rem;margin:-.5rem -1rem;-webkit-margin-end:1rem;margin-inline-end:1rem}textarea.form-control{min-height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2))}textarea.form-control-sm{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}textarea.form-control-lg{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-control-color{width:3rem;height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2));padding:.375rem}.form-control-color:not(:disabled):not([readonly]){cursor:pointer}.form-control-color::-moz-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color::-webkit-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color.form-control-sm{height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}.form-control-color.form-control-lg{height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-select{--bs-form-select-bg-img:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-body-bg);background-image:var(--bs-form-select-bg-img),var(--bs-form-select-bg-icon,none);background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-select{transition:none}}.form-select:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-select[multiple],.form-select[size]:not([size="1"]){padding-right:.75rem;background-image:none}.form-select:disabled{background-color:var(--bs-secondary-bg)}.form-select:-moz-focusring{color:transparent;text-shadow:0 0 0 var(--bs-body-color)}.form-select-sm{padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-select-lg{padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}[data-bs-theme=dark] .form-select{--bs-form-select-bg-img:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23dee2e6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e")}.form-check{display:block;min-height:1.5rem;padding-left:1.5em;margin-bottom:.125rem}.form-check .form-check-input{float:left;margin-left:-1.5em}.form-check-reverse{padding-right:1.5em;padding-left:0;text-align:right}.form-check-reverse .form-check-input{float:right;margin-right:-1.5em;margin-left:0}.form-check-input{--bs-form-check-bg:var(--bs-body-bg);flex-shrink:0;width:1em;height:1em;margin-top:.25em;vertical-align:top;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bs-form-check-bg);background-image:var(--bs-form-check-bg-image);background-repeat:no-repeat;background-position:center;background-size:contain;border:var(--bs-border-width) solid var(--bs-border-color);-webkit-print-color-adjust:exact;color-adjust:exact;print-color-adjust:exact}.form-check-input[type=checkbox]{border-radius:.25em}.form-check-input[type=radio]{border-radius:50%}.form-check-input:active{filter:brightness(90%)}.form-check-input:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.form-check-input:checked{background-color:#0d6efd;border-color:#0d6efd}.form-check-input:checked[type=checkbox]{--bs-form-check-bg-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='m6 10 3 3 6-6'/%3e%3c/svg%3e")}.form-check-input:checked[type=radio]{--bs-form-check-bg-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e")}.form-check-input[type=checkbox]:indeterminate{background-color:#0d6efd;border-color:#0d6efd;--bs-form-check-bg-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10h8'/%3e%3c/svg%3e")}.form-check-input:disabled{pointer-events:none;filter:none;opacity:.5}.form-check-input:disabled~.form-check-label,.form-check-input[disabled]~.form-check-label{cursor:default;opacity:.5}.form-switch{padding-left:2.5em}.form-switch .form-check-input{--bs-form-switch-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%280, 0, 0, 0.25%29'/%3e%3c/svg%3e");width:2em;margin-left:-2.5em;background-image:var(--bs-form-switch-bg);background-position:left center;border-radius:2em;transition:background-position .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-switch .form-check-input{transition:none}}.form-switch .form-check-input:focus{--bs-form-switch-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%2386b7fe'/%3e%3c/svg%3e")}.form-switch .form-check-input:checked{background-position:right center;--bs-form-switch-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e")}.form-switch.form-check-reverse{padding-right:2.5em;padding-left:0}.form-switch.form-check-reverse .form-check-input{margin-right:-2.5em;margin-left:0}.form-check-inline{display:inline-block;margin-right:1rem}.btn-check{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.btn-check:disabled+.btn,.btn-check[disabled]+.btn{pointer-events:none;filter:none;opacity:.65}[data-bs-theme=dark] .form-switch .form-check-input:not(:checked):not(:focus){--bs-form-switch-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%28255, 255, 255, 0.25%29'/%3e%3c/svg%3e")}.form-range{width:100%;height:1.5rem;padding:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent}.form-range:focus{outline:0}.form-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem rgba(13,110,253,.25)}.form-range::-moz-focus-outer{border:0}.form-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;-webkit-appearance:none;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.form-range::-webkit-slider-thumb:active{background-color:#b6d4fe}.form-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range::-moz-range-thumb{width:1rem;height:1rem;-moz-appearance:none;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range::-moz-range-thumb{-moz-transition:none;transition:none}}.form-range::-moz-range-thumb:active{background-color:#b6d4fe}.form-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range:disabled{pointer-events:none}.form-range:disabled::-webkit-slider-thumb{background-color:var(--bs-secondary-color)}.form-range:disabled::-moz-range-thumb{background-color:var(--bs-secondary-color)}.form-floating{position:relative}.form-floating>.form-control,.form-floating>.form-control-plaintext,.form-floating>.form-select{height:calc(3.5rem + calc(var(--bs-border-width) * 2));min-height:calc(3.5rem + calc(var(--bs-border-width) * 2));line-height:1.25}.form-floating>label{position:absolute;top:0;left:0;z-index:2;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:var(--bs-border-width) solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out}@media (prefers-reduced-motion:reduce){.form-floating>label{transition:none}}.form-floating>.form-control,.form-floating>.form-control-plaintext{padding:1rem .75rem}.form-floating>.form-control-plaintext::-moz-placeholder,.form-floating>.form-control::-moz-placeholder{color:transparent}.form-floating>.form-control-plaintext::placeholder,.form-floating>.form-control::placeholder{color:transparent}.form-floating>.form-control-plaintext:not(:-moz-placeholder-shown),.form-floating>.form-control:not(:-moz-placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control-plaintext:focus,.form-floating>.form-control-plaintext:not(:placeholder-shown),.form-floating>.form-control:focus,.form-floating>.form-control:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control-plaintext:-webkit-autofill,.form-floating>.form-control:-webkit-autofill{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-select{padding-top:1.625rem;padding-bottom:.625rem}.form-floating>.form-control:not(:-moz-placeholder-shown)~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control-plaintext~label,.form-floating>.form-control:focus~label,.form-floating>.form-control:not(:placeholder-shown)~label,.form-floating>.form-select~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control:not(:-moz-placeholder-shown)~label::after{position:absolute;inset:1rem 0.375rem;z-index:-1;height:1.5em;content:"";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating>.form-control-plaintext~label::after,.form-floating>.form-control:focus~label::after,.form-floating>.form-control:not(:placeholder-shown)~label::after,.form-floating>.form-select~label::after{position:absolute;inset:1rem 0.375rem;z-index:-1;height:1.5em;content:"";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating>.form-control:-webkit-autofill~label{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translateX(.15rem)}.form-floating>.form-control-plaintext~label{border-width:var(--bs-border-width) 0}.form-floating>.form-control:disabled~label,.form-floating>:disabled~label{color:#6c757d}.form-floating>.form-control:disabled~label::after,.form-floating>:disabled~label::after{background-color:var(--bs-secondary-bg)}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.form-control,.input-group>.form-floating,.input-group>.form-select{position:relative;flex:1 1 auto;width:1%;min-width:0}.input-group>.form-control:focus,.input-group>.form-floating:focus-within,.input-group>.form-select:focus{z-index:5}.input-group .btn{position:relative;z-index:2}.input-group .btn:focus{z-index:5}.input-group-text{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);text-align:center;white-space:nowrap;background-color:var(--bs-tertiary-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius)}.input-group-lg>.btn,.input-group-lg>.form-control,.input-group-lg>.form-select,.input-group-lg>.input-group-text{padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.input-group-sm>.btn,.input-group-sm>.form-control,.input-group-sm>.form-select,.input-group-sm>.input-group-text{padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.input-group-lg>.form-select,.input-group-sm>.form-select{padding-right:3rem}.input-group:not(.has-validation)>.dropdown-toggle:nth-last-child(n+3),.input-group:not(.has-validation)>.form-floating:not(:last-child)>.form-control,.input-group:not(.has-validation)>.form-floating:not(:last-child)>.form-select,.input-group:not(.has-validation)>:not(:last-child):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group.has-validation>.dropdown-toggle:nth-last-child(n+4),.input-group.has-validation>.form-floating:nth-last-child(n+3)>.form-control,.input-group.has-validation>.form-floating:nth-last-child(n+3)>.form-select,.input-group.has-validation>:nth-last-child(n+3):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>:not(:first-child):not(.dropdown-menu):not(.valid-tooltip):not(.valid-feedback):not(.invalid-tooltip):not(.invalid-feedback){margin-left:calc(var(--bs-border-width) * -1);border-top-left-radius:0;border-bottom-left-radius:0}.input-group>.form-floating:not(:first-child)>.form-control,.input-group>.form-floating:not(:first-child)>.form-select{border-top-left-radius:0;border-bottom-left-radius:0}.valid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-valid-color)}.valid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-success);border-radius:var(--bs-border-radius)}.is-valid~.valid-feedback,.is-valid~.valid-tooltip,.was-validated :valid~.valid-feedback,.was-validated :valid~.valid-tooltip{display:block}.form-control.is-valid,.was-validated .form-control:valid{border-color:var(--bs-form-valid-border-color);padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-valid:focus,.was-validated .form-control:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.was-validated textarea.form-control:valid,textarea.form-control.is-valid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-valid,.was-validated .form-select:valid{border-color:var(--bs-form-valid-border-color)}.form-select.is-valid:not([multiple]):not([size]),.form-select.is-valid:not([multiple])[size="1"],.was-validated .form-select:valid:not([multiple]):not([size]),.was-validated .form-select:valid:not([multiple])[size="1"]{--bs-form-select-bg-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-valid:focus,.was-validated .form-select:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-control-color.is-valid,.was-validated .form-control-color:valid{width:calc(3rem + calc(1.5em + .75rem))}.form-check-input.is-valid,.was-validated .form-check-input:valid{border-color:var(--bs-form-valid-border-color)}.form-check-input.is-valid:checked,.was-validated .form-check-input:valid:checked{background-color:var(--bs-form-valid-color)}.form-check-input.is-valid:focus,.was-validated .form-check-input:valid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-check-input.is-valid~.form-check-label,.was-validated .form-check-input:valid~.form-check-label{color:var(--bs-form-valid-color)}.form-check-inline .form-check-input~.valid-feedback{margin-left:.5em}.input-group>.form-control:not(:focus).is-valid,.input-group>.form-floating:not(:focus-within).is-valid,.input-group>.form-select:not(:focus).is-valid,.was-validated .input-group>.form-control:not(:focus):valid,.was-validated .input-group>.form-floating:not(:focus-within):valid,.was-validated .input-group>.form-select:not(:focus):valid{z-index:3}.invalid-feedback{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}.invalid-tooltip{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-danger);border-radius:var(--bs-border-radius)}.is-invalid~.invalid-feedback,.is-invalid~.invalid-tooltip,.was-validated :invalid~.invalid-feedback,.was-validated :invalid~.invalid-tooltip{display:block}.form-control.is-invalid,.was-validated .form-control:invalid{border-color:var(--bs-form-invalid-border-color);padding-right:calc(1.5em + .75rem);background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-invalid:focus,.was-validated .form-control:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.was-validated textarea.form-control:invalid,textarea.form-control.is-invalid{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-invalid,.was-validated .form-select:invalid{border-color:var(--bs-form-invalid-border-color)}.form-select.is-invalid:not([multiple]):not([size]),.form-select.is-invalid:not([multiple])[size="1"],.was-validated .form-select:invalid:not([multiple]):not([size]),.was-validated .form-select:invalid:not([multiple])[size="1"]{--bs-form-select-bg-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-invalid:focus,.was-validated .form-select:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-control-color.is-invalid,.was-validated .form-control-color:invalid{width:calc(3rem + calc(1.5em + .75rem))}.form-check-input.is-invalid,.was-validated .form-check-input:invalid{border-color:var(--bs-form-invalid-border-color)}.form-check-input.is-invalid:checked,.was-validated .form-check-input:invalid:checked{background-color:var(--bs-form-invalid-color)}.form-check-input.is-invalid:focus,.was-validated .form-check-input:invalid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-check-input.is-invalid~.form-check-label,.was-validated .form-check-input:invalid~.form-check-label{color:var(--bs-form-invalid-color)}.form-check-inline .form-check-input~.invalid-feedback{margin-left:.5em}.input-group>.form-control:not(:focus).is-invalid,.input-group>.form-floating:not(:focus-within).is-invalid,.input-group>.form-select:not(:focus).is-invalid,.was-validated .input-group>.form-control:not(:focus):invalid,.was-validated .input-group>.form-floating:not(:focus-within):invalid,.was-validated .input-group>.form-select:not(:focus):invalid{z-index:4}.btn{--bs-btn-padding-x:0.75rem;--bs-btn-padding-y:0.375rem;--bs-btn-font-family: ;--bs-btn-font-size:1rem;--bs-btn-font-weight:400;--bs-btn-line-height:1.5;--bs-btn-color:var(--bs-body-color);--bs-btn-bg:transparent;--bs-btn-border-width:var(--bs-border-width);--bs-btn-border-color:transparent;--bs-btn-border-radius:var(--bs-border-radius);--bs-btn-hover-border-color:transparent;--bs-btn-box-shadow:inset 0 1px 0 rgba(255, 255, 255, 0.15),0 1px 1px rgba(0, 0, 0, 0.075);--bs-btn-disabled-opacity:0.65;--bs-btn-focus-box-shadow:0 0 0 0.25rem rgba(var(--bs-btn-focus-shadow-rgb), .5);display:inline-block;padding:var(--bs-btn-padding-y) var(--bs-btn-padding-x);font-family:var(--bs-btn-font-family);font-size:var(--bs-btn-font-size);font-weight:var(--bs-btn-font-weight);line-height:var(--bs-btn-line-height);color:var(--bs-btn-color);text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;border:var(--bs-btn-border-width) solid var(--bs-btn-border-color);border-radius:var(--bs-btn-border-radius);background-color:var(--bs-btn-bg);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color)}.btn-check+.btn:hover{color:var(--bs-btn-color);background-color:var(--bs-btn-bg);border-color:var(--bs-btn-border-color)}.btn:focus-visible{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check:focus-visible+.btn{border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check:checked+.btn,.btn.active,.btn.show,.btn:first-child:active,:not(.btn-check)+.btn:active{color:var(--bs-btn-active-color);background-color:var(--bs-btn-active-bg);border-color:var(--bs-btn-active-border-color)}.btn-check:checked+.btn:focus-visible,.btn.active:focus-visible,.btn.show:focus-visible,.btn:first-child:active:focus-visible,:not(.btn-check)+.btn:active:focus-visible{box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check:checked:focus-visible+.btn{box-shadow:var(--bs-btn-focus-box-shadow)}.btn.disabled,.btn:disabled,fieldset:disabled .btn{color:var(--bs-btn-disabled-color);pointer-events:none;background-color:var(--bs-btn-disabled-bg);border-color:var(--bs-btn-disabled-border-color);opacity:var(--bs-btn-disabled-opacity)}.btn-primary{--bs-btn-color:#fff;--bs-btn-bg:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0b5ed7;--bs-btn-hover-border-color:#0a58ca;--bs-btn-focus-shadow-rgb:49,132,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0a58ca;--bs-btn-active-border-color:#0a53be;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#0d6efd;--bs-btn-disabled-border-color:#0d6efd}.btn-secondary{--bs-btn-color:#fff;--bs-btn-bg:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#5c636a;--bs-btn-hover-border-color:#565e64;--bs-btn-focus-shadow-rgb:130,138,145;--bs-btn-active-color:#fff;--bs-btn-active-bg:#565e64;--bs-btn-active-border-color:#51585e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#6c757d;--bs-btn-disabled-border-color:#6c757d}.btn-success{--bs-btn-color:#fff;--bs-btn-bg:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#157347;--bs-btn-hover-border-color:#146c43;--bs-btn-focus-shadow-rgb:60,153,110;--bs-btn-active-color:#fff;--bs-btn-active-bg:#146c43;--bs-btn-active-border-color:#13653f;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#198754;--bs-btn-disabled-border-color:#198754}.btn-info{--bs-btn-color:#000;--bs-btn-bg:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#31d2f2;--bs-btn-hover-border-color:#25cff2;--bs-btn-focus-shadow-rgb:11,172,204;--bs-btn-active-color:#000;--bs-btn-active-bg:#3dd5f3;--bs-btn-active-border-color:#25cff2;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#0dcaf0;--bs-btn-disabled-border-color:#0dcaf0}.btn-warning{--bs-btn-color:#000;--bs-btn-bg:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffca2c;--bs-btn-hover-border-color:#ffc720;--bs-btn-focus-shadow-rgb:217,164,6;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffcd39;--bs-btn-active-border-color:#ffc720;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#ffc107;--bs-btn-disabled-border-color:#ffc107}.btn-danger{--bs-btn-color:#fff;--bs-btn-bg:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#bb2d3b;--bs-btn-hover-border-color:#b02a37;--bs-btn-focus-shadow-rgb:225,83,97;--bs-btn-active-color:#fff;--bs-btn-active-bg:#b02a37;--bs-btn-active-border-color:#a52834;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#dc3545;--bs-btn-disabled-border-color:#dc3545}.btn-light{--bs-btn-color:#000;--bs-btn-bg:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#d3d4d5;--bs-btn-hover-border-color:#c6c7c8;--bs-btn-focus-shadow-rgb:211,212,213;--bs-btn-active-color:#000;--bs-btn-active-bg:#c6c7c8;--bs-btn-active-border-color:#babbbc;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#f8f9fa;--bs-btn-disabled-border-color:#f8f9fa}.btn-dark{--bs-btn-color:#fff;--bs-btn-bg:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#424649;--bs-btn-hover-border-color:#373b3e;--bs-btn-focus-shadow-rgb:66,70,73;--bs-btn-active-color:#fff;--bs-btn-active-bg:#4d5154;--bs-btn-active-border-color:#373b3e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#212529;--bs-btn-disabled-border-color:#212529}.btn-outline-primary{--bs-btn-color:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0d6efd;--bs-btn-hover-border-color:#0d6efd;--bs-btn-focus-shadow-rgb:13,110,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0d6efd;--bs-btn-active-border-color:#0d6efd;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#0d6efd;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0d6efd;--bs-gradient:none}.btn-outline-secondary{--bs-btn-color:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#6c757d;--bs-btn-hover-border-color:#6c757d;--bs-btn-focus-shadow-rgb:108,117,125;--bs-btn-active-color:#fff;--bs-btn-active-bg:#6c757d;--bs-btn-active-border-color:#6c757d;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#6c757d;--bs-gradient:none}.btn-outline-success{--bs-btn-color:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#198754;--bs-btn-hover-border-color:#198754;--bs-btn-focus-shadow-rgb:25,135,84;--bs-btn-active-color:#fff;--bs-btn-active-bg:#198754;--bs-btn-active-border-color:#198754;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#198754;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#198754;--bs-gradient:none}.btn-outline-info{--bs-btn-color:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#0dcaf0;--bs-btn-hover-border-color:#0dcaf0;--bs-btn-focus-shadow-rgb:13,202,240;--bs-btn-active-color:#000;--bs-btn-active-bg:#0dcaf0;--bs-btn-active-border-color:#0dcaf0;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#0dcaf0;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0dcaf0;--bs-gradient:none}.btn-outline-warning{--bs-btn-color:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffc107;--bs-btn-hover-border-color:#ffc107;--bs-btn-focus-shadow-rgb:255,193,7;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffc107;--bs-btn-active-border-color:#ffc107;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#ffc107;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#ffc107;--bs-gradient:none}.btn-outline-danger{--bs-btn-color:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#dc3545;--bs-btn-hover-border-color:#dc3545;--bs-btn-focus-shadow-rgb:220,53,69;--bs-btn-active-color:#fff;--bs-btn-active-bg:#dc3545;--bs-btn-active-border-color:#dc3545;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#dc3545;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#dc3545;--bs-gradient:none}.btn-outline-light{--bs-btn-color:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#f8f9fa;--bs-btn-hover-border-color:#f8f9fa;--bs-btn-focus-shadow-rgb:248,249,250;--bs-btn-active-color:#000;--bs-btn-active-bg:#f8f9fa;--bs-btn-active-border-color:#f8f9fa;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#f8f9fa;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#f8f9fa;--bs-gradient:none}.btn-outline-dark{--bs-btn-color:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#212529;--bs-btn-hover-border-color:#212529;--bs-btn-focus-shadow-rgb:33,37,41;--bs-btn-active-color:#fff;--bs-btn-active-bg:#212529;--bs-btn-active-border-color:#212529;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);--bs-btn-disabled-color:#212529;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#212529;--bs-gradient:none}.btn-link{--bs-btn-font-weight:400;--bs-btn-color:var(--bs-link-color);--bs-btn-bg:transparent;--bs-btn-border-color:transparent;--bs-btn-hover-color:var(--bs-link-hover-color);--bs-btn-hover-border-color:transparent;--bs-btn-active-color:var(--bs-link-hover-color);--bs-btn-active-border-color:transparent;--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-border-color:transparent;--bs-btn-box-shadow:0 0 0 #000;--bs-btn-focus-shadow-rgb:49,132,253;text-decoration:underline}.btn-link:focus-visible{color:var(--bs-btn-color)}.btn-link:hover{color:var(--bs-btn-hover-color)}.btn-group-lg>.btn,.btn-lg{--bs-btn-padding-y:0.5rem;--bs-btn-padding-x:1rem;--bs-btn-font-size:1.25rem;--bs-btn-border-radius:var(--bs-border-radius-lg)}.btn-group-sm>.btn,.btn-sm{--bs-btn-padding-y:0.25rem;--bs-btn-padding-x:0.5rem;--bs-btn-font-size:0.875rem;--bs-btn-border-radius:var(--bs-border-radius-sm)}.fade{transition:opacity .15s linear}@media (prefers-reduced-motion:reduce){.fade{transition:none}}.fade:not(.show){opacity:0}.collapse:not(.show){display:none}.collapsing{height:0;overflow:hidden;transition:height .35s ease}@media (prefers-reduced-motion:reduce){.collapsing{transition:none}}.collapsing.collapse-horizontal{width:0;height:auto;transition:width .35s ease}@media (prefers-reduced-motion:reduce){.collapsing.collapse-horizontal{transition:none}}.dropdown,.dropdown-center,.dropend,.dropstart,.dropup,.dropup-center{position:relative}.dropdown-toggle{white-space:nowrap}.dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle:empty::after{margin-left:0}.dropdown-menu{--bs-dropdown-zindex:1000;--bs-dropdown-min-width:10rem;--bs-dropdown-padding-x:0;--bs-dropdown-padding-y:0.5rem;--bs-dropdown-spacer:0.125rem;--bs-dropdown-font-size:1rem;--bs-dropdown-color:var(--bs-body-color);--bs-dropdown-bg:var(--bs-body-bg);--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-border-radius:var(--bs-border-radius);--bs-dropdown-border-width:var(--bs-border-width);--bs-dropdown-inner-border-radius:calc(var(--bs-border-radius) - var(--bs-border-width));--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-divider-margin-y:0.5rem;--bs-dropdown-box-shadow:var(--bs-box-shadow);--bs-dropdown-link-color:var(--bs-body-color);--bs-dropdown-link-hover-color:var(--bs-body-color);--bs-dropdown-link-hover-bg:var(--bs-tertiary-bg);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:var(--bs-tertiary-color);--bs-dropdown-item-padding-x:1rem;--bs-dropdown-item-padding-y:0.25rem;--bs-dropdown-header-color:#6c757d;--bs-dropdown-header-padding-x:1rem;--bs-dropdown-header-padding-y:0.5rem;position:absolute;z-index:var(--bs-dropdown-zindex);display:none;min-width:var(--bs-dropdown-min-width);padding:var(--bs-dropdown-padding-y) var(--bs-dropdown-padding-x);margin:0;font-size:var(--bs-dropdown-font-size);color:var(--bs-dropdown-color);text-align:left;list-style:none;background-color:var(--bs-dropdown-bg);background-clip:padding-box;border:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color);border-radius:var(--bs-dropdown-border-radius)}.dropdown-menu[data-bs-popper]{top:100%;left:0;margin-top:var(--bs-dropdown-spacer)}.dropdown-menu-start{--bs-position:start}.dropdown-menu-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-end{--bs-position:end}.dropdown-menu-end[data-bs-popper]{right:0;left:auto}@media (min-width:576px){.dropdown-menu-sm-start{--bs-position:start}.dropdown-menu-sm-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-sm-end{--bs-position:end}.dropdown-menu-sm-end[data-bs-popper]{right:0;left:auto}}@media (min-width:768px){.dropdown-menu-md-start{--bs-position:start}.dropdown-menu-md-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-md-end{--bs-position:end}.dropdown-menu-md-end[data-bs-popper]{right:0;left:auto}}@media (min-width:992px){.dropdown-menu-lg-start{--bs-position:start}.dropdown-menu-lg-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-lg-end{--bs-position:end}.dropdown-menu-lg-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1200px){.dropdown-menu-xl-start{--bs-position:start}.dropdown-menu-xl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xl-end{--bs-position:end}.dropdown-menu-xl-end[data-bs-popper]{right:0;left:auto}}@media (min-width:1400px){.dropdown-menu-xxl-start{--bs-position:start}.dropdown-menu-xxl-start[data-bs-popper]{right:auto;left:0}.dropdown-menu-xxl-end{--bs-position:end}.dropdown-menu-xxl-end[data-bs-popper]{right:0;left:auto}}.dropup .dropdown-menu[data-bs-popper]{top:auto;bottom:100%;margin-top:0;margin-bottom:var(--bs-dropdown-spacer)}.dropup .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-menu[data-bs-popper]{top:0;right:auto;left:100%;margin-top:0;margin-left:var(--bs-dropdown-spacer)}.dropend .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropend .dropdown-toggle:empty::after{margin-left:0}.dropend .dropdown-toggle::after{vertical-align:0}.dropstart .dropdown-menu[data-bs-popper]{top:0;right:100%;left:auto;margin-top:0;margin-right:var(--bs-dropdown-spacer)}.dropstart .dropdown-toggle::after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:""}.dropstart .dropdown-toggle::after{display:none}.dropstart .dropdown-toggle::before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:"";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropstart .dropdown-toggle:empty::after{margin-left:0}.dropstart .dropdown-toggle::before{vertical-align:0}.dropdown-divider{height:0;margin:var(--bs-dropdown-divider-margin-y) 0;overflow:hidden;border-top:1px solid var(--bs-dropdown-divider-bg);opacity:1}.dropdown-item{display:block;width:100%;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);clear:both;font-weight:400;color:var(--bs-dropdown-link-color);text-align:inherit;text-decoration:none;white-space:nowrap;background-color:transparent;border:0;border-radius:var(--bs-dropdown-item-border-radius,0)}.dropdown-item:focus,.dropdown-item:hover{color:var(--bs-dropdown-link-hover-color);background-color:var(--bs-dropdown-link-hover-bg)}.dropdown-item.active,.dropdown-item:active{color:var(--bs-dropdown-link-active-color);text-decoration:none;background-color:var(--bs-dropdown-link-active-bg)}.dropdown-item.disabled,.dropdown-item:disabled{color:var(--bs-dropdown-link-disabled-color);pointer-events:none;background-color:transparent}.dropdown-menu.show{display:block}.dropdown-header{display:block;padding:var(--bs-dropdown-header-padding-y) var(--bs-dropdown-header-padding-x);margin-bottom:0;font-size:.875rem;color:var(--bs-dropdown-header-color);white-space:nowrap}.dropdown-item-text{display:block;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);color:var(--bs-dropdown-link-color)}.dropdown-menu-dark{--bs-dropdown-color:#dee2e6;--bs-dropdown-bg:#343a40;--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-box-shadow: ;--bs-dropdown-link-color:#dee2e6;--bs-dropdown-link-hover-color:#fff;--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-link-hover-bg:rgba(255, 255, 255, 0.15);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:#adb5bd;--bs-dropdown-header-color:#adb5bd}.btn-group,.btn-group-vertical{position:relative;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group-vertical>.btn-check:checked+.btn,.btn-group-vertical>.btn-check:focus+.btn,.btn-group-vertical>.btn.active,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:hover,.btn-group>.btn-check:checked+.btn,.btn-group>.btn-check:focus+.btn,.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-toolbar{display:flex;flex-wrap:wrap;justify-content:flex-start}.btn-toolbar .input-group{width:auto}.btn-group{border-radius:var(--bs-border-radius)}.btn-group>.btn-group:not(:first-child),.btn-group>:not(.btn-check:first-child)+.btn{margin-left:calc(var(--bs-border-width) * -1)}.btn-group>.btn-group:not(:last-child)>.btn,.btn-group>.btn.dropdown-toggle-split:first-child,.btn-group>.btn:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:nth-child(n+3),.btn-group>:not(.btn-check)+.btn{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split::after,.dropend .dropdown-toggle-split::after,.dropup .dropdown-toggle-split::after{margin-left:0}.dropstart .dropdown-toggle-split::before{margin-right:0}.btn-group-sm>.btn+.dropdown-toggle-split,.btn-sm+.dropdown-toggle-split{padding-right:.375rem;padding-left:.375rem}.btn-group-lg>.btn+.dropdown-toggle-split,.btn-lg+.dropdown-toggle-split{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical{flex-direction:column;align-items:flex-start;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:calc(var(--bs-border-width) * -1)}.btn-group-vertical>.btn-group:not(:last-child)>.btn,.btn-group-vertical>.btn:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn~.btn{border-top-left-radius:0;border-top-right-radius:0}.nav{--bs-nav-link-padding-x:1rem;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-link-color);--bs-nav-link-hover-color:var(--bs-link-hover-color);--bs-nav-link-disabled-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:var(--bs-nav-link-padding-y) var(--bs-nav-link-padding-x);font-size:var(--bs-nav-link-font-size);font-weight:var(--bs-nav-link-font-weight);color:var(--bs-nav-link-color);text-decoration:none;background:0 0;border:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}@media (prefers-reduced-motion:reduce){.nav-link{transition:none}}.nav-link:focus,.nav-link:hover{color:var(--bs-nav-link-hover-color)}.nav-link:focus-visible{outline:0;box-shadow:0 0 0 .25rem rgba(13,110,253,.25)}.nav-link.disabled,.nav-link:disabled{color:var(--bs-nav-link-disabled-color);pointer-events:none;cursor:default}.nav-tabs{--bs-nav-tabs-border-width:var(--bs-border-width);--bs-nav-tabs-border-color:var(--bs-border-color);--bs-nav-tabs-border-radius:var(--bs-border-radius);--bs-nav-tabs-link-hover-border-color:var(--bs-secondary-bg) var(--bs-secondary-bg) var(--bs-border-color);--bs-nav-tabs-link-active-color:var(--bs-emphasis-color);--bs-nav-tabs-link-active-bg:var(--bs-body-bg);--bs-nav-tabs-link-active-border-color:var(--bs-border-color) var(--bs-border-color) var(--bs-body-bg);border-bottom:var(--bs-nav-tabs-border-width) solid var(--bs-nav-tabs-border-color)}.nav-tabs .nav-link{margin-bottom:calc(-1 * var(--bs-nav-tabs-border-width));border:var(--bs-nav-tabs-border-width) solid transparent;border-top-left-radius:var(--bs-nav-tabs-border-radius);border-top-right-radius:var(--bs-nav-tabs-border-radius)}.nav-tabs .nav-link:focus,.nav-tabs .nav-link:hover{isolation:isolate;border-color:var(--bs-nav-tabs-link-hover-border-color)}.nav-tabs .nav-item.show .nav-link,.nav-tabs .nav-link.active{color:var(--bs-nav-tabs-link-active-color);background-color:var(--bs-nav-tabs-link-active-bg);border-color:var(--bs-nav-tabs-link-active-border-color)}.nav-tabs .dropdown-menu{margin-top:calc(-1 * var(--bs-nav-tabs-border-width));border-top-left-radius:0;border-top-right-radius:0}.nav-pills{--bs-nav-pills-border-radius:var(--bs-border-radius);--bs-nav-pills-link-active-color:#fff;--bs-nav-pills-link-active-bg:#0d6efd}.nav-pills .nav-link{border-radius:var(--bs-nav-pills-border-radius)}.nav-pills .nav-link.active,.nav-pills .show>.nav-link{color:var(--bs-nav-pills-link-active-color);background-color:var(--bs-nav-pills-link-active-bg)}.nav-underline{--bs-nav-underline-gap:1rem;--bs-nav-underline-border-width:0.125rem;--bs-nav-underline-link-active-color:var(--bs-emphasis-color);gap:var(--bs-nav-underline-gap)}.nav-underline .nav-link{padding-right:0;padding-left:0;border-bottom:var(--bs-nav-underline-border-width) solid transparent}.nav-underline .nav-link:focus,.nav-underline .nav-link:hover{border-bottom-color:currentcolor}.nav-underline .nav-link.active,.nav-underline .show>.nav-link{font-weight:700;color:var(--bs-nav-underline-link-active-color);border-bottom-color:currentcolor}.nav-fill .nav-item,.nav-fill>.nav-link{flex:1 1 auto;text-align:center}.nav-justified .nav-item,.nav-justified>.nav-link{flex-basis:0;flex-grow:1;text-align:center}.nav-fill .nav-item .nav-link,.nav-justified .nav-item .nav-link{width:100%}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.navbar{--bs-navbar-padding-x:0;--bs-navbar-padding-y:0.5rem;--bs-navbar-color:rgba(var(--bs-emphasis-color-rgb), 0.65);--bs-navbar-hover-color:rgba(var(--bs-emphasis-color-rgb), 0.8);--bs-navbar-disabled-color:rgba(var(--bs-emphasis-color-rgb), 0.3);--bs-navbar-active-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-padding-y:0.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-hover-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-nav-link-padding-x:0.5rem;--bs-navbar-toggler-padding-y:0.25rem;--bs-navbar-toggler-padding-x:0.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");--bs-navbar-toggler-border-color:rgba(var(--bs-emphasis-color-rgb), 0.15);--bs-navbar-toggler-border-radius:var(--bs-border-radius);--bs-navbar-toggler-focus-width:0.25rem;--bs-navbar-toggler-transition:box-shadow 0.15s ease-in-out;position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x)}.navbar>.container,.navbar>.container-fluid,.navbar>.container-lg,.navbar>.container-md,.navbar>.container-sm,.navbar>.container-xl,.navbar>.container-xxl{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand{padding-top:var(--bs-navbar-brand-padding-y);padding-bottom:var(--bs-navbar-brand-padding-y);margin-right:var(--bs-navbar-brand-margin-end);font-size:var(--bs-navbar-brand-font-size);color:var(--bs-navbar-brand-color);text-decoration:none;white-space:nowrap}.navbar-brand:focus,.navbar-brand:hover{color:var(--bs-navbar-brand-hover-color)}.navbar-nav{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:0.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav .nav-link.active,.navbar-nav .nav-link.show{color:var(--bs-navbar-active-color)}.navbar-nav .dropdown-menu{position:static}.navbar-text{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-navbar-color)}.navbar-text a,.navbar-text a:focus,.navbar-text a:hover{color:var(--bs-navbar-active-color)}.navbar-collapse{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler{padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);font-size:var(--bs-navbar-toggler-font-size);line-height:1;color:var(--bs-navbar-color);background-color:transparent;border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius);transition:var(--bs-navbar-toggler-transition)}@media (prefers-reduced-motion:reduce){.navbar-toggler{transition:none}}.navbar-toggler:hover{text-decoration:none}.navbar-toggler:focus{text-decoration:none;outline:0;box-shadow:0 0 0 var(--bs-navbar-toggler-focus-width)}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-image:var(--bs-navbar-toggler-icon-bg);background-repeat:no-repeat;background-position:center;background-size:100%}.navbar-nav-scroll{max-height:var(--bs-scroll-height,75vh);overflow-y:auto}@media (min-width:576px){.navbar-expand-sm{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-sm .navbar-nav{flex-direction:row}.navbar-expand-sm .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-sm .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-sm .navbar-nav-scroll{overflow:visible}.navbar-expand-sm .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-sm .navbar-toggler{display:none}.navbar-expand-sm .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-sm .offcanvas .offcanvas-header{display:none}.navbar-expand-sm .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:768px){.navbar-expand-md{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md .navbar-nav{flex-direction:row}.navbar-expand-md .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-md .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-md .navbar-nav-scroll{overflow:visible}.navbar-expand-md .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-md .navbar-toggler{display:none}.navbar-expand-md .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-md .offcanvas .offcanvas-header{display:none}.navbar-expand-md .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:992px){.navbar-expand-lg{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg .navbar-nav{flex-direction:row}.navbar-expand-lg .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-lg .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-lg .navbar-nav-scroll{overflow:visible}.navbar-expand-lg .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-lg .navbar-toggler{display:none}.navbar-expand-lg .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-lg .offcanvas .offcanvas-header{display:none}.navbar-expand-lg .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1200px){.navbar-expand-xl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xl .navbar-nav{flex-direction:row}.navbar-expand-xl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xl .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xl .navbar-nav-scroll{overflow:visible}.navbar-expand-xl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xl .navbar-toggler{display:none}.navbar-expand-xl .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xl .offcanvas .offcanvas-header{display:none}.navbar-expand-xl .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1400px){.navbar-expand-xxl{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xxl .navbar-nav{flex-direction:row}.navbar-expand-xxl .navbar-nav .dropdown-menu{position:absolute}.navbar-expand-xxl .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xxl .navbar-nav-scroll{overflow:visible}.navbar-expand-xxl .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand-xxl .navbar-toggler{display:none}.navbar-expand-xxl .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xxl .offcanvas .offcanvas-header{display:none}.navbar-expand-xxl .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}}.navbar-expand{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand .navbar-nav{flex-direction:row}.navbar-expand .navbar-nav .dropdown-menu{position:absolute}.navbar-expand .navbar-nav .nav-link{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand .navbar-nav-scroll{overflow:visible}.navbar-expand .navbar-collapse{display:flex!important;flex-basis:auto}.navbar-expand .navbar-toggler{display:none}.navbar-expand .offcanvas{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand .offcanvas .offcanvas-header{display:none}.navbar-expand .offcanvas .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible}.navbar-dark,.navbar[data-bs-theme=dark]{--bs-navbar-color:rgba(255, 255, 255, 0.55);--bs-navbar-hover-color:rgba(255, 255, 255, 0.75);--bs-navbar-disabled-color:rgba(255, 255, 255, 0.25);--bs-navbar-active-color:#fff;--bs-navbar-brand-color:#fff;--bs-navbar-brand-hover-color:#fff;--bs-navbar-toggler-border-color:rgba(255, 255, 255, 0.1);--bs-navbar-toggler-icon-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}[data-bs-theme=dark] .navbar-toggler-icon{--bs-navbar-toggler-icon-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}.card{--bs-card-spacer-y:1rem;--bs-card-spacer-x:1rem;--bs-card-title-spacer-y:0.5rem;--bs-card-title-color: ;--bs-card-subtitle-color: ;--bs-card-border-width:var(--bs-border-width);--bs-card-border-color:var(--bs-border-color-translucent);--bs-card-border-radius:var(--bs-border-radius);--bs-card-box-shadow: ;--bs-card-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-card-cap-padding-y:0.5rem;--bs-card-cap-padding-x:1rem;--bs-card-cap-bg:rgba(var(--bs-body-color-rgb), 0.03);--bs-card-cap-color: ;--bs-card-height: ;--bs-card-color: ;--bs-card-bg:var(--bs-body-bg);--bs-card-img-overlay-padding:1rem;--bs-card-group-margin:0.75rem;position:relative;display:flex;flex-direction:column;min-width:0;height:var(--bs-card-height);color:var(--bs-body-color);word-wrap:break-word;background-color:var(--bs-card-bg);background-clip:border-box;border:var(--bs-card-border-width) solid var(--bs-card-border-color);border-radius:var(--bs-card-border-radius)}.card>hr{margin-right:0;margin-left:0}.card>.list-group{border-top:inherit;border-bottom:inherit}.card>.list-group:first-child{border-top-width:0;border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card>.list-group:last-child{border-bottom-width:0;border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card>.card-header+.list-group,.card>.list-group+.card-footer{border-top:0}.card-body{flex:1 1 auto;padding:var(--bs-card-spacer-y) var(--bs-card-spacer-x);color:var(--bs-card-color)}.card-title{margin-bottom:var(--bs-card-title-spacer-y);color:var(--bs-card-title-color)}.card-subtitle{margin-top:calc(-.5 * var(--bs-card-title-spacer-y));margin-bottom:0;color:var(--bs-card-subtitle-color)}.card-text:last-child{margin-bottom:0}.card-link+.card-link{margin-left:var(--bs-card-spacer-x)}.card-header{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);margin-bottom:0;color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-header:first-child{border-radius:var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius) 0 0}.card-footer{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-top:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-footer:last-child{border-radius:0 0 var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius)}.card-header-tabs{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-bottom:calc(-1 * var(--bs-card-cap-padding-y));margin-left:calc(-.5 * var(--bs-card-cap-padding-x));border-bottom:0}.card-header-tabs .nav-link.active{background-color:var(--bs-card-bg);border-bottom-color:var(--bs-card-bg)}.card-header-pills{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-left:calc(-.5 * var(--bs-card-cap-padding-x))}.card-img-overlay{position:absolute;top:0;right:0;bottom:0;left:0;padding:var(--bs-card-img-overlay-padding);border-radius:var(--bs-card-inner-border-radius)}.card-img,.card-img-bottom,.card-img-top{width:100%}.card-img,.card-img-top{border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card-img,.card-img-bottom{border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card-group>.card{margin-bottom:var(--bs-card-group-margin)}@media (min-width:576px){.card-group{display:flex;flex-flow:row wrap}.card-group>.card{flex:1 0 0%;margin-bottom:0}.card-group>.card+.card{margin-left:0;border-left:0}.card-group>.card:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group>.card:not(:last-child) .card-header,.card-group>.card:not(:last-child) .card-img-top{border-top-right-radius:0}.card-group>.card:not(:last-child) .card-footer,.card-group>.card:not(:last-child) .card-img-bottom{border-bottom-right-radius:0}.card-group>.card:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group>.card:not(:first-child) .card-header,.card-group>.card:not(:first-child) .card-img-top{border-top-left-radius:0}.card-group>.card:not(:first-child) .card-footer,.card-group>.card:not(:first-child) .card-img-bottom{border-bottom-left-radius:0}}.accordion{--bs-accordion-color:var(--bs-body-color);--bs-accordion-bg:var(--bs-body-bg);--bs-accordion-transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out,border-radius 0.15s ease;--bs-accordion-border-color:var(--bs-border-color);--bs-accordion-border-width:var(--bs-border-width);--bs-accordion-border-radius:var(--bs-border-radius);--bs-accordion-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-accordion-btn-padding-x:1.25rem;--bs-accordion-btn-padding-y:1rem;--bs-accordion-btn-color:var(--bs-body-color);--bs-accordion-btn-bg:var(--bs-accordion-bg);--bs-accordion-btn-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23212529' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e");--bs-accordion-btn-icon-width:1.25rem;--bs-accordion-btn-icon-transform:rotate(-180deg);--bs-accordion-btn-icon-transition:transform 0.2s ease-in-out;--bs-accordion-btn-active-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23052c65' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e");--bs-accordion-btn-focus-box-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-accordion-body-padding-x:1.25rem;--bs-accordion-body-padding-y:1rem;--bs-accordion-active-color:var(--bs-primary-text-emphasis);--bs-accordion-active-bg:var(--bs-primary-bg-subtle)}.accordion-button{position:relative;display:flex;align-items:center;width:100%;padding:var(--bs-accordion-btn-padding-y) var(--bs-accordion-btn-padding-x);font-size:1rem;color:var(--bs-accordion-btn-color);text-align:left;background-color:var(--bs-accordion-btn-bg);border:0;border-radius:0;overflow-anchor:none;transition:var(--bs-accordion-transition)}@media (prefers-reduced-motion:reduce){.accordion-button{transition:none}}.accordion-button:not(.collapsed){color:var(--bs-accordion-active-color);background-color:var(--bs-accordion-active-bg);box-shadow:inset 0 calc(-1 * var(--bs-accordion-border-width)) 0 var(--bs-accordion-border-color)}.accordion-button:not(.collapsed)::after{background-image:var(--bs-accordion-btn-active-icon);transform:var(--bs-accordion-btn-icon-transform)}.accordion-button::after{flex-shrink:0;width:var(--bs-accordion-btn-icon-width);height:var(--bs-accordion-btn-icon-width);margin-left:auto;content:"";background-image:var(--bs-accordion-btn-icon);background-repeat:no-repeat;background-size:var(--bs-accordion-btn-icon-width);transition:var(--bs-accordion-btn-icon-transition)}@media (prefers-reduced-motion:reduce){.accordion-button::after{transition:none}}.accordion-button:hover{z-index:2}.accordion-button:focus{z-index:3;outline:0;box-shadow:var(--bs-accordion-btn-focus-box-shadow)}.accordion-header{margin-bottom:0}.accordion-item{color:var(--bs-accordion-color);background-color:var(--bs-accordion-bg);border:var(--bs-accordion-border-width) solid var(--bs-accordion-border-color)}.accordion-item:first-of-type{border-top-left-radius:var(--bs-accordion-border-radius);border-top-right-radius:var(--bs-accordion-border-radius)}.accordion-item:first-of-type>.accordion-header .accordion-button{border-top-left-radius:var(--bs-accordion-inner-border-radius);border-top-right-radius:var(--bs-accordion-inner-border-radius)}.accordion-item:not(:first-of-type){border-top:0}.accordion-item:last-of-type{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-item:last-of-type>.accordion-header .accordion-button.collapsed{border-bottom-right-radius:var(--bs-accordion-inner-border-radius);border-bottom-left-radius:var(--bs-accordion-inner-border-radius)}.accordion-item:last-of-type>.accordion-collapse{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-body{padding:var(--bs-accordion-body-padding-y) var(--bs-accordion-body-padding-x)}.accordion-flush>.accordion-item{border-right:0;border-left:0;border-radius:0}.accordion-flush>.accordion-item:first-child{border-top:0}.accordion-flush>.accordion-item:last-child{border-bottom:0}.accordion-flush>.accordion-item>.accordion-header .accordion-button,.accordion-flush>.accordion-item>.accordion-header .accordion-button.collapsed{border-radius:0}.accordion-flush>.accordion-item>.accordion-collapse{border-radius:0}[data-bs-theme=dark] .accordion-button::after{--bs-accordion-btn-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e");--bs-accordion-btn-active-icon:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e")}.breadcrumb{--bs-breadcrumb-padding-x:0;--bs-breadcrumb-padding-y:0;--bs-breadcrumb-margin-bottom:1rem;--bs-breadcrumb-bg: ;--bs-breadcrumb-border-radius: ;--bs-breadcrumb-divider-color:var(--bs-secondary-color);--bs-breadcrumb-item-padding-x:0.5rem;--bs-breadcrumb-item-active-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding:var(--bs-breadcrumb-padding-y) var(--bs-breadcrumb-padding-x);margin-bottom:var(--bs-breadcrumb-margin-bottom);font-size:var(--bs-breadcrumb-font-size);list-style:none;background-color:var(--bs-breadcrumb-bg);border-radius:var(--bs-breadcrumb-border-radius)}.breadcrumb-item+.breadcrumb-item{padding-left:var(--bs-breadcrumb-item-padding-x)}.breadcrumb-item+.breadcrumb-item::before{float:left;padding-right:var(--bs-breadcrumb-item-padding-x);color:var(--bs-breadcrumb-divider-color);content:var(--bs-breadcrumb-divider, "/")}.breadcrumb-item.active{color:var(--bs-breadcrumb-item-active-color)}.pagination{--bs-pagination-padding-x:0.75rem;--bs-pagination-padding-y:0.375rem;--bs-pagination-font-size:1rem;--bs-pagination-color:var(--bs-link-color);--bs-pagination-bg:var(--bs-body-bg);--bs-pagination-border-width:var(--bs-border-width);--bs-pagination-border-color:var(--bs-border-color);--bs-pagination-border-radius:var(--bs-border-radius);--bs-pagination-hover-color:var(--bs-link-hover-color);--bs-pagination-hover-bg:var(--bs-tertiary-bg);--bs-pagination-hover-border-color:var(--bs-border-color);--bs-pagination-focus-color:var(--bs-link-hover-color);--bs-pagination-focus-bg:var(--bs-secondary-bg);--bs-pagination-focus-box-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-pagination-active-color:#fff;--bs-pagination-active-bg:#0d6efd;--bs-pagination-active-border-color:#0d6efd;--bs-pagination-disabled-color:var(--bs-secondary-color);--bs-pagination-disabled-bg:var(--bs-secondary-bg);--bs-pagination-disabled-border-color:var(--bs-border-color);display:flex;padding-left:0;list-style:none}.page-link{position:relative;display:block;padding:var(--bs-pagination-padding-y) var(--bs-pagination-padding-x);font-size:var(--bs-pagination-font-size);color:var(--bs-pagination-color);text-decoration:none;background-color:var(--bs-pagination-bg);border:var(--bs-pagination-border-width) solid var(--bs-pagination-border-color);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.page-link{transition:none}}.page-link:hover{z-index:2;color:var(--bs-pagination-hover-color);background-color:var(--bs-pagination-hover-bg);border-color:var(--bs-pagination-hover-border-color)}.page-link:focus{z-index:3;color:var(--bs-pagination-focus-color);background-color:var(--bs-pagination-focus-bg);outline:0;box-shadow:var(--bs-pagination-focus-box-shadow)}.active>.page-link,.page-link.active{z-index:3;color:var(--bs-pagination-active-color);background-color:var(--bs-pagination-active-bg);border-color:var(--bs-pagination-active-border-color)}.disabled>.page-link,.page-link.disabled{color:var(--bs-pagination-disabled-color);pointer-events:none;background-color:var(--bs-pagination-disabled-bg);border-color:var(--bs-pagination-disabled-border-color)}.page-item:not(:first-child) .page-link{margin-left:calc(var(--bs-border-width) * -1)}.page-item:first-child .page-link{border-top-left-radius:var(--bs-pagination-border-radius);border-bottom-left-radius:var(--bs-pagination-border-radius)}.page-item:last-child .page-link{border-top-right-radius:var(--bs-pagination-border-radius);border-bottom-right-radius:var(--bs-pagination-border-radius)}.pagination-lg{--bs-pagination-padding-x:1.5rem;--bs-pagination-padding-y:0.75rem;--bs-pagination-font-size:1.25rem;--bs-pagination-border-radius:var(--bs-border-radius-lg)}.pagination-sm{--bs-pagination-padding-x:0.5rem;--bs-pagination-padding-y:0.25rem;--bs-pagination-font-size:0.875rem;--bs-pagination-border-radius:var(--bs-border-radius-sm)}.badge{--bs-badge-padding-x:0.65em;--bs-badge-padding-y:0.35em;--bs-badge-font-size:0.75em;--bs-badge-font-weight:700;--bs-badge-color:#fff;--bs-badge-border-radius:var(--bs-border-radius);display:inline-block;padding:var(--bs-badge-padding-y) var(--bs-badge-padding-x);font-size:var(--bs-badge-font-size);font-weight:var(--bs-badge-font-weight);line-height:1;color:var(--bs-badge-color);text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:var(--bs-badge-border-radius)}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.alert{--bs-alert-bg:transparent;--bs-alert-padding-x:1rem;--bs-alert-padding-y:1rem;--bs-alert-margin-bottom:1rem;--bs-alert-color:inherit;--bs-alert-border-color:transparent;--bs-alert-border:var(--bs-border-width) solid var(--bs-alert-border-color);--bs-alert-border-radius:var(--bs-border-radius);--bs-alert-link-color:inherit;position:relative;padding:var(--bs-alert-padding-y) var(--bs-alert-padding-x);margin-bottom:var(--bs-alert-margin-bottom);color:var(--bs-alert-color);background-color:var(--bs-alert-bg);border:var(--bs-alert-border);border-radius:var(--bs-alert-border-radius)}.alert-heading{color:inherit}.alert-link{font-weight:700;color:var(--bs-alert-link-color)}.alert-dismissible{padding-right:3rem}.alert-dismissible .btn-close{position:absolute;top:0;right:0;z-index:2;padding:1.25rem 1rem}.alert-primary{--bs-alert-color:var(--bs-primary-text-emphasis);--bs-alert-bg:var(--bs-primary-bg-subtle);--bs-alert-border-color:var(--bs-primary-border-subtle);--bs-alert-link-color:var(--bs-primary-text-emphasis)}.alert-secondary{--bs-alert-color:var(--bs-secondary-text-emphasis);--bs-alert-bg:var(--bs-secondary-bg-subtle);--bs-alert-border-color:var(--bs-secondary-border-subtle);--bs-alert-link-color:var(--bs-secondary-text-emphasis)}.alert-success{--bs-alert-color:var(--bs-success-text-emphasis);--bs-alert-bg:var(--bs-success-bg-subtle);--bs-alert-border-color:var(--bs-success-border-subtle);--bs-alert-link-color:var(--bs-success-text-emphasis)}.alert-info{--bs-alert-color:var(--bs-info-text-emphasis);--bs-alert-bg:var(--bs-info-bg-subtle);--bs-alert-border-color:var(--bs-info-border-subtle);--bs-alert-link-color:var(--bs-info-text-emphasis)}.alert-warning{--bs-alert-color:var(--bs-warning-text-emphasis);--bs-alert-bg:var(--bs-warning-bg-subtle);--bs-alert-border-color:var(--bs-warning-border-subtle);--bs-alert-link-color:var(--bs-warning-text-emphasis)}.alert-danger{--bs-alert-color:var(--bs-danger-text-emphasis);--bs-alert-bg:var(--bs-danger-bg-subtle);--bs-alert-border-color:var(--bs-danger-border-subtle);--bs-alert-link-color:var(--bs-danger-text-emphasis)}.alert-light{--bs-alert-color:var(--bs-light-text-emphasis);--bs-alert-bg:var(--bs-light-bg-subtle);--bs-alert-border-color:var(--bs-light-border-subtle);--bs-alert-link-color:var(--bs-light-text-emphasis)}.alert-dark{--bs-alert-color:var(--bs-dark-text-emphasis);--bs-alert-bg:var(--bs-dark-bg-subtle);--bs-alert-border-color:var(--bs-dark-border-subtle);--bs-alert-link-color:var(--bs-dark-text-emphasis)}@keyframes progress-bar-stripes{0%{background-position-x:1rem}}.progress,.progress-stacked{--bs-progress-height:1rem;--bs-progress-font-size:0.75rem;--bs-progress-bg:var(--bs-secondary-bg);--bs-progress-border-radius:var(--bs-border-radius);--bs-progress-box-shadow:var(--bs-box-shadow-inset);--bs-progress-bar-color:#fff;--bs-progress-bar-bg:#0d6efd;--bs-progress-bar-transition:width 0.6s ease;display:flex;height:var(--bs-progress-height);overflow:hidden;font-size:var(--bs-progress-font-size);background-color:var(--bs-progress-bg);border-radius:var(--bs-progress-border-radius)}.progress-bar{display:flex;flex-direction:column;justify-content:center;overflow:hidden;color:var(--bs-progress-bar-color);text-align:center;white-space:nowrap;background-color:var(--bs-progress-bar-bg);transition:var(--bs-progress-bar-transition)}@media (prefers-reduced-motion:reduce){.progress-bar{transition:none}}.progress-bar-striped{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-size:var(--bs-progress-height) var(--bs-progress-height)}.progress-stacked>.progress{overflow:visible}.progress-stacked>.progress>.progress-bar{width:100%}.progress-bar-animated{animation:1s linear infinite progress-bar-stripes}@media (prefers-reduced-motion:reduce){.progress-bar-animated{animation:none}}.list-group{--bs-list-group-color:var(--bs-body-color);--bs-list-group-bg:var(--bs-body-bg);--bs-list-group-border-color:var(--bs-border-color);--bs-list-group-border-width:var(--bs-border-width);--bs-list-group-border-radius:var(--bs-border-radius);--bs-list-group-item-padding-x:1rem;--bs-list-group-item-padding-y:0.5rem;--bs-list-group-action-color:var(--bs-secondary-color);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-tertiary-bg);--bs-list-group-action-active-color:var(--bs-body-color);--bs-list-group-action-active-bg:var(--bs-secondary-bg);--bs-list-group-disabled-color:var(--bs-secondary-color);--bs-list-group-disabled-bg:var(--bs-body-bg);--bs-list-group-active-color:#fff;--bs-list-group-active-bg:#0d6efd;--bs-list-group-active-border-color:#0d6efd;display:flex;flex-direction:column;padding-left:0;margin-bottom:0;border-radius:var(--bs-list-group-border-radius)}.list-group-numbered{list-style-type:none;counter-reset:section}.list-group-numbered>.list-group-item::before{content:counters(section, ".") ". ";counter-increment:section}.list-group-item-action{width:100%;color:var(--bs-list-group-action-color);text-align:inherit}.list-group-item-action:focus,.list-group-item-action:hover{z-index:1;color:var(--bs-list-group-action-hover-color);text-decoration:none;background-color:var(--bs-list-group-action-hover-bg)}.list-group-item-action:active{color:var(--bs-list-group-action-active-color);background-color:var(--bs-list-group-action-active-bg)}.list-group-item{position:relative;display:block;padding:var(--bs-list-group-item-padding-y) var(--bs-list-group-item-padding-x);color:var(--bs-list-group-color);text-decoration:none;background-color:var(--bs-list-group-bg);border:var(--bs-list-group-border-width) solid var(--bs-list-group-border-color)}.list-group-item:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.list-group-item:last-child{border-bottom-right-radius:inherit;border-bottom-left-radius:inherit}.list-group-item.disabled,.list-group-item:disabled{color:var(--bs-list-group-disabled-color);pointer-events:none;background-color:var(--bs-list-group-disabled-bg)}.list-group-item.active{z-index:2;color:var(--bs-list-group-active-color);background-color:var(--bs-list-group-active-bg);border-color:var(--bs-list-group-active-border-color)}.list-group-item+.list-group-item{border-top-width:0}.list-group-item+.list-group-item.active{margin-top:calc(-1 * var(--bs-list-group-border-width));border-top-width:var(--bs-list-group-border-width)}.list-group-horizontal{flex-direction:row}.list-group-horizontal>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal>.list-group-item.active{margin-top:0}.list-group-horizontal>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}@media (min-width:576px){.list-group-horizontal-sm{flex-direction:row}.list-group-horizontal-sm>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-sm>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-sm>.list-group-item.active{margin-top:0}.list-group-horizontal-sm>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-sm>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:768px){.list-group-horizontal-md{flex-direction:row}.list-group-horizontal-md>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-md>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-md>.list-group-item.active{margin-top:0}.list-group-horizontal-md>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-md>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:992px){.list-group-horizontal-lg{flex-direction:row}.list-group-horizontal-lg>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-lg>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-lg>.list-group-item.active{margin-top:0}.list-group-horizontal-lg>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-lg>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1200px){.list-group-horizontal-xl{flex-direction:row}.list-group-horizontal-xl>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xl>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xl>.list-group-item.active{margin-top:0}.list-group-horizontal-xl>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xl>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1400px){.list-group-horizontal-xxl{flex-direction:row}.list-group-horizontal-xxl>.list-group-item:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xxl>.list-group-item:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xxl>.list-group-item.active{margin-top:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xxl>.list-group-item+.list-group-item.active{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}.list-group-flush{border-radius:0}.list-group-flush>.list-group-item{border-width:0 0 var(--bs-list-group-border-width)}.list-group-flush>.list-group-item:last-child{border-bottom-width:0}.list-group-item-primary{--bs-list-group-color:var(--bs-primary-text-emphasis);--bs-list-group-bg:var(--bs-primary-bg-subtle);--bs-list-group-border-color:var(--bs-primary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-primary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-primary-border-subtle);--bs-list-group-active-color:var(--bs-primary-bg-subtle);--bs-list-group-active-bg:var(--bs-primary-text-emphasis);--bs-list-group-active-border-color:var(--bs-primary-text-emphasis)}.list-group-item-secondary{--bs-list-group-color:var(--bs-secondary-text-emphasis);--bs-list-group-bg:var(--bs-secondary-bg-subtle);--bs-list-group-border-color:var(--bs-secondary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-secondary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-secondary-border-subtle);--bs-list-group-active-color:var(--bs-secondary-bg-subtle);--bs-list-group-active-bg:var(--bs-secondary-text-emphasis);--bs-list-group-active-border-color:var(--bs-secondary-text-emphasis)}.list-group-item-success{--bs-list-group-color:var(--bs-success-text-emphasis);--bs-list-group-bg:var(--bs-success-bg-subtle);--bs-list-group-border-color:var(--bs-success-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-success-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-success-border-subtle);--bs-list-group-active-color:var(--bs-success-bg-subtle);--bs-list-group-active-bg:var(--bs-success-text-emphasis);--bs-list-group-active-border-color:var(--bs-success-text-emphasis)}.list-group-item-info{--bs-list-group-color:var(--bs-info-text-emphasis);--bs-list-group-bg:var(--bs-info-bg-subtle);--bs-list-group-border-color:var(--bs-info-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-info-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-info-border-subtle);--bs-list-group-active-color:var(--bs-info-bg-subtle);--bs-list-group-active-bg:var(--bs-info-text-emphasis);--bs-list-group-active-border-color:var(--bs-info-text-emphasis)}.list-group-item-warning{--bs-list-group-color:var(--bs-warning-text-emphasis);--bs-list-group-bg:var(--bs-warning-bg-subtle);--bs-list-group-border-color:var(--bs-warning-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-warning-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-warning-border-subtle);--bs-list-group-active-color:var(--bs-warning-bg-subtle);--bs-list-group-active-bg:var(--bs-warning-text-emphasis);--bs-list-group-active-border-color:var(--bs-warning-text-emphasis)}.list-group-item-danger{--bs-list-group-color:var(--bs-danger-text-emphasis);--bs-list-group-bg:var(--bs-danger-bg-subtle);--bs-list-group-border-color:var(--bs-danger-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-danger-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-danger-border-subtle);--bs-list-group-active-color:var(--bs-danger-bg-subtle);--bs-list-group-active-bg:var(--bs-danger-text-emphasis);--bs-list-group-active-border-color:var(--bs-danger-text-emphasis)}.list-group-item-light{--bs-list-group-color:var(--bs-light-text-emphasis);--bs-list-group-bg:var(--bs-light-bg-subtle);--bs-list-group-border-color:var(--bs-light-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-light-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-light-border-subtle);--bs-list-group-active-color:var(--bs-light-bg-subtle);--bs-list-group-active-bg:var(--bs-light-text-emphasis);--bs-list-group-active-border-color:var(--bs-light-text-emphasis)}.list-group-item-dark{--bs-list-group-color:var(--bs-dark-text-emphasis);--bs-list-group-bg:var(--bs-dark-bg-subtle);--bs-list-group-border-color:var(--bs-dark-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-dark-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-dark-border-subtle);--bs-list-group-active-color:var(--bs-dark-bg-subtle);--bs-list-group-active-bg:var(--bs-dark-text-emphasis);--bs-list-group-active-border-color:var(--bs-dark-text-emphasis)}.btn-close{--bs-btn-close-color:#000;--bs-btn-close-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e");--bs-btn-close-opacity:0.5;--bs-btn-close-hover-opacity:0.75;--bs-btn-close-focus-shadow:0 0 0 0.25rem rgba(13, 110, 253, 0.25);--bs-btn-close-focus-opacity:1;--bs-btn-close-disabled-opacity:0.25;--bs-btn-close-white-filter:invert(1) grayscale(100%) brightness(200%);box-sizing:content-box;width:1em;height:1em;padding:.25em .25em;color:var(--bs-btn-close-color);background:transparent var(--bs-btn-close-bg) center/1em auto no-repeat;border:0;border-radius:.375rem;opacity:var(--bs-btn-close-opacity)}.btn-close:hover{color:var(--bs-btn-close-color);text-decoration:none;opacity:var(--bs-btn-close-hover-opacity)}.btn-close:focus{outline:0;box-shadow:var(--bs-btn-close-focus-shadow);opacity:var(--bs-btn-close-focus-opacity)}.btn-close.disabled,.btn-close:disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:var(--bs-btn-close-disabled-opacity)}.btn-close-white{filter:var(--bs-btn-close-white-filter)}[data-bs-theme=dark] .btn-close{filter:var(--bs-btn-close-white-filter)}.toast{--bs-toast-zindex:1090;--bs-toast-padding-x:0.75rem;--bs-toast-padding-y:0.5rem;--bs-toast-spacing:1.5rem;--bs-toast-max-width:350px;--bs-toast-font-size:0.875rem;--bs-toast-color: ;--bs-toast-bg:rgba(var(--bs-body-bg-rgb), 0.85);--bs-toast-border-width:var(--bs-border-width);--bs-toast-border-color:var(--bs-border-color-translucent);--bs-toast-border-radius:var(--bs-border-radius);--bs-toast-box-shadow:var(--bs-box-shadow);--bs-toast-header-color:var(--bs-secondary-color);--bs-toast-header-bg:rgba(var(--bs-body-bg-rgb), 0.85);--bs-toast-header-border-color:var(--bs-border-color-translucent);width:var(--bs-toast-max-width);max-width:100%;font-size:var(--bs-toast-font-size);color:var(--bs-toast-color);pointer-events:auto;background-color:var(--bs-toast-bg);background-clip:padding-box;border:var(--bs-toast-border-width) solid var(--bs-toast-border-color);box-shadow:var(--bs-toast-box-shadow);border-radius:var(--bs-toast-border-radius)}.toast.showing{opacity:0}.toast:not(.show){display:none}.toast-container{--bs-toast-zindex:1090;position:absolute;z-index:var(--bs-toast-zindex);width:-webkit-max-content;width:-moz-max-content;width:max-content;max-width:100%;pointer-events:none}.toast-container>:not(:last-child){margin-bottom:var(--bs-toast-spacing)}.toast-header{display:flex;align-items:center;padding:var(--bs-toast-padding-y) var(--bs-toast-padding-x);color:var(--bs-toast-header-color);background-color:var(--bs-toast-header-bg);background-clip:padding-box;border-bottom:var(--bs-toast-border-width) solid var(--bs-toast-header-border-color);border-top-left-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width));border-top-right-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width))}.toast-header .btn-close{margin-right:calc(-.5 * var(--bs-toast-padding-x));margin-left:var(--bs-toast-padding-x)}.toast-body{padding:var(--bs-toast-padding-x);word-wrap:break-word}.modal{--bs-modal-zindex:1055;--bs-modal-width:500px;--bs-modal-padding:1rem;--bs-modal-margin:0.5rem;--bs-modal-color: ;--bs-modal-bg:var(--bs-body-bg);--bs-modal-border-color:var(--bs-border-color-translucent);--bs-modal-border-width:var(--bs-border-width);--bs-modal-border-radius:var(--bs-border-radius-lg);--bs-modal-box-shadow:var(--bs-box-shadow-sm);--bs-modal-inner-border-radius:calc(var(--bs-border-radius-lg) - (var(--bs-border-width)));--bs-modal-header-padding-x:1rem;--bs-modal-header-padding-y:1rem;--bs-modal-header-padding:1rem 1rem;--bs-modal-header-border-color:var(--bs-border-color);--bs-modal-header-border-width:var(--bs-border-width);--bs-modal-title-line-height:1.5;--bs-modal-footer-gap:0.5rem;--bs-modal-footer-bg: ;--bs-modal-footer-border-color:var(--bs-border-color);--bs-modal-footer-border-width:var(--bs-border-width);position:fixed;top:0;left:0;z-index:var(--bs-modal-zindex);display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog{position:relative;width:auto;margin:var(--bs-modal-margin);pointer-events:none}.modal.fade .modal-dialog{transition:transform .3s ease-out;transform:translate(0,-50px)}@media (prefers-reduced-motion:reduce){.modal.fade .modal-dialog{transition:none}}.modal.show .modal-dialog{transform:none}.modal.modal-static .modal-dialog{transform:scale(1.02)}.modal-dialog-scrollable{height:calc(100% - var(--bs-modal-margin) * 2)}.modal-dialog-scrollable .modal-content{max-height:100%;overflow:hidden}.modal-dialog-scrollable .modal-body{overflow-y:auto}.modal-dialog-centered{display:flex;align-items:center;min-height:calc(100% - var(--bs-modal-margin) * 2)}.modal-content{position:relative;display:flex;flex-direction:column;width:100%;color:var(--bs-modal-color);pointer-events:auto;background-color:var(--bs-modal-bg);background-clip:padding-box;border:var(--bs-modal-border-width) solid var(--bs-modal-border-color);border-radius:var(--bs-modal-border-radius);outline:0}.modal-backdrop{--bs-backdrop-zindex:1050;--bs-backdrop-bg:#000;--bs-backdrop-opacity:0.5;position:fixed;top:0;left:0;z-index:var(--bs-backdrop-zindex);width:100vw;height:100vh;background-color:var(--bs-backdrop-bg)}.modal-backdrop.fade{opacity:0}.modal-backdrop.show{opacity:var(--bs-backdrop-opacity)}.modal-header{display:flex;flex-shrink:0;align-items:center;padding:var(--bs-modal-header-padding);border-bottom:var(--bs-modal-header-border-width) solid var(--bs-modal-header-border-color);border-top-left-radius:var(--bs-modal-inner-border-radius);border-top-right-radius:var(--bs-modal-inner-border-radius)}.modal-header .btn-close{padding:calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin:calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto}.modal-title{margin-bottom:0;line-height:var(--bs-modal-title-line-height)}.modal-body{position:relative;flex:1 1 auto;padding:var(--bs-modal-padding)}.modal-footer{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:calc(var(--bs-modal-padding) - var(--bs-modal-footer-gap) * .5);background-color:var(--bs-modal-footer-bg);border-top:var(--bs-modal-footer-border-width) solid var(--bs-modal-footer-border-color);border-bottom-right-radius:var(--bs-modal-inner-border-radius);border-bottom-left-radius:var(--bs-modal-inner-border-radius)}.modal-footer>*{margin:calc(var(--bs-modal-footer-gap) * .5)}@media (min-width:576px){.modal{--bs-modal-margin:1.75rem;--bs-modal-box-shadow:var(--bs-box-shadow)}.modal-dialog{max-width:var(--bs-modal-width);margin-right:auto;margin-left:auto}.modal-sm{--bs-modal-width:300px}}@media (min-width:992px){.modal-lg,.modal-xl{--bs-modal-width:800px}}@media (min-width:1200px){.modal-xl{--bs-modal-width:1140px}}.modal-fullscreen{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen .modal-footer,.modal-fullscreen .modal-header{border-radius:0}.modal-fullscreen .modal-body{overflow-y:auto}@media (max-width:575.98px){.modal-fullscreen-sm-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down .modal-footer,.modal-fullscreen-sm-down .modal-header{border-radius:0}.modal-fullscreen-sm-down .modal-body{overflow-y:auto}}@media (max-width:767.98px){.modal-fullscreen-md-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down .modal-footer,.modal-fullscreen-md-down .modal-header{border-radius:0}.modal-fullscreen-md-down .modal-body{overflow-y:auto}}@media (max-width:991.98px){.modal-fullscreen-lg-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down .modal-footer,.modal-fullscreen-lg-down .modal-header{border-radius:0}.modal-fullscreen-lg-down .modal-body{overflow-y:auto}}@media (max-width:1199.98px){.modal-fullscreen-xl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down .modal-footer,.modal-fullscreen-xl-down .modal-header{border-radius:0}.modal-fullscreen-xl-down .modal-body{overflow-y:auto}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down .modal-content{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down .modal-footer,.modal-fullscreen-xxl-down .modal-header{border-radius:0}.modal-fullscreen-xxl-down .modal-body{overflow-y:auto}}.tooltip{--bs-tooltip-zindex:1080;--bs-tooltip-max-width:200px;--bs-tooltip-padding-x:0.5rem;--bs-tooltip-padding-y:0.25rem;--bs-tooltip-margin: ;--bs-tooltip-font-size:0.875rem;--bs-tooltip-color:var(--bs-body-bg);--bs-tooltip-bg:var(--bs-emphasis-color);--bs-tooltip-border-radius:var(--bs-border-radius);--bs-tooltip-opacity:0.9;--bs-tooltip-arrow-width:0.8rem;--bs-tooltip-arrow-height:0.4rem;z-index:var(--bs-tooltip-zindex);display:block;margin:var(--bs-tooltip-margin);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-tooltip-font-size);word-wrap:break-word;opacity:0}.tooltip.show{opacity:var(--bs-tooltip-opacity)}.tooltip .tooltip-arrow{display:block;width:var(--bs-tooltip-arrow-width);height:var(--bs-tooltip-arrow-height)}.tooltip .tooltip-arrow::before{position:absolute;content:"";border-color:transparent;border-style:solid}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow,.bs-tooltip-top .tooltip-arrow{bottom:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=top] .tooltip-arrow::before,.bs-tooltip-top .tooltip-arrow::before{top:-1px;border-width:var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-top-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow,.bs-tooltip-end .tooltip-arrow{left:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=right] .tooltip-arrow::before,.bs-tooltip-end .tooltip-arrow::before{right:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-right-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow,.bs-tooltip-bottom .tooltip-arrow{top:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=bottom] .tooltip-arrow::before,.bs-tooltip-bottom .tooltip-arrow::before{bottom:-1px;border-width:0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-bottom-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow,.bs-tooltip-start .tooltip-arrow{right:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=left] .tooltip-arrow::before,.bs-tooltip-start .tooltip-arrow::before{left:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) 0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-left-color:var(--bs-tooltip-bg)}.tooltip-inner{max-width:var(--bs-tooltip-max-width);padding:var(--bs-tooltip-padding-y) var(--bs-tooltip-padding-x);color:var(--bs-tooltip-color);text-align:center;background-color:var(--bs-tooltip-bg);border-radius:var(--bs-tooltip-border-radius)}.popover{--bs-popover-zindex:1070;--bs-popover-max-width:276px;--bs-popover-font-size:0.875rem;--bs-popover-bg:var(--bs-body-bg);--bs-popover-border-width:var(--bs-border-width);--bs-popover-border-color:var(--bs-border-color-translucent);--bs-popover-border-radius:var(--bs-border-radius-lg);--bs-popover-inner-border-radius:calc(var(--bs-border-radius-lg) - var(--bs-border-width));--bs-popover-box-shadow:var(--bs-box-shadow);--bs-popover-header-padding-x:1rem;--bs-popover-header-padding-y:0.5rem;--bs-popover-header-font-size:1rem;--bs-popover-header-color:inherit;--bs-popover-header-bg:var(--bs-secondary-bg);--bs-popover-body-padding-x:1rem;--bs-popover-body-padding-y:1rem;--bs-popover-body-color:var(--bs-body-color);--bs-popover-arrow-width:1rem;--bs-popover-arrow-height:0.5rem;--bs-popover-arrow-border:var(--bs-popover-border-color);z-index:var(--bs-popover-zindex);display:block;max-width:var(--bs-popover-max-width);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-popover-font-size);word-wrap:break-word;background-color:var(--bs-popover-bg);background-clip:padding-box;border:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-radius:var(--bs-popover-border-radius)}.popover .popover-arrow{display:block;width:var(--bs-popover-arrow-width);height:var(--bs-popover-arrow-height)}.popover .popover-arrow::after,.popover .popover-arrow::before{position:absolute;display:block;content:"";border-color:transparent;border-style:solid;border-width:0}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow,.bs-popover-top>.popover-arrow{bottom:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::before,.bs-popover-top>.popover-arrow::after,.bs-popover-top>.popover-arrow::before{border-width:var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::before,.bs-popover-top>.popover-arrow::before{bottom:0;border-top-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=top]>.popover-arrow::after,.bs-popover-top>.popover-arrow::after{bottom:var(--bs-popover-border-width);border-top-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow,.bs-popover-end>.popover-arrow{left:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::before,.bs-popover-end>.popover-arrow::after,.bs-popover-end>.popover-arrow::before{border-width:calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::before,.bs-popover-end>.popover-arrow::before{left:0;border-right-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=right]>.popover-arrow::after,.bs-popover-end>.popover-arrow::after{left:var(--bs-popover-border-width);border-right-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow,.bs-popover-bottom>.popover-arrow{top:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::before,.bs-popover-bottom>.popover-arrow::after,.bs-popover-bottom>.popover-arrow::before{border-width:0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::before,.bs-popover-bottom>.popover-arrow::before{top:0;border-bottom-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=bottom]>.popover-arrow::after,.bs-popover-bottom>.popover-arrow::after{top:var(--bs-popover-border-width);border-bottom-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom] .popover-header::before,.bs-popover-bottom .popover-header::before{position:absolute;top:0;left:50%;display:block;width:var(--bs-popover-arrow-width);margin-left:calc(-.5 * var(--bs-popover-arrow-width));content:"";border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-header-bg)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow,.bs-popover-start>.popover-arrow{right:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::after,.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::before,.bs-popover-start>.popover-arrow::after,.bs-popover-start>.popover-arrow::before{border-width:calc(var(--bs-popover-arrow-width) * .5) 0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::before,.bs-popover-start>.popover-arrow::before{right:0;border-left-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=left]>.popover-arrow::after,.bs-popover-start>.popover-arrow::after{right:var(--bs-popover-border-width);border-left-color:var(--bs-popover-bg)}.popover-header{padding:var(--bs-popover-header-padding-y) var(--bs-popover-header-padding-x);margin-bottom:0;font-size:var(--bs-popover-header-font-size);color:var(--bs-popover-header-color);background-color:var(--bs-popover-header-bg);border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-top-left-radius:var(--bs-popover-inner-border-radius);border-top-right-radius:var(--bs-popover-inner-border-radius)}.popover-header:empty{display:none}.popover-body{padding:var(--bs-popover-body-padding-y) var(--bs-popover-body-padding-x);color:var(--bs-popover-body-color)}.carousel{position:relative}.carousel.pointer-event{touch-action:pan-y}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner::after{display:block;clear:both;content:""}.carousel-item{position:relative;display:none;float:left;width:100%;margin-right:-100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;transition:transform .6s ease-in-out}@media (prefers-reduced-motion:reduce){.carousel-item{transition:none}}.carousel-item-next,.carousel-item-prev,.carousel-item.active{display:block}.active.carousel-item-end,.carousel-item-next:not(.carousel-item-start){transform:translateX(100%)}.active.carousel-item-start,.carousel-item-prev:not(.carousel-item-end){transform:translateX(-100%)}.carousel-fade .carousel-item{opacity:0;transition-property:opacity;transform:none}.carousel-fade .carousel-item-next.carousel-item-start,.carousel-fade .carousel-item-prev.carousel-item-end,.carousel-fade .carousel-item.active{z-index:1;opacity:1}.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{z-index:0;opacity:0;transition:opacity 0s .6s}@media (prefers-reduced-motion:reduce){.carousel-fade .active.carousel-item-end,.carousel-fade .active.carousel-item-start{transition:none}}.carousel-control-next,.carousel-control-prev{position:absolute;top:0;bottom:0;z-index:1;display:flex;align-items:center;justify-content:center;width:15%;padding:0;color:#fff;text-align:center;background:0 0;border:0;opacity:.5;transition:opacity .15s ease}@media (prefers-reduced-motion:reduce){.carousel-control-next,.carousel-control-prev{transition:none}}.carousel-control-next:focus,.carousel-control-next:hover,.carousel-control-prev:focus,.carousel-control-prev:hover{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev{left:0}.carousel-control-next{right:0}.carousel-control-next-icon,.carousel-control-prev-icon{display:inline-block;width:2rem;height:2rem;background-repeat:no-repeat;background-position:50%;background-size:100% 100%}.carousel-control-prev-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z'/%3e%3c/svg%3e")}.carousel-control-next-icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e")}.carousel-indicators{position:absolute;right:0;bottom:0;left:0;z-index:2;display:flex;justify-content:center;padding:0;margin-right:15%;margin-bottom:1rem;margin-left:15%}.carousel-indicators [data-bs-target]{box-sizing:content-box;flex:0 1 auto;width:30px;height:3px;padding:0;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border:0;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media (prefers-reduced-motion:reduce){.carousel-indicators [data-bs-target]{transition:none}}.carousel-indicators .active{opacity:1}.carousel-caption{position:absolute;right:15%;bottom:1.25rem;left:15%;padding-top:1.25rem;padding-bottom:1.25rem;color:#fff;text-align:center}.carousel-dark .carousel-control-next-icon,.carousel-dark .carousel-control-prev-icon{filter:invert(1) grayscale(100)}.carousel-dark .carousel-indicators [data-bs-target]{background-color:#000}.carousel-dark .carousel-caption{color:#000}[data-bs-theme=dark] .carousel .carousel-control-next-icon,[data-bs-theme=dark] .carousel .carousel-control-prev-icon,[data-bs-theme=dark].carousel .carousel-control-next-icon,[data-bs-theme=dark].carousel .carousel-control-prev-icon{filter:invert(1) grayscale(100)}[data-bs-theme=dark] .carousel .carousel-indicators [data-bs-target],[data-bs-theme=dark].carousel .carousel-indicators [data-bs-target]{background-color:#000}[data-bs-theme=dark] .carousel .carousel-caption,[data-bs-theme=dark].carousel .carousel-caption{color:#000}.spinner-border,.spinner-grow{display:inline-block;width:var(--bs-spinner-width);height:var(--bs-spinner-height);vertical-align:var(--bs-spinner-vertical-align);border-radius:50%;animation:var(--bs-spinner-animation-speed) linear infinite var(--bs-spinner-animation-name)}@keyframes spinner-border{to{transform:rotate(360deg)}}.spinner-border{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-0.125em;--bs-spinner-border-width:0.25em;--bs-spinner-animation-speed:0.75s;--bs-spinner-animation-name:spinner-border;border:var(--bs-spinner-border-width) solid currentcolor;border-right-color:transparent}.spinner-border-sm{--bs-spinner-width:1rem;--bs-spinner-height:1rem;--bs-spinner-border-width:0.2em}@keyframes spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}.spinner-grow{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-0.125em;--bs-spinner-animation-speed:0.75s;--bs-spinner-animation-name:spinner-grow;background-color:currentcolor;opacity:0}.spinner-grow-sm{--bs-spinner-width:1rem;--bs-spinner-height:1rem}@media (prefers-reduced-motion:reduce){.spinner-border,.spinner-grow{--bs-spinner-animation-speed:1.5s}}.offcanvas,.offcanvas-lg,.offcanvas-md,.offcanvas-sm,.offcanvas-xl,.offcanvas-xxl{--bs-offcanvas-zindex:1045;--bs-offcanvas-width:400px;--bs-offcanvas-height:30vh;--bs-offcanvas-padding-x:1rem;--bs-offcanvas-padding-y:1rem;--bs-offcanvas-color:var(--bs-body-color);--bs-offcanvas-bg:var(--bs-body-bg);--bs-offcanvas-border-width:var(--bs-border-width);--bs-offcanvas-border-color:var(--bs-border-color-translucent);--bs-offcanvas-box-shadow:var(--bs-box-shadow-sm);--bs-offcanvas-transition:transform 0.3s ease-in-out;--bs-offcanvas-title-line-height:1.5}@media (max-width:575.98px){.offcanvas-sm{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:575.98px) and (prefers-reduced-motion:reduce){.offcanvas-sm{transition:none}}@media (max-width:575.98px){.offcanvas-sm.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-sm.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-sm.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-sm.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-sm.show:not(.hiding),.offcanvas-sm.showing{transform:none}.offcanvas-sm.hiding,.offcanvas-sm.show,.offcanvas-sm.showing{visibility:visible}}@media (min-width:576px){.offcanvas-sm{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-sm .offcanvas-header{display:none}.offcanvas-sm .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:767.98px){.offcanvas-md{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:767.98px) and (prefers-reduced-motion:reduce){.offcanvas-md{transition:none}}@media (max-width:767.98px){.offcanvas-md.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-md.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-md.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-md.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-md.show:not(.hiding),.offcanvas-md.showing{transform:none}.offcanvas-md.hiding,.offcanvas-md.show,.offcanvas-md.showing{visibility:visible}}@media (min-width:768px){.offcanvas-md{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-md .offcanvas-header{display:none}.offcanvas-md .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:991.98px){.offcanvas-lg{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:991.98px) and (prefers-reduced-motion:reduce){.offcanvas-lg{transition:none}}@media (max-width:991.98px){.offcanvas-lg.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-lg.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-lg.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-lg.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-lg.show:not(.hiding),.offcanvas-lg.showing{transform:none}.offcanvas-lg.hiding,.offcanvas-lg.show,.offcanvas-lg.showing{visibility:visible}}@media (min-width:992px){.offcanvas-lg{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-lg .offcanvas-header{display:none}.offcanvas-lg .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1199.98px){.offcanvas-xl{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1199.98px) and (prefers-reduced-motion:reduce){.offcanvas-xl{transition:none}}@media (max-width:1199.98px){.offcanvas-xl.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-xl.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-xl.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xl.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xl.show:not(.hiding),.offcanvas-xl.showing{transform:none}.offcanvas-xl.hiding,.offcanvas-xl.show,.offcanvas-xl.showing{visibility:visible}}@media (min-width:1200px){.offcanvas-xl{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xl .offcanvas-header{display:none}.offcanvas-xl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1399.98px){.offcanvas-xxl{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1399.98px) and (prefers-reduced-motion:reduce){.offcanvas-xxl{transition:none}}@media (max-width:1399.98px){.offcanvas-xxl.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas-xxl.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas-xxl.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xxl.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xxl.show:not(.hiding),.offcanvas-xxl.showing{transform:none}.offcanvas-xxl.hiding,.offcanvas-xxl.show,.offcanvas-xxl.showing{visibility:visible}}@media (min-width:1400px){.offcanvas-xxl{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xxl .offcanvas-header{display:none}.offcanvas-xxl .offcanvas-body{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}.offcanvas{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}@media (prefers-reduced-motion:reduce){.offcanvas{transition:none}}.offcanvas.offcanvas-start{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(-100%)}.offcanvas.offcanvas-end{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateX(100%)}.offcanvas.offcanvas-top{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas.offcanvas-bottom{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas.show:not(.hiding),.offcanvas.showing{transform:none}.offcanvas.hiding,.offcanvas.show,.offcanvas.showing{visibility:visible}.offcanvas-backdrop{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.offcanvas-backdrop.fade{opacity:0}.offcanvas-backdrop.show{opacity:.5}.offcanvas-header{display:flex;align-items:center;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x)}.offcanvas-header .btn-close{padding:calc(var(--bs-offcanvas-padding-y) * .5) calc(var(--bs-offcanvas-padding-x) * .5);margin:calc(-.5 * var(--bs-offcanvas-padding-y)) calc(-.5 * var(--bs-offcanvas-padding-x)) calc(-.5 * var(--bs-offcanvas-padding-y)) auto}.offcanvas-title{margin-bottom:0;line-height:var(--bs-offcanvas-title-line-height)}.offcanvas-body{flex-grow:1;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x);overflow-y:auto}.placeholder{display:inline-block;min-height:1em;vertical-align:middle;cursor:wait;background-color:currentcolor;opacity:.5}.placeholder.btn::before{display:inline-block;content:""}.placeholder-xs{min-height:.6em}.placeholder-sm{min-height:.8em}.placeholder-lg{min-height:1.2em}.placeholder-glow .placeholder{animation:placeholder-glow 2s ease-in-out infinite}@keyframes placeholder-glow{50%{opacity:.2}}.placeholder-wave{-webkit-mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,0.8) 75%,#000 95%);-webkit-mask-size:200% 100%;mask-size:200% 100%;animation:placeholder-wave 2s linear infinite}@keyframes placeholder-wave{100%{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}.clearfix::after{display:block;clear:both;content:""}.text-bg-primary{color:#fff!important;background-color:RGBA(var(--bs-primary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-secondary{color:#fff!important;background-color:RGBA(var(--bs-secondary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-success{color:#fff!important;background-color:RGBA(var(--bs-success-rgb),var(--bs-bg-opacity,1))!important}.text-bg-info{color:#000!important;background-color:RGBA(var(--bs-info-rgb),var(--bs-bg-opacity,1))!important}.text-bg-warning{color:#000!important;background-color:RGBA(var(--bs-warning-rgb),var(--bs-bg-opacity,1))!important}.text-bg-danger{color:#fff!important;background-color:RGBA(var(--bs-danger-rgb),var(--bs-bg-opacity,1))!important}.text-bg-light{color:#000!important;background-color:RGBA(var(--bs-light-rgb),var(--bs-bg-opacity,1))!important}.text-bg-dark{color:#fff!important;background-color:RGBA(var(--bs-dark-rgb),var(--bs-bg-opacity,1))!important}.link-primary{color:RGBA(var(--bs-primary-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important}.link-primary:focus,.link-primary:hover{color:RGBA(10,88,202,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important}.link-secondary{color:RGBA(var(--bs-secondary-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important}.link-secondary:focus,.link-secondary:hover{color:RGBA(86,94,100,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important}.link-success{color:RGBA(var(--bs-success-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important}.link-success:focus,.link-success:hover{color:RGBA(20,108,67,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important}.link-info{color:RGBA(var(--bs-info-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important}.link-info:focus,.link-info:hover{color:RGBA(61,213,243,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important}.link-warning{color:RGBA(var(--bs-warning-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important}.link-warning:focus,.link-warning:hover{color:RGBA(255,205,57,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important}.link-danger{color:RGBA(var(--bs-danger-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important}.link-danger:focus,.link-danger:hover{color:RGBA(176,42,55,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important}.link-light{color:RGBA(var(--bs-light-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important}.link-light:focus,.link-light:hover{color:RGBA(249,250,251,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important}.link-dark{color:RGBA(var(--bs-dark-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important}.link-dark:focus,.link-dark:hover{color:RGBA(26,30,33,var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important}.link-body-emphasis{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,1))!important;-webkit-text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-body-emphasis:focus,.link-body-emphasis:hover{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,.75))!important;-webkit-text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,0.75))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,0.75))!important}.focus-ring:focus{outline:0;box-shadow:var(--bs-focus-ring-x,0) var(--bs-focus-ring-y,0) var(--bs-focus-ring-blur,0) var(--bs-focus-ring-width) var(--bs-focus-ring-color)}.icon-link{display:inline-flex;gap:.375rem;align-items:center;-webkit-text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,0.5));text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,0.5));text-underline-offset:0.25em;-webkit-backface-visibility:hidden;backface-visibility:hidden}.icon-link>.bi{flex-shrink:0;width:1em;height:1em;fill:currentcolor;transition:.2s ease-in-out transform}@media (prefers-reduced-motion:reduce){.icon-link>.bi{transition:none}}.icon-link-hover:focus-visible>.bi,.icon-link-hover:hover>.bi{transform:var(--bs-icon-link-transform,translate3d(.25em,0,0))}.ratio{position:relative;width:100%}.ratio::before{display:block;padding-top:var(--bs-aspect-ratio);content:""}.ratio>*{position:absolute;top:0;left:0;width:100%;height:100%}.ratio-1x1{--bs-aspect-ratio:100%}.ratio-4x3{--bs-aspect-ratio:75%}.ratio-16x9{--bs-aspect-ratio:56.25%}.ratio-21x9{--bs-aspect-ratio:42.8571428571%}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}@media (min-width:576px){.sticky-sm-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-sm-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:768px){.sticky-md-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-md-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:992px){.sticky-lg-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-lg-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:1200px){.sticky-xl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-xl-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}@media (min-width:1400px){.sticky-xxl-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}.sticky-xxl-bottom{position:-webkit-sticky;position:sticky;bottom:0;z-index:1020}}.hstack{display:flex;flex-direction:row;align-items:center;align-self:stretch}.vstack{display:flex;flex:1 1 auto;flex-direction:column;align-self:stretch}.visually-hidden,.visually-hidden-focusable:not(:focus):not(:focus-within){width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.visually-hidden-focusable:not(:focus):not(:focus-within):not(caption),.visually-hidden:not(caption){position:absolute!important}.stretched-link::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:1;content:""}.text-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vr{display:inline-block;align-self:stretch;width:var(--bs-border-width);min-height:1em;background-color:currentcolor;opacity:.25}.align-baseline{vertical-align:baseline!important}.align-top{vertical-align:top!important}.align-middle{vertical-align:middle!important}.align-bottom{vertical-align:bottom!important}.align-text-bottom{vertical-align:text-bottom!important}.align-text-top{vertical-align:text-top!important}.float-start{float:left!important}.float-end{float:right!important}.float-none{float:none!important}.object-fit-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-none{-o-object-fit:none!important;object-fit:none!important}.opacity-0{opacity:0!important}.opacity-25{opacity:.25!important}.opacity-50{opacity:.5!important}.opacity-75{opacity:.75!important}.opacity-100{opacity:1!important}.overflow-auto{overflow:auto!important}.overflow-hidden{overflow:hidden!important}.overflow-visible{overflow:visible!important}.overflow-scroll{overflow:scroll!important}.overflow-x-auto{overflow-x:auto!important}.overflow-x-hidden{overflow-x:hidden!important}.overflow-x-visible{overflow-x:visible!important}.overflow-x-scroll{overflow-x:scroll!important}.overflow-y-auto{overflow-y:auto!important}.overflow-y-hidden{overflow-y:hidden!important}.overflow-y-visible{overflow-y:visible!important}.overflow-y-scroll{overflow-y:scroll!important}.d-inline{display:inline!important}.d-inline-block{display:inline-block!important}.d-block{display:block!important}.d-grid{display:grid!important}.d-inline-grid{display:inline-grid!important}.d-table{display:table!important}.d-table-row{display:table-row!important}.d-table-cell{display:table-cell!important}.d-flex{display:flex!important}.d-inline-flex{display:inline-flex!important}.d-none{display:none!important}.shadow{box-shadow:var(--bs-box-shadow)!important}.shadow-sm{box-shadow:var(--bs-box-shadow-sm)!important}.shadow-lg{box-shadow:var(--bs-box-shadow-lg)!important}.shadow-none{box-shadow:none!important}.focus-ring-primary{--bs-focus-ring-color:rgba(var(--bs-primary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-secondary{--bs-focus-ring-color:rgba(var(--bs-secondary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-success{--bs-focus-ring-color:rgba(var(--bs-success-rgb), var(--bs-focus-ring-opacity))}.focus-ring-info{--bs-focus-ring-color:rgba(var(--bs-info-rgb), var(--bs-focus-ring-opacity))}.focus-ring-warning{--bs-focus-ring-color:rgba(var(--bs-warning-rgb), var(--bs-focus-ring-opacity))}.focus-ring-danger{--bs-focus-ring-color:rgba(var(--bs-danger-rgb), var(--bs-focus-ring-opacity))}.focus-ring-light{--bs-focus-ring-color:rgba(var(--bs-light-rgb), var(--bs-focus-ring-opacity))}.focus-ring-dark{--bs-focus-ring-color:rgba(var(--bs-dark-rgb), var(--bs-focus-ring-opacity))}.position-static{position:static!important}.position-relative{position:relative!important}.position-absolute{position:absolute!important}.position-fixed{position:fixed!important}.position-sticky{position:-webkit-sticky!important;position:sticky!important}.top-0{top:0!important}.top-50{top:50%!important}.top-100{top:100%!important}.bottom-0{bottom:0!important}.bottom-50{bottom:50%!important}.bottom-100{bottom:100%!important}.start-0{left:0!important}.start-50{left:50%!important}.start-100{left:100%!important}.end-0{right:0!important}.end-50{right:50%!important}.end-100{right:100%!important}.translate-middle{transform:translate(-50%,-50%)!important}.translate-middle-x{transform:translateX(-50%)!important}.translate-middle-y{transform:translateY(-50%)!important}.border{border:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-0{border:0!important}.border-top{border-top:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-top-0{border-top:0!important}.border-end{border-right:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-end-0{border-right:0!important}.border-bottom{border-bottom:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-bottom-0{border-bottom:0!important}.border-start{border-left:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-start-0{border-left:0!important}.border-primary{--bs-border-opacity:1;border-color:rgba(var(--bs-primary-rgb),var(--bs-border-opacity))!important}.border-secondary{--bs-border-opacity:1;border-color:rgba(var(--bs-secondary-rgb),var(--bs-border-opacity))!important}.border-success{--bs-border-opacity:1;border-color:rgba(var(--bs-success-rgb),var(--bs-border-opacity))!important}.border-info{--bs-border-opacity:1;border-color:rgba(var(--bs-info-rgb),var(--bs-border-opacity))!important}.border-warning{--bs-border-opacity:1;border-color:rgba(var(--bs-warning-rgb),var(--bs-border-opacity))!important}.border-danger{--bs-border-opacity:1;border-color:rgba(var(--bs-danger-rgb),var(--bs-border-opacity))!important}.border-light{--bs-border-opacity:1;border-color:rgba(var(--bs-light-rgb),var(--bs-border-opacity))!important}.border-dark{--bs-border-opacity:1;border-color:rgba(var(--bs-dark-rgb),var(--bs-border-opacity))!important}.border-black{--bs-border-opacity:1;border-color:rgba(var(--bs-black-rgb),var(--bs-border-opacity))!important}.border-white{--bs-border-opacity:1;border-color:rgba(var(--bs-white-rgb),var(--bs-border-opacity))!important}.border-primary-subtle{border-color:var(--bs-primary-border-subtle)!important}.border-secondary-subtle{border-color:var(--bs-secondary-border-subtle)!important}.border-success-subtle{border-color:var(--bs-success-border-subtle)!important}.border-info-subtle{border-color:var(--bs-info-border-subtle)!important}.border-warning-subtle{border-color:var(--bs-warning-border-subtle)!important}.border-danger-subtle{border-color:var(--bs-danger-border-subtle)!important}.border-light-subtle{border-color:var(--bs-light-border-subtle)!important}.border-dark-subtle{border-color:var(--bs-dark-border-subtle)!important}.border-1{border-width:1px!important}.border-2{border-width:2px!important}.border-3{border-width:3px!important}.border-4{border-width:4px!important}.border-5{border-width:5px!important}.border-opacity-10{--bs-border-opacity:0.1}.border-opacity-25{--bs-border-opacity:0.25}.border-opacity-50{--bs-border-opacity:0.5}.border-opacity-75{--bs-border-opacity:0.75}.border-opacity-100{--bs-border-opacity:1}.w-25{width:25%!important}.w-50{width:50%!important}.w-75{width:75%!important}.w-100{width:100%!important}.w-auto{width:auto!important}.mw-100{max-width:100%!important}.vw-100{width:100vw!important}.min-vw-100{min-width:100vw!important}.h-25{height:25%!important}.h-50{height:50%!important}.h-75{height:75%!important}.h-100{height:100%!important}.h-auto{height:auto!important}.mh-100{max-height:100%!important}.vh-100{height:100vh!important}.min-vh-100{min-height:100vh!important}.flex-fill{flex:1 1 auto!important}.flex-row{flex-direction:row!important}.flex-column{flex-direction:column!important}.flex-row-reverse{flex-direction:row-reverse!important}.flex-column-reverse{flex-direction:column-reverse!important}.flex-grow-0{flex-grow:0!important}.flex-grow-1{flex-grow:1!important}.flex-shrink-0{flex-shrink:0!important}.flex-shrink-1{flex-shrink:1!important}.flex-wrap{flex-wrap:wrap!important}.flex-nowrap{flex-wrap:nowrap!important}.flex-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-start{justify-content:flex-start!important}.justify-content-end{justify-content:flex-end!important}.justify-content-center{justify-content:center!important}.justify-content-between{justify-content:space-between!important}.justify-content-around{justify-content:space-around!important}.justify-content-evenly{justify-content:space-evenly!important}.align-items-start{align-items:flex-start!important}.align-items-end{align-items:flex-end!important}.align-items-center{align-items:center!important}.align-items-baseline{align-items:baseline!important}.align-items-stretch{align-items:stretch!important}.align-content-start{align-content:flex-start!important}.align-content-end{align-content:flex-end!important}.align-content-center{align-content:center!important}.align-content-between{align-content:space-between!important}.align-content-around{align-content:space-around!important}.align-content-stretch{align-content:stretch!important}.align-self-auto{align-self:auto!important}.align-self-start{align-self:flex-start!important}.align-self-end{align-self:flex-end!important}.align-self-center{align-self:center!important}.align-self-baseline{align-self:baseline!important}.align-self-stretch{align-self:stretch!important}.order-first{order:-1!important}.order-0{order:0!important}.order-1{order:1!important}.order-2{order:2!important}.order-3{order:3!important}.order-4{order:4!important}.order-5{order:5!important}.order-last{order:6!important}.m-0{margin:0!important}.m-1{margin:.25rem!important}.m-2{margin:.5rem!important}.m-3{margin:1rem!important}.m-4{margin:1.5rem!important}.m-5{margin:3rem!important}.m-auto{margin:auto!important}.mx-0{margin-right:0!important;margin-left:0!important}.mx-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-3{margin-right:1rem!important;margin-left:1rem!important}.mx-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-5{margin-right:3rem!important;margin-left:3rem!important}.mx-auto{margin-right:auto!important;margin-left:auto!important}.my-0{margin-top:0!important;margin-bottom:0!important}.my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-0{margin-top:0!important}.mt-1{margin-top:.25rem!important}.mt-2{margin-top:.5rem!important}.mt-3{margin-top:1rem!important}.mt-4{margin-top:1.5rem!important}.mt-5{margin-top:3rem!important}.mt-auto{margin-top:auto!important}.me-0{margin-right:0!important}.me-1{margin-right:.25rem!important}.me-2{margin-right:.5rem!important}.me-3{margin-right:1rem!important}.me-4{margin-right:1.5rem!important}.me-5{margin-right:3rem!important}.me-auto{margin-right:auto!important}.mb-0{margin-bottom:0!important}.mb-1{margin-bottom:.25rem!important}.mb-2{margin-bottom:.5rem!important}.mb-3{margin-bottom:1rem!important}.mb-4{margin-bottom:1.5rem!important}.mb-5{margin-bottom:3rem!important}.mb-auto{margin-bottom:auto!important}.ms-0{margin-left:0!important}.ms-1{margin-left:.25rem!important}.ms-2{margin-left:.5rem!important}.ms-3{margin-left:1rem!important}.ms-4{margin-left:1.5rem!important}.ms-5{margin-left:3rem!important}.ms-auto{margin-left:auto!important}.p-0{padding:0!important}.p-1{padding:.25rem!important}.p-2{padding:.5rem!important}.p-3{padding:1rem!important}.p-4{padding:1.5rem!important}.p-5{padding:3rem!important}.px-0{padding-right:0!important;padding-left:0!important}.px-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-3{padding-right:1rem!important;padding-left:1rem!important}.px-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-5{padding-right:3rem!important;padding-left:3rem!important}.py-0{padding-top:0!important;padding-bottom:0!important}.py-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-0{padding-top:0!important}.pt-1{padding-top:.25rem!important}.pt-2{padding-top:.5rem!important}.pt-3{padding-top:1rem!important}.pt-4{padding-top:1.5rem!important}.pt-5{padding-top:3rem!important}.pe-0{padding-right:0!important}.pe-1{padding-right:.25rem!important}.pe-2{padding-right:.5rem!important}.pe-3{padding-right:1rem!important}.pe-4{padding-right:1.5rem!important}.pe-5{padding-right:3rem!important}.pb-0{padding-bottom:0!important}.pb-1{padding-bottom:.25rem!important}.pb-2{padding-bottom:.5rem!important}.pb-3{padding-bottom:1rem!important}.pb-4{padding-bottom:1.5rem!important}.pb-5{padding-bottom:3rem!important}.ps-0{padding-left:0!important}.ps-1{padding-left:.25rem!important}.ps-2{padding-left:.5rem!important}.ps-3{padding-left:1rem!important}.ps-4{padding-left:1.5rem!important}.ps-5{padding-left:3rem!important}.gap-0{gap:0!important}.gap-1{gap:.25rem!important}.gap-2{gap:.5rem!important}.gap-3{gap:1rem!important}.gap-4{gap:1.5rem!important}.gap-5{gap:3rem!important}.row-gap-0{row-gap:0!important}.row-gap-1{row-gap:.25rem!important}.row-gap-2{row-gap:.5rem!important}.row-gap-3{row-gap:1rem!important}.row-gap-4{row-gap:1.5rem!important}.row-gap-5{row-gap:3rem!important}.column-gap-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.font-monospace{font-family:var(--bs-font-monospace)!important}.fs-1{font-size:calc(1.375rem + 1.5vw)!important}.fs-2{font-size:calc(1.325rem + .9vw)!important}.fs-3{font-size:calc(1.3rem + .6vw)!important}.fs-4{font-size:calc(1.275rem + .3vw)!important}.fs-5{font-size:1.25rem!important}.fs-6{font-size:1rem!important}.fst-italic{font-style:italic!important}.fst-normal{font-style:normal!important}.fw-lighter{font-weight:lighter!important}.fw-light{font-weight:300!important}.fw-normal{font-weight:400!important}.fw-medium{font-weight:500!important}.fw-semibold{font-weight:600!important}.fw-bold{font-weight:700!important}.fw-bolder{font-weight:bolder!important}.lh-1{line-height:1!important}.lh-sm{line-height:1.25!important}.lh-base{line-height:1.5!important}.lh-lg{line-height:2!important}.text-start{text-align:left!important}.text-end{text-align:right!important}.text-center{text-align:center!important}.text-decoration-none{text-decoration:none!important}.text-decoration-underline{text-decoration:underline!important}.text-decoration-line-through{text-decoration:line-through!important}.text-lowercase{text-transform:lowercase!important}.text-uppercase{text-transform:uppercase!important}.text-capitalize{text-transform:capitalize!important}.text-wrap{white-space:normal!important}.text-nowrap{white-space:nowrap!important}.text-break{word-wrap:break-word!important;word-break:break-word!important}.text-primary{--bs-text-opacity:1;color:rgba(var(--bs-primary-rgb),var(--bs-text-opacity))!important}.text-secondary{--bs-text-opacity:1;color:rgba(var(--bs-secondary-rgb),var(--bs-text-opacity))!important}.text-success{--bs-text-opacity:1;color:rgba(var(--bs-success-rgb),var(--bs-text-opacity))!important}.text-info{--bs-text-opacity:1;color:rgba(var(--bs-info-rgb),var(--bs-text-opacity))!important}.text-warning{--bs-text-opacity:1;color:rgba(var(--bs-warning-rgb),var(--bs-text-opacity))!important}.text-danger{--bs-text-opacity:1;color:rgba(var(--bs-danger-rgb),var(--bs-text-opacity))!important}.text-light{--bs-text-opacity:1;color:rgba(var(--bs-light-rgb),var(--bs-text-opacity))!important}.text-dark{--bs-text-opacity:1;color:rgba(var(--bs-dark-rgb),var(--bs-text-opacity))!important}.text-black{--bs-text-opacity:1;color:rgba(var(--bs-black-rgb),var(--bs-text-opacity))!important}.text-white{--bs-text-opacity:1;color:rgba(var(--bs-white-rgb),var(--bs-text-opacity))!important}.text-body{--bs-text-opacity:1;color:rgba(var(--bs-body-color-rgb),var(--bs-text-opacity))!important}.text-muted{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-black-50{--bs-text-opacity:1;color:rgba(0,0,0,.5)!important}.text-white-50{--bs-text-opacity:1;color:rgba(255,255,255,.5)!important}.text-body-secondary{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-body-tertiary{--bs-text-opacity:1;color:var(--bs-tertiary-color)!important}.text-body-emphasis{--bs-text-opacity:1;color:var(--bs-emphasis-color)!important}.text-reset{--bs-text-opacity:1;color:inherit!important}.text-opacity-25{--bs-text-opacity:0.25}.text-opacity-50{--bs-text-opacity:0.5}.text-opacity-75{--bs-text-opacity:0.75}.text-opacity-100{--bs-text-opacity:1}.text-primary-emphasis{color:var(--bs-primary-text-emphasis)!important}.text-secondary-emphasis{color:var(--bs-secondary-text-emphasis)!important}.text-success-emphasis{color:var(--bs-success-text-emphasis)!important}.text-info-emphasis{color:var(--bs-info-text-emphasis)!important}.text-warning-emphasis{color:var(--bs-warning-text-emphasis)!important}.text-danger-emphasis{color:var(--bs-danger-text-emphasis)!important}.text-light-emphasis{color:var(--bs-light-text-emphasis)!important}.text-dark-emphasis{color:var(--bs-dark-text-emphasis)!important}.link-opacity-10{--bs-link-opacity:0.1}.link-opacity-10-hover:hover{--bs-link-opacity:0.1}.link-opacity-25{--bs-link-opacity:0.25}.link-opacity-25-hover:hover{--bs-link-opacity:0.25}.link-opacity-50{--bs-link-opacity:0.5}.link-opacity-50-hover:hover{--bs-link-opacity:0.5}.link-opacity-75{--bs-link-opacity:0.75}.link-opacity-75-hover:hover{--bs-link-opacity:0.75}.link-opacity-100{--bs-link-opacity:1}.link-opacity-100-hover:hover{--bs-link-opacity:1}.link-offset-1{text-underline-offset:0.125em!important}.link-offset-1-hover:hover{text-underline-offset:0.125em!important}.link-offset-2{text-underline-offset:0.25em!important}.link-offset-2-hover:hover{text-underline-offset:0.25em!important}.link-offset-3{text-underline-offset:0.375em!important}.link-offset-3-hover:hover{text-underline-offset:0.375em!important}.link-underline-primary{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-secondary{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-success{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important}.link-underline-info{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important}.link-underline-warning{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important}.link-underline-danger{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important}.link-underline-light{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important}.link-underline-dark{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important;text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important}.link-underline{--bs-link-underline-opacity:1;-webkit-text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-underline-opacity-0{--bs-link-underline-opacity:0}.link-underline-opacity-0-hover:hover{--bs-link-underline-opacity:0}.link-underline-opacity-10{--bs-link-underline-opacity:0.1}.link-underline-opacity-10-hover:hover{--bs-link-underline-opacity:0.1}.link-underline-opacity-25{--bs-link-underline-opacity:0.25}.link-underline-opacity-25-hover:hover{--bs-link-underline-opacity:0.25}.link-underline-opacity-50{--bs-link-underline-opacity:0.5}.link-underline-opacity-50-hover:hover{--bs-link-underline-opacity:0.5}.link-underline-opacity-75{--bs-link-underline-opacity:0.75}.link-underline-opacity-75-hover:hover{--bs-link-underline-opacity:0.75}.link-underline-opacity-100{--bs-link-underline-opacity:1}.link-underline-opacity-100-hover:hover{--bs-link-underline-opacity:1}.bg-primary{--bs-bg-opacity:1;background-color:rgba(var(--bs-primary-rgb),var(--bs-bg-opacity))!important}.bg-secondary{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-rgb),var(--bs-bg-opacity))!important}.bg-success{--bs-bg-opacity:1;background-color:rgba(var(--bs-success-rgb),var(--bs-bg-opacity))!important}.bg-info{--bs-bg-opacity:1;background-color:rgba(var(--bs-info-rgb),var(--bs-bg-opacity))!important}.bg-warning{--bs-bg-opacity:1;background-color:rgba(var(--bs-warning-rgb),var(--bs-bg-opacity))!important}.bg-danger{--bs-bg-opacity:1;background-color:rgba(var(--bs-danger-rgb),var(--bs-bg-opacity))!important}.bg-light{--bs-bg-opacity:1;background-color:rgba(var(--bs-light-rgb),var(--bs-bg-opacity))!important}.bg-dark{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}.bg-black{--bs-bg-opacity:1;background-color:rgba(var(--bs-black-rgb),var(--bs-bg-opacity))!important}.bg-white{--bs-bg-opacity:1;background-color:rgba(var(--bs-white-rgb),var(--bs-bg-opacity))!important}.bg-body{--bs-bg-opacity:1;background-color:rgba(var(--bs-body-bg-rgb),var(--bs-bg-opacity))!important}.bg-transparent{--bs-bg-opacity:1;background-color:transparent!important}.bg-body-secondary{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-bg-rgb),var(--bs-bg-opacity))!important}.bg-body-tertiary{--bs-bg-opacity:1;background-color:rgba(var(--bs-tertiary-bg-rgb),var(--bs-bg-opacity))!important}.bg-opacity-10{--bs-bg-opacity:0.1}.bg-opacity-25{--bs-bg-opacity:0.25}.bg-opacity-50{--bs-bg-opacity:0.5}.bg-opacity-75{--bs-bg-opacity:0.75}.bg-opacity-100{--bs-bg-opacity:1}.bg-primary-subtle{background-color:var(--bs-primary-bg-subtle)!important}.bg-secondary-subtle{background-color:var(--bs-secondary-bg-subtle)!important}.bg-success-subtle{background-color:var(--bs-success-bg-subtle)!important}.bg-info-subtle{background-color:var(--bs-info-bg-subtle)!important}.bg-warning-subtle{background-color:var(--bs-warning-bg-subtle)!important}.bg-danger-subtle{background-color:var(--bs-danger-bg-subtle)!important}.bg-light-subtle{background-color:var(--bs-light-bg-subtle)!important}.bg-dark-subtle{background-color:var(--bs-dark-bg-subtle)!important}.bg-gradient{background-image:var(--bs-gradient)!important}.user-select-all{-webkit-user-select:all!important;-moz-user-select:all!important;user-select:all!important}.user-select-auto{-webkit-user-select:auto!important;-moz-user-select:auto!important;user-select:auto!important}.user-select-none{-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important}.pe-none{pointer-events:none!important}.pe-auto{pointer-events:auto!important}.rounded{border-radius:var(--bs-border-radius)!important}.rounded-0{border-radius:0!important}.rounded-1{border-radius:var(--bs-border-radius-sm)!important}.rounded-2{border-radius:var(--bs-border-radius)!important}.rounded-3{border-radius:var(--bs-border-radius-lg)!important}.rounded-4{border-radius:var(--bs-border-radius-xl)!important}.rounded-5{border-radius:var(--bs-border-radius-xxl)!important}.rounded-circle{border-radius:50%!important}.rounded-pill{border-radius:var(--bs-border-radius-pill)!important}.rounded-top{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-0{border-top-left-radius:0!important;border-top-right-radius:0!important}.rounded-top-1{border-top-left-radius:var(--bs-border-radius-sm)!important;border-top-right-radius:var(--bs-border-radius-sm)!important}.rounded-top-2{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-3{border-top-left-radius:var(--bs-border-radius-lg)!important;border-top-right-radius:var(--bs-border-radius-lg)!important}.rounded-top-4{border-top-left-radius:var(--bs-border-radius-xl)!important;border-top-right-radius:var(--bs-border-radius-xl)!important}.rounded-top-5{border-top-left-radius:var(--bs-border-radius-xxl)!important;border-top-right-radius:var(--bs-border-radius-xxl)!important}.rounded-top-circle{border-top-left-radius:50%!important;border-top-right-radius:50%!important}.rounded-top-pill{border-top-left-radius:var(--bs-border-radius-pill)!important;border-top-right-radius:var(--bs-border-radius-pill)!important}.rounded-end{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-0{border-top-right-radius:0!important;border-bottom-right-radius:0!important}.rounded-end-1{border-top-right-radius:var(--bs-border-radius-sm)!important;border-bottom-right-radius:var(--bs-border-radius-sm)!important}.rounded-end-2{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-3{border-top-right-radius:var(--bs-border-radius-lg)!important;border-bottom-right-radius:var(--bs-border-radius-lg)!important}.rounded-end-4{border-top-right-radius:var(--bs-border-radius-xl)!important;border-bottom-right-radius:var(--bs-border-radius-xl)!important}.rounded-end-5{border-top-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-right-radius:var(--bs-border-radius-xxl)!important}.rounded-end-circle{border-top-right-radius:50%!important;border-bottom-right-radius:50%!important}.rounded-end-pill{border-top-right-radius:var(--bs-border-radius-pill)!important;border-bottom-right-radius:var(--bs-border-radius-pill)!important}.rounded-bottom{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-0{border-bottom-right-radius:0!important;border-bottom-left-radius:0!important}.rounded-bottom-1{border-bottom-right-radius:var(--bs-border-radius-sm)!important;border-bottom-left-radius:var(--bs-border-radius-sm)!important}.rounded-bottom-2{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-3{border-bottom-right-radius:var(--bs-border-radius-lg)!important;border-bottom-left-radius:var(--bs-border-radius-lg)!important}.rounded-bottom-4{border-bottom-right-radius:var(--bs-border-radius-xl)!important;border-bottom-left-radius:var(--bs-border-radius-xl)!important}.rounded-bottom-5{border-bottom-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-left-radius:var(--bs-border-radius-xxl)!important}.rounded-bottom-circle{border-bottom-right-radius:50%!important;border-bottom-left-radius:50%!important}.rounded-bottom-pill{border-bottom-right-radius:var(--bs-border-radius-pill)!important;border-bottom-left-radius:var(--bs-border-radius-pill)!important}.rounded-start{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-0{border-bottom-left-radius:0!important;border-top-left-radius:0!important}.rounded-start-1{border-bottom-left-radius:var(--bs-border-radius-sm)!important;border-top-left-radius:var(--bs-border-radius-sm)!important}.rounded-start-2{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-3{border-bottom-left-radius:var(--bs-border-radius-lg)!important;border-top-left-radius:var(--bs-border-radius-lg)!important}.rounded-start-4{border-bottom-left-radius:var(--bs-border-radius-xl)!important;border-top-left-radius:var(--bs-border-radius-xl)!important}.rounded-start-5{border-bottom-left-radius:var(--bs-border-radius-xxl)!important;border-top-left-radius:var(--bs-border-radius-xxl)!important}.rounded-start-circle{border-bottom-left-radius:50%!important;border-top-left-radius:50%!important}.rounded-start-pill{border-bottom-left-radius:var(--bs-border-radius-pill)!important;border-top-left-radius:var(--bs-border-radius-pill)!important}.visible{visibility:visible!important}.invisible{visibility:hidden!important}.z-n1{z-index:-1!important}.z-0{z-index:0!important}.z-1{z-index:1!important}.z-2{z-index:2!important}.z-3{z-index:3!important}@media (min-width:576px){.float-sm-start{float:left!important}.float-sm-end{float:right!important}.float-sm-none{float:none!important}.object-fit-sm-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-sm-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-sm-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-sm-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-sm-none{-o-object-fit:none!important;object-fit:none!important}.d-sm-inline{display:inline!important}.d-sm-inline-block{display:inline-block!important}.d-sm-block{display:block!important}.d-sm-grid{display:grid!important}.d-sm-inline-grid{display:inline-grid!important}.d-sm-table{display:table!important}.d-sm-table-row{display:table-row!important}.d-sm-table-cell{display:table-cell!important}.d-sm-flex{display:flex!important}.d-sm-inline-flex{display:inline-flex!important}.d-sm-none{display:none!important}.flex-sm-fill{flex:1 1 auto!important}.flex-sm-row{flex-direction:row!important}.flex-sm-column{flex-direction:column!important}.flex-sm-row-reverse{flex-direction:row-reverse!important}.flex-sm-column-reverse{flex-direction:column-reverse!important}.flex-sm-grow-0{flex-grow:0!important}.flex-sm-grow-1{flex-grow:1!important}.flex-sm-shrink-0{flex-shrink:0!important}.flex-sm-shrink-1{flex-shrink:1!important}.flex-sm-wrap{flex-wrap:wrap!important}.flex-sm-nowrap{flex-wrap:nowrap!important}.flex-sm-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-sm-start{justify-content:flex-start!important}.justify-content-sm-end{justify-content:flex-end!important}.justify-content-sm-center{justify-content:center!important}.justify-content-sm-between{justify-content:space-between!important}.justify-content-sm-around{justify-content:space-around!important}.justify-content-sm-evenly{justify-content:space-evenly!important}.align-items-sm-start{align-items:flex-start!important}.align-items-sm-end{align-items:flex-end!important}.align-items-sm-center{align-items:center!important}.align-items-sm-baseline{align-items:baseline!important}.align-items-sm-stretch{align-items:stretch!important}.align-content-sm-start{align-content:flex-start!important}.align-content-sm-end{align-content:flex-end!important}.align-content-sm-center{align-content:center!important}.align-content-sm-between{align-content:space-between!important}.align-content-sm-around{align-content:space-around!important}.align-content-sm-stretch{align-content:stretch!important}.align-self-sm-auto{align-self:auto!important}.align-self-sm-start{align-self:flex-start!important}.align-self-sm-end{align-self:flex-end!important}.align-self-sm-center{align-self:center!important}.align-self-sm-baseline{align-self:baseline!important}.align-self-sm-stretch{align-self:stretch!important}.order-sm-first{order:-1!important}.order-sm-0{order:0!important}.order-sm-1{order:1!important}.order-sm-2{order:2!important}.order-sm-3{order:3!important}.order-sm-4{order:4!important}.order-sm-5{order:5!important}.order-sm-last{order:6!important}.m-sm-0{margin:0!important}.m-sm-1{margin:.25rem!important}.m-sm-2{margin:.5rem!important}.m-sm-3{margin:1rem!important}.m-sm-4{margin:1.5rem!important}.m-sm-5{margin:3rem!important}.m-sm-auto{margin:auto!important}.mx-sm-0{margin-right:0!important;margin-left:0!important}.mx-sm-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-sm-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-sm-3{margin-right:1rem!important;margin-left:1rem!important}.mx-sm-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-sm-5{margin-right:3rem!important;margin-left:3rem!important}.mx-sm-auto{margin-right:auto!important;margin-left:auto!important}.my-sm-0{margin-top:0!important;margin-bottom:0!important}.my-sm-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-sm-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-sm-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-sm-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-sm-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-sm-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-sm-0{margin-top:0!important}.mt-sm-1{margin-top:.25rem!important}.mt-sm-2{margin-top:.5rem!important}.mt-sm-3{margin-top:1rem!important}.mt-sm-4{margin-top:1.5rem!important}.mt-sm-5{margin-top:3rem!important}.mt-sm-auto{margin-top:auto!important}.me-sm-0{margin-right:0!important}.me-sm-1{margin-right:.25rem!important}.me-sm-2{margin-right:.5rem!important}.me-sm-3{margin-right:1rem!important}.me-sm-4{margin-right:1.5rem!important}.me-sm-5{margin-right:3rem!important}.me-sm-auto{margin-right:auto!important}.mb-sm-0{margin-bottom:0!important}.mb-sm-1{margin-bottom:.25rem!important}.mb-sm-2{margin-bottom:.5rem!important}.mb-sm-3{margin-bottom:1rem!important}.mb-sm-4{margin-bottom:1.5rem!important}.mb-sm-5{margin-bottom:3rem!important}.mb-sm-auto{margin-bottom:auto!important}.ms-sm-0{margin-left:0!important}.ms-sm-1{margin-left:.25rem!important}.ms-sm-2{margin-left:.5rem!important}.ms-sm-3{margin-left:1rem!important}.ms-sm-4{margin-left:1.5rem!important}.ms-sm-5{margin-left:3rem!important}.ms-sm-auto{margin-left:auto!important}.p-sm-0{padding:0!important}.p-sm-1{padding:.25rem!important}.p-sm-2{padding:.5rem!important}.p-sm-3{padding:1rem!important}.p-sm-4{padding:1.5rem!important}.p-sm-5{padding:3rem!important}.px-sm-0{padding-right:0!important;padding-left:0!important}.px-sm-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-sm-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-sm-3{padding-right:1rem!important;padding-left:1rem!important}.px-sm-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-sm-5{padding-right:3rem!important;padding-left:3rem!important}.py-sm-0{padding-top:0!important;padding-bottom:0!important}.py-sm-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-sm-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-sm-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-sm-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-sm-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-sm-0{padding-top:0!important}.pt-sm-1{padding-top:.25rem!important}.pt-sm-2{padding-top:.5rem!important}.pt-sm-3{padding-top:1rem!important}.pt-sm-4{padding-top:1.5rem!important}.pt-sm-5{padding-top:3rem!important}.pe-sm-0{padding-right:0!important}.pe-sm-1{padding-right:.25rem!important}.pe-sm-2{padding-right:.5rem!important}.pe-sm-3{padding-right:1rem!important}.pe-sm-4{padding-right:1.5rem!important}.pe-sm-5{padding-right:3rem!important}.pb-sm-0{padding-bottom:0!important}.pb-sm-1{padding-bottom:.25rem!important}.pb-sm-2{padding-bottom:.5rem!important}.pb-sm-3{padding-bottom:1rem!important}.pb-sm-4{padding-bottom:1.5rem!important}.pb-sm-5{padding-bottom:3rem!important}.ps-sm-0{padding-left:0!important}.ps-sm-1{padding-left:.25rem!important}.ps-sm-2{padding-left:.5rem!important}.ps-sm-3{padding-left:1rem!important}.ps-sm-4{padding-left:1.5rem!important}.ps-sm-5{padding-left:3rem!important}.gap-sm-0{gap:0!important}.gap-sm-1{gap:.25rem!important}.gap-sm-2{gap:.5rem!important}.gap-sm-3{gap:1rem!important}.gap-sm-4{gap:1.5rem!important}.gap-sm-5{gap:3rem!important}.row-gap-sm-0{row-gap:0!important}.row-gap-sm-1{row-gap:.25rem!important}.row-gap-sm-2{row-gap:.5rem!important}.row-gap-sm-3{row-gap:1rem!important}.row-gap-sm-4{row-gap:1.5rem!important}.row-gap-sm-5{row-gap:3rem!important}.column-gap-sm-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-sm-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-sm-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-sm-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-sm-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-sm-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-sm-start{text-align:left!important}.text-sm-end{text-align:right!important}.text-sm-center{text-align:center!important}}@media (min-width:768px){.float-md-start{float:left!important}.float-md-end{float:right!important}.float-md-none{float:none!important}.object-fit-md-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-md-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-md-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-md-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-md-none{-o-object-fit:none!important;object-fit:none!important}.d-md-inline{display:inline!important}.d-md-inline-block{display:inline-block!important}.d-md-block{display:block!important}.d-md-grid{display:grid!important}.d-md-inline-grid{display:inline-grid!important}.d-md-table{display:table!important}.d-md-table-row{display:table-row!important}.d-md-table-cell{display:table-cell!important}.d-md-flex{display:flex!important}.d-md-inline-flex{display:inline-flex!important}.d-md-none{display:none!important}.flex-md-fill{flex:1 1 auto!important}.flex-md-row{flex-direction:row!important}.flex-md-column{flex-direction:column!important}.flex-md-row-reverse{flex-direction:row-reverse!important}.flex-md-column-reverse{flex-direction:column-reverse!important}.flex-md-grow-0{flex-grow:0!important}.flex-md-grow-1{flex-grow:1!important}.flex-md-shrink-0{flex-shrink:0!important}.flex-md-shrink-1{flex-shrink:1!important}.flex-md-wrap{flex-wrap:wrap!important}.flex-md-nowrap{flex-wrap:nowrap!important}.flex-md-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-md-start{justify-content:flex-start!important}.justify-content-md-end{justify-content:flex-end!important}.justify-content-md-center{justify-content:center!important}.justify-content-md-between{justify-content:space-between!important}.justify-content-md-around{justify-content:space-around!important}.justify-content-md-evenly{justify-content:space-evenly!important}.align-items-md-start{align-items:flex-start!important}.align-items-md-end{align-items:flex-end!important}.align-items-md-center{align-items:center!important}.align-items-md-baseline{align-items:baseline!important}.align-items-md-stretch{align-items:stretch!important}.align-content-md-start{align-content:flex-start!important}.align-content-md-end{align-content:flex-end!important}.align-content-md-center{align-content:center!important}.align-content-md-between{align-content:space-between!important}.align-content-md-around{align-content:space-around!important}.align-content-md-stretch{align-content:stretch!important}.align-self-md-auto{align-self:auto!important}.align-self-md-start{align-self:flex-start!important}.align-self-md-end{align-self:flex-end!important}.align-self-md-center{align-self:center!important}.align-self-md-baseline{align-self:baseline!important}.align-self-md-stretch{align-self:stretch!important}.order-md-first{order:-1!important}.order-md-0{order:0!important}.order-md-1{order:1!important}.order-md-2{order:2!important}.order-md-3{order:3!important}.order-md-4{order:4!important}.order-md-5{order:5!important}.order-md-last{order:6!important}.m-md-0{margin:0!important}.m-md-1{margin:.25rem!important}.m-md-2{margin:.5rem!important}.m-md-3{margin:1rem!important}.m-md-4{margin:1.5rem!important}.m-md-5{margin:3rem!important}.m-md-auto{margin:auto!important}.mx-md-0{margin-right:0!important;margin-left:0!important}.mx-md-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-md-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-md-3{margin-right:1rem!important;margin-left:1rem!important}.mx-md-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-md-5{margin-right:3rem!important;margin-left:3rem!important}.mx-md-auto{margin-right:auto!important;margin-left:auto!important}.my-md-0{margin-top:0!important;margin-bottom:0!important}.my-md-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-md-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-md-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-md-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-md-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-md-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-md-0{margin-top:0!important}.mt-md-1{margin-top:.25rem!important}.mt-md-2{margin-top:.5rem!important}.mt-md-3{margin-top:1rem!important}.mt-md-4{margin-top:1.5rem!important}.mt-md-5{margin-top:3rem!important}.mt-md-auto{margin-top:auto!important}.me-md-0{margin-right:0!important}.me-md-1{margin-right:.25rem!important}.me-md-2{margin-right:.5rem!important}.me-md-3{margin-right:1rem!important}.me-md-4{margin-right:1.5rem!important}.me-md-5{margin-right:3rem!important}.me-md-auto{margin-right:auto!important}.mb-md-0{margin-bottom:0!important}.mb-md-1{margin-bottom:.25rem!important}.mb-md-2{margin-bottom:.5rem!important}.mb-md-3{margin-bottom:1rem!important}.mb-md-4{margin-bottom:1.5rem!important}.mb-md-5{margin-bottom:3rem!important}.mb-md-auto{margin-bottom:auto!important}.ms-md-0{margin-left:0!important}.ms-md-1{margin-left:.25rem!important}.ms-md-2{margin-left:.5rem!important}.ms-md-3{margin-left:1rem!important}.ms-md-4{margin-left:1.5rem!important}.ms-md-5{margin-left:3rem!important}.ms-md-auto{margin-left:auto!important}.p-md-0{padding:0!important}.p-md-1{padding:.25rem!important}.p-md-2{padding:.5rem!important}.p-md-3{padding:1rem!important}.p-md-4{padding:1.5rem!important}.p-md-5{padding:3rem!important}.px-md-0{padding-right:0!important;padding-left:0!important}.px-md-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-md-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-md-3{padding-right:1rem!important;padding-left:1rem!important}.px-md-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-md-5{padding-right:3rem!important;padding-left:3rem!important}.py-md-0{padding-top:0!important;padding-bottom:0!important}.py-md-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-md-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-md-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-md-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-md-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-md-0{padding-top:0!important}.pt-md-1{padding-top:.25rem!important}.pt-md-2{padding-top:.5rem!important}.pt-md-3{padding-top:1rem!important}.pt-md-4{padding-top:1.5rem!important}.pt-md-5{padding-top:3rem!important}.pe-md-0{padding-right:0!important}.pe-md-1{padding-right:.25rem!important}.pe-md-2{padding-right:.5rem!important}.pe-md-3{padding-right:1rem!important}.pe-md-4{padding-right:1.5rem!important}.pe-md-5{padding-right:3rem!important}.pb-md-0{padding-bottom:0!important}.pb-md-1{padding-bottom:.25rem!important}.pb-md-2{padding-bottom:.5rem!important}.pb-md-3{padding-bottom:1rem!important}.pb-md-4{padding-bottom:1.5rem!important}.pb-md-5{padding-bottom:3rem!important}.ps-md-0{padding-left:0!important}.ps-md-1{padding-left:.25rem!important}.ps-md-2{padding-left:.5rem!important}.ps-md-3{padding-left:1rem!important}.ps-md-4{padding-left:1.5rem!important}.ps-md-5{padding-left:3rem!important}.gap-md-0{gap:0!important}.gap-md-1{gap:.25rem!important}.gap-md-2{gap:.5rem!important}.gap-md-3{gap:1rem!important}.gap-md-4{gap:1.5rem!important}.gap-md-5{gap:3rem!important}.row-gap-md-0{row-gap:0!important}.row-gap-md-1{row-gap:.25rem!important}.row-gap-md-2{row-gap:.5rem!important}.row-gap-md-3{row-gap:1rem!important}.row-gap-md-4{row-gap:1.5rem!important}.row-gap-md-5{row-gap:3rem!important}.column-gap-md-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-md-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-md-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-md-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-md-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-md-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-md-start{text-align:left!important}.text-md-end{text-align:right!important}.text-md-center{text-align:center!important}}@media (min-width:992px){.float-lg-start{float:left!important}.float-lg-end{float:right!important}.float-lg-none{float:none!important}.object-fit-lg-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-lg-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-lg-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-lg-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-lg-none{-o-object-fit:none!important;object-fit:none!important}.d-lg-inline{display:inline!important}.d-lg-inline-block{display:inline-block!important}.d-lg-block{display:block!important}.d-lg-grid{display:grid!important}.d-lg-inline-grid{display:inline-grid!important}.d-lg-table{display:table!important}.d-lg-table-row{display:table-row!important}.d-lg-table-cell{display:table-cell!important}.d-lg-flex{display:flex!important}.d-lg-inline-flex{display:inline-flex!important}.d-lg-none{display:none!important}.flex-lg-fill{flex:1 1 auto!important}.flex-lg-row{flex-direction:row!important}.flex-lg-column{flex-direction:column!important}.flex-lg-row-reverse{flex-direction:row-reverse!important}.flex-lg-column-reverse{flex-direction:column-reverse!important}.flex-lg-grow-0{flex-grow:0!important}.flex-lg-grow-1{flex-grow:1!important}.flex-lg-shrink-0{flex-shrink:0!important}.flex-lg-shrink-1{flex-shrink:1!important}.flex-lg-wrap{flex-wrap:wrap!important}.flex-lg-nowrap{flex-wrap:nowrap!important}.flex-lg-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-lg-start{justify-content:flex-start!important}.justify-content-lg-end{justify-content:flex-end!important}.justify-content-lg-center{justify-content:center!important}.justify-content-lg-between{justify-content:space-between!important}.justify-content-lg-around{justify-content:space-around!important}.justify-content-lg-evenly{justify-content:space-evenly!important}.align-items-lg-start{align-items:flex-start!important}.align-items-lg-end{align-items:flex-end!important}.align-items-lg-center{align-items:center!important}.align-items-lg-baseline{align-items:baseline!important}.align-items-lg-stretch{align-items:stretch!important}.align-content-lg-start{align-content:flex-start!important}.align-content-lg-end{align-content:flex-end!important}.align-content-lg-center{align-content:center!important}.align-content-lg-between{align-content:space-between!important}.align-content-lg-around{align-content:space-around!important}.align-content-lg-stretch{align-content:stretch!important}.align-self-lg-auto{align-self:auto!important}.align-self-lg-start{align-self:flex-start!important}.align-self-lg-end{align-self:flex-end!important}.align-self-lg-center{align-self:center!important}.align-self-lg-baseline{align-self:baseline!important}.align-self-lg-stretch{align-self:stretch!important}.order-lg-first{order:-1!important}.order-lg-0{order:0!important}.order-lg-1{order:1!important}.order-lg-2{order:2!important}.order-lg-3{order:3!important}.order-lg-4{order:4!important}.order-lg-5{order:5!important}.order-lg-last{order:6!important}.m-lg-0{margin:0!important}.m-lg-1{margin:.25rem!important}.m-lg-2{margin:.5rem!important}.m-lg-3{margin:1rem!important}.m-lg-4{margin:1.5rem!important}.m-lg-5{margin:3rem!important}.m-lg-auto{margin:auto!important}.mx-lg-0{margin-right:0!important;margin-left:0!important}.mx-lg-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-lg-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-lg-3{margin-right:1rem!important;margin-left:1rem!important}.mx-lg-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-lg-5{margin-right:3rem!important;margin-left:3rem!important}.mx-lg-auto{margin-right:auto!important;margin-left:auto!important}.my-lg-0{margin-top:0!important;margin-bottom:0!important}.my-lg-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-lg-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-lg-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-lg-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-lg-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-lg-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-lg-0{margin-top:0!important}.mt-lg-1{margin-top:.25rem!important}.mt-lg-2{margin-top:.5rem!important}.mt-lg-3{margin-top:1rem!important}.mt-lg-4{margin-top:1.5rem!important}.mt-lg-5{margin-top:3rem!important}.mt-lg-auto{margin-top:auto!important}.me-lg-0{margin-right:0!important}.me-lg-1{margin-right:.25rem!important}.me-lg-2{margin-right:.5rem!important}.me-lg-3{margin-right:1rem!important}.me-lg-4{margin-right:1.5rem!important}.me-lg-5{margin-right:3rem!important}.me-lg-auto{margin-right:auto!important}.mb-lg-0{margin-bottom:0!important}.mb-lg-1{margin-bottom:.25rem!important}.mb-lg-2{margin-bottom:.5rem!important}.mb-lg-3{margin-bottom:1rem!important}.mb-lg-4{margin-bottom:1.5rem!important}.mb-lg-5{margin-bottom:3rem!important}.mb-lg-auto{margin-bottom:auto!important}.ms-lg-0{margin-left:0!important}.ms-lg-1{margin-left:.25rem!important}.ms-lg-2{margin-left:.5rem!important}.ms-lg-3{margin-left:1rem!important}.ms-lg-4{margin-left:1.5rem!important}.ms-lg-5{margin-left:3rem!important}.ms-lg-auto{margin-left:auto!important}.p-lg-0{padding:0!important}.p-lg-1{padding:.25rem!important}.p-lg-2{padding:.5rem!important}.p-lg-3{padding:1rem!important}.p-lg-4{padding:1.5rem!important}.p-lg-5{padding:3rem!important}.px-lg-0{padding-right:0!important;padding-left:0!important}.px-lg-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-lg-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-lg-3{padding-right:1rem!important;padding-left:1rem!important}.px-lg-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-lg-5{padding-right:3rem!important;padding-left:3rem!important}.py-lg-0{padding-top:0!important;padding-bottom:0!important}.py-lg-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-lg-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-lg-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-lg-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-lg-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-lg-0{padding-top:0!important}.pt-lg-1{padding-top:.25rem!important}.pt-lg-2{padding-top:.5rem!important}.pt-lg-3{padding-top:1rem!important}.pt-lg-4{padding-top:1.5rem!important}.pt-lg-5{padding-top:3rem!important}.pe-lg-0{padding-right:0!important}.pe-lg-1{padding-right:.25rem!important}.pe-lg-2{padding-right:.5rem!important}.pe-lg-3{padding-right:1rem!important}.pe-lg-4{padding-right:1.5rem!important}.pe-lg-5{padding-right:3rem!important}.pb-lg-0{padding-bottom:0!important}.pb-lg-1{padding-bottom:.25rem!important}.pb-lg-2{padding-bottom:.5rem!important}.pb-lg-3{padding-bottom:1rem!important}.pb-lg-4{padding-bottom:1.5rem!important}.pb-lg-5{padding-bottom:3rem!important}.ps-lg-0{padding-left:0!important}.ps-lg-1{padding-left:.25rem!important}.ps-lg-2{padding-left:.5rem!important}.ps-lg-3{padding-left:1rem!important}.ps-lg-4{padding-left:1.5rem!important}.ps-lg-5{padding-left:3rem!important}.gap-lg-0{gap:0!important}.gap-lg-1{gap:.25rem!important}.gap-lg-2{gap:.5rem!important}.gap-lg-3{gap:1rem!important}.gap-lg-4{gap:1.5rem!important}.gap-lg-5{gap:3rem!important}.row-gap-lg-0{row-gap:0!important}.row-gap-lg-1{row-gap:.25rem!important}.row-gap-lg-2{row-gap:.5rem!important}.row-gap-lg-3{row-gap:1rem!important}.row-gap-lg-4{row-gap:1.5rem!important}.row-gap-lg-5{row-gap:3rem!important}.column-gap-lg-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-lg-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-lg-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-lg-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-lg-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-lg-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-lg-start{text-align:left!important}.text-lg-end{text-align:right!important}.text-lg-center{text-align:center!important}}@media (min-width:1200px){.float-xl-start{float:left!important}.float-xl-end{float:right!important}.float-xl-none{float:none!important}.object-fit-xl-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-xl-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-xl-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-xl-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-xl-none{-o-object-fit:none!important;object-fit:none!important}.d-xl-inline{display:inline!important}.d-xl-inline-block{display:inline-block!important}.d-xl-block{display:block!important}.d-xl-grid{display:grid!important}.d-xl-inline-grid{display:inline-grid!important}.d-xl-table{display:table!important}.d-xl-table-row{display:table-row!important}.d-xl-table-cell{display:table-cell!important}.d-xl-flex{display:flex!important}.d-xl-inline-flex{display:inline-flex!important}.d-xl-none{display:none!important}.flex-xl-fill{flex:1 1 auto!important}.flex-xl-row{flex-direction:row!important}.flex-xl-column{flex-direction:column!important}.flex-xl-row-reverse{flex-direction:row-reverse!important}.flex-xl-column-reverse{flex-direction:column-reverse!important}.flex-xl-grow-0{flex-grow:0!important}.flex-xl-grow-1{flex-grow:1!important}.flex-xl-shrink-0{flex-shrink:0!important}.flex-xl-shrink-1{flex-shrink:1!important}.flex-xl-wrap{flex-wrap:wrap!important}.flex-xl-nowrap{flex-wrap:nowrap!important}.flex-xl-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xl-start{justify-content:flex-start!important}.justify-content-xl-end{justify-content:flex-end!important}.justify-content-xl-center{justify-content:center!important}.justify-content-xl-between{justify-content:space-between!important}.justify-content-xl-around{justify-content:space-around!important}.justify-content-xl-evenly{justify-content:space-evenly!important}.align-items-xl-start{align-items:flex-start!important}.align-items-xl-end{align-items:flex-end!important}.align-items-xl-center{align-items:center!important}.align-items-xl-baseline{align-items:baseline!important}.align-items-xl-stretch{align-items:stretch!important}.align-content-xl-start{align-content:flex-start!important}.align-content-xl-end{align-content:flex-end!important}.align-content-xl-center{align-content:center!important}.align-content-xl-between{align-content:space-between!important}.align-content-xl-around{align-content:space-around!important}.align-content-xl-stretch{align-content:stretch!important}.align-self-xl-auto{align-self:auto!important}.align-self-xl-start{align-self:flex-start!important}.align-self-xl-end{align-self:flex-end!important}.align-self-xl-center{align-self:center!important}.align-self-xl-baseline{align-self:baseline!important}.align-self-xl-stretch{align-self:stretch!important}.order-xl-first{order:-1!important}.order-xl-0{order:0!important}.order-xl-1{order:1!important}.order-xl-2{order:2!important}.order-xl-3{order:3!important}.order-xl-4{order:4!important}.order-xl-5{order:5!important}.order-xl-last{order:6!important}.m-xl-0{margin:0!important}.m-xl-1{margin:.25rem!important}.m-xl-2{margin:.5rem!important}.m-xl-3{margin:1rem!important}.m-xl-4{margin:1.5rem!important}.m-xl-5{margin:3rem!important}.m-xl-auto{margin:auto!important}.mx-xl-0{margin-right:0!important;margin-left:0!important}.mx-xl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xl-auto{margin-right:auto!important;margin-left:auto!important}.my-xl-0{margin-top:0!important;margin-bottom:0!important}.my-xl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xl-0{margin-top:0!important}.mt-xl-1{margin-top:.25rem!important}.mt-xl-2{margin-top:.5rem!important}.mt-xl-3{margin-top:1rem!important}.mt-xl-4{margin-top:1.5rem!important}.mt-xl-5{margin-top:3rem!important}.mt-xl-auto{margin-top:auto!important}.me-xl-0{margin-right:0!important}.me-xl-1{margin-right:.25rem!important}.me-xl-2{margin-right:.5rem!important}.me-xl-3{margin-right:1rem!important}.me-xl-4{margin-right:1.5rem!important}.me-xl-5{margin-right:3rem!important}.me-xl-auto{margin-right:auto!important}.mb-xl-0{margin-bottom:0!important}.mb-xl-1{margin-bottom:.25rem!important}.mb-xl-2{margin-bottom:.5rem!important}.mb-xl-3{margin-bottom:1rem!important}.mb-xl-4{margin-bottom:1.5rem!important}.mb-xl-5{margin-bottom:3rem!important}.mb-xl-auto{margin-bottom:auto!important}.ms-xl-0{margin-left:0!important}.ms-xl-1{margin-left:.25rem!important}.ms-xl-2{margin-left:.5rem!important}.ms-xl-3{margin-left:1rem!important}.ms-xl-4{margin-left:1.5rem!important}.ms-xl-5{margin-left:3rem!important}.ms-xl-auto{margin-left:auto!important}.p-xl-0{padding:0!important}.p-xl-1{padding:.25rem!important}.p-xl-2{padding:.5rem!important}.p-xl-3{padding:1rem!important}.p-xl-4{padding:1.5rem!important}.p-xl-5{padding:3rem!important}.px-xl-0{padding-right:0!important;padding-left:0!important}.px-xl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xl-0{padding-top:0!important;padding-bottom:0!important}.py-xl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xl-0{padding-top:0!important}.pt-xl-1{padding-top:.25rem!important}.pt-xl-2{padding-top:.5rem!important}.pt-xl-3{padding-top:1rem!important}.pt-xl-4{padding-top:1.5rem!important}.pt-xl-5{padding-top:3rem!important}.pe-xl-0{padding-right:0!important}.pe-xl-1{padding-right:.25rem!important}.pe-xl-2{padding-right:.5rem!important}.pe-xl-3{padding-right:1rem!important}.pe-xl-4{padding-right:1.5rem!important}.pe-xl-5{padding-right:3rem!important}.pb-xl-0{padding-bottom:0!important}.pb-xl-1{padding-bottom:.25rem!important}.pb-xl-2{padding-bottom:.5rem!important}.pb-xl-3{padding-bottom:1rem!important}.pb-xl-4{padding-bottom:1.5rem!important}.pb-xl-5{padding-bottom:3rem!important}.ps-xl-0{padding-left:0!important}.ps-xl-1{padding-left:.25rem!important}.ps-xl-2{padding-left:.5rem!important}.ps-xl-3{padding-left:1rem!important}.ps-xl-4{padding-left:1.5rem!important}.ps-xl-5{padding-left:3rem!important}.gap-xl-0{gap:0!important}.gap-xl-1{gap:.25rem!important}.gap-xl-2{gap:.5rem!important}.gap-xl-3{gap:1rem!important}.gap-xl-4{gap:1.5rem!important}.gap-xl-5{gap:3rem!important}.row-gap-xl-0{row-gap:0!important}.row-gap-xl-1{row-gap:.25rem!important}.row-gap-xl-2{row-gap:.5rem!important}.row-gap-xl-3{row-gap:1rem!important}.row-gap-xl-4{row-gap:1.5rem!important}.row-gap-xl-5{row-gap:3rem!important}.column-gap-xl-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-xl-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-xl-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-xl-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-xl-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-xl-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-xl-start{text-align:left!important}.text-xl-end{text-align:right!important}.text-xl-center{text-align:center!important}}@media (min-width:1400px){.float-xxl-start{float:left!important}.float-xxl-end{float:right!important}.float-xxl-none{float:none!important}.object-fit-xxl-contain{-o-object-fit:contain!important;object-fit:contain!important}.object-fit-xxl-cover{-o-object-fit:cover!important;object-fit:cover!important}.object-fit-xxl-fill{-o-object-fit:fill!important;object-fit:fill!important}.object-fit-xxl-scale{-o-object-fit:scale-down!important;object-fit:scale-down!important}.object-fit-xxl-none{-o-object-fit:none!important;object-fit:none!important}.d-xxl-inline{display:inline!important}.d-xxl-inline-block{display:inline-block!important}.d-xxl-block{display:block!important}.d-xxl-grid{display:grid!important}.d-xxl-inline-grid{display:inline-grid!important}.d-xxl-table{display:table!important}.d-xxl-table-row{display:table-row!important}.d-xxl-table-cell{display:table-cell!important}.d-xxl-flex{display:flex!important}.d-xxl-inline-flex{display:inline-flex!important}.d-xxl-none{display:none!important}.flex-xxl-fill{flex:1 1 auto!important}.flex-xxl-row{flex-direction:row!important}.flex-xxl-column{flex-direction:column!important}.flex-xxl-row-reverse{flex-direction:row-reverse!important}.flex-xxl-column-reverse{flex-direction:column-reverse!important}.flex-xxl-grow-0{flex-grow:0!important}.flex-xxl-grow-1{flex-grow:1!important}.flex-xxl-shrink-0{flex-shrink:0!important}.flex-xxl-shrink-1{flex-shrink:1!important}.flex-xxl-wrap{flex-wrap:wrap!important}.flex-xxl-nowrap{flex-wrap:nowrap!important}.flex-xxl-wrap-reverse{flex-wrap:wrap-reverse!important}.justify-content-xxl-start{justify-content:flex-start!important}.justify-content-xxl-end{justify-content:flex-end!important}.justify-content-xxl-center{justify-content:center!important}.justify-content-xxl-between{justify-content:space-between!important}.justify-content-xxl-around{justify-content:space-around!important}.justify-content-xxl-evenly{justify-content:space-evenly!important}.align-items-xxl-start{align-items:flex-start!important}.align-items-xxl-end{align-items:flex-end!important}.align-items-xxl-center{align-items:center!important}.align-items-xxl-baseline{align-items:baseline!important}.align-items-xxl-stretch{align-items:stretch!important}.align-content-xxl-start{align-content:flex-start!important}.align-content-xxl-end{align-content:flex-end!important}.align-content-xxl-center{align-content:center!important}.align-content-xxl-between{align-content:space-between!important}.align-content-xxl-around{align-content:space-around!important}.align-content-xxl-stretch{align-content:stretch!important}.align-self-xxl-auto{align-self:auto!important}.align-self-xxl-start{align-self:flex-start!important}.align-self-xxl-end{align-self:flex-end!important}.align-self-xxl-center{align-self:center!important}.align-self-xxl-baseline{align-self:baseline!important}.align-self-xxl-stretch{align-self:stretch!important}.order-xxl-first{order:-1!important}.order-xxl-0{order:0!important}.order-xxl-1{order:1!important}.order-xxl-2{order:2!important}.order-xxl-3{order:3!important}.order-xxl-4{order:4!important}.order-xxl-5{order:5!important}.order-xxl-last{order:6!important}.m-xxl-0{margin:0!important}.m-xxl-1{margin:.25rem!important}.m-xxl-2{margin:.5rem!important}.m-xxl-3{margin:1rem!important}.m-xxl-4{margin:1.5rem!important}.m-xxl-5{margin:3rem!important}.m-xxl-auto{margin:auto!important}.mx-xxl-0{margin-right:0!important;margin-left:0!important}.mx-xxl-1{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xxl-2{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xxl-3{margin-right:1rem!important;margin-left:1rem!important}.mx-xxl-4{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xxl-5{margin-right:3rem!important;margin-left:3rem!important}.mx-xxl-auto{margin-right:auto!important;margin-left:auto!important}.my-xxl-0{margin-top:0!important;margin-bottom:0!important}.my-xxl-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xxl-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xxl-3{margin-top:1rem!important;margin-bottom:1rem!important}.my-xxl-4{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xxl-5{margin-top:3rem!important;margin-bottom:3rem!important}.my-xxl-auto{margin-top:auto!important;margin-bottom:auto!important}.mt-xxl-0{margin-top:0!important}.mt-xxl-1{margin-top:.25rem!important}.mt-xxl-2{margin-top:.5rem!important}.mt-xxl-3{margin-top:1rem!important}.mt-xxl-4{margin-top:1.5rem!important}.mt-xxl-5{margin-top:3rem!important}.mt-xxl-auto{margin-top:auto!important}.me-xxl-0{margin-right:0!important}.me-xxl-1{margin-right:.25rem!important}.me-xxl-2{margin-right:.5rem!important}.me-xxl-3{margin-right:1rem!important}.me-xxl-4{margin-right:1.5rem!important}.me-xxl-5{margin-right:3rem!important}.me-xxl-auto{margin-right:auto!important}.mb-xxl-0{margin-bottom:0!important}.mb-xxl-1{margin-bottom:.25rem!important}.mb-xxl-2{margin-bottom:.5rem!important}.mb-xxl-3{margin-bottom:1rem!important}.mb-xxl-4{margin-bottom:1.5rem!important}.mb-xxl-5{margin-bottom:3rem!important}.mb-xxl-auto{margin-bottom:auto!important}.ms-xxl-0{margin-left:0!important}.ms-xxl-1{margin-left:.25rem!important}.ms-xxl-2{margin-left:.5rem!important}.ms-xxl-3{margin-left:1rem!important}.ms-xxl-4{margin-left:1.5rem!important}.ms-xxl-5{margin-left:3rem!important}.ms-xxl-auto{margin-left:auto!important}.p-xxl-0{padding:0!important}.p-xxl-1{padding:.25rem!important}.p-xxl-2{padding:.5rem!important}.p-xxl-3{padding:1rem!important}.p-xxl-4{padding:1.5rem!important}.p-xxl-5{padding:3rem!important}.px-xxl-0{padding-right:0!important;padding-left:0!important}.px-xxl-1{padding-right:.25rem!important;padding-left:.25rem!important}.px-xxl-2{padding-right:.5rem!important;padding-left:.5rem!important}.px-xxl-3{padding-right:1rem!important;padding-left:1rem!important}.px-xxl-4{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xxl-5{padding-right:3rem!important;padding-left:3rem!important}.py-xxl-0{padding-top:0!important;padding-bottom:0!important}.py-xxl-1{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xxl-2{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xxl-3{padding-top:1rem!important;padding-bottom:1rem!important}.py-xxl-4{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xxl-5{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xxl-0{padding-top:0!important}.pt-xxl-1{padding-top:.25rem!important}.pt-xxl-2{padding-top:.5rem!important}.pt-xxl-3{padding-top:1rem!important}.pt-xxl-4{padding-top:1.5rem!important}.pt-xxl-5{padding-top:3rem!important}.pe-xxl-0{padding-right:0!important}.pe-xxl-1{padding-right:.25rem!important}.pe-xxl-2{padding-right:.5rem!important}.pe-xxl-3{padding-right:1rem!important}.pe-xxl-4{padding-right:1.5rem!important}.pe-xxl-5{padding-right:3rem!important}.pb-xxl-0{padding-bottom:0!important}.pb-xxl-1{padding-bottom:.25rem!important}.pb-xxl-2{padding-bottom:.5rem!important}.pb-xxl-3{padding-bottom:1rem!important}.pb-xxl-4{padding-bottom:1.5rem!important}.pb-xxl-5{padding-bottom:3rem!important}.ps-xxl-0{padding-left:0!important}.ps-xxl-1{padding-left:.25rem!important}.ps-xxl-2{padding-left:.5rem!important}.ps-xxl-3{padding-left:1rem!important}.ps-xxl-4{padding-left:1.5rem!important}.ps-xxl-5{padding-left:3rem!important}.gap-xxl-0{gap:0!important}.gap-xxl-1{gap:.25rem!important}.gap-xxl-2{gap:.5rem!important}.gap-xxl-3{gap:1rem!important}.gap-xxl-4{gap:1.5rem!important}.gap-xxl-5{gap:3rem!important}.row-gap-xxl-0{row-gap:0!important}.row-gap-xxl-1{row-gap:.25rem!important}.row-gap-xxl-2{row-gap:.5rem!important}.row-gap-xxl-3{row-gap:1rem!important}.row-gap-xxl-4{row-gap:1.5rem!important}.row-gap-xxl-5{row-gap:3rem!important}.column-gap-xxl-0{-moz-column-gap:0!important;column-gap:0!important}.column-gap-xxl-1{-moz-column-gap:0.25rem!important;column-gap:.25rem!important}.column-gap-xxl-2{-moz-column-gap:0.5rem!important;column-gap:.5rem!important}.column-gap-xxl-3{-moz-column-gap:1rem!important;column-gap:1rem!important}.column-gap-xxl-4{-moz-column-gap:1.5rem!important;column-gap:1.5rem!important}.column-gap-xxl-5{-moz-column-gap:3rem!important;column-gap:3rem!important}.text-xxl-start{text-align:left!important}.text-xxl-end{text-align:right!important}.text-xxl-center{text-align:center!important}}@media (min-width:1200px){.fs-1{font-size:2.5rem!important}.fs-2{font-size:2rem!important}.fs-3{font-size:1.75rem!important}.fs-4{font-size:1.5rem!important}}@media print{.d-print-inline{display:inline!important}.d-print-inline-block{display:inline-block!important}.d-print-block{display:block!important}.d-print-grid{display:grid!important}.d-print-inline-grid{display:inline-grid!important}.d-print-table{display:table!important}.d-print-table-row{display:table-row!important}.d-print-table-cell{display:table-cell!important}.d-print-flex{display:flex!important}.d-print-inline-flex{display:inline-flex!important}.d-print-none{display:none!important}}
/*# sourceMappingURL=bootstrap.min.css.map */
</file>

<file path="payisp/css/pgwmodal.min.css">
/**
 * PgwModal - Version 2.0
 *
 * Copyright 2014, Jonathan M. Piat
 * http://pgwjs.com - http://pagawa.com
 *
 * Released under the GNU GPLv3 license - http://opensource.org/licenses/gpl-3.0
 */
body.pgwModalOpen{overflow:hidden}#pgwModalBackdrop{width:100%;height:100%;position:fixed;top:0;left:0;z-index:9000}#pgwModal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9010;overflow-x:auto;overflow-y:scroll;text-align:center}#pgwModal .pm-container{margin:10px}#pgwModal .pm-body{display:inline-block;max-width:800px;min-width:300px;position:relative;width:100%;z-index:9020;margin-top:10px}.pgwModalBackdrop{background:#000;opacity:.6;filter:alpha(opacity=60)}.pgwModal .pm-body{background-color:#fff;border-radius:5px;-webkit-box-shadow:0 0 5px 5px #555;box-shadow:0 0 5px 5px #555}.pgwModal .pm-title{background:#e5e5e5;padding:5px 0 6px;border-bottom:1px solid #d5d5d5;border-radius:5px 5px 0 0;font-size:1rem;min-height:25px}.pgwModal .pm-content{background:#fff;padding:10px;border-radius:5px;text-align:left}.pgwModal .pm-close{cursor:pointer;position:absolute;top:9px;right:15px}.pgwModal .pm-close span.pm-icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwQAADsEBuJFr7QAAABp0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjUuMTFH80I3AAABIklEQVQ4T62T20oDQRBE+9EIGo1/H4gEQd8E74lJvKHiV+mmai7QNdu+ZFNwWKqmpzJhdq3rur0ShkMIwyGoMTsEl+AenDDw62WGmoAFOAcjWRdjdgX+Ck9gDPw6xbIN4MwvmEmHmFzCQRo+H0E6aRHL1sDP3EiHmLx5WQbrBv4Ic3+yuvYAxtIhJusUtKUf4LvJUhnQDm9SkNWe1MPsDhyD/v42SGEWT/oFfBl5BWFZ2huGWWfgB/gy8g7CVyrt7QVZLHsB//1lvoNhqZqstozPN/DZZPX2tUNMXFYvILr9dFLpEGO2KoNtWRVLezPSIcbsogyRWyC3WcTSZ8AZfnpT6RCDDx3MwTU4YuDXywzFUn6WU3Ag697sgzAcQhjuTmdbpLYNJt1Fr50AAAAASUVORK5CYII=);display:block;height:20px;width:20px}
</file>

<file path="payisp/css/styles.css">
#systopo {
	display: none;
}

.breadcrumb:not(:last-child) {
  margin-bottom: 0px;
}

a {
  text-decoration: none !important;
}

.sticky-bar {
  position: sticky;
  top: 50px;
  z-index: 2 !important;
}

.container {
  padding-right: 0 !important;
  padding-left: 0 !important;
  margin-right: auto;
  margin-left: auto;
}

.navbar {
  padding: 0 !important;
  flex-wrap: nowrap !important;
  align-items: normal;
}

.form-inputs {
  position: relative;
}

.form-inputs .form-control {
  height: 45px;
}

.form-inputs .form-control:focus {
  box-shadow: none;
  border: 1px solid #000;
}

.form-inputs i {
  position: absolute;
  right: 6px;
  top: 12px;
}

.shop-bag {
  background-color: #000000;
  color: #fff;
  height: 50px;
  width: 50px;
  font-size: 25px;
  display: flex;
  border-radius: 50%;
  align-items: center;
  justify-content: center;
}

.shop-bag a {
  color: #fff;
}

.qty {
  font-size: 12px;
}

.table thead th {
}

.table tbody td {
  vertical-align: middle;
}

.table tbody td a{
  color: #000;
}

.table tbody td i {
}

.table tbody td .img-container {
  width: 55px;
  height: 55px;
}

.table tbody td .img-container i {
  font-weight: 600;
  font-size: 2.2rem;
}

.table tbody td .on,
.table tbody td .off {
  color: #00ab66;
  border-radius: 50%;
}

.table tbody td .off {
  color: #ff0000;
}

.table tbody td .warning {
  background-color: #fcc200;
}

.table tbody tr {
  box-shadow: 0px 2px 3px #1f1f1f1a;
}

.table thead tr {
  border-bottom: 2px solid #E1F5FE;
}

.fw-600 {
  font-weight: 600 !important;
}

.fs-09 {
  font-size: 0.9rem !important;
  font-weight: 500 !important;;
}

.text-grey {
  color: #8b8888 !important;
}

.conn i {
  font-size: 0.9rem !important;
}

.card-counter{
	box-shadow: 2px 2px 10px #DADADA;
	margin: 5px;
	padding: 20px 10px;
	background-color: #fff;
	border-radius: 5px;
	transition: .3s linear all;
}
.card-counter:hover{
	box-shadow: 4px 4px 20px #DADADA;
	transition: .3s linear all;
}
.card-counter.primary{
	background-color: #007bff;
	color: #FFF;
}
.card-counter.danger{
	background-color: #ef5350;
	color: #FFF;
}
.card-counter.success{
	background-color: #66bb6a;
	color: #FFF;
}
.card-counter.info{
	background-color: #26c6da;
	color: #FFF;
}
.card-counter .count-name{
	float: right;
	font-size: 15px;
	color: #FFF;
}
.card-counter a{
	text-decoration: none !important;
}
.card-counter i{
	font-size: 15px;
	color: #FFF;
}
</file>

<file path="payisp/css/toastr.min.css">
.toast-title{font-weight:700}.toast-message{-ms-word-wrap:break-word;word-wrap:break-word}.toast-message a,.toast-message label{color:#fff}.toast-message a:hover{color:#ccc;text-decoration:none}.toast-close-button{position:relative;right:-.3em;top:-.3em;float:right;font-size:20px;font-weight:700;color:#fff;-webkit-text-shadow:0 1px 0 #fff;text-shadow:0 1px 0 #fff;opacity:.8;-ms-filter:alpha(Opacity=80);filter:alpha(opacity=80)}.toast-close-button:focus,.toast-close-button:hover{color:#000;text-decoration:none;cursor:pointer;opacity:.4;-ms-filter:alpha(Opacity=40);filter:alpha(opacity=40)}button.toast-close-button{padding:0;cursor:pointer;background:0 0;border:0;-webkit-appearance:none}.toast-top-center{top:0;right:0;width:100%}.toast-bottom-center{bottom:0;right:0;width:100%}.toast-top-full-width{top:0;right:0;width:100%}.toast-bottom-full-width{bottom:0;right:0;width:100%}.toast-top-left{top:12px;left:12px}.toast-top-right{top:12px;right:12px}.toast-bottom-right{right:12px;bottom:12px}.toast-bottom-left{bottom:12px;left:12px}#toast-container{position:fixed;z-index:999999}#toast-container *{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#toast-container>div{position:relative;overflow:hidden;margin:0 0 6px;padding:15px 15px 15px 50px;width:300px;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-position:15px center;background-repeat:no-repeat;-moz-box-shadow:0 0 12px #999;-webkit-box-shadow:0 0 12px #999;box-shadow:0 0 12px #999;color:#fff;opacity:.8;-ms-filter:alpha(Opacity=80);filter:alpha(opacity=80)}#toast-container>:hover{-moz-box-shadow:0 0 12px #000;-webkit-box-shadow:0 0 12px #000;box-shadow:0 0 12px #000;opacity:1;-ms-filter:alpha(Opacity=100);filter:alpha(opacity=100);cursor:pointer}#toast-container>.toast-info{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGwSURBVEhLtZa9SgNBEMc9sUxxRcoUKSzSWIhXpFMhhYWFhaBg4yPYiWCXZxBLERsLRS3EQkEfwCKdjWJAwSKCgoKCcudv4O5YLrt7EzgXhiU3/4+b2ckmwVjJSpKkQ6wAi4gwhT+z3wRBcEz0yjSseUTrcRyfsHsXmD0AmbHOC9Ii8VImnuXBPglHpQ5wwSVM7sNnTG7Za4JwDdCjxyAiH3nyA2mtaTJufiDZ5dCaqlItILh1NHatfN5skvjx9Z38m69CgzuXmZgVrPIGE763Jx9qKsRozWYw6xOHdER+nn2KkO+Bb+UV5CBN6WC6QtBgbRVozrahAbmm6HtUsgtPC19tFdxXZYBOfkbmFJ1VaHA1VAHjd0pp70oTZzvR+EVrx2Ygfdsq6eu55BHYR8hlcki+n+kERUFG8BrA0BwjeAv2M8WLQBtcy+SD6fNsmnB3AlBLrgTtVW1c2QN4bVWLATaIS60J2Du5y1TiJgjSBvFVZgTmwCU+dAZFoPxGEEs8nyHC9Bwe2GvEJv2WXZb0vjdyFT4Cxk3e/kIqlOGoVLwwPevpYHT+00T+hWwXDf4AJAOUqWcDhbwAAAAASUVORK5CYII=)!important}#toast-container>.toast-error{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHOSURBVEhLrZa/SgNBEMZzh0WKCClSCKaIYOED+AAKeQQLG8HWztLCImBrYadgIdY+gIKNYkBFSwu7CAoqCgkkoGBI/E28PdbLZmeDLgzZzcx83/zZ2SSXC1j9fr+I1Hq93g2yxH4iwM1vkoBWAdxCmpzTxfkN2RcyZNaHFIkSo10+8kgxkXIURV5HGxTmFuc75B2RfQkpxHG8aAgaAFa0tAHqYFfQ7Iwe2yhODk8+J4C7yAoRTWI3w/4klGRgR4lO7Rpn9+gvMyWp+uxFh8+H+ARlgN1nJuJuQAYvNkEnwGFck18Er4q3egEc/oO+mhLdKgRyhdNFiacC0rlOCbhNVz4H9FnAYgDBvU3QIioZlJFLJtsoHYRDfiZoUyIxqCtRpVlANq0EU4dApjrtgezPFad5S19Wgjkc0hNVnuF4HjVA6C7QrSIbylB+oZe3aHgBsqlNqKYH48jXyJKMuAbiyVJ8KzaB3eRc0pg9VwQ4niFryI68qiOi3AbjwdsfnAtk0bCjTLJKr6mrD9g8iq/S/B81hguOMlQTnVyG40wAcjnmgsCNESDrjme7wfftP4P7SP4N3CJZdvzoNyGq2c/HWOXJGsvVg+RA/k2MC/wN6I2YA2Pt8GkAAAAASUVORK5CYII=)!important}#toast-container>.toast-success{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADsSURBVEhLY2AYBfQMgf///3P8+/evAIgvA/FsIF+BavYDDWMBGroaSMMBiE8VC7AZDrIFaMFnii3AZTjUgsUUWUDA8OdAH6iQbQEhw4HyGsPEcKBXBIC4ARhex4G4BsjmweU1soIFaGg/WtoFZRIZdEvIMhxkCCjXIVsATV6gFGACs4Rsw0EGgIIH3QJYJgHSARQZDrWAB+jawzgs+Q2UO49D7jnRSRGoEFRILcdmEMWGI0cm0JJ2QpYA1RDvcmzJEWhABhD/pqrL0S0CWuABKgnRki9lLseS7g2AlqwHWQSKH4oKLrILpRGhEQCw2LiRUIa4lwAAAABJRU5ErkJggg==)!important}#toast-container>.toast-warning{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGYSURBVEhL5ZSvTsNQFMbXZGICMYGYmJhAQIJAICYQPAACiSDB8AiICQQJT4CqQEwgJvYASAQCiZiYmJhAIBATCARJy+9rTsldd8sKu1M0+dLb057v6/lbq/2rK0mS/TRNj9cWNAKPYIJII7gIxCcQ51cvqID+GIEX8ASG4B1bK5gIZFeQfoJdEXOfgX4QAQg7kH2A65yQ87lyxb27sggkAzAuFhbbg1K2kgCkB1bVwyIR9m2L7PRPIhDUIXgGtyKw575yz3lTNs6X4JXnjV+LKM/m3MydnTbtOKIjtz6VhCBq4vSm3ncdrD2lk0VgUXSVKjVDJXJzijW1RQdsU7F77He8u68koNZTz8Oz5yGa6J3H3lZ0xYgXBK2QymlWWA+RWnYhskLBv2vmE+hBMCtbA7KX5drWyRT/2JsqZ2IvfB9Y4bWDNMFbJRFmC9E74SoS0CqulwjkC0+5bpcV1CZ8NMej4pjy0U+doDQsGyo1hzVJttIjhQ7GnBtRFN1UarUlH8F3xict+HY07rEzoUGPlWcjRFRr4/gChZgc3ZL2d8oAAAAASUVORK5CYII=)!important}#toast-container.toast-bottom-center>div,#toast-container.toast-top-center>div{width:300px;margin:auto}#toast-container.toast-bottom-full-width>div,#toast-container.toast-top-full-width>div{width:96%;margin:auto}.toast{background-color:#030303}.toast-success{background-color:#51a351}.toast-error{background-color:#bd362f}.toast-info{background-color:#2f96b4}.toast-warning{background-color:#f89406}.toast-progress{position:absolute;left:0;bottom:0;height:4px;background-color:#000;opacity:.4;-ms-filter:alpha(Opacity=40);filter:alpha(opacity=40)}@media all and (max-width:240px){#toast-container>div{padding:8px 8px 8px 50px;width:11em}#toast-container .toast-close-button{right:-.2em;top:-.2em}}@media all and (min-width:241px) and (max-width:480px){#toast-container>div{padding:8px 8px 8px 50px;width:18em}#toast-container .toast-close-button{right:-.2em;top:-.2em}}@media all and (min-width:481px) and (max-width:768px){#toast-container>div{padding:15px 15px 15px 50px;width:25em}}
</file>

<file path="payisp/custom/boleto.hhvm">
<?php 
//checa qual boleto emitir
if(file_exists(dirname(__FILE__).'/../init_cliente.php') && isset($_GET['titulo'])){
	include(dirname(__FILE__).'/../init_cliente.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	if(isset($cliente_logado_central)  && $cliente_logado_central==true){
		//consulta o boleto
		$sql = "SELECT * FROM `sis_lanc` WHERE id = '".$mysqli->real_escape_string($_REQUEST['titulo'])."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['uuid_lanc'])){
			die('Ops, no foi possivel encontrar o boleto consultado!');
		}
		if($fatura['status']=='pago'){
			die('Ops, fatura j paga!');
		}
		//se banco  atrelado ao payisp
		$modulo = trim($fatura['fcartaonumero']);
		$banco = dados_banco_cod_payisp($modulo);
		if(!isset($banco['cod_banco']) || !file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.boleto.central.php')){
			//funcoes originais
			header("Location: /boleto/boleto.hhvm?".http_build_query($_REQUEST)."");
			die();
		}else{
			//cria o link seguro de acesso ao boleto 
			$hash = md5($fatura['id'].''.$banco['serial']);
			header("Location: /admin/addons/payisp/imprimir.boleto.central.php?boleto=".$fatura['id']."&hash=".$hash."");
			die();
		}
	}else{
		//funcoes originais
		header("Location: /boleto/boleto.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	header("Location: /boleto/boleto.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/carne.hhvm">
<?php 
//checa qual carne emitir
if(file_exists(dirname(__FILE__).'/../init_cliente.php') && isset($_GET['carne'])){
	include(dirname(__FILE__).'/../init_cliente.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."&sembancosativos");
		die();
	}
	if(isset($cliente_logado_central) && $cliente_logado_central==true){
		//consulta o carne
		$sql = "SELECT * FROM `sis_carne` WHERE codigo = '".$mysqli->real_escape_string($_REQUEST['carne'])."' LIMIT 1";
		$result = $mysqli->query($sql);
		$carne = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($carne['codigo'])){
			die('Ops, no foi possivel encontrar o carne consultado!');
		}
		//checa o emissor do carnet 
		$sql = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$carne['codigo']."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['uuid_lanc'])){
			die('Ops, no foi possivel encontrar nenhum boleto ao carnet consultado!');
		}
		//se banco  atrelado ao payisp
		$modulo = trim($fatura['fcartaonumero']);
		$banco = dados_banco_cod_payisp($modulo);
		if(!isset($banco['cod_banco']) || !file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.central.php')){
			//funcoes originais
			header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."&semarquivocentral");
			die();
		}else{
			//cria o link seguro de acesso ao carne
			$hash = md5($carne['codigo'].''.$banco['serial']);
			header("Location: /admin/addons/payisp/imprimir.carnet.central.php?carne=".$carne['codigo']."&hash=".$hash."");
			die();
		}
	}else{
		//funcoes originais
		header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."&deslogado");
		die();
	}
}else{
	//funcoes originais
	header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."&semarquivo");
	die();
}
?>
</file>

<file path="payisp/custom/central_prepara_boleto.hhvm">
<?php 
//checa qual boleto emitir
if(file_exists(dirname(__FILE__).'/../init_cliente.php') && isset($_GET['titulo'])){
	include(dirname(__FILE__).'/../init_cliente.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /central/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	if(isset($cliente_logado_central) && $cliente_logado_central==true){
		//consulta o boleto
		$sql = "SELECT * FROM `sis_lanc` WHERE uuid_lanc = '".$mysqli->real_escape_string($_REQUEST['titulo'])."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['uuid_lanc'])){
			die('Ops, no foi possivel encontrar o boleto consultado!');
		}
		if($fatura['status']=='pago'){
			die('Ops, fatura j paga!');
		}
		//se banco  atrelado ao payisp
		$modulo = trim($fatura['fcartaonumero']);
		$banco = dados_banco_cod_payisp($modulo);
		if(!isset($banco['cod_banco']) || !file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.boleto.central.php')){
			//funcoes originais
			header("Location: /central/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
			die();
		}else{
			//cria o link seguro de acesso ao boleto 
			$hash = md5($fatura['id'].''.$banco['serial']);
			header("Location: /admin/addons/payisp/imprimir.boleto.central.php?boleto=".$fatura['id']."&hash=".$hash."");
			die();
		}
	}else{
		//funcoes originais
		header("Location: /central/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	header("Location: /central/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/central_prepara_carne.hhvm">
<?php 
//checa qual carne emitir
if(file_exists(dirname(__FILE__).'/../init_cliente.php') && isset($_GET['carne'])){
	include(dirname(__FILE__).'/../init_cliente.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /boleto/carne.hhvm?".http_build_query($_REQUEST)."&sembancosativos");
		die();
	}
	if(isset($cliente_logado_central) && $cliente_logado_central==true){
		//consulta o carne
		$sql = "SELECT * FROM `sis_carne` WHERE codigo = '".$mysqli->real_escape_string($_REQUEST['carne'])."' LIMIT 1";
		$result = $mysqli->query($sql);
		$carne = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($carne['codigo'])){
			die('Ops, no foi possivel encontrar o carne consultado!');
		}
		//checa o emissor do carnet 
		$sql = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$carne['codigo']."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['uuid_lanc'])){
			die('Ops, no foi possivel encontrar nenhum boleto ao carnet consultado!');
		}
		//se banco  atrelado ao payisp
		$modulo = trim($fatura['fcartaonumero']);
		$banco = dados_banco_cod_payisp($modulo);
		if(!isset($banco['cod_banco']) || !file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.central.php')){
			//funcoes originais
			header("Location: /central/prepara_carne.hhvm?".http_build_query($_REQUEST)."&semarquivocentral");
			die();
		}else{
			//cria o link seguro de acesso ao carne
			$hash = md5($carne['codigo'].''.$banco['serial']);
			header("Location: /admin/addons/payisp/imprimir.carnet.central.php?carne=".$carne['codigo']."&hash=".$hash."");
			die();
		}
	}else{
		//funcoes originais
		header("Location: /central/prepara_carne.hhvm?".http_build_query($_REQUEST)."&deslogado");
		die();
	}
}else{
	//funcoes originais
	header("Location: /central/prepara_carne.hhvm?".http_build_query($_REQUEST)."&semarquivo");
	die();
}
?>
</file>

<file path="payisp/custom/impressao_boletos.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['enviar'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/impressao_boletos.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//vars
	$usar = isset($_REQUEST['usar'])?$_REQUEST['usar']:'carne';
	$i = isset($_REQUEST['datai'])?$_REQUEST['datai']:date('Y-m-d');
	$f = isset($_REQUEST['dataf'])?$_REQUEST['dataf']:date('Y-m-d');
	$conta = isset($_REQUEST['conta'])?$_REQUEST['conta']:array();
	$bairro = isset($_REQUEST['bairro'])?$_REQUEST['bairro']:array();
	$cidade = isset($_REQUEST['cidade'])?$_REQUEST['cidade']:array();
	$plano = isset($_REQUEST['plano'])?$_REQUEST['plano']:array();
	$grupo = isset($_REQUEST['grupo'])?$_REQUEST['grupo']:array();
	$ramal = isset($_REQUEST['ramal'])?$_REQUEST['ramal']:array();
	$venc = isset($_REQUEST['venc'])?$_REQUEST['venc']:array();
	$ordem = isset($_REQUEST['ordenar'])?$_REQUEST['ordenar']:'sis_lanc.id';
	$impressos = isset($_REQUEST['impressos'])?$_REQUEST['impressos']:'naoimpres';
	$clientes = isset($_REQUEST['clientesbloq'])?$_REQUEST['clientesbloq']:'simbloq';
	//apenas uma conta por vez
	if(count($conta)==0){
		$titulo = 'Nenhuma Conta Selecionado';
		$alerta = 'Nenhuma conta foi selecionada, escola a conta correspondente a um banco gerenciado via PAY ISP.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}elseif(count($conta) > 1){
		$titulo = 'Multiplas Contas Selecionada';
		$alerta = 'Mais de uma conta foi selecionada, escola apenas a conta correspondente qual deseja a impresso e que seja um banco gerenciado via PAY ISP.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	//filtra os titulos
	$sql = "SELECT * FROM `vtab_titulos` WHERE status = 'aberto' AND numconta = '".$conta[0]."' AND deltitulo = 0 AND (processamento BETWEEN '".$i."' AND '".$f."') ";
	if($usar=='carne'){
		$sql .= "AND tipocob = 'car' ";
	}
	if($impressos=='naoimpres'){
		$sql .= "AND imp = 'nao' ";
	}
	if($clientes=='naobloq'){
		$sql .= "AND bloqueado = 'sim' ";
	}
	if(!isset($_REQUEST['checkAll_Bairros']) && count($bairro) > 0){
		$sql .= "AND FIND_IN_SET(bairro, '".implode(",",$bairro)."') ";
	}
	if(!isset($_REQUEST['checkAll_Cidades']) && count($cidade) > 0){
		$sql .= "AND FIND_IN_SET(cidade, '".implode(",",$cidade)."') ";
	}
	if(!isset($_REQUEST['checkAll_Planos']) && count($plano) > 0){
		$sql .= "AND FIND_IN_SET(plano, '".implode(",",$plano)."') ";
	}
	if(!isset($_REQUEST['checkAll_Grupos']) && count($grupo) > 0){
		$sql .= "AND FIND_IN_SET(grupo, '".implode(",",$grupo)."') ";
	}
	if(!isset($_REQUEST['checkAll_Ramais']) && count($ramal) > 0){
		$sql .= "AND FIND_IN_SET(ramal, '".implode(",",$ramal)."') ";
	}
	if(!isset($_REQUEST['checkAll_Vencimentos']) && count($venc) > 0){
		$sql .= "AND FIND_IN_SET(venc, '".implode(",",$venc)."') ";
	}
	if($usar=='carne'){
		$sql .= "GROUP BY codigo_carne ";
	}
	if($ordem=='sis_lanc.id'){
		$sql .= "ORDER BY titulo ASC";
	}elseif($ordem=='sis_cliente.cidade'){
		$sql .= "ORDER BY cidade ASC, titulo ASC";
	}elseif($ordem=='sis_cliente.bairro'){
		$sql .= "ORDER BY bairro ASC, titulo ASC";
	}elseif($ordem=='sis_cliente.nome'){
		$sql .= "ORDER BY nome ASC, titulo ASC";
	}
	$results = $mysqli->query($sql);
	if($results->num_rows==0){
		$titulo = 'Nenhum Titulo/Carnet Encontrado';
		$alerta = 'No foi possivel encontrar titulos/carnets para impresso para sua consulta, tente novamente escolhendo outros filtros.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	$lista_carnets = '';
	$lista_titulos = '';
	$id_carnet_selecao = '';
	while ($row = $results->fetch_array()) { 
		$id_carnet_selecao = $row['codigo_carne'];
		$id_titulo_selecao = $row['titulo'];
		$lista_carnets .= '&carne[]='.$row['codigo_carne'].'';
		$lista_titulos .= '&titulo[]='.$row['titulo'].'';
	}
	//checa o emissor do carnet 
	if($usar=='carne'){
		$sql_check = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$mysqli->real_escape_string($id_carnet_selecao)."' LIMIT 1";
	}else{
		$sql_check = "SELECT * FROM `sis_lanc` WHERE id = '".$mysqli->real_escape_string($id_titulo_selecao)."' LIMIT 1";
	}
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Carnet No Encontrado';
		$alerta = 'No foi possivel encontrar carnets para impresso para sua consulta, tente novamente escolhendo outros filtros.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	//se banco atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		if($usar=='carne'){
			header("Location: /admin/addons/payisp/imprimir.carnet.php?origem=impressao_boletos".$lista_carnets."");
		}else{
			header("Location: /admin/addons/payisp/imprimir.carnet.php?origem=impressao_boletos".$lista_titulos."");
		}
		die();
	}else{
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/impressao_boletos.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	require(dirname(__FILE__).'/to_form.php');
	request_to_post_payisp("/admin/impressao_boletos.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/impressao_carnes.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['enviar'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/impressao_carnes.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//vars
	$i = isset($_REQUEST['datai'])?$_REQUEST['datai']:date('Y-m-d');
	$f = isset($_REQUEST['dataf'])?$_REQUEST['dataf']:date('Y-m-d');
	$conta = isset($_REQUEST['conta'])?$_REQUEST['conta']:array();
	$bairro = isset($_REQUEST['bairro'])?$_REQUEST['bairro']:array();
	$cidade = isset($_REQUEST['cidade'])?$_REQUEST['cidade']:array();
	$plano = isset($_REQUEST['plano'])?$_REQUEST['plano']:array();
	$grupo = isset($_REQUEST['grupo'])?$_REQUEST['grupo']:array();
	$ramal = isset($_REQUEST['ramal'])?$_REQUEST['ramal']:array();
	$venc = isset($_REQUEST['venc'])?$_REQUEST['venc']:array();
	$ordem = isset($_REQUEST['ordenar'])?$_REQUEST['ordenar']:'sis_lanc.id';
	$impressos = isset($_REQUEST['impressos'])?$_REQUEST['impressos']:'naoimpres';
	$clientes = isset($_REQUEST['clientesbloq'])?$_REQUEST['clientesbloq']:'simbloq';
	//apenas uma conta por vez
	if(count($conta)==0){
		$titulo = 'Nenhuma Conta Selecionado';
		$alerta = 'Nenhuma conta foi selecionada, escola a conta correspondente a um banco gerenciado via PAY ISP.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}elseif(count($conta) > 1){
		$titulo = 'Multiplas Contas Selecionada';
		$alerta = 'Mais de uma conta foi selecionada, escola apenas a conta correspondente qual deseja a impresso e que seja um banco gerenciado via PAY ISP.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	//filtra os titulos
	$sql = "SELECT * FROM `vtab_titulos` WHERE tipocob = 'car' AND numconta = '".$conta[0]."' AND status = 'aberto' AND deltitulo = 0 AND (processamento BETWEEN '".$i."' AND '".$f."') ";
	if($impressos=='naoimpres'){
		$sql .= "AND imp = 'nao' ";
	}
	if($clientes=='naobloq'){
		$sql .= "AND bloqueado = 'sim' ";
	}
	if(!isset($_REQUEST['checkAll_Bairros']) && count($bairro) > 0){
		$sql .= "AND FIND_IN_SET(bairro, '".implode(",",$bairro)."') ";
	}
	if(!isset($_REQUEST['checkAll_Cidades']) && count($cidade) > 0){
		$sql .= "AND FIND_IN_SET(cidade, '".implode(",",$cidade)."') ";
	}
	if(!isset($_REQUEST['checkAll_Planos']) && count($plano) > 0){
		$sql .= "AND FIND_IN_SET(plano, '".implode(",",$plano)."') ";
	}
	if(!isset($_REQUEST['checkAll_Grupos']) && count($grupo) > 0){
		$sql .= "AND FIND_IN_SET(grupo, '".implode(",",$grupo)."') ";
	}
	if(!isset($_REQUEST['checkAll_Ramais']) && count($ramal) > 0){
		$sql .= "AND FIND_IN_SET(ramal, '".implode(",",$ramal)."') ";
	}
	if(!isset($_REQUEST['checkAll_Vencimentos']) && count($venc) > 0){
		$sql .= "AND FIND_IN_SET(venc, '".implode(",",$venc)."') ";
	}
	$sql .= "GROUP BY codigo_carne ";
	if($ordem=='sis_lanc.id'){
		$sql .= "ORDER BY titulo ASC";
	}elseif($ordem=='sis_cliente.cidade'){
		$sql .= "ORDER BY cidade ASC, titulo ASC";
	}elseif($ordem=='sis_cliente.bairro'){
		$sql .= "ORDER BY bairro ASC, titulo ASC";
	}elseif($ordem=='sis_cliente.nome'){
		$sql .= "ORDER BY nome ASC, titulo ASC";
	}
	$results = $mysqli->query($sql);
	if($results->num_rows==0){
		$titulo = 'Nenhum Carnet Encontrado';
		$alerta = 'No foi possivel encontrar carnets para impresso para sua consulta, tente novamente escolhendo outros filtros.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	$lista_carnets = '';
	$id_carnet_selecao = '';
	while ($row = $results->fetch_array()) { 
		$id_carnet_selecao = $row['codigo_carne'];
		$lista_carnets .= '&carne[]='.$row['codigo_carne'].'';
	}
	//checa o emissor do carnet 
	$sql_check = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$mysqli->real_escape_string($id_carnet_selecao)."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Carnet No Encontrado';
		$alerta = 'No foi possivel encontrar carnets para impresso para sua consulta, tente novamente escolhendo outros filtros.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		exit;
	}
	//se banco atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		header("Location: /admin/addons/payisp/imprimir.carnet.php?origem=impressao_carnes".$lista_carnets."");
		die();
	}else{
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/impressao_carnes.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	require(dirname(__FILE__).'/to_form.php');
	request_to_post_payisp("/admin/impressao_carnes.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/imprimir_boletos.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['titulo'][0])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/imprimir_boletos.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//verifica se o titulo so para o mesmo banco 
	$bancos = array();
	foreach($_REQUEST['titulo'] as $k=>$v){
		$sql = "SELECT * FROM `sis_lanc` WHERE id = '".$mysqli->real_escape_string($v)."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		$bancos[(int)$fatura['numconta']][] = $fatura['uuid_lanc'];
	}
	//bloqueia quando existe mais de um emissor 
	if(count($bancos) > 1){
		$titulo = 'Ops';
		$alerta = 'No foi possivel imprimir boletos emitidos por banco diferentes um do outro, selecione apenas boletos emitidos por o mesmo banco!';
		$tipo_alerta = 'danger';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//checa o emissor do carnet 
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Ops';
		$alerta = 'No foi possivel encontrar o boleto aos titulos consultados, todos os boletos a ser impressos precisa ser registrado via o mesmo banco!';
		$tipo_alerta = 'danger';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//titulos
	$titulos = '';
	if(isset($_REQUEST['titulo']) && !empty($_REQUEST['titulo'])){
		foreach($_REQUEST['titulo'] as $k=>$v){
			$titulos .= '&titulo[]='.$v.'';
		}
	}
	//se banco atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		header("Location: /admin/addons/payisp/imprimir.carnet.php?carne=".$fatura['codigo_carne']."".$titulos."");
		die();
	}else{
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/imprimir_boletos.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	require(dirname(__FILE__).'/to_form.php');
	request_to_post_payisp("/admin/imprimir_boletos.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/imprimir_carnes.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['carne'][0])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/imprimir_carnes.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//verifica se os carnets so para o mesmo banco 
	$bancos = array();
	foreach($_REQUEST['carne'] as $k=>$v){
		$sql = "SELECT * FROM `sis_carne` WHERE codigo = '".$mysqli->real_escape_string($v)."' LIMIT 1";
		$result = $mysqli->query($sql);
		$carnet = $result->fetch_array(MYSQLI_ASSOC);
		$bancos[(int)$carnet['banco']][] = $carnet['uuid_carne'];
	}
	//bloqueia quando existe mais de um emissor 
	if(count($bancos) > 1){
		$titulo = 'Ops';
		$alerta = 'No foi possivel imprimir carnets emitidos por banco diferentes um do outro, selecione apenas emitidos por o mesmo banco!';
		$tipo_alerta = 'danger';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//checa o emissor do carnet 
	$sql = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$mysqli->real_escape_string($_REQUEST['carne'][0])."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Ops';
		$alerta = 'No foi possivel encontrar nenhum boleto ao carnet consultado!';
		$tipo_alerta = 'danger';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//se banco atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		header("Location: /admin/addons/payisp/imprimir.carnet.php?origem=imprimir_carnes&".http_build_query($_REQUEST)."&banco=".$modulo."");
		die();
	}else{
		//funcoes originais
		require(dirname(__FILE__).'/to_form.php');
		request_to_post_payisp("/admin/imprimir_carnes.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	require(dirname(__FILE__).'/to_form.php');
	request_to_post_payisp("/admin/imprimir_carnes.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/prepara_boleto.hhvm">
<?php
//checa qual boleto emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['titulo'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /admin/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//dados do titulo
	$sql = "SELECT * FROM `sis_lanc` WHERE id = '".$mysqli->real_escape_string($_REQUEST['titulo'])."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Fatura No Encontrada';
		$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	if($fatura['status']=='pago'){
		$titulo = 'Fatura j Paga';
		$alerta = 'O titulo do boleto selecionado j encontra-se pago em nossa base de dados.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//se banco  atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.boleto.php')){
		header("Location: /admin/addons/payisp/imprimir.boleto.php?boleto=".$fatura['id']."&banco=".$modulo."");
		die();
	}else{
		//funcoes originais
		header("Location: /admin/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	header("Location: /admin/prepara_boleto.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/prepara_carne.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_GET['carne'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		header("Location: /admin/prepara_carne.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
	//checa o emissor do carnet 
	$sql = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$mysqli->real_escape_string($_GET['carne'])."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		$titulo = 'Fatura No Encontrada';
		$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__).'/../template_alerta.php');
		die('');
	}
	//se banco  atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		header("Location: /admin/addons/payisp/imprimir.carnet.php?carne[]=".$fatura['codigo_carne']."&banco=".$modulo."");
		die();
	}else{
		header("Location: /admin/prepara_carne.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	header("Location: /admin/prepara_carne.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/send_bolpdf.hhvm">
<?php
//checa qual boleto emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_REQUEST['uuid'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		die('GWT');
	}
	//dados do titulo
	$sql = "SELECT * FROM `sis_lanc` WHERE uuid_lanc = '".$mysqli->real_escape_string($_REQUEST['uuid'])."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		die('ERRO');
	}
	//se banco  atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.boleto.php')){
		die('GWT');
	}else{
		//funcoes originais
		include('/opt/mk-auth/admin/send_bolpdf.hhvm');
	}
}else{
	//funcoes originais
	include('/opt/mk-auth/admin/send_bolpdf.hhvm');
}
?>
</file>

<file path="payisp/custom/send_carnepdf.hhvm">
<?php
//checa qual carnet emitir
if(file_exists(dirname(__FILE__).'/../init.php') && isset($_GET['carne'])){
	//funcoes customizadas
	require(dirname(__FILE__).'/../init.php');
	//desativado 
	if(qtd_bancos_payisp_ativos()==0){
		//funcoes originais
		die('GWT');
	}
	//checa o emissor do carnet 
	$sql = "SELECT * FROM `sis_lanc` WHERE codigo_carne = '".$mysqli->real_escape_string($_GET['carne'])."' LIMIT 1";
	$result = $mysqli->query($sql);
	$fatura = $result->fetch_array(MYSQLI_ASSOC);
	if(!isset($fatura['uuid_lanc'])){
		die('ERRO');
	}
	//se banco  atrelado ao payisp
	$modulo = trim($fatura['fcartaonumero']);
	$banco = dados_banco_cod_payisp($modulo);
	if(isset($banco['cod_banco']) && file_exists('/opt/mk-auth/admin/addons/payisp/imprimir.carnet.php')){
		die('GWT');
	}else{
		//funcoes originais
		include('/opt/mk-auth/admin/send_carnepdf.hhvm');
	}
}else{
	//funcoes originais
	include('/opt/mk-auth/admin/send_carnepdf.hhvm');
}
?>
</file>

<file path="payisp/custom/titulo.hhvm">
<?php
//checa qual boleto emitir
$tipo_acao = isset($_GET['tipo'])?$_GET['tipo']:'';
if($tipo_acao=='alttitulo'){//alterar
	$id = isset($_GET['id'])?(int)$_GET['id']:0;
	if(file_exists(dirname(__FILE__).'/../init.php') && $id > 0){
		//funcoes customizadas
		require(dirname(__FILE__).'/../init.php');
		//desativado 
		if(qtd_bancos_payisp_ativos()==0){
			//funcoes originais
			header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
			die();
		}
		//dados do titulo
		$sql = "SELECT * FROM `sis_lanc` WHERE id = '".$id."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['uuid_lanc'])){
			$titulo = 'Fatura No Encontrada';
			$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
			$tipo_alerta = 'warning';
			require(dirname(__FILE__).'/../template_alerta.php');
			die('');
		}else{
			if(!empty($fatura['fchequenumero']) && $fatura['fchequenumero']=='registrado'){
				$titulo = 'Alterao No Permitida';
				$alerta = 'O titulo do boleto selecionado n&atilde;o pode ser mais alterado pois j&aacute; encontra-se registrado junto ao banco emissor.';
				$tipo_alerta = 'warning';
				require(dirname(__FILE__).'/../template_alerta.php');
			}else{
				//funcoes originais
				header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
				die();
			}
		}
	}else{
		//funcoes originais
		header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}elseif($tipo_acao=='atrelar_titulo'){//atrelar
	$id = isset($_GET['titulo'])?(int)$_GET['titulo']:0;
	if(file_exists(dirname(__FILE__).'/../init.php') && $id > 0){
		//funcoes customizadas
		require(dirname(__FILE__).'/../init.php');
		//desativado 
		if(qtd_bancos_payisp_ativos()==0){
			//funcoes originais
			header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
			die();
		}
		//dados do titulo
		$sql = "SELECT * FROM `sis_lanc` WHERE id = '".$id."' LIMIT 1";
		$result = $mysqli->query($sql);
		$fatura = $result->fetch_array(MYSQLI_ASSOC);
		if(!isset($fatura['id'])){
			$titulo = 'Fatura No Encontrada';
			$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
			$tipo_alerta = 'warning';
			require(dirname(__FILE__).'/../template_alerta.php');
		}else{
			if(!empty($fatura['fchequenumero']) && $fatura['fchequenumero']=='registrado'){
				$titulo = 'Atrelao No Permitido';
				$alerta = 'O titulo do boleto selecionado n&atilde;o pode ser mais atrelado pois j&aacute; encontra-se registrado junto ao banco emissor.';
				$tipo_alerta = 'warning';
				require(dirname(__FILE__).'/../template_alerta.php');
			}else{
				//funcoes originais
				header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
				die();
			}
		}
	}else{
		//funcoes originais
		header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
		die();
	}
}else{
	//funcoes originais
	header("Location: /admin/titulo.hhvm?".http_build_query($_REQUEST)."");
	die();
}
?>
</file>

<file path="payisp/custom/to_form.php">
<?php
function request_to_post_payisp($url){
	$form  = '<html>';
	$form .= '<head>';
	$form .= '<title>Aguarde o redirecionamento...</title>';
	$form .= '</head>';
	$form .= '<body>';
	$form .= "<form name=\"myform\" id=\"myform\" method='post' action='".$url."'>"; 
	foreach($_REQUEST as $k=>$v){
		if(is_array($v)){
			foreach($v as $kk=>$vv){
				$form .= '<input type="hidden" value="'.$vv.'" name="'.$k.'['.$kk.']">';
			}
		}else{
			$form .= '<input type="hidden" value="'.$v.'" name="'.$k.'">';
		}
	}
	$form .= '<center><input type="submit" value="Clique aqui se n&atilde;o for redirecionado..."></center>';
	$form .= '</form>';
	$form .= '<script type="text/javascript">';
    $form .= 'document.getElementById("myform").submit();';
	$form .= '</script>';
	$form .= '</body>';
	$form .= '</html>';
	echo $form;
}
?>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consReciNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consReciNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consReciNFCom" type="TConsReciNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Consulta de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consReciNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TProtNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Protocolo de status resultado do processamento da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infProt">
				<xs:annotation>
					<xs:documentation>Dados do protocolo de status</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chaves de acesso da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto">
							<xs:annotation>
								<xs:documentation>Data e hora de processamento, no formato AAAA-MM-DDTHH:MM:SS TZD. </xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TDateTimeUTC"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do Protocolo de Status da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="digVal" type="ds:DigestValueType" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Digest Value da NFCom processado. Utilizado para conferir a integridade da NFCom original.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da NFCom.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" type="xs:ID" use="optional"/>
				</xs:complexType>
			</xs:element>
			<xs:element name="infFisco" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Mensagem do Fisco</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cMsg">
							<xs:annotation>
								<xs:documentation>Cdigo do status da mensagem do fisco</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMsg" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Mensagem do Fisco</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsReciNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TConsReciNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta do Recibo da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="nRec" type="TRec">
				<xs:annotation>
					<xs:documentation>Nmero do Recibo do arquivo a ser consultado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsReciNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsReciNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do Pedido de  Consulta do Recibo da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="nRec" type="TRec">
				<xs:annotation>
					<xs:documentation>Nmero do Recibo Consultado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Idntificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" type="TProtNFCom" minOccurs="0" maxOccurs="50">
				<xs:annotation>
					<xs:documentation>Resultado do processamento do NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsReciNFCom" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsReciNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta do Recibo de NFCom - 1.00</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consSitNFCom" type="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema de validao XML dp Pedido de Consulta da Situao Atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consSitNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:complexType name="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta da Situao Atual da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo; 
2 - Homologao;</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="CONSULTAR">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="chNFCom" type="TChDFe">
				<xs:annotation>
					<xs:documentation>Chaves de acesso do NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno de Pedido de Consulta da Situao Atual de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou o NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>cdigo da UF de atendimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" minOccurs="0">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar protNFCom da verso correspondente da NFCom autorizada</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element name="procEventoNFCom" minOccurs="0" maxOccurs="unbounded">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar procEventoNFCom da verso correspondente do evento NFCom autorizado</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsSitNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta situao de NFCom - 1.00</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consStatServNFCom" type="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/consStatServNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="STATUS">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Resultado da Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TVerAplic">
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo da UF responsvel pelo servio</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="dhRecbto" type="TDateTimeUTC">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tMed" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:integer">
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="dhRetorno" type="TDateTimeUTC" minOccurs="0">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD. Deve ser preenchida com data e hora previstas para o retorno dos servios prestados.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xObs" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Campo observao utilizado para incluir informaes ao contribuinte</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:minLength value="1"/>
						<xs:maxLength value="255"/>
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsStat">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/enviNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="enviNFCom" type="TEnviNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Envio de Lote NFCom para concesso de autorizao</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/evCancNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="evCancNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do evento do cancelamento 
110111</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="descEvento">
					<xs:annotation>
						<xs:documentation>Descrio do Evento - Cancelamento</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:whiteSpace value="preserve"/>
							<xs:enumeration value="Cancelamento"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="nProt" type="TProt">
					<xs:annotation>
						<xs:documentation>Nmero do Protocolo de Status da NFCom</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="xJust" type="TJust">
					<xs:annotation>
						<xs:documentation>Justificativa do Cancelamento</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/eventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="eventoNFCom" type="TEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Registro de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/eventoNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TEvento">
		<xs:annotation>
			<xs:documentation>Tipo Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="CNPJ" type="TCnpj">
							<xs:annotation>
								<xs:documentation>CNPJ do emissor do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de Acesso da NFCom vinculada ao evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhEvento" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e Hora do Evento, formato UTC (AAAA-MM-DDThh:mm:ssTZD)</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento">
							<xs:annotation>
								<xs:documentation>Tipo do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento">
							<xs:annotation>
								<xs:documentation>Seqencial do evento para o mesmo tipo de evento.  Para maioria dos eventos ser 1, nos casos em que possa existir mais de um evento o autor do evento deve numerar de forma seqencial.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="detEvento">
							<xs:annotation>
								<xs:documentation>Detalhamento do evento especfico</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:any processContents="skip">
										<xs:annotation>
											<xs:documentation>XML do evento
Insira neste local o XML especfico do tipo de evento (cancelamento, encerramento, registro de passagem).  </xs:documentation>
										</xs:annotation>
									</xs:any>
								</xs:sequence>
								<xs:attribute name="versaoEvento" use="required">
									<xs:simpleType>
										<xs:restriction base="xs:string">
											<xs:whiteSpace value="preserve"/>
											<xs:pattern value="1\.(0[0-9]|[1-9][0-9])"/>
										</xs:restriction>
									</xs:simpleType>
								</xs:attribute>
							</xs:complexType>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da TAG a ser assinada, a regra de formao do Id :
ID + tpEvento +  chave da NF-3e + nSeqEvento (preencher com zeros a esquerda para compor 3 digitos)</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{53}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEvento">
		<xs:annotation>
			<xs:documentation>Tipo retorno do Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que recebeu o Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento. Utilizar a Tabela do IBGE extendida, utilizar 90 para identificar SUFRAMA</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat" type="TStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status do registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Chave de Acesso NFCom vinculada</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Tipo do Evento vinculado</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Descrio do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TString">
									<xs:minLength value="4"/>
									<xs:maxLength value="60"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Seqencial do evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="dhRegEvento" type="TDateTimeUTC" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Data e Hora de do recebimento do evento ou do registro do evento formato AAAA-MM-DDThh:mm:ssTZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do protocolo de registro do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="optional">
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{16}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" use="required">
			<xs:simpleType>
				<xs:restriction base="TVerEvento"/>
			</xs:simpleType>
		</xs:attribute>
	</xs:complexType>
	<xs:complexType name="TProcEvento">
		<xs:annotation>
			<xs:documentation>Tipo procEvento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="eventoNFCom" type="TEvento"/>
			<xs:element name="retEventoNFCom" type="TRetEvento"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
		<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
			<xs:annotation>
				<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
			</xs:annotation>
		</xs:attribute>
		<xs:attribute name="nPortaCon" use="optional">
			<xs:annotation>
				<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
			</xs:annotation>
			<xs:simpleType>
				<xs:restriction base="xs:string">
					<xs:pattern value="[0-9]{1,5}"/>
				</xs:restriction>
			</xs:simpleType>
		</xs:attribute>
		<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
			<xs:annotation>
				<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
			</xs:annotation>
		</xs:attribute>
	</xs:complexType>
	<xs:simpleType name="TVerEvento">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Evento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/nfcom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="NFCom" type="TNFCom">
		<xs:annotation>
			<xs:documentation>Nota Fiscal Fatura de Comunicao Eletrnica</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/nfcomTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Nota Fiscal Fatura de Comunicao</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infNFCom">
				<xs:annotation>
					<xs:documentation>Informaes da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="ide">
							<xs:annotation>
								<xs:documentation>Identificao da NFCom</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="cUF" type="TCodUfIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo da UF do emitente da NFCom</xs:documentation>
											<xs:documentation>Cdigo da UF do emitente do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpAmb" type="TAmb">
										<xs:annotation>
											<xs:documentation>Tipo do Ambiente</xs:documentation>
											<xs:documentation>1 - Produo; 
2 - Homologao</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="mod" type="TModNFCom">
										<xs:annotation>
											<xs:documentation>Modelo da NFCom</xs:documentation>
											<xs:documentation>Utilizar o cdigo 62 para identificao da NFCom</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="serie" type="TSerie">
										<xs:annotation>
											<xs:documentation>Srie do documento fiscal</xs:documentation>
											<xs:documentation>Informar a srie do documento fiscal (informar zero para srie nica).</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nNF" type="TNF">
										<xs:annotation>
											<xs:documentation>Nmero do documento fiscal</xs:documentation>
											<xs:documentation>Nmero que identifica o documento fiscal 1 a 999999999.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="cNF">
										<xs:annotation>
											<xs:documentation>Cdigo numrico que compe a Chave de Acesso. </xs:documentation>
											<xs:documentation>Cdigo aleatrio gerado pelo emitente, com o objetivo de evitar acessos indevidos ao documento.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{8}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cDV">
										<xs:annotation>
											<xs:documentation>Digito verificador da chave de acesso</xs:documentation>
											<xs:documentation>Informar o dgito  de controle da chave de acesso documento fiscal, que deve ser calculado com a aplicao do algoritmo mdulo 11 (base 2,9) da chave de acesso. </xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dhEmi" type="TDateTimeUTC">
										<xs:annotation>
											<xs:documentation>Data e hora de emisso do documento fiscal</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DDTHH:MM:DD TZD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpEmis" type="TtpEmis">
										<xs:annotation>
											<xs:documentation>Forma de emisso do Documento Fiscal </xs:documentation>
											<xs:documentation>1 - Normal
; 2 - Contingncia</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nSiteAutoriz">
										<xs:annotation>
											<xs:documentation>Identificao do nmero do Site do Autorizador de recepo da NFCom</xs:documentation>
											<xs:documentation>Se o autorizador da NFCom possuir apenas um site dever ser informado com Zero (0), em caso de Autorizador trabalhar com mltiplos sites indicar o nmero do site para qual foi endereada a NFCOM (1 a 9).

Observao: o ambiente autorizador que trabalhar com mais de um Site dever divulgar para cada endereo de site qual nmero correspondente de nSiteAutoriz o contribuinte pode usar</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cMunFG" type="TCodMunIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo do municpio de ocorrncia do fato gerador</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="finNFCom" type="TFinNFCom">
										<xs:annotation>
											<xs:documentation>Finalidade de emisso da NFCom</xs:documentation>
											<xs:documentation>0- NFCom Normal; 

3 - NFCom de Substituio; 4 - NFCom de Ajuste;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpFat" type="TFatNFCom">
										<xs:annotation>
											<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
											<xs:documentation>0- Faturamento Normal; 1 - Faturamento centralizado; 2 - Cofaturamento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="verProc">
										<xs:annotation>
											<xs:documentation>Verso do processo de emisso</xs:documentation>
											<xs:documentation>Informar a verso do aplicativo emissor de NFCom.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indPrePago" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de servio pr-pago</xs:documentation>
											<xs:documentation>1  Servio pr-pago (informar a tag somente se a nota for referente a um servio exclusivamente pr-pago)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informar apenas
para tpEmis diferente de 1</xs:documentation>
										</xs:annotation>
										<xs:element name="dhCont" type="TDateTimeUTC">
											<xs:annotation>
												<xs:documentation>Data e Hora da entrada em contingncia</xs:documentation>
												<xs:documentation>Informar a data e hora no formato AAAA-MM-DDTHH:MM:SS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="xJust">
											<xs:annotation>
												<xs:documentation>Justificativa da entrada em contingncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="15"/>
													<xs:maxLength value="256"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="emit">
							<xs:annotation>
								<xs:documentation>Identificao do Emitente do documento fiscal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="CNPJ" type="TCnpj">
										<xs:annotation>
											<xs:documentation>CNPJ do emitente</xs:documentation>
											<xs:documentation>Informar zeros no significativos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIe">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IEUFDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual Virtual do emitente na UF de Destino da partilha (IE Virtual)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TIe"/>
										</xs:simpleType>
									</xs:element>
									<xs:element name="CRT" type="TCRT">
										<xs:annotation>
											<xs:documentation>Cdigo do Regime Tributrio</xs:documentation>
											<xs:documentation>Informar: 1=Simples Nacional; 
2=Simples Nacional, excesso sublimite de receita bruta;
3=Regime Normal. 
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="xFant" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nome fantasia do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderEmit" type="TEndeEmi">
										<xs:annotation>
											<xs:documentation>Endereo do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="dest">
							<xs:annotation>
								<xs:documentation>Identificao do destinatrio / assinante </xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do destinatrio</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpjOpc">
											<xs:annotation>
												<xs:documentation>Nmero do CNPJ</xs:documentation>
												<xs:documentation>Em caso de empresa no estabelecida no Brasil, ser informado o CNPJ com zeros.
							Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>Nmero do CPF</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="idOutros">
											<xs:annotation>
												<xs:documentation>Identificao do destinatrio outros</xs:documentation>
												<xs:documentation>Identificao do destinatrio no obrigado a inscrio do CPF tais como estrangeiro, indgena e quilombola;
Em caso de no contar CPF do assinante, informar o RG</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="2"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="([!-]{0}|[!-]{2,20})?"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:choice>
									<xs:element name="indIEDest" type="TIndIEDest">
										<xs:annotation>
											<xs:documentation>Indicador da IE do Destinatrio</xs:documentation>
											<xs:documentation>1 - Contribuinte ICMS (informar a IE do destinatrio); 

2 - Contribuinte isento de Inscrio no cadastro de Contribuintes do ICMS;

 9 - No Contribuinte, que pode ou no possuir Inscrio Estadual no Cadastro de Contribuintes do ICMS. 

Nota: No caso de Contribuinte Isento de Inscrio (indIEDest=2) informar a tag IE do destinatrio com o literal ISENTO.
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIeDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do destinatrio</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IM" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Municipal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="15"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderDest" type="TEndeEmi">
										<xs:annotation>
											<xs:documentation>Endereo do destinatrio / assinante</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="assinante">
							<xs:annotation>
								<xs:documentation>Dados do assinante</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="iCodAssinante">
										<xs:annotation>
											<xs:documentation>Cdigo nico de Identificao do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="15"/>
												<xs:pattern value="([!-]{0}|[!-]{1,15})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="tpAssinante" type="TAssinante">
										<xs:annotation>
											<xs:documentation>Tipo de assinante</xs:documentation>
											<xs:documentation>1-Comercial;
2-Industrial;
3-Residencial/Pessoa Fsica;
4-Produtor Rural;
5-rgo da administrao pblica estadual direta e suas fundaes e autarquias, quando mantidas pelo poder pblico estadual e regidas por normas de direito pblico, nos termos do Convnio ICMS 107/95; 	
6-Prestador de servio de telecomunicao responsvel pelo recolhimento do imposto incidente sobre a cesso dos meios de rede do prestador do servio ao usurio final, nos termos do Convnio ICMS 17/13 ;	
7-Misses Diplomticas, Reparties Consulares e Organismos Internacionais, nos termos do Convnio ICMS 158/94 ;	
8-Igrejas e Templos de qualquer natureza ;
99-Outros no especificados anteriormente 	</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpServUtil" type="TUtilizacao">
										<xs:annotation>
											<xs:documentation>Tipo de servio utilizado</xs:documentation>
											<xs:documentation>1-Telefonia; 2-Comunicao de dados; 3-TV por Assinatura;4 - Provimento de acesso  Internet; 5-Multimdia; 6-Outros; 7-Varios (Combo);</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nContrato">
										<xs:annotation>
											<xs:documentation>Nmero do Contrato do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
												<xs:pattern value="([!-]{0}|[!-]{1,15})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dContratoIni" type="TData">
										<xs:annotation>
											<xs:documentation>Data de incio do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="dContratoFim" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de trmino do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Identifica o terminal principal do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermPrinc">
											<xs:annotation>
												<xs:documentation>Nmero do Terminal Principal do servio contratado</xs:documentation>
												<xs:documentation>Em se tratando de plano de prestao de servio telefnico corporativo, familiar ou similares, informar o nmero do terminal telefnico principal do plano. </xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUF" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
												<xs:documentation> Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
									<xs:sequence minOccurs="0" maxOccurs="unbounded">
										<xs:annotation>
											<xs:documentation>Identifica os terminais adicionais do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermAdic">
											<xs:annotation>
												<xs:documentation>Nmero dos Terminais adicionais do servio contratado</xs:documentation>
												<xs:documentation/>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUF" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:sequence>
							<xs:annotation>
								<xs:documentation>Conjunto de informaes da NFCom </xs:documentation>
							</xs:annotation>
							<xs:element name="gSub" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes da substituio</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFCom" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom original</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary">
																	<xs:minLength value="32"/>
																	<xs:maxLength value="32"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
										<xs:element name="motSub" type="TMotSub">
											<xs:annotation>
												<xs:documentation>Motivo da substituio</xs:documentation>
												<xs:documentation>01  Erro de Preo; 02  Erro Cadastral; 
03  Deciso Judicial
;  04 - Erro de Tributao</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gCofat" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes do Cofaturamento</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="chNFComLocal" type="TChDFe">
											<xs:annotation>
												<xs:documentation>Chave de acesso da NFCom emitida pela Operadora Local</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="det" maxOccurs="990">
								<xs:annotation>
									<xs:documentation>Detalhamento de Produtos e Servios </xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="prod">
											<xs:annotation>
												<xs:documentation>Dados do Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="cProd">
														<xs:annotation>
															<xs:documentation>Cdigo do produto ou servio. </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="60"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xProd">
														<xs:annotation>
															<xs:documentation>Descrio do produto ou servio</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="120"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="cClass">
														<xs:annotation>
															<xs:documentation>Cdigo de classificao</xs:documentation>
															<xs:documentation>Tabela de Classificao de Item da NFCom (validar por RV)</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="7"/>
																<xs:maxLength value="7"/>
																<xs:whiteSpace value="preserve"/>
																<xs:pattern value="[0-9]{7}"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="CFOP" type="TCfop" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CFOP</xs:documentation>
															<xs:documentation>Utilizar Tabela de CFOP. (O CFOP no ser exigido no caso de dedues e cobranas)</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="CNPJLD" type="TCnpj" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CNPJ da operadora LD</xs:documentation>
															<xs:documentation>Informar o CNPJ da operadora LD que ir lanar o item de cofaturamento em nota do tipo 6</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="uMed" type="TUMedItem">
														<xs:annotation>
															<xs:documentation>Unidade Bsica de Medida</xs:documentation>
															<xs:documentation>1=Minuto
; 2=MB; 
3=GB; 
4=UN</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="dExpiracao" type="TData" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Data de expirao de crdito </xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="imposto">
											<xs:annotation>
												<xs:documentation>Tributos incidentes no Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:complexContent>
													<xs:extension base="TImp">
														<xs:sequence>
															<xs:choice>
																<xs:element name="ICMS00">
																	<xs:annotation>
																		<xs:documentation>Prestao sujeito  tributao normal do ICMS</xs:documentation>
																		<xs:documentation>Tributada integralmente</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>classificao Tributria do Servio</xs:documentation>
																					<xs:documentation>00 - tributao normal ICMS</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="00"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:element name="vBC" type="TDec_1302">
																				<xs:annotation>
																					<xs:documentation>Valor da BC do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:element name="pICMS" type="TDec_0302">
																				<xs:annotation>
																					<xs:documentation>Alquota do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:element name="vICMS" type="TDec_1302">
																				<xs:annotation>
																					<xs:documentation>Valor do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequencia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="pFCP" type="TDec_0302a04Opc">
																					<xs:annotation>
																						<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vFCP" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																			</xs:sequence>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
																<xs:element name="ICMS20">
																	<xs:annotation>
																		<xs:documentation>Prestao sujeito  tributao com reduo de BC do ICMS</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>Classificao Tributria do servio</xs:documentation>
																					<xs:documentation>20 - tributao com BC reduzida do ICMS</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="20"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:element name="pRedBC" type="TDec_0302Opc">
																				<xs:annotation>
																					<xs:documentation>Percentual de reduo da BC</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:element name="vBC" type="TDec_1302">
																				<xs:annotation>
																					<xs:documentation>Valor da BC do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:element name="pICMS" type="TDec_0302">
																				<xs:annotation>
																					<xs:documentation>Alquota do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:element name="vICMS" type="TDec_1302">
																				<xs:annotation>
																					<xs:documentation>Valor do ICMS</xs:documentation>
																				</xs:annotation>
																			</xs:element>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequencia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="vICMSDeson" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenef">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
 item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequencia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="pFCP" type="TDec_0302a04Opc">
																					<xs:annotation>
																						<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vFCP" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																			</xs:sequence>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
																<xs:element name="ICMS40">
																	<xs:annotation>
																		<xs:documentation>Tributao Isenta, No tributada</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>Classificao Tributria do servio</xs:documentation>
																					<xs:documentation>40=Isenta; 41=No tributada;
</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="40"/>
																						<xs:enumeration value="41"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequencia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="vICMSDeson" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenef">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
																<xs:element name="ICMS51">
																	<xs:annotation>
																		<xs:documentation>Tributao com Diferimento </xs:documentation>
																		<xs:documentation>A exigncia do preenchimento das informaes do ICMS diferido fica a critrio de cada UF</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>Classificao Tributria do servio</xs:documentation>
																					<xs:documentation>Tributao pelo ICMS 51 - Diferimento</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="51"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequencia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="vICMSDeson" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenef">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
																<xs:element name="ICMS90">
																	<xs:annotation>
																		<xs:documentation>ICMS Outros</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																					<xs:documentation> 90 - ICMS outros</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="90"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:sequence minOccurs="0">
																				<xs:annotation>
																					<xs:documentation>Sequncia XML</xs:documentation>
																				</xs:annotation>
																				<xs:element name="vBC" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor da BC do ICMS</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pICMS" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Alquota do ICMS</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMS" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																			</xs:sequence>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
																<xs:element name="ICMSSN">
																	<xs:annotation>
																		<xs:documentation>Simples Nacional</xs:documentation>
																	</xs:annotation>
																	<xs:complexType>
																		<xs:sequence>
																			<xs:element name="CST">
																				<xs:annotation>
																					<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																					<xs:documentation>90 - Outros SN</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="90"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																			<xs:element name="indSN">
																				<xs:annotation>
																					<xs:documentation>Indica se o contribuinte  Simples Nacional			1=Sim</xs:documentation>
																				</xs:annotation>
																				<xs:simpleType>
																					<xs:restriction base="xs:string">
																						<xs:whiteSpace value="preserve"/>
																						<xs:enumeration value="1"/>
																					</xs:restriction>
																				</xs:simpleType>
																			</xs:element>
																		</xs:sequence>
																	</xs:complexType>
																</xs:element>
															</xs:choice>
															<xs:element name="ICMSUFDest" minOccurs="0" maxOccurs="unbounded">
																<xs:annotation>
																	<xs:documentation>Informaes do ICMS de partilha com a UF destinatria</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBCUFDest" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do ICMS na UF de destino</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFCPUFDest" type="TDec_0302">
																			<xs:annotation>
																				<xs:documentation>Percentual do ICMS relativo ao Fundo de Combate  pobreza (FCP) na UF de destino</xs:documentation>
																				<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pICMSUFDest" type="TDec_0302">
																			<xs:annotation>
																				<xs:documentation>Alquota interna da UF de destino</xs:documentation>
																				<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pICMSInter" type="TDec_0302">
																			<xs:annotation>
																				<xs:documentation>Alquota interestadual das UF envolvidas</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFCPUFDest" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP) da UF de destino</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vICMSUFDest" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do ICMS de partilha para a UF de destino</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vICMSUFEmi" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do ICMS de partilha para a UF de emisso</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																	<xs:attribute name="cUFDest" type="TCodUfIBGE" use="required"/>
																</xs:complexType>
															</xs:element>
															<xs:element name="PIS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do PIS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do PIS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota 07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pPIS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do PIS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vPIS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="COFINS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do COFINS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do COFINS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota erro
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada
</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pCOFINS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do COFINS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vCOFINS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUST" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUST</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUST" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUST (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUST" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUNTTEL" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUNTTEL</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUNTTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUNTTEL" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUNTTEL (em percentual) </xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUNTTEL" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUNTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="retTrib" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes de reteno de tributos federais</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vRetPIS" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCofins" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do COFNS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCSLL" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor da CSLL retida</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vBCIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Base de clculo do IRRF</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do IRRF retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
														</xs:sequence>
													</xs:extension>
												</xs:complexContent>
											</xs:complexType>
										</xs:element>
										<xs:element name="gProcRef" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo Processo referenciado</xs:documentation>
												<xs:documentation>Este grupo somente dever ser preenchido quando houver processo judicial ou administrativo que altere valores.</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
															<xs:documentation>Informar o valor sem a influncia da deciso judicial/administrativa.</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vBC" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor da BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="pICMS" type="TDec_0302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Alquota do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vPIS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do PIS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vCOFINS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do COFINS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="gProc" maxOccurs="10">
														<xs:annotation>
															<xs:documentation>Grupo identificador do Processo</xs:documentation>
														</xs:annotation>
														<xs:complexType>
															<xs:sequence>
																<xs:element name="tpProc" type="TProcesso">
																	<xs:annotation>
																		<xs:documentation>Tipo de Processo</xs:documentation>
																		<xs:documentation>0 - SEFAZ; 1 - Justia Federal; 2 - Justia Estadual</xs:documentation>
																	</xs:annotation>
																</xs:element>
																<xs:element name="nProcesso">
																	<xs:annotation>
																		<xs:documentation>Nmero do Processo</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="TString">
																			<xs:minLength value="1"/>
																			<xs:maxLength value="60"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:sequence>
														</xs:complexType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="gRessarc" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo de Informaes detalhadas de item de cClass de Ressarcimento</xs:documentation>
												<xs:documentation>Este grupo somente dever ser preenchido quando houver processo judicial ou administrativo que altere valores.</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="tpRessarc" type="TRessarcimento">
														<xs:annotation>
															<xs:documentation>Tipo de Ressarcimento</xs:documentation>
															<xs:documentation>1 - Cobrana Indevida
2 - Interrupo
99 - Outros</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="dRef" type="TData">
														<xs:annotation>
															<xs:documentation>Data de referencia</xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="nProcesso" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do Processo</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="nProtReclama" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do protocolo de reclamao</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xObs" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Observaes sobre o processo de ressarcimento</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="15"/>
																<xs:maxLength value="100"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="infAdProd" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Informaes adicionais do produto (norma referenciada, informaes complementares, etc)</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="1"/>
													<xs:maxLength value="500"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:attribute name="nItem" use="required">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,1}|[1-8]{1}[0-9]{2}|[9]{1}[0-8]{1}[0-9]{1}|[9]{1}[9]{1}[0]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="chNFComAnt" type="TChDFe">
										<xs:annotation>
											<xs:documentation>Chave de Acesso da NFCom anterior </xs:documentation>
											<xs:documentation>Informar chave de acesso de referencia anterior</xs:documentation>
										</xs:annotation>
									</xs:attribute>
									<xs:attribute name="nItemAnt" use="optional">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom anterior</xs:documentation>
											<xs:documentation>Informar nro do item da chave de acesso de referencia anterior</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,1}|[1-8]{1}[0-9]{2}|[9]{1}[0-8]{1}[0-9]{1}|[9]{1}[9]{1}[0]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
								</xs:complexType>
							</xs:element>
							<xs:element name="total">
								<xs:annotation>
									<xs:documentation>Dados dos totais da NFCom</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="vProd" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total dos produtos e servios</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="ICMSTot">
											<xs:annotation>
												<xs:documentation>Totais referentes ao ICMS</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vBC" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMSDeson" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS desonerado</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do FCP (Fundo de Combate  Pobreza).</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vCOFINS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do COFINS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vPIS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do PIS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUNTTEL" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUNTTEL</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUST" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUST</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vRetTribTot">
											<xs:annotation>
												<xs:documentation>Total da reteno de tributos federais</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vRetPIS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do PIS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCofins" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do COFNS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCSLL" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor da CSLL retida</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vIRRF" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do IRRF retido</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vDesc" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total do Desconto</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vOutro" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Outras Despesas acessrias</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vNF" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total da NFCom</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gFidelidade" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes do programa de fidelidade do assinante</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="qtdSaldoPts">
											<xs:annotation>
												<xs:documentation> Saldo de pontos do cliente na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefSaldoPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de aferio do saldo de pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="qtdPtsResg">
											<xs:annotation>
												<xs:documentation> Qtd de pontos resgatados na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefResgPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de resgate dos pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:choice>
								<xs:element name="gFat" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes de controle da Fatura</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CompetFat" type="TCompet">
												<xs:annotation>
													<xs:documentation>Ano e ms referncia do faturamento (AAAAMM)</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="dVencFat" type="TData">
												<xs:annotation>
													<xs:documentation>Data de vencimento da fatura</xs:documentation>
													<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:annotation>
													<xs:documentation>Sequencia XML</xs:documentation>
												</xs:annotation>
												<xs:element name="dPerUsoIni" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso inicial</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
												<xs:element name="dPerUsoFim" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso final</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
											</xs:sequence>
											<xs:element name="codBarras">
												<xs:annotation>
													<xs:documentation>Linha digitvel do cdigo de barras</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="48"/>
														<xs:pattern value="[0-9]{1,48}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:choice>
												<xs:element name="codDebAuto">
													<xs:annotation>
														<xs:documentation>Cdigo de autorizao dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="xs:string">
															<xs:whiteSpace value="preserve"/>
															<xs:minLength value="1"/>
															<xs:maxLength value="20"/>
															<xs:pattern value="[0-9]{1,20}"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
												<xs:sequence>
													<xs:element name="codBanco">
														<xs:annotation>
															<xs:documentation>Nmero do banco para dbito em conta</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="3"/>
																<xs:maxLength value="5"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="codAgencia">
														<xs:annotation>
															<xs:documentation>Nmero da agncia bancria para dbito em conta</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="10"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:choice>
											<xs:element name="enderCorresp" type="TEndeEmi" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Endereo de entrega da fatura.</xs:documentation>
													<xs:documentation>Informar se diferente do endereo do destinatrio</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gPIX" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Grupo de informaes do PIX</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="urlQRCodePIX">
															<xs:annotation>
																<xs:documentation>URL do QRCode do PIX que ser apresentado na fatura</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:maxLength value="2000"/>
																	<xs:minLength value="2"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
								<xs:element name="gFatCentral" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes do Faturamento Centralizado</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CNPJ" type="TCnpj">
												<xs:annotation>
													<xs:documentation>CNPJ do Emitente centralizador</xs:documentation>
													<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="cUF" type="TCodUfIBGE">
												<xs:annotation>
													<xs:documentation>Cdigo da UF do emitente centralizador</xs:documentation>
													<xs:documentation>Cdigo da UF do emitente do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
												</xs:annotation>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
							</xs:choice>
						</xs:sequence>
						<xs:element name="autXML" minOccurs="0" maxOccurs="10">
							<xs:annotation>
								<xs:documentation>Autorizados para download do XML do DF-e</xs:documentation>
								<xs:documentation>Informar CNPJ ou CPF. Preencher os zeros no significativos.</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpj">
											<xs:annotation>
												<xs:documentation>CNPJ do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>CPF do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:choice>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="infAdic" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes Adicionais</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:annotation>
										<xs:documentation>Sequencia XML</xs:documentation>
									</xs:annotation>
									<xs:element name="infAdFisco" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informaes adicionais de interesse do Fisco</xs:documentation>
											<xs:documentation>Norma referenciada, informaes complementares, etc</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="2000"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="infCpl" minOccurs="0" maxOccurs="5">
										<xs:annotation>
											<xs:documentation>Informaes complementares de interesse do Contribuinte</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="3000"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gRespTec" type="TRespTec" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes do Responsvel Tcnico pela emisso do DF-e</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="versao" type="TVerNFCom" use="required">
						<xs:annotation>
							<xs:documentation>Verso do leiaute</xs:documentation>
						</xs:annotation>
					</xs:attribute>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da tag a ser assinada</xs:documentation>
							<xs:documentation>Informar a chave de acesso da NFCom e precedida do literal "NFCom"</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="NFCom[0-9]{44}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
				<xs:unique name="pk_nItem">
					<xs:selector xpath="./*"/>
					<xs:field xpath="@nItem"/>
				</xs:unique>
			</xs:element>
			<xs:element name="infNFComSupl">
				<xs:annotation>
					<xs:documentation>Informaes suplementares da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qrCodNFCom">
							<xs:annotation>
								<xs:documentation>Texto com o QR-Code para consulta da NFCom</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:minLength value="50"/>
									<xs:maxLength value="1000"/>
									<xs:pattern value="((HTTPS?|https?)://.*\?chNFCom=[0-9]{44}&amp;tpAmb=[1-2](&amp;sign=[!-]{1}[ -]{0,}[!-]{1}|[!-]{1})?)"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Concesso de Autorizao de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="idLote" type="TIdLote"/>
			<xs:element name="NFCom" type="TNFCom" maxOccurs="50"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TEndeEmi">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf_sem_EX">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndereco">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="255"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE), informar 9999999 para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio, informar EXTERIOR para operaes com o exterior.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP" minOccurs="0">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar os zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF, informar EX para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TProtNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Protocolo de status resultado do processamento da NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infProt">
				<xs:annotation>
					<xs:documentation>Dados do protocolo de status</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de acesso da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora de processamento, no formato AAAA-MM-DDTHH:MM:SS TZD.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do Protocolo de Status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="digVal" type="ds:DigestValueType" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Digest Value da NFCom processado. Utilizado para conferir a integridade da NFCom original.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da NFCom.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" type="xs:ID" use="optional"/>
				</xs:complexType>
			</xs:element>
			<xs:element name="infFisco" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Mensagem do Fisco</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cMsg">
							<xs:annotation>
								<xs:documentation>Cdigo do status da mensagem do fisco</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMsg" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Mensagem do Fisco</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do Pedido de Autorizao de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" type="TProtNFCom" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Reposta ao processamento da NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do recibo de envio do lote de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="infRec" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Dados do Recibo do Lote</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="nRec" type="TRec">
							<xs:annotation>
								<xs:documentation>Nmero do Recibo</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora do recebimento, no formato AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tMed">
							<xs:annotation>
								<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:integer">
									<xs:pattern value="[0-9]{1,4}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TImp">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Imposto NFCom</xs:documentation>
		</xs:annotation>
	</xs:complexType>
	<xs:complexType name="TEmpresaSoft">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Empresa de Software</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:choice>
				<xs:element name="CNPJ" type="TCnpj">
					<xs:annotation>
						<xs:documentation>CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="CPF" type="TCpf">
					<xs:annotation>
						<xs:documentation>CPF da pessoa fsica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>No caso de pessoa fsica, informar o CPF do desenvolvedor do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica/fsica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica/fsica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRespTec">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Responsvel Tcnico</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CNPJ" type="TCnpj">
				<xs:annotation>
					<xs:documentation>CNPJ da pessoa jurdica responsvel tcnica pelo sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
					<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:sequence minOccurs="0">
				<xs:annotation>
					<xs:documentation>Sequencia XML</xs:documentation>
				</xs:annotation>
				<xs:element name="idCSRT">
					<xs:annotation>
						<xs:documentation>Identificador do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>Identificador do CSRT utilizado para gerao do hash</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:pattern value="[0-9]{3}"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="hashCSRT">
					<xs:annotation>
						<xs:documentation>Hash do token do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>O hashCSRT  o resultado das funes SHA-1 e base64 do token CSRT fornecido pelo fisco + chave de acesso do DF-e. (Implementao em futura NT)

Observao: 28 caracteres so representados no schema como 20 bytes do tipo base64Binary</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:base64Binary">
							<xs:length value="20"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="TProcEmi">
		<xs:annotation>
			<xs:documentation>Tipo processo de emisso do NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAssinante">
		<xs:annotation>
			<xs:documentation>Tipo assinante</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value="8"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIdLote">
		<xs:annotation>
			<xs:documentation>Tipo Identificador de controle do envio do lote. Nmero seqencial auto-incremental, de controle correspondente ao identificador nico do lote enviado. A responsabilidade de gerar e controlar esse nmero  do prprio contribuinte.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUMedItem">
		<xs:annotation>
			<xs:documentation>Tipo da unidade bsica de medida</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTime">
		<xs:annotation>
			<xs:documentation> Tipo hora</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-1][0-9])|([2][0-3])):([0-5][0-9]):([0-5][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEmail">
		<xs:annotation>
			<xs:documentation>Tipo Email</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="60"/>
			<xs:pattern value="[^@]+@[^\.]+\..+"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFinNFCom">
		<xs:annotation>
			<xs:documentation>Finalidade da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFatNFCom">
		<xs:annotation>
			<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDoc">
		<xs:annotation>
			<xs:documentation>Tipo de Documento de Identificao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCfop">
		<xs:annotation>
			<xs:documentation>Tipo CFOP</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[123567][0-9]([0-9][1-9]|[1-9][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIndIEDest">
		<xs:annotation>
			<xs:documentation>Tipo indicador da IE do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="9"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCRT">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo Regime Tributrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TtpEmis">
		<xs:annotation>
			<xs:documentation>Tipo de emisso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUtilizacao">
		<xs:annotation>
			<xs:documentation>Tipo utilizacao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value=""/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompet">
		<xs:annotation>
			<xs:documentation>Tipo Competncia</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="6"/>
			<xs:maxLength value="6"/>
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFPapel">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NF papel</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotSub">
		<xs:annotation>
			<xs:documentation>Tipo Motivo Substituio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="01"/>
			<xs:enumeration value="02"/>
			<xs:enumeration value="03"/>
			<xs:enumeration value="04"/>
			<xs:enumeration value="05"/>
			<xs:enumeration value="06"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt_v2">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotAjuste">
		<xs:annotation>
			<xs:documentation>Tipo do Motivo de Ajuste</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTarifa">
		<xs:annotation>
			<xs:documentation>Tipo de tarifa de aplicao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProcesso">
		<xs:annotation>
			<xs:documentation>Tipo de processo judicial</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRessarcimento">
		<xs:annotation>
			<xs:documentation>Tipo de Ressarcimento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompFat">
		<xs:annotation>
			<xs:documentation>Tipo componente da fatura</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/procEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="procEventoNFCom" type="TProcEvento">
		<xs:annotation>
			<xs:documentation>Pedido de Registro de Evento de NFCom processado</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/procNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="nfcomProc">
		<xs:annotation>
			<xs:documentation>NFCom processada</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="NFCom" type="TNFCom"/>
				<xs:element name="protNFCom" type="TProtNFCom"/>
			</xs:sequence>
			<xs:attribute name="versao" type="TVerNFCom" use="required"/>
			<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
				<xs:annotation>
					<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
				</xs:annotation>
			</xs:attribute>
			<xs:attribute name="nPortaCon" use="optional">
				<xs:annotation>
					<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:pattern value="[0-9]{1,5}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:attribute>
			<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
				<xs:annotation>
					<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
				</xs:annotation>
			</xs:attribute>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retConsReciNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consReciNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsReciNFCom" type="TRetConsReciNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do Pedido de Consulta da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retConsSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsSitNFCom" type="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno da consulta da situao atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retConsStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsStatServNFCom" type="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Resultado da Consulta do Status do Servio de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retEnviNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="retEnviNFCom" type="TRetEnviNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do recibo de envio do lote de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retEventoNFCom" type="TRetEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno Pedido de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/retNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="retNFCom" type="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/tiposGeralNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:simpleType name="TDateTimeUTC">
		<xs:annotation>
			<xs:documentation>Data e Hora, formato UTC (AAAA-MM-DDThh:mm:ssTZD, onde TZD = +hh:mm ou -hh:mm)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(((20(([02468][048])|([13579][26]))-02-29))|(20[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))T(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d([\-,\+](0[0-9]|10|11):00|([\+](12):00))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodMunIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo do Municpio da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{7}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCOrgaoIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo de orgo (UF da tabela do IBGE + 90 SUFRAMA + 91 RFB + 92 BRId)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="90"/>
			<xs:enumeration value="91"/>
			<xs:enumeration value="92"/>
			<xs:enumeration value="93"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE_EX">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE + 99 para Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TChDFe">
		<xs:annotation>
			<xs:documentation>Tipo Chave de Documento Fiscal Eletrnico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:maxLength value="44"/>
			<xs:pattern value="[0-9]{44}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSegCodBarra">
		<xs:annotation>
			<xs:documentation>Tipo Segundo Codigo Barra</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{36}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProt">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Protocolo de Status</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRec">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Recibo do envio de lote de DF-e</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TStat">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da Mensagem enviada</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpj">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ tamanho varavel (3-14)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjOpc">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ Opcional</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0}|[0-9]{14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpf">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpfVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF de tamanho varivel (3-11)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais usado em tags opcionais </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 ou 5 dgitos, sendo 3 inteiros e 3 ou 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,3}(\.[0-9]{2,3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros e 2 at 4 decimais. Utilizados em TAGs opcionais, no aceita valor zero.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Max100">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 3 inteiros (no mximo 100), com at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0(\.[0-9]{2,4})?|[1-9]{1}[0-9]{0,1}(\.[0-9]{2,4})?|100(\.0{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0402_0408">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  4 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0503">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 8 dgitos, sendo 5 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,4}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1100_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  11 dgitos inteiros e 0 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,11}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1306">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 6 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1308">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 13 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1304">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIeDest">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0,14}|ISENTO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="62"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIe">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Emitente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNF">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Documento Fiscal</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[1-9]{1}[0-9]{0,8}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSerie">
		<xs:annotation>
			<xs:documentation>Tipo Srie do Documento Fiscal </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|[1-9]{1}[0-9]{0,2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
			<xs:enumeration value="EX"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf_sem_EX">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF - Sem Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAmb">
		<xs:annotation>
			<xs:documentation>Tipo Ambiente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerAplic">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Aplicativo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="20"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotivo">
		<xs:annotation>
			<xs:documentation>Tipo Motivo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TJust">
		<xs:annotation>
			<xs:documentation>Tipo Justificativa</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="15"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TServ">
		<xs:annotation>
			<xs:documentation>Tipo Servio solicitado</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString"/>
	</xs:simpleType>
	<xs:simpleType name="Tano">
		<xs:annotation>
			<xs:documentation> Tipo ano</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMed">
		<xs:annotation>
			<xs:documentation> Tipo temp mdio em segundos</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TString">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TData">
		<xs:annotation>
			<xs:documentation> Tipo data AAAA-MM-DD</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="((((20|19|18)(([02468][048])|([13579][26]))-02-29))|((20|19|18)[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLatitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Latitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-8][0-9]\.[0-9]{6}|90\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-8][0-9]\.[0-9]{6}|-90\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLongitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Longitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-9][0-9]\.[0-9]{6}|1[0-7][0-9]\.[0-9]{6}|180\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-9][0-9]\.[0-9]{6}|-1[0-7][0-9]\.[0-9]{6}|-180\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNSU">
		<xs:annotation>
			<xs:documentation> Tipo nmero sequencial nico do AN</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIPv4">
		<xs:annotation>
			<xs:documentation>Tipo IP verso 4</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00/xmldsig-core-schema_v1.01.xsd">
<?xml version="1.0" encoding="utf-8"?>
<!-- ***************************************************-->
<!-- ***   Schema especfico para assinaturas XML    ***-->
<!-- *** a partir de certificados do padro (X509)   ***-->
<!-- *** ICP-Brasil - Projeto Nota Fiscal Eletrnica ***-->
<!-- ***************************************************-->
<!-- Schema for XML Signatures-->
<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.w3.org/2000/09/xmldsig#" elementFormDefault="qualified" attributeFormDefault="unqualified" version="0.1">
	<element name="Signature" type="ds:SignatureType"/>
	<complexType name="SignatureType">
		<sequence>
			<element name="SignedInfo" type="ds:SignedInfoType"/>
			<element name="SignatureValue" type="ds:SignatureValueType"/>
			<element name="KeyInfo" type="ds:KeyInfoType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="SignatureValueType">
		<simpleContent>
			<extension base="base64Binary">
				<attribute name="Id" type="ID" use="optional"/>
			</extension>
		</simpleContent>
	</complexType>
	<complexType name="SignedInfoType">
		<sequence>
			<element name="CanonicalizationMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				</complexType>
			</element>
			<element name="SignatureMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				</complexType>
			</element>
			<element name="Reference" type="ds:ReferenceType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="ReferenceType">
		<sequence>
			<element name="Transforms" type="ds:TransformsType">
				<!-- Garante a unicidade do atributo -->
				<unique name="unique_Transf_Alg">
					<selector xpath="./*"/>
					<field xpath="@Algorithm"/>
				</unique>
			</element>
			<element name="DigestMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#sha1"/>
				</complexType>
			</element>
			<element name="DigestValue" type="ds:DigestValueType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
		<attribute name="URI" use="required">
			<simpleType>
				<restriction base="anyURI">
					<minLength value="2"/>
				</restriction>
			</simpleType>
		</attribute>
		<attribute name="Type" type="anyURI" use="optional"/>
	</complexType>
	<complexType name="TransformsType">
		<sequence>
			<element name="Transform" type="ds:TransformType" minOccurs="2" maxOccurs="2"/>
		</sequence>
	</complexType>
	<complexType name="TransformType">
		<sequence minOccurs="0" maxOccurs="unbounded">
			<element name="XPath" type="string"/>
		</sequence>
		<attribute name="Algorithm" type="ds:TTransformURI" use="required"/>
	</complexType>
	<complexType name="KeyInfoType">
		<sequence>
			<element name="X509Data" type="ds:X509DataType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="X509DataType">
		<sequence>
			<element name="X509Certificate" type="base64Binary"/>
		</sequence>
	</complexType>
	<simpleType name="DigestValueType">
		<restriction base="base64Binary"/>
	</simpleType>
	<simpleType name="TTransformURI">
		<restriction base="anyURI">
			<enumeration value="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
			<enumeration value="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
		</restriction>
	</simpleType>
</schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/consSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consSitNFCom" type="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema de validao XML dp Pedido de Consulta da Situao Atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/consSitNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:complexType name="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta da Situao Atual da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo; 
2 - Homologao;</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="CONSULTAR">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="chNFCom" type="TChDFe">
				<xs:annotation>
					<xs:documentation>Chaves de acesso do NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno de Pedido de Consulta da Situao Atual de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou o NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>cdigo da UF de atendimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" minOccurs="0">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar protNFCom da verso correspondente da NFCom autorizada</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element name="procEventoNFCom" minOccurs="0" maxOccurs="unbounded">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar procEventoNFCom da verso correspondente do evento NFCom autorizado</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsSitNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta situao de NFCom - 1.00</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/consStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consStatServNFCom" type="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/consStatServNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="STATUS">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Resultado da Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TVerAplic">
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo da UF responsvel pelo servio</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="dhRecbto" type="TDateTimeUTC">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tMed" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:integer">
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="dhRetorno" type="TDateTimeUTC" minOccurs="0">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD. Deve ser preenchida com data e hora previstas para o retorno dos servios prestados.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xObs" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Campo observao utilizado para incluir informaes ao contribuinte</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:minLength value="1"/>
						<xs:maxLength value="255"/>
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsStat">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/evCancNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="evCancNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do evento do cancelamento 
110111</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="descEvento">
					<xs:annotation>
						<xs:documentation>Descrio do Evento - Cancelamento</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:whiteSpace value="preserve"/>
							<xs:enumeration value="Cancelamento"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="nProt" type="TProt">
					<xs:annotation>
						<xs:documentation>Nmero do Protocolo de Status da NFCom</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="xJust" type="TJust">
					<xs:annotation>
						<xs:documentation>Justificativa do Cancelamento</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/eventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="eventoNFCom" type="TEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Registro de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/eventoNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TEvento">
		<xs:annotation>
			<xs:documentation>Tipo Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="CNPJ" type="TCnpj">
							<xs:annotation>
								<xs:documentation>CNPJ do emissor do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de Acesso da NFCom vinculada ao evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhEvento" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e Hora do Evento, formato UTC (AAAA-MM-DDThh:mm:ssTZD)</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento">
							<xs:annotation>
								<xs:documentation>Tipo do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento">
							<xs:annotation>
								<xs:documentation>Seqencial do evento para o mesmo tipo de evento.  Para maioria dos eventos ser 1, nos casos em que possa existir mais de um evento o autor do evento deve numerar de forma seqencial.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="detEvento">
							<xs:annotation>
								<xs:documentation>Detalhamento do evento especfico</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:any processContents="skip">
										<xs:annotation>
											<xs:documentation>XML do evento
Insira neste local o XML especfico do tipo de evento (cancelamento, encerramento, registro de passagem).  </xs:documentation>
										</xs:annotation>
									</xs:any>
								</xs:sequence>
								<xs:attribute name="versaoEvento" use="required">
									<xs:simpleType>
										<xs:restriction base="xs:string">
											<xs:whiteSpace value="preserve"/>
											<xs:pattern value="1\.(0[0-9]|[1-9][0-9])"/>
										</xs:restriction>
									</xs:simpleType>
								</xs:attribute>
							</xs:complexType>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da TAG a ser assinada, a regra de formao do Id :
ID + tpEvento +  chave da NF-3e + nSeqEvento (preencher com zeros a esquerda para compor 3 digitos)</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{53}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEvento">
		<xs:annotation>
			<xs:documentation>Tipo retorno do Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que recebeu o Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento. Utilizar a Tabela do IBGE extendida, utilizar 90 para identificar SUFRAMA</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat" type="TStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status do registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Chave de Acesso NFCom vinculada</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Tipo do Evento vinculado</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Descrio do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TString">
									<xs:minLength value="4"/>
									<xs:maxLength value="60"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Seqencial do evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="dhRegEvento" type="TDateTimeUTC" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Data e Hora de do recebimento do evento ou do registro do evento formato AAAA-MM-DDThh:mm:ssTZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do protocolo de registro do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="optional">
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{16}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" use="required">
			<xs:simpleType>
				<xs:restriction base="TVerEvento"/>
			</xs:simpleType>
		</xs:attribute>
	</xs:complexType>
	<xs:complexType name="TProcEvento">
		<xs:annotation>
			<xs:documentation>Tipo procEvento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="eventoNFCom" type="TEvento"/>
			<xs:element name="retEventoNFCom" type="TRetEvento"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
		<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
			<xs:annotation>
				<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
			</xs:annotation>
		</xs:attribute>
		<xs:attribute name="nPortaCon" use="optional">
			<xs:annotation>
				<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
			</xs:annotation>
			<xs:simpleType>
				<xs:restriction base="xs:string">
					<xs:pattern value="[0-9]{1,5}"/>
				</xs:restriction>
			</xs:simpleType>
		</xs:attribute>
		<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
			<xs:annotation>
				<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
			</xs:annotation>
		</xs:attribute>
	</xs:complexType>
	<xs:simpleType name="TVerEvento">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Evento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/nfcom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="NFCom" type="TNFCom">
		<xs:annotation>
			<xs:documentation>Nota Fiscal Fatura de Comunicao Eletrnica</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/nfcomTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2014 rel. 2 (http://www.altova.com) by private (private) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Nota Fiscal Fatura de Comunicao</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infNFCom">
				<xs:annotation>
					<xs:documentation>Informaes da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="ide">
							<xs:annotation>
								<xs:documentation>Identificao da NFCom</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="cUF" type="TCodUfIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo da UF de emisso e autorizao da NFCom</xs:documentation>
											<xs:documentation>Cdigo da UF de emisso e autorizao do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpAmb" type="TAmb">
										<xs:annotation>
											<xs:documentation>Tipo do Ambiente</xs:documentation>
											<xs:documentation>1 - Produo; 
2 - Homologao</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="mod" type="TModNFCom">
										<xs:annotation>
											<xs:documentation>Modelo da NFCom</xs:documentation>
											<xs:documentation>Utilizar o cdigo 62 para identificao da NFCom</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="serie" type="TSerie">
										<xs:annotation>
											<xs:documentation>Srie do documento fiscal</xs:documentation>
											<xs:documentation>Informar a srie do documento fiscal (informar zero para srie nica).</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nNF" type="TNF">
										<xs:annotation>
											<xs:documentation>Nmero do documento fiscal</xs:documentation>
											<xs:documentation>Nmero que identifica o documento fiscal 1 a 999999999.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="cNF">
										<xs:annotation>
											<xs:documentation>Cdigo numrico que compe a Chave de Acesso. </xs:documentation>
											<xs:documentation>Cdigo aleatrio gerado pelo emitente, com o objetivo de evitar acessos indevidos ao documento.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{7}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cDV">
										<xs:annotation>
											<xs:documentation>Digito verificador da chave de acesso</xs:documentation>
											<xs:documentation>Informar o dgito  de controle da chave de acesso documento fiscal, que deve ser calculado com a aplicao do algoritmo mdulo 11 (base 2,9) da chave de acesso. </xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dhEmi" type="TDateTimeUTC">
										<xs:annotation>
											<xs:documentation>Data e hora de emisso do documento fiscal</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DDTHH:MM:DD TZD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpEmis" type="TtpEmis">
										<xs:annotation>
											<xs:documentation>Forma de emisso do Documento Fiscal </xs:documentation>
											<xs:documentation>1 - Normal
; 2 - Contingncia</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nSiteAutoriz">
										<xs:annotation>
											<xs:documentation>Identificao do nmero do Site do Autorizador de recepo da NFCom</xs:documentation>
											<xs:documentation>Se o autorizador da NFCom possuir apenas um site dever ser informado com Zero (0), em caso de Autorizador trabalhar com mltiplos sites indicar o nmero do site para qual foi endereada a NFCOM (1 a 9).

Observao: o ambiente autorizador que trabalhar com mais de um Site dever divulgar para cada endereo de site qual nmero correspondente de nSiteAutoriz o contribuinte pode usar</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cMunFG" type="TCodMunIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo do municpio de ocorrncia do fato gerador</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="finNFCom" type="TFinNFCom">
										<xs:annotation>
											<xs:documentation>Finalidade de emisso da NFCom</xs:documentation>
											<xs:documentation>0- NFCom Normal; 
3 - NFCom de Substituio; 
4 - NFCom de Ajuste;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpFat" type="TFatNFCom">
										<xs:annotation>
											<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
											<xs:documentation>0- Faturamento Normal; 1 - Faturamento centralizado; 2 - Cofaturamento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="verProc">
										<xs:annotation>
											<xs:documentation>Verso do processo de emisso</xs:documentation>
											<xs:documentation>Informar a verso do aplicativo emissor de NFCom.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indPrePago" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de servio pr-pago</xs:documentation>
											<xs:documentation>1  Servio pr-pago (informar a tag somente se a nota for referente a um servio exclusivamente pr-pago)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indCessaoMeiosRede" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de Sesso de Meios de Rede.</xs:documentation>
											<xs:documentation>Uma vez informado (valor = 1), essa tag dispensa gerao do grupo Fatura.
Apenas para notas dos tipos Normal e Substituio com tipo de faturamento normal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indNotaEntrada" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de nota de entrada</xs:documentation>
											<xs:documentation>1  Informar quando for nota de ajuste e possuir itens com CFOP de entrada</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informar apenas
para tpEmis diferente de 1</xs:documentation>
										</xs:annotation>
										<xs:element name="dhCont" type="TDateTimeUTC">
											<xs:annotation>
												<xs:documentation>Data e Hora da entrada em contingncia</xs:documentation>
												<xs:documentation>Informar a data e hora no formato AAAA-MM-DDTHH:MM:SS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="xJust">
											<xs:annotation>
												<xs:documentation>Justificativa da entrada em contingncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="15"/>
													<xs:maxLength value="256"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="emit">
							<xs:annotation>
								<xs:documentation>Identificao do Emitente do documento fiscal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="CNPJ" type="TCnpj">
										<xs:annotation>
											<xs:documentation>CNPJ do emitente</xs:documentation>
											<xs:documentation>Informar zeros no significativos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIe">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IEUFDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual Virtual do emitente na UF de Destino da partilha (IE Virtual)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TIe"/>
										</xs:simpleType>
									</xs:element>
									<xs:element name="CRT" type="TCRT">
										<xs:annotation>
											<xs:documentation>Cdigo do Regime Tributrio</xs:documentation>
											<xs:documentation>Informar: 1=Simples Nacional; 
2=Simples Nacional, excesso sublimite de receita bruta;
3=Regime Normal. 
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="xFant" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nome fantasia do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderEmit" type="TEndeEmi">
										<xs:annotation>
											<xs:documentation>Endereo do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="dest">
							<xs:annotation>
								<xs:documentation>Identificao do destinatrio / assinante </xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do destinatrio</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpjOpc">
											<xs:annotation>
												<xs:documentation>Nmero do CNPJ</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>Nmero do CPF</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="idOutros">
											<xs:annotation>
												<xs:documentation>Identificao do destinatrio outros</xs:documentation>
												<xs:documentation>Identificao do destinatrio no obrigado a inscrio do CPF tais como estrangeiro, indgena e quilombola;
Em caso de no contar CPF do assinante, informar o RG</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="2"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="([!-]{0}|[!-]{2,20})?"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:choice>
									<xs:element name="indIEDest" type="TIndIEDest">
										<xs:annotation>
											<xs:documentation>Indicador da IE do Destinatrio</xs:documentation>
											<xs:documentation>1 - Contribuinte ICMS (informar a IE do destinatrio); 

2 - Contribuinte isento de Inscrio no cadastro de Contribuintes do ICMS;

 9 - No Contribuinte, que pode ou no possuir Inscrio Estadual no Cadastro de Contribuintes do ICMS. 

Nota: No caso de Contribuinte Isento de Inscrio (indIEDest=2) informar a tag IE do destinatrio com o literal ISENTO.
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIeDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do destinatrio</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IM" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Municipal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="15"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderDest" type="TEndeDest">
										<xs:annotation>
											<xs:documentation>Endereo do destinatrio / assinante</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="assinante">
							<xs:annotation>
								<xs:documentation>Dados do assinante</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="iCodAssinante">
										<xs:annotation>
											<xs:documentation>Cdigo nico de Identificao do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="30"/>
												<xs:pattern value="([!-]{0}|[!-]{1,30})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="tpAssinante" type="TAssinante">
										<xs:annotation>
											<xs:documentation>Tipo de assinante</xs:documentation>
											<xs:documentation>1-Comercial;
2-Industrial;
3-Residencial/Pessoa Fsica;
4-Produtor Rural;
5-rgo da administrao pblica estadual direta e suas fundaes e autarquias, quando mantidas pelo poder pblico estadual e regidas por normas de direito pblico, nos termos do Convnio ICMS 107/95; 	
6-Prestador de servio de telecomunicao responsvel pelo recolhimento do imposto incidente sobre a cesso dos meios de rede do prestador do servio ao usurio final, nos termos do Convnio ICMS 17/13 ;	
7-Misses Diplomticas, Reparties Consulares e Organismos Internacionais, nos termos do Convnio ICMS 158/94 ;	
8-Igrejas e Templos de qualquer natureza ;
99-Outros no especificados anteriormente 	</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpServUtil" type="TUtilizacao">
										<xs:annotation>
											<xs:documentation>Tipo de servio utilizado</xs:documentation>
											<xs:documentation>1-Telefonia; 2-Comunicao de dados; 3-TV por Assinatura;4 - Provimento de acesso  Internet; 5-Multimdia; 6-Outros; 7-Varios;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nContrato" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nmero do Contrato do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
												<xs:pattern value="([!-]{0}|[!-]{1,15})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dContratoIni" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de incio do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="dContratoFim" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de trmino do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Identifica o terminal principal do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermPrinc">
											<xs:annotation>
												<xs:documentation>Nmero do Terminal Principal do servio contratado</xs:documentation>
												<xs:documentation>Em se tratando de plano de prestao de servio telefnico corporativo, familiar ou similares, informar o nmero do terminal telefnico principal do plano. </xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFPrinc" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
												<xs:documentation> Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
									<xs:sequence minOccurs="0" maxOccurs="unbounded">
										<xs:annotation>
											<xs:documentation>Identifica os terminais adicionais do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermAdic">
											<xs:annotation>
												<xs:documentation>Nmero dos Terminais adicionais do servio contratado</xs:documentation>
												<xs:documentation/>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFAdic" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:sequence>
							<xs:annotation>
								<xs:documentation>Conjunto de informaes da NFCom </xs:documentation>
							</xs:annotation>
							<xs:element name="gSub" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes da substituio</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFCom" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom original</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary">
																	<xs:minLength value="32"/>
																	<xs:maxLength value="32"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
										<xs:element name="motSub" type="TMotSub">
											<xs:annotation>
												<xs:documentation>Motivo da substituio</xs:documentation>
												<xs:documentation>01  Erro de Preo
02  Erro Cadastral
03  Deciso Judicial
04 - Erro de Tributao
05 - Descontinuidade do Servio</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gCofat" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes do Cofaturamento</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="chNFComLocal" type="TChDFe">
											<xs:annotation>
												<xs:documentation>Chave de acesso da NFCom emitida pela Operadora Local</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="det" maxOccurs="9990">
								<xs:annotation>
									<xs:documentation>Detalhamento de Produtos e Servios </xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="prod">
											<xs:annotation>
												<xs:documentation>Dados do Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="cProd">
														<xs:annotation>
															<xs:documentation>Cdigo do produto ou servio. </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="60"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xProd">
														<xs:annotation>
															<xs:documentation>Descrio do produto ou servio</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="120"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="cClass">
														<xs:annotation>
															<xs:documentation>Cdigo de classificao</xs:documentation>
															<xs:documentation>Tabela de Classificao de Item da NFCom (validar por RV)</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="7"/>
																<xs:maxLength value="7"/>
																<xs:whiteSpace value="preserve"/>
																<xs:pattern value="[0-9]{7}"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="CFOP" type="TCfop" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CFOP</xs:documentation>
															<xs:documentation>Utilizar Tabela de CFOP. </xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="CNPJLD" type="TCnpj" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CNPJ da operadora LD</xs:documentation>
															<xs:documentation>Informar o CNPJ da operadora LD que ir lanar o item de cofaturamento em nota do tipo faturamento 2</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="uMed" type="TUMedItem">
														<xs:annotation>
															<xs:documentation>Unidade Bsica de Medida</xs:documentation>
															<xs:documentation>1=Minuto
; 2=MB; 
3=GB; 
4=UN</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="dExpiracao" type="TData" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Data de expirao de crdito </xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="imposto">
											<xs:annotation>
												<xs:documentation>Tributos incidentes no Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:complexContent>
													<xs:extension base="TImp">
														<xs:sequence>
															<xs:choice>
																<xs:sequence>
																	<xs:choice>
																		<xs:element name="ICMS00">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao normal do ICMS</xs:documentation>
																				<xs:documentation>Tributada integralmente</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>00 - tributao normal ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="00"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS20">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao com reduo de BC do ICMS</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>20 - tributao com BC reduzida do ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="20"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="pRedBC" type="TDec_0302Opc">
																						<xs:annotation>
																							<xs:documentation>Percentual de reduo da BC</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
 item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS40">
																			<xs:annotation>
																				<xs:documentation>Tributao Isenta, No tributada</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>40=Isenta; 41=No tributada;
</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="40"/>
																								<xs:enumeration value="41"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS51">
																			<xs:annotation>
																				<xs:documentation>Tributao com Diferimento </xs:documentation>
																				<xs:documentation>A exigncia do preenchimento das informaes do ICMS diferido fica a critrio de cada UF</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>Tributao pelo ICMS 51 - Diferimento</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="51"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS90">
																			<xs:annotation>
																				<xs:documentation>ICMS Outros</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation> 90 - ICMS outros</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequncia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vBC" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor da BC do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="pICMS" type="TDec_0302">
																							<xs:annotation>
																								<xs:documentation>Alquota do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vICMS" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMSSN">
																			<xs:annotation>
																				<xs:documentation>Simples Nacional</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>90 - Outros SN</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="indSN">
																						<xs:annotation>
																							<xs:documentation>Indica se o contribuinte  Simples Nacional			1=Sim</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="1"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																	</xs:choice>
																	<xs:element name="ICMSUFDest" minOccurs="0" maxOccurs="unbounded">
																		<xs:annotation>
																			<xs:documentation>Informaes do ICMS de partilha com a UF destinatria</xs:documentation>
																		</xs:annotation>
																		<xs:complexType>
																			<xs:sequence>
																				<xs:element name="vBCUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor da BC do ICMS na UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pFCPUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Percentual do ICMS relativo ao Fundo de Combate  pobreza (FCP) na UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pICMSUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Alquota interna da UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vFCPUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP) da UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFEmi" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de emisso</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenefUFDest" minOccurs="0">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF destino aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																			<xs:attribute name="cUFDest" type="TCodUfIBGE" use="required"/>
																		</xs:complexType>
																	</xs:element>
																</xs:sequence>
																<xs:element name="indSemCST">
																	<xs:annotation>
																		<xs:documentation>Sem Situao Tributria para o ICMS</xs:documentation>
																		<xs:documentation>Informar para itens que no tenham nenhuma relao com o ICMS.
Quando informado o item NO PODE ter CFOP informado

Se informado esse grupo o schema no permite informar nenhum dos grupos de ICMSXX</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="xs:string">
																			<xs:whiteSpace value="preserve"/>
																			<xs:enumeration value="1"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:choice>
															<xs:element name="PIS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do PIS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do PIS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pPIS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do PIS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vPIS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="COFINS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do COFINS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do COFINS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada
</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pCOFINS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do COFINS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vCOFINS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUST" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUST</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUST" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUST (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUST" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUNTTEL" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUNTTEL</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUNTTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUNTTEL" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUNTTEL (em percentual) </xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUNTTEL" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUNTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="retTrib" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes de reteno de tributos federais</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vRetPIS" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCofins" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do COFNS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCSLL" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor da CSLL retida</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vBCIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Base de clculo do IRRF</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do IRRF retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
														</xs:sequence>
													</xs:extension>
												</xs:complexContent>
											</xs:complexType>
										</xs:element>
										<xs:element name="gProcRef" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo Processo referenciado</xs:documentation>
												<xs:documentation>Este grupo somente dever ser preenchido quando houver processo judicial ou administrativo que altere valores.</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
															<xs:documentation>Informar o valor sem a influncia da deciso judicial/administrativa.</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vBC" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor da BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="pICMS" type="TDec_0302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Alquota do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vPIS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do PIS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vCOFINS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do COFINS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Fundo de Combate  Pobreza (FCP).</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="gProc" maxOccurs="10">
														<xs:annotation>
															<xs:documentation>Grupo identificador do Processo</xs:documentation>
														</xs:annotation>
														<xs:complexType>
															<xs:sequence>
																<xs:element name="tpProc" type="TProcesso">
																	<xs:annotation>
																		<xs:documentation>Tipo de Processo</xs:documentation>
																		<xs:documentation>0 - SEFAZ; 1 - Justia Federal; 2 - Justia Estadual</xs:documentation>
																	</xs:annotation>
																</xs:element>
																<xs:element name="nProcesso">
																	<xs:annotation>
																		<xs:documentation>Nmero do Processo</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="TString">
																			<xs:minLength value="1"/>
																			<xs:maxLength value="60"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:sequence>
														</xs:complexType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="gRessarc" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo de Informaes detalhadas de item de cClass de Ressarcimento</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="tpRessarc" type="TRessarcimento">
														<xs:annotation>
															<xs:documentation>Tipo de Ressarcimento</xs:documentation>
															<xs:documentation>1 - Cobrana Indevida
2 - Interrupo
99 - Outros</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="dRef" type="TData">
														<xs:annotation>
															<xs:documentation>Data de referencia</xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="nProcesso" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do Processo</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="nProtReclama" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do protocolo de reclamao</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xObs" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Observaes sobre o processo de ressarcimento</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="15"/>
																<xs:maxLength value="100"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="infAdProd" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Informaes adicionais do produto (norma referenciada, informaes complementares, etc)</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="1"/>
													<xs:maxLength value="500"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:attribute name="nItem" use="required">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="chNFComAnt" type="TChDFe">
										<xs:annotation>
											<xs:documentation>Chave de Acesso da NFCom anterior </xs:documentation>
											<xs:documentation>Informar chave de acesso de referencia anterior
TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
									</xs:attribute>
									<xs:attribute name="nItemAnt" use="optional">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom anterior</xs:documentation>
											<xs:documentation>Informar nro do item da chave de acesso de referencia anterior

TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
								</xs:complexType>
							</xs:element>
							<xs:element name="total">
								<xs:annotation>
									<xs:documentation>Dados dos totais da NFCom</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="vProd" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total dos produtos e servios</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="ICMSTot">
											<xs:annotation>
												<xs:documentation>Totais referentes ao ICMS</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vBC" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMSDeson" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS desonerado</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do FCP (Fundo de Combate  Pobreza).</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vCOFINS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do COFINS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vPIS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do PIS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUNTTEL" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUNTTEL</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUST" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUST</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vRetTribTot">
											<xs:annotation>
												<xs:documentation>Total da reteno de tributos federais</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vRetPIS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do PIS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCofins" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do COFNS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCSLL" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor da CSLL retida</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vIRRF" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do IRRF retido</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vDesc" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total do Desconto</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vOutro" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Outras Despesas acessrias</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vNF" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total da NFCom</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gFidelidade" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes do programa de fidelidade do assinante</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="qtdSaldoPts">
											<xs:annotation>
												<xs:documentation> Saldo de pontos do cliente na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefSaldoPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de aferio do saldo de pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="qtdPtsResg">
											<xs:annotation>
												<xs:documentation> Qtd de pontos resgatados na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefResgPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de resgate dos pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:choice>
								<xs:element name="gFat" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes de controle da Fatura</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CompetFat" type="TCompet">
												<xs:annotation>
													<xs:documentation>Ano e ms referncia do faturamento (AAAAMM)</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="dVencFat" type="TData">
												<xs:annotation>
													<xs:documentation>Data de vencimento da fatura</xs:documentation>
													<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:annotation>
													<xs:documentation>Sequencia XML</xs:documentation>
												</xs:annotation>
												<xs:element name="dPerUsoIni" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso inicial</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
												<xs:element name="dPerUsoFim" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso final</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
											</xs:sequence>
											<xs:element name="codBarras">
												<xs:annotation>
													<xs:documentation>Linha digitvel do cdigo de barras</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="48"/>
														<xs:pattern value="[0-9]{1,48}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:element name="codDebAuto" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Cdigo de autorizao dbito em conta</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="20"/>
														<xs:pattern value="[0-9]{1,20}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:element name="codBanco">
													<xs:annotation>
														<xs:documentation>Nmero do banco para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="3"/>
															<xs:maxLength value="5"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
												<xs:element name="codAgencia">
													<xs:annotation>
														<xs:documentation>Nmero da agncia bancria para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="1"/>
															<xs:maxLength value="10"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
											</xs:sequence>
											<xs:element name="enderCorresp" type="TEndeEmi" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Endereo de entrega da fatura.</xs:documentation>
													<xs:documentation>Informar se diferente do endereo do destinatrio</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gPIX" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Grupo de informaes do PIX</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="urlQRCodePIX">
															<xs:annotation>
																<xs:documentation>URL do QRCode do PIX que ser apresentado na fatura</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:maxLength value="2000"/>
																	<xs:minLength value="2"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
								<xs:element name="gFatCentral" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes do Faturamento Centralizado</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CNPJ" type="TCnpj">
												<xs:annotation>
													<xs:documentation>CNPJ do Emitente centralizador</xs:documentation>
													<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="cUF" type="TCodUfIBGE">
												<xs:annotation>
													<xs:documentation>Cdigo da UF do emitente centralizador</xs:documentation>
													<xs:documentation>Cdigo da UF do emitente do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
												</xs:annotation>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
							</xs:choice>
						</xs:sequence>
						<xs:element name="autXML" minOccurs="0" maxOccurs="10">
							<xs:annotation>
								<xs:documentation>Autorizados para download do XML do DF-e</xs:documentation>
								<xs:documentation>Informar CNPJ ou CPF. Preencher os zeros no significativos.</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpj">
											<xs:annotation>
												<xs:documentation>CNPJ do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>CPF do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:choice>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="infAdic" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes Adicionais</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:annotation>
										<xs:documentation>Sequencia XML</xs:documentation>
									</xs:annotation>
									<xs:element name="infAdFisco" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informaes adicionais de interesse do Fisco</xs:documentation>
											<xs:documentation>Norma referenciada, informaes complementares, etc</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="2000"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="infCpl" minOccurs="0" maxOccurs="5">
										<xs:annotation>
											<xs:documentation>Informaes complementares de interesse do Contribuinte</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="3000"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gRespTec" type="TRespTec" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes do Responsvel Tcnico pela emisso do DF-e</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="versao" type="TVerNFCom" use="required">
						<xs:annotation>
							<xs:documentation>Verso do leiaute</xs:documentation>
						</xs:annotation>
					</xs:attribute>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da tag a ser assinada</xs:documentation>
							<xs:documentation>Informar a chave de acesso da NFCom e precedida do literal "NFCom"</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="NFCom[0-9]{44}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
				<xs:unique name="pk_nItem">
					<xs:selector xpath="./*"/>
					<xs:field xpath="@nItem"/>
				</xs:unique>
			</xs:element>
			<xs:element name="infNFComSupl">
				<xs:annotation>
					<xs:documentation>Informaes suplementares da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qrCodNFCom">
							<xs:annotation>
								<xs:documentation>Texto com o QR-Code para consulta da NFCom</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:minLength value="50"/>
									<xs:maxLength value="1000"/>
									<xs:pattern value="((HTTPS?|https?)://.*\?chNFCom=[0-9]{44}&amp;tpAmb=[1-2](&amp;sign=[!-]{1}[ -]{0,}[!-]{1}|[!-]{1})?)"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Concesso de Autorizao de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="idLote" type="TIdLote"/>
			<xs:element name="NFCom" type="TNFCom" maxOccurs="50"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TEndeEmi">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndeDest">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo Destinatario</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndereco">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="255"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE), informar 9999999 para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio, informar EXTERIOR para operaes com o exterior.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP" minOccurs="0">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar os zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF, informar EX para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TProtNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Protocolo de status resultado do processamento da NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infProt">
				<xs:annotation>
					<xs:documentation>Dados do protocolo de status</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de acesso da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora de processamento, no formato AAAA-MM-DDTHH:MM:SS TZD.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do Protocolo de Status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="digVal" type="ds:DigestValueType" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Digest Value da NFCom processado. Utilizado para conferir a integridade da NFCom original.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da NFCom.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" type="xs:ID" use="optional"/>
				</xs:complexType>
			</xs:element>
			<xs:element name="infFisco" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Mensagem do Fisco</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cMsg">
							<xs:annotation>
								<xs:documentation>Cdigo do status da mensagem do fisco</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMsg" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Mensagem do Fisco</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do Pedido de Autorizao de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" type="TProtNFCom" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Reposta ao processamento da NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do recibo de envio do lote de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="infRec" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Dados do Recibo do Lote</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="nRec" type="TRec">
							<xs:annotation>
								<xs:documentation>Nmero do Recibo</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora do recebimento, no formato AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tMed">
							<xs:annotation>
								<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:integer">
									<xs:pattern value="[0-9]{1,4}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TImp">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Imposto NFCom</xs:documentation>
		</xs:annotation>
	</xs:complexType>
	<xs:complexType name="TEmpresaSoft">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Empresa de Software</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:choice>
				<xs:element name="CNPJ" type="TCnpj">
					<xs:annotation>
						<xs:documentation>CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="CPF" type="TCpf">
					<xs:annotation>
						<xs:documentation>CPF da pessoa fsica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>No caso de pessoa fsica, informar o CPF do desenvolvedor do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica/fsica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica/fsica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRespTec">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Responsvel Tcnico</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CNPJ" type="TCnpj">
				<xs:annotation>
					<xs:documentation>CNPJ da pessoa jurdica responsvel tcnica pelo sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
					<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:sequence minOccurs="0">
				<xs:annotation>
					<xs:documentation>Sequencia XML</xs:documentation>
				</xs:annotation>
				<xs:element name="idCSRT">
					<xs:annotation>
						<xs:documentation>Identificador do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>Identificador do CSRT utilizado para gerao do hash</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:pattern value="[0-9]{3}"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="hashCSRT">
					<xs:annotation>
						<xs:documentation>Hash do token do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>O hashCSRT  o resultado das funes SHA-1 e base64 do token CSRT fornecido pelo fisco + chave de acesso do DF-e. (Implementao em futura NT)

Observao: 28 caracteres so representados no schema como 20 bytes do tipo base64Binary</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:base64Binary">
							<xs:length value="20"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="TProcEmi">
		<xs:annotation>
			<xs:documentation>Tipo processo de emisso do NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAssinante">
		<xs:annotation>
			<xs:documentation>Tipo assinante</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value="8"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIdLote">
		<xs:annotation>
			<xs:documentation>Tipo Identificador de controle do envio do lote. Nmero seqencial auto-incremental, de controle correspondente ao identificador nico do lote enviado. A responsabilidade de gerar e controlar esse nmero  do prprio contribuinte.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUMedItem">
		<xs:annotation>
			<xs:documentation>Tipo da unidade bsica de medida</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTime">
		<xs:annotation>
			<xs:documentation> Tipo hora</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-1][0-9])|([2][0-3])):([0-5][0-9]):([0-5][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEmail">
		<xs:annotation>
			<xs:documentation>Tipo Email</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="60"/>
			<xs:pattern value="[^@]+@[^\.]+\..+"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFinNFCom">
		<xs:annotation>
			<xs:documentation>Finalidade da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFatNFCom">
		<xs:annotation>
			<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDoc">
		<xs:annotation>
			<xs:documentation>Tipo de Documento de Identificao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCfop">
		<xs:annotation>
			<xs:documentation>Tipo CFOP</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[123567][0-9]([0-9][1-9]|[1-9][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIndIEDest">
		<xs:annotation>
			<xs:documentation>Tipo indicador da IE do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="9"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCRT">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo Regime Tributrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TtpEmis">
		<xs:annotation>
			<xs:documentation>Tipo de emisso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUtilizacao">
		<xs:annotation>
			<xs:documentation>Tipo utilizacao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value=""/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompet">
		<xs:annotation>
			<xs:documentation>Tipo Competncia</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="6"/>
			<xs:maxLength value="6"/>
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFPapel">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NF papel</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotSub">
		<xs:annotation>
			<xs:documentation>Tipo Motivo Substituio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="01"/>
			<xs:enumeration value="02"/>
			<xs:enumeration value="03"/>
			<xs:enumeration value="04"/>
			<xs:enumeration value="05"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt_v2">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotAjuste">
		<xs:annotation>
			<xs:documentation>Tipo do Motivo de Ajuste</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTarifa">
		<xs:annotation>
			<xs:documentation>Tipo de tarifa de aplicao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProcesso">
		<xs:annotation>
			<xs:documentation>Tipo de processo judicial</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRessarcimento">
		<xs:annotation>
			<xs:documentation>Tipo de Ressarcimento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompFat">
		<xs:annotation>
			<xs:documentation>Tipo componente da fatura</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/procEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="procEventoNFCom" type="TProcEvento">
		<xs:annotation>
			<xs:documentation>Pedido de Registro de Evento de NFCom processado</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/procNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="nfcomProc">
		<xs:annotation>
			<xs:documentation>NFCom processada</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="NFCom" type="TNFCom"/>
				<xs:element name="protNFCom" type="TProtNFCom"/>
			</xs:sequence>
			<xs:attribute name="versao" type="TVerNFCom" use="required"/>
			<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
				<xs:annotation>
					<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
				</xs:annotation>
			</xs:attribute>
			<xs:attribute name="nPortaCon" use="optional">
				<xs:annotation>
					<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:pattern value="[0-9]{1,5}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:attribute>
			<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
				<xs:annotation>
					<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
				</xs:annotation>
			</xs:attribute>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/retConsSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsSitNFCom" type="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno da consulta da situao atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/retConsStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsStatServNFCom" type="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Resultado da Consulta do Status do Servio de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/retEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retEventoNFCom" type="TRetEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno Pedido de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/retNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="retNFCom" type="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/tiposGeralNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:simpleType name="TDateTimeUTC">
		<xs:annotation>
			<xs:documentation>Data e Hora, formato UTC (AAAA-MM-DDThh:mm:ssTZD, onde TZD = +hh:mm ou -hh:mm)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(((20(([02468][048])|([13579][26]))-02-29))|(20[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))T(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d([\-,\+](0[0-9]|10|11):00|([\+](12):00))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodMunIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo do Municpio da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{7}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCOrgaoIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo de orgo (UF da tabela do IBGE + 90 SUFRAMA + 91 RFB + 92 BRId)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="90"/>
			<xs:enumeration value="91"/>
			<xs:enumeration value="92"/>
			<xs:enumeration value="93"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE_EX">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE + 99 para Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TChDFe">
		<xs:annotation>
			<xs:documentation>Tipo Chave de Documento Fiscal Eletrnico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:maxLength value="44"/>
			<xs:pattern value="[0-9]{44}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSegCodBarra">
		<xs:annotation>
			<xs:documentation>Tipo Segundo Codigo Barra</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{36}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProt">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Protocolo de Status</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRec">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Recibo do envio de lote de DF-e</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TStat">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da Mensagem enviada</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpj">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ tamanho varavel (3-14)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjOpc">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ Opcional</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0}|[0-9]{14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpf">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpfVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF de tamanho varivel (3-11)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais usado em tags opcionais </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 ou 5 dgitos, sendo 3 inteiros e 3 ou 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,3}(\.[0-9]{2,3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros e 2 at 4 decimais. Utilizados em TAGs opcionais, no aceita valor zero.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Max100">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 3 inteiros (no mximo 100), com at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0(\.[0-9]{2,4})?|[1-9]{1}[0-9]{0,1}(\.[0-9]{2,4})?|100(\.0{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0402_0408">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  4 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0503">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 8 dgitos, sendo 5 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,4}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1100_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  11 dgitos inteiros e 0 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,11}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1306">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 6 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1308">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 13 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1304">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIeDest">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0,14}|ISENTO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="62"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIe">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Emitente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNF">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Documento Fiscal</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[1-9]{1}[0-9]{0,8}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSerie">
		<xs:annotation>
			<xs:documentation>Tipo Srie do Documento Fiscal </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|[1-9]{1}[0-9]{0,2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
			<xs:enumeration value="EX"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf_sem_EX">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF - Sem Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAmb">
		<xs:annotation>
			<xs:documentation>Tipo Ambiente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerAplic">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Aplicativo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="20"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotivo">
		<xs:annotation>
			<xs:documentation>Tipo Motivo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TJust">
		<xs:annotation>
			<xs:documentation>Tipo Justificativa</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="15"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TServ">
		<xs:annotation>
			<xs:documentation>Tipo Servio solicitado</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString"/>
	</xs:simpleType>
	<xs:simpleType name="Tano">
		<xs:annotation>
			<xs:documentation> Tipo ano</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMed">
		<xs:annotation>
			<xs:documentation> Tipo temp mdio em segundos</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TString">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TData">
		<xs:annotation>
			<xs:documentation> Tipo data AAAA-MM-DD</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="((((20|19|18)(([02468][048])|([13579][26]))-02-29))|((20|19|18)[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLatitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Latitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-8][0-9]\.[0-9]{6}|90\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-8][0-9]\.[0-9]{6}|-90\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLongitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Longitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-9][0-9]\.[0-9]{6}|1[0-7][0-9]\.[0-9]{6}|180\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-9][0-9]\.[0-9]{6}|-1[0-7][0-9]\.[0-9]{6}|-180\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNSU">
		<xs:annotation>
			<xs:documentation> Tipo nmero sequencial nico do AN</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIPv4">
		<xs:annotation>
			<xs:documentation>Tipo IP verso 4</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2024001/xmldsig-core-schema_v1.01.xsd">
<?xml version="1.0" encoding="utf-8"?>
<!-- ***************************************************-->
<!-- ***   Schema especfico para assinaturas XML    ***-->
<!-- *** a partir de certificados do padro (X509)   ***-->
<!-- *** ICP-Brasil - Projeto Nota Fiscal Eletrnica ***-->
<!-- ***************************************************-->
<!-- Schema for XML Signatures-->
<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.w3.org/2000/09/xmldsig#" elementFormDefault="qualified" attributeFormDefault="unqualified" version="0.1">
	<element name="Signature" type="ds:SignatureType"/>
	<complexType name="SignatureType">
		<sequence>
			<element name="SignedInfo" type="ds:SignedInfoType"/>
			<element name="SignatureValue" type="ds:SignatureValueType"/>
			<element name="KeyInfo" type="ds:KeyInfoType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="SignatureValueType">
		<simpleContent>
			<extension base="base64Binary">
				<attribute name="Id" type="ID" use="optional"/>
			</extension>
		</simpleContent>
	</complexType>
	<complexType name="SignedInfoType">
		<sequence>
			<element name="CanonicalizationMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				</complexType>
			</element>
			<element name="SignatureMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				</complexType>
			</element>
			<element name="Reference" type="ds:ReferenceType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="ReferenceType">
		<sequence>
			<element name="Transforms" type="ds:TransformsType">
				<!-- Garante a unicidade do atributo -->
				<unique name="unique_Transf_Alg">
					<selector xpath="./*"/>
					<field xpath="@Algorithm"/>
				</unique>
			</element>
			<element name="DigestMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#sha1"/>
				</complexType>
			</element>
			<element name="DigestValue" type="ds:DigestValueType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
		<attribute name="URI" use="required">
			<simpleType>
				<restriction base="anyURI">
					<minLength value="2"/>
				</restriction>
			</simpleType>
		</attribute>
		<attribute name="Type" type="anyURI" use="optional"/>
	</complexType>
	<complexType name="TransformsType">
		<sequence>
			<element name="Transform" type="ds:TransformType" minOccurs="2" maxOccurs="2"/>
		</sequence>
	</complexType>
	<complexType name="TransformType">
		<sequence minOccurs="0" maxOccurs="unbounded">
			<element name="XPath" type="string"/>
		</sequence>
		<attribute name="Algorithm" type="ds:TTransformURI" use="required"/>
	</complexType>
	<complexType name="KeyInfoType">
		<sequence>
			<element name="X509Data" type="ds:X509DataType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="X509DataType">
		<sequence>
			<element name="X509Certificate" type="base64Binary"/>
		</sequence>
	</complexType>
	<simpleType name="DigestValueType">
		<restriction base="base64Binary"/>
	</simpleType>
	<simpleType name="TTransformURI">
		<restriction base="anyURI">
			<enumeration value="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
			<enumeration value="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
		</restriction>
	</simpleType>
</schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/consSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consSitNFCom" type="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema de validao XML dp Pedido de Consulta da Situao Atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/consSitNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:complexType name="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta da Situao Atual da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo; 
2 - Homologao;</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="CONSULTAR">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="chNFCom" type="TChDFe">
				<xs:annotation>
					<xs:documentation>Chaves de acesso do NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno de Pedido de Consulta da Situao Atual de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou o NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>cdigo da UF de atendimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" minOccurs="0">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar protNFCom da verso correspondente da NFCom autorizada</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element name="procEventoNFCom" minOccurs="0" maxOccurs="unbounded">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar procEventoNFCom da verso correspondente do evento NFCom autorizado</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsSitNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta situao de NFCom - 1.00</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/consStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consStatServNFCom" type="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/consStatServNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="STATUS">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Resultado da Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TVerAplic">
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo da UF responsvel pelo servio</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="dhRecbto" type="TDateTimeUTC">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tMed" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:integer">
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="dhRetorno" type="TDateTimeUTC" minOccurs="0">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD. Deve ser preenchida com data e hora previstas para o retorno dos servios prestados.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xObs" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Campo observao utilizado para incluir informaes ao contribuinte</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:minLength value="1"/>
						<xs:maxLength value="255"/>
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsStat">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/DFeTiposBasicos_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas-softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">
	<xs:simpleType name="TStringRTC">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCST">
		<xs:annotation>
			<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="\d{3}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TcClassTrib">
		<xs:annotation>
			<xs:documentation>Cdigo de Classificao Tributria do IBS e da CBS</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="\d{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104Op">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 inteiros, podendo ter 4 decimais (utilizado em tags opcionais)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[1-9]{1}[0-9]{3}|0\.[0-9]{3}[1-9]{1}|0\.[0-9]{2}[1-9]{1}[0-9]{1}|0\.[0-9]{1}[1-9]{1}[0-9]{2}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec1302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 de corpo e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_04">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEnteGov">
		<xs:annotation>
			<xs:documentation>Tipo de Ente Governamental</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:complexType name="TTribNFCom">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNF3e">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NF3e</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribCTe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao do CTe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribBPe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao do BPe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFCe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFCe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:choice minOccurs="0">
				<xs:element name="gIBSCBS" type="TCIBS"/>
				<xs:element name="gIBSCBSMono" type="TMonofasia"/>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:choice minOccurs="0">
				<xs:element name="gIBSCBS" type="TCIBS"/>
				<xs:element name="gIBSCBSMono" type="TMonofasia">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para Monofasia</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="gTransfCred" type="TTransfCred">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para o CST 800</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIS">
		<xs:annotation>
			<xs:documentation>Grupo de informaes do Imposto Seletivo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CSTIS" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do Imposto Seletivo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTribIS" type="TcClassTrib"/>
			<xs:sequence minOccurs="0">
				<xs:element name="vBCIS" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do BC</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="pIS" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Alquota do Imposto Seletivo (percentual)</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="pISEspec" type="TDec_0302_04" minOccurs="0">
					<xs:annotation>
						<xs:documentation>Alquota do Imposto Seletivo (por valor)</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:sequence minOccurs="0">
					<xs:element name="uTrib">
						<xs:annotation>
							<xs:documentation>Unidade de medida apropriada especificada em Lei Ordinaria para fins de apurao do Imposto Seletivo</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="TStringRTC">
								<xs:minLength value="1"/>
								<xs:maxLength value="6"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:element>
					<xs:element name="qTrib" type="TDec_1104Op">
						<xs:annotation>
							<xs:documentation>Quantidade com abse no campo uTrib informado</xs:documentation>
						</xs:annotation>
					</xs:element>
				</xs:sequence>
				<xs:element name="vIS" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do Imposto Seletivo calculado</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TISTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais do Imposto Seletivo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vIS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor Total do Imposto Seletivo</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIBSCBSTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais da CBS/IBS</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vBCIBSCBS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Total Base de Calculo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBS">
				<xs:annotation>
					<xs:documentation>Totalizao do IBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="gIBSUF">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia da UF</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSUF" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Estadual</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gIBSMun">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia Municipal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSMun" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Municipal</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="vIBS" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total do IBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPresCondSus" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido Condio Suspensiva</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gCBS">
				<xs:annotation>
					<xs:documentation>Totalizao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vDif" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vDevTrib" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total de devolues de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPresCondSus" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido Condio Suspensiva</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIBSCBSMonoTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais da CBS/IBS com monofasia</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vBCIBSCBS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Total Base de Calculo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBS" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao do IBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="gIBSUF">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia da UF</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSUF" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Estadual</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gIBSMun">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia Municipal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSMun" type="TDec1302">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Municipal</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="vIBS" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total do IBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gCBS" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vDif" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vDevTrib" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total de devolues de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gMono" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totais da Monofasia</xs:documentation>
					<xs:documentation>S dever ser utilizado para DFe modelos 55 e 65</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vIBSMono" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total do IBS monofsico</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMono" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total da CBS monofsica</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoReten" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total do IBS monofsico sujeito a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoReten" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor total da CBS monofsica sujeita a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoRet" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor do IBS monofsico retido anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoRet" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor da CBS monofsica retida anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TMonofasia">
		<xs:annotation>
			<xs:documentation>Tipo Monofasia</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:annotation>
				<xs:documentation>Monofasia</xs:documentation>
			</xs:annotation>
			<xs:element name="qBCMono" type="TDec_1104Op">
				<xs:annotation>
					<xs:documentation>Quantidade tributada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="adRemIBS" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Alquota especfica do IBS.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="adRemCBS" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Alquota especfiac da CBS.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vIBSMono" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do IBS monofsico</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCBSMono" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor da CBS monofsica</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:sequence minOccurs="0">
				<xs:element name="qBCMonoReten" type="TDec_1104Op">
					<xs:annotation>
						<xs:documentation>Quantidade tributada sujeita a reteno.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="adRemIBSReten" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Alquota ad rem do IBS sujeito a reteno</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vIBSMonoReten" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do IBS monofsico sujeito a reteno</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="adRemCBSReten" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Alquota ad rem da CBS sujeita a reteno</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vCBSMonoReten" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor da CBS monofsica sujeita a reteno</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
			<xs:sequence minOccurs="0">
				<xs:element name="qBCMonoRet" type="TDec_1104Op">
					<xs:annotation>
						<xs:documentation>Quantidade tributada retida anteriormente</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="adRemIBSRet" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Alquota ad rem do IBS retido anteriormente</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vIBSMonoRet" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do IBS retido anteriormente</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="adRemCBSRet" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Alquota ad rem da CBS retida anteriormente</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vCBSMonoRet" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor da CBS retida anteriormente</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
			<xs:sequence minOccurs="0">
				<xs:element name="pDifIBS" type="TDec_0302_04">
					<xs:annotation>
						<xs:documentation>Percentual do diferimento do imposto monofsico</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vIBSMonoDif" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do IBS monofsico diferido</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="pDifCBS" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Percentual do diferimento do imposto monofsico</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vCBSMonoDif" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor da CBS monofsica diferida</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
			<xs:element name="vTotIBSMonoItem" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Total de IBS monofsico do item</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTotCBSMonoItem" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Total da CBS monofsica do item</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCIBS">
		<xs:annotation>
			<xs:documentation>Tipo CBS IBS Completo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:annotation>
				<xs:documentation>IBS / CBS</xs:documentation>
			</xs:annotation>
			<xs:element name="vBC" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do BC</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBSUF">
				<xs:annotation>
					<xs:documentation>Grupo de informaes do IBS na UF</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="pIBSUF" type="TDec_0302_04">
							<xs:annotation>
								<xs:documentation>Aliquota do IBS de competncia das UF</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDif" type="TDifIBS" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gRed" type="TRed" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSUF" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor do IBS de competncia das UF</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gIBSMun">
				<xs:annotation>
					<xs:documentation>Grupo de Informaes do IBS no Municpio</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="pIBSMun" type="TDec_0302_04">
							<xs:annotation>
								<xs:documentation>Aliquota do IBS Municipal</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDif" type="TDifIBS" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gRed" type="TRed" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMun" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor do IBS Municipal</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gCBS">
				<xs:annotation>
					<xs:documentation>Grupo de Tributao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="pCBS" type="TDec_0302_04">
							<xs:annotation>
								<xs:documentation>Aliquota da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDif" type="TDifCBS" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gRed" type="TRed" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302">
							<xs:annotation>
								<xs:documentation>Valor da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gTribRegular" type="TTribRegular" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da Tributao Regular. Informar como seria a tributao caso no cumprida a condio resolutria/suspensiva. Exemplo 1: Art. 442, 4. Operaes com ZFM e ALC. Exemplo 2: Operaes com suspenso do tributo.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBSCredPres" type="TCredPres" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de Informaes do Crdito Presumido referente ao IBS, quando aproveitado pelo emitente do documento. </xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gCBSCredPres" type="TCredPres" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de Informaes do Crdito Presumido referente a CBS, quando aproveitado pelo emitente do documento. </xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRed">
		<xs:annotation>
			<xs:documentation>Tipo Reduo Base de Clculo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pRedAliq" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Percentual de reduo de aliquota</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfet" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Aliquota Efetiva que ser aplicada a Base de Calculo</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCredPres">
		<xs:annotation>
			<xs:documentation>Tipo Crdito Presumido</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="cCredPres">
				<xs:annotation>
					<xs:documentation>Usar tabela Cred Presumido, para o emitente da nota.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pCredPres" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Percentual do Crdito Presumido</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:choice>
				<xs:element name="vCredPres" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do Crdito Presumido</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vCredPresCondSus" type="TDec1302">
					<xs:annotation>
						<xs:documentation>Valor do Crdito Presumido Condio Suspensiva, preencher apenas para cCredPres que possui indicao de Condio Suspensiva</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TDifIBS">
		<xs:annotation>
			<xs:documentation>Tipo Diferimento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pDif" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Percentual do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vDif" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TDifCBS">
		<xs:annotation>
			<xs:documentation>Tipo Diferimento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pDif" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Percentual do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vDif" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TDevTrib">
		<xs:annotation>
			<xs:documentation>Tipo Devoluo Tributo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vDevTrib" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do tributo devolvido. No fornecimento de energia eltrica, gua, esgoto e
gs natural e em outras hipteses definidas no regulamento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribRegular">
		<xs:annotation>
			<xs:documentation>Tipo Tributao Regular</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CSTReg" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo da Situao Tributria do IBS e CBS</xs:documentation>
					<xs:documentation>Informar qual seria o CST caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTribReg" type="TcClassTrib">
				<xs:annotation>
					<xs:documentation>Informar qual seria o cClassTrib caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegIBSUF" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Alquota do IBS da UF</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegIBSUF" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do IBS da UF</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegIBSMun" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Alquota do IBS do Municpio</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegIBSMun" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do IBS do Municpio</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegCBS" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Alquota da CBS</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegCBS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor da CBS</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCompraGov">
		<xs:annotation>
			<xs:documentation>Tipo Compras Governamentais</xs:documentation>
			<xs:documentation>Cada DFe que utilizar dever utilizar esses tipo no grupo ide</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpEnteGov" type="TEnteGov">
				<xs:annotation>
					<xs:documentation>Para administrao pblica direta e suas autarquias e fundaes:
1=Unio
2=Estados
3=Distrito Federal
4=Municpios</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pRedutor" type="TDec_0302_04">
				<xs:annotation>
					<xs:documentation>Percentual de reduo de aliquota em compra goverrnamental</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTransfCred">
		<xs:annotation>
			<xs:documentation>Tipo Transferncia de Credito</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vIBS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do IBS </xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCBS" type="TDec1302">
				<xs:annotation>
					<xs:documentation>Valor do CBS </xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/evCancNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="evCancNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do evento do cancelamento 
110111</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="descEvento">
					<xs:annotation>
						<xs:documentation>Descrio do Evento - Cancelamento</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:whiteSpace value="preserve"/>
							<xs:enumeration value="Cancelamento"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="nProt" type="TProt">
					<xs:annotation>
						<xs:documentation>Nmero do Protocolo de Status da NFCom</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="xJust" type="TJust">
					<xs:annotation>
						<xs:documentation>Justificativa do Cancelamento</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/eventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="eventoNFCom" type="TEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Registro de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/eventoNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TEvento">
		<xs:annotation>
			<xs:documentation>Tipo Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="CNPJ" type="TCnpj">
							<xs:annotation>
								<xs:documentation>CNPJ do emissor do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de Acesso da NFCom vinculada ao evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhEvento" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e Hora do Evento, formato UTC (AAAA-MM-DDThh:mm:ssTZD)</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento">
							<xs:annotation>
								<xs:documentation>Tipo do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento">
							<xs:annotation>
								<xs:documentation>Seqencial do evento para o mesmo tipo de evento.  Para maioria dos eventos ser 1, nos casos em que possa existir mais de um evento o autor do evento deve numerar de forma seqencial.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="detEvento">
							<xs:annotation>
								<xs:documentation>Detalhamento do evento especfico</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:any processContents="skip">
										<xs:annotation>
											<xs:documentation>XML do evento
Insira neste local o XML especfico do tipo de evento (cancelamento, encerramento, registro de passagem).  </xs:documentation>
										</xs:annotation>
									</xs:any>
								</xs:sequence>
								<xs:attribute name="versaoEvento" use="required">
									<xs:simpleType>
										<xs:restriction base="xs:string">
											<xs:whiteSpace value="preserve"/>
											<xs:pattern value="1\.(0[0-9]|[1-9][0-9])"/>
										</xs:restriction>
									</xs:simpleType>
								</xs:attribute>
							</xs:complexType>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da TAG a ser assinada, a regra de formao do Id :
ID + tpEvento +  chave da NF-3e + nSeqEvento (preencher com zeros a esquerda para compor 3 digitos)</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="0"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEvento">
		<xs:annotation>
			<xs:documentation>Tipo retorno do Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que recebeu o Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento. Utilizar a Tabela do IBGE extendida, utilizar 90 para identificar SUFRAMA</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat" type="TStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status do registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Chave de Acesso NFCom vinculada</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Tipo do Evento vinculado</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Descrio do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TString">
									<xs:minLength value="4"/>
									<xs:maxLength value="60"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Seqencial do evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="dhRegEvento" type="TDateTimeUTC" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Data e Hora de do recebimento do evento ou do registro do evento formato AAAA-MM-DDThh:mm:ssTZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do protocolo de registro do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="optional">
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{16}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" use="required">
			<xs:simpleType>
				<xs:restriction base="TVerEvento"/>
			</xs:simpleType>
		</xs:attribute>
	</xs:complexType>
	<xs:complexType name="TProcEvento">
		<xs:annotation>
			<xs:documentation>Tipo procEvento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="eventoNFCom" type="TEvento"/>
			<xs:element name="retEventoNFCom" type="TRetEvento"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
		<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
			<xs:annotation>
				<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
			</xs:annotation>
		</xs:attribute>
		<xs:attribute name="nPortaCon" use="optional">
			<xs:annotation>
				<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
			</xs:annotation>
			<xs:simpleType>
				<xs:restriction base="xs:string">
					<xs:pattern value="[0-9]{1,5}"/>
				</xs:restriction>
			</xs:simpleType>
		</xs:attribute>
		<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
			<xs:annotation>
				<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
			</xs:annotation>
		</xs:attribute>
	</xs:complexType>
	<xs:simpleType name="TVerEvento">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Evento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/nfcom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="NFCom" type="TNFCom">
		<xs:annotation>
			<xs:documentation>Nota Fiscal Fatura de Comunicao Eletrnica</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/nfcomTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2014 rel. 2 (http://www.altova.com) by private (private) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:include schemaLocation="DFeTiposBasicos_v1.00.xsd"/>
	<xs:complexType name="TNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Nota Fiscal Fatura de Comunicao</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infNFCom">
				<xs:annotation>
					<xs:documentation>Informaes da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="ide">
							<xs:annotation>
								<xs:documentation>Identificao da NFCom</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="cUF" type="TCodUfIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo da UF de emisso e autorizao da NFCom</xs:documentation>
											<xs:documentation>Cdigo da UF de emisso e autorizao do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpAmb" type="TAmb">
										<xs:annotation>
											<xs:documentation>Tipo do Ambiente</xs:documentation>
											<xs:documentation>1 - Produo; 
2 - Homologao</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="mod" type="TModNFCom">
										<xs:annotation>
											<xs:documentation>Modelo da NFCom</xs:documentation>
											<xs:documentation>Utilizar o cdigo 62 para identificao da NFCom</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="serie" type="TSerie">
										<xs:annotation>
											<xs:documentation>Srie do documento fiscal</xs:documentation>
											<xs:documentation>Informar a srie do documento fiscal (informar zero para srie nica).</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nNF" type="TNF">
										<xs:annotation>
											<xs:documentation>Nmero do documento fiscal</xs:documentation>
											<xs:documentation>Nmero que identifica o documento fiscal 1 a 999999999.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="cNF">
										<xs:annotation>
											<xs:documentation>Cdigo numrico que compe a Chave de Acesso. </xs:documentation>
											<xs:documentation>Cdigo aleatrio gerado pelo emitente, com o objetivo de evitar acessos indevidos ao documento.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{7}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cDV">
										<xs:annotation>
											<xs:documentation>Digito verificador da chave de acesso</xs:documentation>
											<xs:documentation>Informar o dgito  de controle da chave de acesso documento fiscal, que deve ser calculado com a aplicao do algoritmo mdulo 11 (base 2,9) da chave de acesso. </xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dhEmi" type="TDateTimeUTC">
										<xs:annotation>
											<xs:documentation>Data e hora de emisso do documento fiscal</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DDTHH:MM:DD TZD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpEmis" type="TtpEmis">
										<xs:annotation>
											<xs:documentation>Forma de emisso do Documento Fiscal </xs:documentation>
											<xs:documentation>1 - Normal
; 2 - Contingncia</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nSiteAutoriz">
										<xs:annotation>
											<xs:documentation>Identificao do nmero do Site do Autorizador de recepo da NFCom</xs:documentation>
											<xs:documentation>Se o autorizador da NFCom possuir apenas um site dever ser informado com Zero (0), em caso de Autorizador trabalhar com mltiplos sites indicar o nmero do site para qual foi endereada a NFCOM (1 a 9).

Observao: o ambiente autorizador que trabalhar com mais de um Site dever divulgar para cada endereo de site qual nmero correspondente de nSiteAutoriz o contribuinte pode usar</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cMunFG" type="TCodMunIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo do municpio de ocorrncia do fato gerador</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="finNFCom" type="TFinNFCom">
										<xs:annotation>
											<xs:documentation>Finalidade de emisso da NFCom</xs:documentation>
											<xs:documentation>0- NFCom Normal; 
3 - NFCom de Substituio; 
4 - NFCom de Ajuste;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpFat" type="TFatNFCom">
										<xs:annotation>
											<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
											<xs:documentation>0- Faturamento Normal; 1 - Faturamento centralizado; 2 - Cofaturamento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="verProc">
										<xs:annotation>
											<xs:documentation>Verso do processo de emisso</xs:documentation>
											<xs:documentation>Informar a verso do aplicativo emissor de NFCom.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indPrePago" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de servio pr-pago</xs:documentation>
											<xs:documentation>1  Servio pr-pago (informar a tag somente se a nota for referente a um servio exclusivamente pr-pago)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indCessaoMeiosRede" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de Sesso de Meios de Rede.</xs:documentation>
											<xs:documentation>Uma vez informado (valor = 1), essa tag dispensa gerao do grupo Fatura.
Apenas para notas dos tipos Normal e Substituio com tipo de faturamento normal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indNotaEntrada" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de nota de entrada</xs:documentation>
											<xs:documentation>1  Informar quando for nota de ajuste e possuir itens com CFOP de entrada</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informar apenas
para tpEmis diferente de 1</xs:documentation>
										</xs:annotation>
										<xs:element name="dhCont" type="TDateTimeUTC">
											<xs:annotation>
												<xs:documentation>Data e Hora da entrada em contingncia</xs:documentation>
												<xs:documentation>Informar a data e hora no formato AAAA-MM-DDTHH:MM:SS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="xJust">
											<xs:annotation>
												<xs:documentation>Justificativa da entrada em contingncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="15"/>
													<xs:maxLength value="256"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:element name="gCompraGov" type="TCompraGov" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Grupo de Compras Governamentais</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="emit">
							<xs:annotation>
								<xs:documentation>Identificao do Emitente do documento fiscal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="CNPJ" type="TCnpj">
										<xs:annotation>
											<xs:documentation>CNPJ do emitente</xs:documentation>
											<xs:documentation>Informar zeros no significativos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIe">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IEUFDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual Virtual do emitente na UF de Destino da partilha (IE Virtual)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TIe"/>
										</xs:simpleType>
									</xs:element>
									<xs:element name="CRT" type="TCRT">
										<xs:annotation>
											<xs:documentation>Cdigo do Regime Tributrio</xs:documentation>
											<xs:documentation>Informar: 1=Simples Nacional; 
2=Simples Nacional, excesso sublimite de receita bruta;
3=Regime Normal. 
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="xFant" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nome fantasia do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderEmit" type="TEndeEmi">
										<xs:annotation>
											<xs:documentation>Endereo do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="dest">
							<xs:annotation>
								<xs:documentation>Identificao do destinatrio / assinante </xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do destinatrio</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpjOpc">
											<xs:annotation>
												<xs:documentation>Nmero do CNPJ</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>Nmero do CPF</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="idOutros">
											<xs:annotation>
												<xs:documentation>Identificao do destinatrio outros</xs:documentation>
												<xs:documentation>Identificao do destinatrio no obrigado a inscrio do CPF tais como estrangeiro, indgena e quilombola;
Em caso de no contar CPF do assinante, informar o RG</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="2"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="([!-]{0}|[!-]{2,20})?"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:choice>
									<xs:element name="indIEDest" type="TIndIEDest">
										<xs:annotation>
											<xs:documentation>Indicador da IE do Destinatrio</xs:documentation>
											<xs:documentation>1 - Contribuinte ICMS (informar a IE do destinatrio); 

2 - Contribuinte isento de Inscrio no cadastro de Contribuintes do ICMS;

 9 - No Contribuinte, que pode ou no possuir Inscrio Estadual no Cadastro de Contribuintes do ICMS. 

Nota: No caso de Contribuinte Isento de Inscrio (indIEDest=2) informar a tag IE do destinatrio com o literal ISENTO.
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIeDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do destinatrio</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IM" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Municipal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="15"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderDest" type="TEndeDest">
										<xs:annotation>
											<xs:documentation>Endereo do destinatrio / assinante</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="assinante">
							<xs:annotation>
								<xs:documentation>Dados do assinante</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="iCodAssinante">
										<xs:annotation>
											<xs:documentation>Cdigo nico de Identificao do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="30"/>
												<xs:pattern value="([!-]{0}|[!-]{1,30})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="tpAssinante" type="TAssinante">
										<xs:annotation>
											<xs:documentation>Tipo de assinante</xs:documentation>
											<xs:documentation>1-Comercial;
2-Industrial;
3-Residencial/Pessoa Fsica;
4-Produtor Rural;
5-rgo da administrao pblica estadual direta e suas fundaes e autarquias, quando mantidas pelo poder pblico estadual e regidas por normas de direito pblico, nos termos do Convnio ICMS 107/95; 	
6-Prestador de servio de telecomunicao responsvel pelo recolhimento do imposto incidente sobre a cesso dos meios de rede do prestador do servio ao usurio final, nos termos do Convnio ICMS 17/13 ;	
7-Misses Diplomticas, Reparties Consulares e Organismos Internacionais, nos termos do Convnio ICMS 158/94 ;	
8-Igrejas e Templos de qualquer natureza ;
99-Outros no especificados anteriormente 	</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpServUtil" type="TUtilizacao">
										<xs:annotation>
											<xs:documentation>Tipo de servio utilizado</xs:documentation>
											<xs:documentation>1-Telefonia; 2-Comunicao de dados; 3-TV por Assinatura;4 - Provimento de acesso  Internet; 5-Multimdia; 6-Outros; 7-Varios;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nContrato" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nmero do Contrato do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
												<xs:pattern value="([!-]{0}|[!-]{1,15})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dContratoIni" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de incio do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="dContratoFim" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de trmino do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Identifica o terminal principal do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermPrinc">
											<xs:annotation>
												<xs:documentation>Nmero do Terminal Principal do servio contratado</xs:documentation>
												<xs:documentation>Em se tratando de plano de prestao de servio telefnico corporativo, familiar ou similares, informar o nmero do terminal telefnico principal do plano. </xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFPrinc" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
												<xs:documentation> Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
									<xs:sequence minOccurs="0" maxOccurs="unbounded">
										<xs:annotation>
											<xs:documentation>Identifica os terminais adicionais do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermAdic">
											<xs:annotation>
												<xs:documentation>Nmero dos Terminais adicionais do servio contratado</xs:documentation>
												<xs:documentation/>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFAdic" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:sequence>
							<xs:annotation>
								<xs:documentation>Conjunto de informaes da NFCom </xs:documentation>
							</xs:annotation>
							<xs:element name="gSub" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes da substituio</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFCom" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom original</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary"/>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
										<xs:element name="motSub" type="TMotSub">
											<xs:annotation>
												<xs:documentation>Motivo da substituio</xs:documentation>
												<xs:documentation>01  Erro de Preo
02  Erro Cadastral
03  Deciso Judicial
04 - Erro de Tributao
05 - Descontinuidade do Servio</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gCofat" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes do Cofaturamento</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFComLocal" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom emitida pela Operadora Local</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary"/>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="det" maxOccurs="990">
								<xs:annotation>
									<xs:documentation>Detalhamento de Produtos e Servios </xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="prod">
											<xs:annotation>
												<xs:documentation>Dados do Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="cProd">
														<xs:annotation>
															<xs:documentation>Cdigo do produto ou servio. </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="60"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xProd">
														<xs:annotation>
															<xs:documentation>Descrio do produto ou servio</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="120"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="cClass">
														<xs:annotation>
															<xs:documentation>Cdigo de classificao</xs:documentation>
															<xs:documentation>Tabela de Classificao de Item da NFCom (validar por RV)</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="7"/>
																<xs:maxLength value="7"/>
																<xs:whiteSpace value="preserve"/>
																<xs:pattern value="[0-9]{7}"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="CFOP" type="TCfop" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CFOP</xs:documentation>
															<xs:documentation>Utilizar Tabela de CFOP. </xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="CNPJLD" type="TCnpj" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CNPJ da operadora LD</xs:documentation>
															<xs:documentation>Informar o CNPJ da operadora LD que ir lanar o item de cofaturamento em nota do tipo faturamento 2</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="uMed" type="TUMedItem">
														<xs:annotation>
															<xs:documentation>Unidade Bsica de Medida</xs:documentation>
															<xs:documentation>1=Minuto
; 2=MB; 
3=GB; 
4=UN</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="dExpiracao" type="TData" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Data de expirao de crdito </xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="imposto">
											<xs:annotation>
												<xs:documentation>Tributos incidentes no Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:complexContent>
													<xs:extension base="TImp">
														<xs:sequence>
															<xs:choice>
																<xs:sequence>
																	<xs:choice>
																		<xs:element name="ICMS00">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao normal do ICMS</xs:documentation>
																				<xs:documentation>Tributada integralmente</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>00 - tributao normal ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="00"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS20">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao com reduo de BC do ICMS</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>20 - tributao com BC reduzida do ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="20"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="pRedBC" type="TDec_0302Opc">
																						<xs:annotation>
																							<xs:documentation>Percentual de reduo da BC</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
 item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS40">
																			<xs:annotation>
																				<xs:documentation>Tributao Isenta, No tributada</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>40=Isenta; 41=No tributada;
</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="40"/>
																								<xs:enumeration value="41"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS51">
																			<xs:annotation>
																				<xs:documentation>Tributao com Diferimento </xs:documentation>
																				<xs:documentation>A exigncia do preenchimento das informaes do ICMS diferido fica a critrio de cada UF</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>Tributao pelo ICMS 51 - Diferimento</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="51"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS90">
																			<xs:annotation>
																				<xs:documentation>ICMS Outros</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation> 90 - ICMS outros</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequncia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vBC" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor da BC do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="pICMS" type="TDec_0302">
																							<xs:annotation>
																								<xs:documentation>Alquota do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vICMS" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMSSN">
																			<xs:annotation>
																				<xs:documentation>Simples Nacional</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>90 - Outros SN</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="indSN">
																						<xs:annotation>
																							<xs:documentation>Indica se o contribuinte  Simples Nacional			1=Sim</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="1"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																	</xs:choice>
																	<xs:element name="ICMSUFDest" minOccurs="0" maxOccurs="unbounded">
																		<xs:annotation>
																			<xs:documentation>Informaes do ICMS de partilha com a UF destinatria</xs:documentation>
																		</xs:annotation>
																		<xs:complexType>
																			<xs:sequence>
																				<xs:element name="vBCUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor da BC do ICMS na UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pFCPUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Percentual do ICMS relativo ao Fundo de Combate  pobreza (FCP) na UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pICMSUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Alquota interna da UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vFCPUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP) da UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFEmi" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de emisso</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenefUFDest" minOccurs="0">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF destino aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																			<xs:attribute name="cUFDest" type="TCodUfIBGE" use="required"/>
																		</xs:complexType>
																	</xs:element>
																</xs:sequence>
																<xs:element name="indSemCST">
																	<xs:annotation>
																		<xs:documentation>Sem Situao Tributria para o ICMS</xs:documentation>
																		<xs:documentation>Informar para itens que no tenham nenhuma relao com o ICMS.
Quando informado o item NO PODE ter CFOP informado

Se informado esse grupo o schema no permite informar nenhum dos grupos de ICMSXX</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="xs:string">
																			<xs:whiteSpace value="preserve"/>
																			<xs:enumeration value="1"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:choice>
															<xs:element name="PIS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do PIS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do PIS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pPIS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do PIS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vPIS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="COFINS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do COFINS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do COFINS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada
</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pCOFINS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do COFINS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vCOFINS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUST" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUST</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUST" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUST (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUST" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUNTTEL" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUNTTEL</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUNTTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUNTTEL" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUNTTEL (em percentual) </xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUNTTEL" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUNTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="retTrib" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes de reteno de tributos federais</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vRetPIS" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCofins" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do COFNS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCSLL" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor da CSLL retida</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vBCIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Base de clculo do IRRF</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do IRRF retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="IBSCBS" type="TTribNFCom" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes do IBS e CBS</xs:documentation>
																</xs:annotation>
															</xs:element>
														</xs:sequence>
													</xs:extension>
												</xs:complexContent>
											</xs:complexType>
										</xs:element>
										<xs:element name="gProcRef" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo Processo referenciado</xs:documentation>
												<xs:documentation>Este grupo somente dever ser preenchido quando houver processo judicial ou administrativo que altere valores.</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
															<xs:documentation>Informar o valor sem a influncia da deciso judicial/administrativa.</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vBC" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor da BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="pICMS" type="TDec_0302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Alquota do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vPIS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do PIS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vCOFINS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do COFINS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Fundo de Combate  Pobreza (FCP).</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="gProc" maxOccurs="10">
														<xs:annotation>
															<xs:documentation>Grupo identificador do Processo</xs:documentation>
														</xs:annotation>
														<xs:complexType>
															<xs:sequence>
																<xs:element name="tpProc" type="TProcesso">
																	<xs:annotation>
																		<xs:documentation>Tipo de Processo</xs:documentation>
																		<xs:documentation>0 - SEFAZ; 1 - Justia Federal; 2 - Justia Estadual</xs:documentation>
																	</xs:annotation>
																</xs:element>
																<xs:element name="nProcesso">
																	<xs:annotation>
																		<xs:documentation>Nmero do Processo</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="TString">
																			<xs:minLength value="1"/>
																			<xs:maxLength value="60"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:sequence>
														</xs:complexType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="gRessarc" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo de Informaes detalhadas de item de cClass de Ressarcimento</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="tpRessarc" type="TRessarcimento">
														<xs:annotation>
															<xs:documentation>Tipo de Ressarcimento</xs:documentation>
															<xs:documentation>1 - Cobrana Indevida
2 - Interrupo
99 - Outros</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="dRef" type="TData">
														<xs:annotation>
															<xs:documentation>Data de referencia</xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="nProcesso" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do Processo</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="nProtReclama" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do protocolo de reclamao</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xObs" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Observaes sobre o processo de ressarcimento</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="15"/>
																<xs:maxLength value="100"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="infAdProd" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Informaes adicionais do produto (norma referenciada, informaes complementares, etc)</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="1"/>
													<xs:maxLength value="500"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:attribute name="nItem" use="required">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="chNFComAnt" type="TChDFe">
										<xs:annotation>
											<xs:documentation>Chave de Acesso da NFCom anterior </xs:documentation>
											<xs:documentation>Informar chave de acesso de referencia anterior
TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
									</xs:attribute>
									<xs:attribute name="nItemAnt" use="optional">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom anterior</xs:documentation>
											<xs:documentation>Informar nro do item da chave de acesso de referencia anterior

TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="indNFComAntPapelFatCentral" use="optional">
										<xs:annotation>
											<xs:documentation>Indicador de Nota anterior em papel no faturamento centralizado</xs:documentation>
											<xs:documentation>Informa que a NFCom Anterior de Faturamento centralizado no  eletrnica</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
								</xs:complexType>
							</xs:element>
							<xs:element name="total">
								<xs:annotation>
									<xs:documentation>Dados dos totais da NFCom</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="vProd" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total dos produtos e servios</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="ICMSTot">
											<xs:annotation>
												<xs:documentation>Totais referentes ao ICMS</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vBC" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMSDeson" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS desonerado</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do FCP (Fundo de Combate  Pobreza).</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vCOFINS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do COFINS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vPIS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do PIS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUNTTEL" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUNTTEL</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUST" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUST</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vRetTribTot">
											<xs:annotation>
												<xs:documentation>Total da reteno de tributos federais</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vRetPIS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do PIS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCofins" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do COFNS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCSLL" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor da CSLL retida</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vIRRF" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do IRRF retido</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vDesc" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total do Desconto</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vOutro" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Outras Despesas acessrias</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vNF" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total da NFCom</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="IBSCBSTot" type="TIBSCBSTot" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Totais de IBS e CBS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vTotDFe" type="TDec_1302" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Valor total do documento fiscal 
(vNF + total do IBS + total da CBS) 
</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gFidelidade" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes do programa de fidelidade do assinante</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="qtdSaldoPts">
											<xs:annotation>
												<xs:documentation> Saldo de pontos do cliente na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefSaldoPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de aferio do saldo de pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="qtdPtsResg">
											<xs:annotation>
												<xs:documentation> Qtd de pontos resgatados na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefResgPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de resgate dos pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:choice>
								<xs:element name="gFat" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes de controle da Fatura</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CompetFat" type="TCompet">
												<xs:annotation>
													<xs:documentation>Ano e ms referncia do faturamento (AAAAMM)</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="dVencFat" type="TData">
												<xs:annotation>
													<xs:documentation>Data de vencimento da fatura</xs:documentation>
													<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:annotation>
													<xs:documentation>Sequencia XML</xs:documentation>
												</xs:annotation>
												<xs:element name="dPerUsoIni" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso inicial</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
												<xs:element name="dPerUsoFim" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso final</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
											</xs:sequence>
											<xs:element name="codBarras">
												<xs:annotation>
													<xs:documentation>Linha digitvel do cdigo de barras</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="48"/>
														<xs:pattern value="[0-9]{1,48}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:element name="codDebAuto" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Cdigo de autorizao dbito em conta</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="20"/>
														<xs:pattern value="[0-9]{1,20}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:element name="codBanco">
													<xs:annotation>
														<xs:documentation>Nmero do banco para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="3"/>
															<xs:maxLength value="5"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
												<xs:element name="codAgencia">
													<xs:annotation>
														<xs:documentation>Nmero da agncia bancria para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="1"/>
															<xs:maxLength value="10"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
											</xs:sequence>
											<xs:element name="enderCorresp" type="TEndeEmi" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Endereo de entrega da fatura.</xs:documentation>
													<xs:documentation>Informar se diferente do endereo do destinatrio</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gPIX" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Grupo de informaes do PIX</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="urlQRCodePIX">
															<xs:annotation>
																<xs:documentation>URL do QRCode do PIX que ser apresentado na fatura</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:maxLength value="2000"/>
																	<xs:minLength value="2"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
								<xs:element name="gFatCentral" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes do Faturamento Centralizado</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CNPJ" type="TCnpj">
												<xs:annotation>
													<xs:documentation>CNPJ do Emitente centralizador</xs:documentation>
													<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="cUF" type="TCodUfIBGE">
												<xs:annotation>
													<xs:documentation>Cdigo da UF do emitente centralizador</xs:documentation>
													<xs:documentation>Cdigo da UF do emitente do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
												</xs:annotation>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
							</xs:choice>
						</xs:sequence>
						<xs:element name="autXML" minOccurs="0" maxOccurs="10">
							<xs:annotation>
								<xs:documentation>Autorizados para download do XML do DF-e</xs:documentation>
								<xs:documentation>Informar CNPJ ou CPF. Preencher os zeros no significativos.</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpj">
											<xs:annotation>
												<xs:documentation>CNPJ do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>CPF do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:choice>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="infAdic" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes Adicionais</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:annotation>
										<xs:documentation>Sequencia XML</xs:documentation>
									</xs:annotation>
									<xs:element name="infAdFisco" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informaes adicionais de interesse do Fisco</xs:documentation>
											<xs:documentation>Norma referenciada, informaes complementares, etc</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="2000"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="infCpl" minOccurs="0" maxOccurs="5">
										<xs:annotation>
											<xs:documentation>Informaes complementares de interesse do Contribuinte</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="3000"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gRespTec" type="TRespTec" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes do Responsvel Tcnico pela emisso do DF-e</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="versao" type="TVerNFCom" use="required">
						<xs:annotation>
							<xs:documentation>Verso do leiaute</xs:documentation>
						</xs:annotation>
					</xs:attribute>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da tag a ser assinada</xs:documentation>
							<xs:documentation>Informar a chave de acesso da NFCom e precedida do literal "NFCom"</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="NFCom[0-9]{6}[A-Z0-9]{12}[0-9]{26}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
				<xs:unique name="pk_nItem">
					<xs:selector xpath="./*"/>
					<xs:field xpath="@nItem"/>
				</xs:unique>
			</xs:element>
			<xs:element name="infNFComSupl">
				<xs:annotation>
					<xs:documentation>Informaes suplementares da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qrCodNFCom">
							<xs:annotation>
								<xs:documentation>Texto com o QR-Code para consulta da NFCom</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:minLength value="50"/>
									<xs:maxLength value="1000"/>
									<xs:pattern value="((HTTPS?|https?)://.*\?chNFCom=[0-9]{44}&amp;tpAmb=[1-2](&amp;sign=[!-]{1}[ -]{0,}[!-]{1}|[!-]{1})?)"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Concesso de Autorizao de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="idLote" type="TIdLote"/>
			<xs:element name="NFCom" type="TNFCom" maxOccurs="50"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TEndeEmi">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndeDest">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo Destinatario</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndereco">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="255"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE), informar 9999999 para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio, informar EXTERIOR para operaes com o exterior.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP" minOccurs="0">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar os zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF, informar EX para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TProtNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Protocolo de status resultado do processamento da NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infProt">
				<xs:annotation>
					<xs:documentation>Dados do protocolo de status</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de acesso da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora de processamento, no formato AAAA-MM-DDTHH:MM:SS TZD.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do Protocolo de Status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="digVal" type="ds:DigestValueType" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Digest Value da NFCom processado. Utilizado para conferir a integridade da NFCom original.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da NFCom.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" type="xs:ID" use="optional"/>
				</xs:complexType>
			</xs:element>
			<xs:element name="infFisco" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Mensagem do Fisco</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cMsg">
							<xs:annotation>
								<xs:documentation>Cdigo do status da mensagem do fisco</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMsg" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Mensagem do Fisco</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do Pedido de Autorizao de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" type="TProtNFCom" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Reposta ao processamento da NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do recibo de envio do lote de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="infRec" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Dados do Recibo do Lote</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="nRec" type="TRec">
							<xs:annotation>
								<xs:documentation>Nmero do Recibo</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora do recebimento, no formato AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tMed">
							<xs:annotation>
								<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:integer">
									<xs:pattern value="[0-9]{1,4}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TImp">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Imposto NFCom</xs:documentation>
		</xs:annotation>
	</xs:complexType>
	<xs:complexType name="TEmpresaSoft">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Empresa de Software</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:choice>
				<xs:element name="CNPJ" type="TCnpj">
					<xs:annotation>
						<xs:documentation>CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="CPF" type="TCpf">
					<xs:annotation>
						<xs:documentation>CPF da pessoa fsica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>No caso de pessoa fsica, informar o CPF do desenvolvedor do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica/fsica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica/fsica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRespTec">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Responsvel Tcnico</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CNPJ" type="TCnpj">
				<xs:annotation>
					<xs:documentation>CNPJ da pessoa jurdica responsvel tcnica pelo sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
					<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:sequence minOccurs="0">
				<xs:annotation>
					<xs:documentation>Sequencia XML</xs:documentation>
				</xs:annotation>
				<xs:element name="idCSRT">
					<xs:annotation>
						<xs:documentation>Identificador do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>Identificador do CSRT utilizado para gerao do hash</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:pattern value="[0-9]{3}"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="hashCSRT">
					<xs:annotation>
						<xs:documentation>Hash do token do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>O hashCSRT  o resultado das funes SHA-1 e base64 do token CSRT fornecido pelo fisco + chave de acesso do DF-e. (Implementao em futura NT)

Observao: 28 caracteres so representados no schema como 20 bytes do tipo base64Binary</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:base64Binary">
							<xs:length value="20"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="TProcEmi">
		<xs:annotation>
			<xs:documentation>Tipo processo de emisso do NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAssinante">
		<xs:annotation>
			<xs:documentation>Tipo assinante</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value="8"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIdLote">
		<xs:annotation>
			<xs:documentation>Tipo Identificador de controle do envio do lote. Nmero seqencial auto-incremental, de controle correspondente ao identificador nico do lote enviado. A responsabilidade de gerar e controlar esse nmero  do prprio contribuinte.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUMedItem">
		<xs:annotation>
			<xs:documentation>Tipo da unidade bsica de medida</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTime">
		<xs:annotation>
			<xs:documentation> Tipo hora</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-1][0-9])|([2][0-3])):([0-5][0-9]):([0-5][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEmail">
		<xs:annotation>
			<xs:documentation>Tipo Email</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="60"/>
			<xs:pattern value="[^@]+@[^\.]+\..+"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFinNFCom">
		<xs:annotation>
			<xs:documentation>Finalidade da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFatNFCom">
		<xs:annotation>
			<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDoc">
		<xs:annotation>
			<xs:documentation>Tipo de Documento de Identificao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCfop">
		<xs:annotation>
			<xs:documentation>Tipo CFOP</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[123567][0-9]([0-9][1-9]|[1-9][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIndIEDest">
		<xs:annotation>
			<xs:documentation>Tipo indicador da IE do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="9"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCRT">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo Regime Tributrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TtpEmis">
		<xs:annotation>
			<xs:documentation>Tipo de emisso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUtilizacao">
		<xs:annotation>
			<xs:documentation>Tipo utilizacao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value=""/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompet">
		<xs:annotation>
			<xs:documentation>Tipo Competncia</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="6"/>
			<xs:maxLength value="6"/>
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFPapel">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NF papel</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotSub">
		<xs:annotation>
			<xs:documentation>Tipo Motivo Substituio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="01"/>
			<xs:enumeration value="02"/>
			<xs:enumeration value="03"/>
			<xs:enumeration value="04"/>
			<xs:enumeration value="05"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt_v2">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotAjuste">
		<xs:annotation>
			<xs:documentation>Tipo do Motivo de Ajuste</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTarifa">
		<xs:annotation>
			<xs:documentation>Tipo de tarifa de aplicao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProcesso">
		<xs:annotation>
			<xs:documentation>Tipo de processo judicial</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRessarcimento">
		<xs:annotation>
			<xs:documentation>Tipo de Ressarcimento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompFat">
		<xs:annotation>
			<xs:documentation>Tipo componente da fatura</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/procEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="procEventoNFCom" type="TProcEvento">
		<xs:annotation>
			<xs:documentation>Pedido de Registro de Evento de NFCom processado</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/procNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="nfcomProc">
		<xs:annotation>
			<xs:documentation>NFCom processada</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="NFCom" type="TNFCom"/>
				<xs:element name="protNFCom" type="TProtNFCom"/>
			</xs:sequence>
			<xs:attribute name="versao" type="TVerNFCom" use="required"/>
			<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
				<xs:annotation>
					<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
				</xs:annotation>
			</xs:attribute>
			<xs:attribute name="nPortaCon" use="optional">
				<xs:annotation>
					<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:pattern value="[0-9]{1,5}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:attribute>
			<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
				<xs:annotation>
					<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
				</xs:annotation>
			</xs:attribute>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/retConsSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsSitNFCom" type="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno da consulta da situao atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/retConsStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsStatServNFCom" type="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Resultado da Consulta do Status do Servio de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/retEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retEventoNFCom" type="TRetEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno Pedido de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/retNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="retNFCom" type="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/tiposGeralNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:simpleType name="TDateTimeUTC">
		<xs:annotation>
			<xs:documentation>Data e Hora, formato UTC (AAAA-MM-DDThh:mm:ssTZD, onde TZD = +hh:mm ou -hh:mm)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(((20(([02468][048])|([13579][26]))-02-29))|(20[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))T(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d([\-,\+](0[0-9]|10|11):00|([\+](12):00))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodMunIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo do Municpio da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{7}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCOrgaoIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo de orgo (UF da tabela do IBGE + 90 SUFRAMA + 91 RFB + 92 BRId)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="90"/>
			<xs:enumeration value="91"/>
			<xs:enumeration value="92"/>
			<xs:enumeration value="93"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE_EX">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE + 99 para Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TChDFe">
		<xs:annotation>
			<xs:documentation>Tipo Chave de Documento Fiscal Eletrnico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:maxLength value="44"/>
			<xs:pattern value="[0-9]{6}[A-Z0-9]{12}[0-9]{26}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSegCodBarra">
		<xs:annotation>
			<xs:documentation>Tipo Segundo Codigo Barra</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{36}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProt">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Protocolo de Status</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRec">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Recibo do envio de lote de DF-e</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TStat">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da Mensagem enviada</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpj">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[A-Z0-9]{12}[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjOpc">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ Opcional</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0}|[A-Z0-9]{12}[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpf">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpfVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF de tamanho varivel (3-11)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais usado em tags opcionais </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 ou 5 dgitos, sendo 3 inteiros e 3 ou 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,3}(\.[0-9]{2,3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros e 2 at 4 decimais. Utilizados em TAGs opcionais, no aceita valor zero.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Max100">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 3 inteiros (no mximo 100), com at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0(\.[0-9]{2,4})?|[1-9]{1}[0-9]{0,1}(\.[0-9]{2,4})?|100(\.0{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0402_0408">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  4 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0503">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 8 dgitos, sendo 5 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,4}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1100_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  11 dgitos inteiros e 0 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,11}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1306">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 6 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1308">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 13 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1304">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIeDest">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0,14}|ISENTO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="62"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIe">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Emitente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNF">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Documento Fiscal</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[1-9]{1}[0-9]{0,8}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSerie">
		<xs:annotation>
			<xs:documentation>Tipo Srie do Documento Fiscal </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|[1-9]{1}[0-9]{0,2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
			<xs:enumeration value="EX"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf_sem_EX">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF - Sem Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAmb">
		<xs:annotation>
			<xs:documentation>Tipo Ambiente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerAplic">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Aplicativo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="20"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotivo">
		<xs:annotation>
			<xs:documentation>Tipo Motivo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TJust">
		<xs:annotation>
			<xs:documentation>Tipo Justificativa</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="15"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TServ">
		<xs:annotation>
			<xs:documentation>Tipo Servio solicitado</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString"/>
	</xs:simpleType>
	<xs:simpleType name="Tano">
		<xs:annotation>
			<xs:documentation> Tipo ano</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMed">
		<xs:annotation>
			<xs:documentation> Tipo temp mdio em segundos</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TString">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TData">
		<xs:annotation>
			<xs:documentation> Tipo data AAAA-MM-DD</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="((((20|19|18)(([02468][048])|([13579][26]))-02-29))|((20|19|18)[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLatitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Latitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-8][0-9]\.[0-9]{6}|90\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-8][0-9]\.[0-9]{6}|-90\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLongitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Longitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-9][0-9]\.[0-9]{6}|1[0-7][0-9]\.[0-9]{6}|180\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-9][0-9]\.[0-9]{6}|-1[0-7][0-9]\.[0-9]{6}|-180\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNSU">
		<xs:annotation>
			<xs:documentation> Tipo nmero sequencial nico do AN</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIPv4">
		<xs:annotation>
			<xs:documentation>Tipo IP verso 4</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.04/xmldsig-core-schema_v1.01.xsd">
<?xml version="1.0" encoding="utf-8"?>
<!-- ***************************************************-->
<!-- ***   Schema especfico para assinaturas XML    ***-->
<!-- *** a partir de certificados do padro (X509)   ***-->
<!-- *** ICP-Brasil - Projeto Nota Fiscal Eletrnica ***-->
<!-- ***************************************************-->
<!-- Schema for XML Signatures-->
<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.w3.org/2000/09/xmldsig#" elementFormDefault="qualified" attributeFormDefault="unqualified" version="0.1">
	<element name="Signature" type="ds:SignatureType"/>
	<complexType name="SignatureType">
		<sequence>
			<element name="SignedInfo" type="ds:SignedInfoType"/>
			<element name="SignatureValue" type="ds:SignatureValueType"/>
			<element name="KeyInfo" type="ds:KeyInfoType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="SignatureValueType">
		<simpleContent>
			<extension base="base64Binary">
				<attribute name="Id" type="ID" use="optional"/>
			</extension>
		</simpleContent>
	</complexType>
	<complexType name="SignedInfoType">
		<sequence>
			<element name="CanonicalizationMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				</complexType>
			</element>
			<element name="SignatureMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				</complexType>
			</element>
			<element name="Reference" type="ds:ReferenceType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="ReferenceType">
		<sequence>
			<element name="Transforms" type="ds:TransformsType">
				<!-- Garante a unicidade do atributo -->
				<unique name="unique_Transf_Alg">
					<selector xpath="./*"/>
					<field xpath="@Algorithm"/>
				</unique>
			</element>
			<element name="DigestMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#sha1"/>
				</complexType>
			</element>
			<element name="DigestValue" type="ds:DigestValueType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
		<attribute name="URI" use="required">
			<simpleType>
				<restriction base="anyURI">
					<minLength value="2"/>
				</restriction>
			</simpleType>
		</attribute>
		<attribute name="Type" type="anyURI" use="optional"/>
	</complexType>
	<complexType name="TransformsType">
		<sequence>
			<element name="Transform" type="ds:TransformType" minOccurs="2" maxOccurs="2"/>
		</sequence>
	</complexType>
	<complexType name="TransformType">
		<sequence minOccurs="0" maxOccurs="unbounded">
			<element name="XPath" type="string"/>
		</sequence>
		<attribute name="Algorithm" type="ds:TTransformURI" use="required"/>
	</complexType>
	<complexType name="KeyInfoType">
		<sequence>
			<element name="X509Data" type="ds:X509DataType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="X509DataType">
		<sequence>
			<element name="X509Certificate" type="base64Binary"/>
		</sequence>
	</complexType>
	<simpleType name="DigestValueType">
		<restriction base="base64Binary"/>
	</simpleType>
	<simpleType name="TTransformURI">
		<restriction base="anyURI">
			<enumeration value="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
			<enumeration value="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
		</restriction>
	</simpleType>
</schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/consSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consSitNFCom" type="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema de validao XML dp Pedido de Consulta da Situao Atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/consSitNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:complexType name="TConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta da Situao Atual da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo; 
2 - Homologao;</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="CONSULTAR">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="chNFCom" type="TChDFe">
				<xs:annotation>
					<xs:documentation>Chaves de acesso do NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno de Pedido de Consulta da Situao Atual de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou o NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>cdigo da UF de atendimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" minOccurs="0">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar protNFCom da verso correspondente da NFCom autorizada</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element name="procEventoNFCom" minOccurs="0" maxOccurs="unbounded">
				<xs:complexType>
					<xs:sequence>
						<xs:any processContents="skip">
							<xs:annotation>
								<xs:documentation>Retornar procEventoNFCom da verso correspondente do evento NFCom autorizado</xs:documentation>
							</xs:annotation>
						</xs:any>
					</xs:sequence>
					<xs:attribute name="versao" use="required">
						<xs:simpleType>
							<xs:restriction base="xs:string">
								<xs:whiteSpace value="preserve"/>
								<xs:enumeration value="1.00"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsSitNFCom" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsSitNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta situao de NFCom - 1.00</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/consStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="consStatServNFCom" type="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/consStatServNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xServ" type="TServ" fixed="STATUS">
				<xs:annotation>
					<xs:documentation>Servio Solicitado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Tipo Resultado da Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TVerAplic">
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>Cdigo do status da mensagem enviada.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do servio solicitado.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo da UF responsvel pelo servio</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="dhRecbto" type="TDateTimeUTC">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tMed" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:integer">
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="dhRetorno" type="TDateTimeUTC" minOccurs="0">
				<xs:annotation>
					<xs:documentation>AAAA-MM-DDTHH:MM:SS TZD. Deve ser preenchida com data e hora previstas para o retorno dos servios prestados.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xObs" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Campo observao utilizado para incluir informaes ao contribuinte</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:minLength value="1"/>
						<xs:maxLength value="255"/>
						<xs:whiteSpace value="collapse"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerConsStat" use="required"/>
	</xs:complexType>
	<xs:simpleType name="TVerConsStat">
		<xs:annotation>
			<xs:documentation> Tipo Verso do Consulta do Status do Servio NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/DFeTiposBasicos_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2025 rel. 2 (x64) (https://www.altova.com) by PROCERGS (Procergs - Centro de Tecnologia da Informao e Comunicao do Estado do Rio Grande do Sul S.A.) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">
	<xs:simpleType name="TStringRTC">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCST">
		<xs:annotation>
			<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="\d{3}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TcClassTrib">
		<xs:annotation>
			<xs:documentation>Cdigo de Classificao Tributria do IBS e da CBS</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="\d{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TcCredPres">
		<xs:annotation>
			<xs:documentation>Cdigo de Classificao do Crdito Presumido do IBS e da CBS, conforme tabela cCredPres</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="\d{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec1104RTC">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104OpRTC">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 inteiros, podendo ter 4 decimais (utilizado em tags opcionais)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[1-9]{1}[0-9]{3}|0\.[0-9]{3}[1-9]{1}|0\.[0-9]{2}[1-9]{1}[0-9]{1}|0\.[0-9]{1}[1-9]{1}[0-9]{2}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec1302RTC">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 de corpo e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_04RTC">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TOperCompraGov">
		<xs:annotation>
			<xs:documentation>Tipo da Operao com Ente Governamental</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEnteGov">
		<xs:annotation>
			<xs:documentation>Tipo de Ente Governamental</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTpCredPresIBSZFM">
		<xs:annotation>
			<xs:documentation>Tipo de classificao do Crdito Presumido IBS ZFM</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIndDoacao">
		<xs:annotation>
			<xs:documentation>Tipo Indicador de Doao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="1"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:complexType name="TTribNFCom">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Indica se a operao  de doao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNF3e">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NF3e</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Indica se a operao  de doao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFAg">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFAg</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribCTe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao do CTe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribBPe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao do BPe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0"/>
			<xs:element name="gIBSCBS" type="TCIBS" minOccurs="0"/>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFCe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFCe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Indica se a operao  de doao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:choice minOccurs="0">
				<xs:element name="gIBSCBS" type="TCIBS"/>
				<xs:element name="gIBSCBSMono" type="TMonofasia"/>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFe">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFe</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Indica se a operao  de doao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:choice minOccurs="0">
				<xs:element name="gIBSCBS" type="TCIBS"/>
				<xs:element name="gIBSCBSMono" type="TMonofasia">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para Monofasia (CST 620)</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="gTransfCred" type="TTransfCred">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para o CST 800</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="gAjusteCompet" type="TAjusteCompet">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para o CST 811</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:choice minOccurs="0">
				<xs:element name="gCredPresOper" type="TCredPresOper">
					<xs:annotation>
						<xs:documentation>Crdito Presumido da Operao. Informado conforme indicador no cClassTrib.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="gCredPresIBSZFM" type="TCredPresIBSZFM">
					<xs:annotation>
						<xs:documentation>Classificao de acordo com o art. 450,  1, da LC 214/25 para o clculo do crdito presumido na ZFM. Informado conforme indicador no cClassTrib.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribNFGas">
		<xs:annotation>
			<xs:documentation>Grupo de informaes da Tributao da NFGas</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CST" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do IBS/CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTrib" type="TcClassTrib"/>
			<xs:element name="indDoacao" type="TIndDoacao" minOccurs="0"/>
			<xs:choice minOccurs="0">
				<xs:element name="gIBSCBS" type="TCIBS"/>
				<xs:element name="gIBSCBSMono" type="TMonofasia">
					<xs:annotation>
						<xs:documentation>Informar essa opo da Choice para Monofasia</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="gEstornoCred" type="TEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Informado conforme indicador no cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIS">
		<xs:annotation>
			<xs:documentation>Grupo de informaes do Imposto Seletivo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CSTIS" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo Situao Tributria do Imposto Seletivo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTribIS" type="TcClassTrib"/>
			<xs:sequence minOccurs="0">
				<xs:element name="vBCIS" type="TDec1302RTC">
					<xs:annotation>
						<xs:documentation>Valor do BC</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="pIS" type="TDec_0302_04RTC">
					<xs:annotation>
						<xs:documentation>Alquota do Imposto Seletivo (percentual)</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="pISEspec" type="TDec_0302_04RTC" minOccurs="0">
					<xs:annotation>
						<xs:documentation>Alquota do Imposto Seletivo (por valor)</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:sequence minOccurs="0">
					<xs:element name="uTrib">
						<xs:annotation>
							<xs:documentation>Unidade de medida apropriada especificada em Lei Ordinaria para fins de apurao do Imposto Seletivo</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="TStringRTC">
								<xs:minLength value="1"/>
								<xs:maxLength value="6"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:element>
					<xs:element name="qTrib" type="TDec_1104OpRTC">
						<xs:annotation>
							<xs:documentation>Quantidade com abse no campo uTrib informado</xs:documentation>
						</xs:annotation>
					</xs:element>
				</xs:sequence>
				<xs:element name="vIS" type="TDec1302RTC">
					<xs:annotation>
						<xs:documentation>Valor do Imposto Seletivo calculado</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TISTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais do Imposto Seletivo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vIS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor Total do Imposto Seletivo</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIBSCBSTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais da CBS/IBS</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vBCIBSCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Total Base de Calculo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBS">
				<xs:annotation>
					<xs:documentation>Totalizao do IBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="gIBSUF">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia da UF</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSUF" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Estadual</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gIBSMun">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia Municipal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSMun" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Municipal</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="vIBS" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gCBS">
				<xs:annotation>
					<xs:documentation>Totalizao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vDif" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vDevTrib" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total de devolues de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao do estorno de crdito</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vIBSEstCred" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS estornado</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSEstCred" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS estornada</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TIBSCBSMonoTot">
		<xs:annotation>
			<xs:documentation>Grupo de informaes de totais da CBS/IBS com monofasia</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vBCIBSCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Total Base de Calculo</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBS" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao do IBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="gIBSUF">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia da UF</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSUF" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Estadual</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gIBSMun">
							<xs:annotation>
								<xs:documentation>Totalizao do IBS de competncia Municipal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="vDif" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total do Diferimento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vDevTrib" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Total de devolues de tributos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="vIBSMun" type="TDec1302RTC">
										<xs:annotation>
											<xs:documentation>Valor total do IBS Municipal</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="vIBS" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPresCondSus" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido Condio Suspensiva</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gCBS" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vDif" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vDevTrib" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total de devolues de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPres" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCredPresCondSus" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Total do Crdito Presumido Condio Suspensiva</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gMono" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totais da Monofasia</xs:documentation>
					<xs:documentation>S dever ser utilizado para DFe modelos 55 e 65</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vIBSMono" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS monofsico</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMono" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS monofsica</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoReten" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS monofsico sujeito a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoReten" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS monofsica sujeita a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoRet" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor do IBS monofsico retido anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoRet" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS monofsica retida anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gEstornoCred" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Totalizao do estorno de crdito</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="vIBSEstCred" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total do IBS estornado</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSEstCred" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor total da CBS estornada</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TMonofasia">
		<xs:annotation>
			<xs:documentation>Tipo Monofasia</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:annotation>
				<xs:documentation>Monofasia</xs:documentation>
			</xs:annotation>
			<xs:element name="gMonoPadrao" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da Tributao Monofsica padro</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qBCMono" type="TDec1104RTC">
							<xs:annotation>
								<xs:documentation>Quantidade tributada na monofasia</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemIBS" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem do IBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemCBS" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMono" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor do IBS monofsico</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMono" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS monofsica</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gMonoReten" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da Tributao Monofsica sujeita a reteno</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qBCMonoReten" type="TDec1104RTC">
							<xs:annotation>
								<xs:documentation>Quantidade tributada sujeita a reteno.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemIBSReten" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem do IBS sujeito a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoReten" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor do IBS monofsico sujeito a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemCBSReten" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem da CBS sujeita a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoReten" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS monofsica sujeita a reteno</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gMonoRet" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da Tributao Monofsica retida anteriormente</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qBCMonoRet" type="TDec1104RTC">
							<xs:annotation>
								<xs:documentation>Quantidade tributada retida anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemIBSRet" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem do IBS retido anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoRet" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor do IBS retido anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="adRemCBSRet" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Alquota ad rem da CBS retida anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoRet" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS retida anteriormente</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gMonoDif" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes do diferimento da Tributao Monofsica</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="pDifIBS" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Percentual do diferimento do imposto monofsico</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vIBSMonoDif" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor do IBS monofsico diferido</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="pDifCBS" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Percentual do diferimento do imposto monofsico</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBSMonoDif" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS monofsica diferida</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="vTotIBSMonoItem" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Total de IBS monofsico do item</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTotCBSMonoItem" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Total da CBS monofsica do item</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCIBS">
		<xs:annotation>
			<xs:documentation>Tipo CBS IBS Completo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:annotation>
				<xs:documentation>IBS / CBS</xs:documentation>
			</xs:annotation>
			<xs:element name="vBC" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do BC</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:sequence>
				<xs:element name="gIBSUF">
					<xs:annotation>
						<xs:documentation>Grupo de informaes do IBS na UF</xs:documentation>
					</xs:annotation>
					<xs:complexType>
						<xs:sequence>
							<xs:element name="pIBSUF" type="TDec_0302_04RTC">
								<xs:annotation>
									<xs:documentation>Aliquota do IBS de competncia das UF (em percentual)</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gDif" type="TDif" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gRed" type="TRed" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="vIBSUF" type="TDec1302RTC">
								<xs:annotation>
									<xs:documentation>Valor do IBS de competncia das UF</xs:documentation>
								</xs:annotation>
							</xs:element>
						</xs:sequence>
					</xs:complexType>
				</xs:element>
				<xs:element name="gIBSMun">
					<xs:annotation>
						<xs:documentation>Grupo de Informaes do IBS no Municpio</xs:documentation>
					</xs:annotation>
					<xs:complexType>
						<xs:sequence>
							<xs:element name="pIBSMun" type="TDec_0302_04RTC">
								<xs:annotation>
									<xs:documentation>Aliquota do IBS Municipal (em percentual)</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gDif" type="TDif" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="gRed" type="TRed" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
								</xs:annotation>
							</xs:element>
							<xs:element name="vIBSMun" type="TDec1302RTC">
								<xs:annotation>
									<xs:documentation>Valor do IBS Municipal</xs:documentation>
								</xs:annotation>
							</xs:element>
						</xs:sequence>
					</xs:complexType>
				</xs:element>
				<xs:element name="vIBS" type="TDec1302RTC">
					<xs:annotation>
						<xs:documentation>Valor do IBS</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
			<xs:element name="gCBS">
				<xs:annotation>
					<xs:documentation>Grupo de Tributao da CBS</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="pCBS" type="TDec_0302_04RTC">
							<xs:annotation>
								<xs:documentation>Aliquota da CBS (em percentual)</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDif" type="TDif" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos do Diferimento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gDevTrib" type="TDevTrib" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de Informaes da devoluo de tributos</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="gRed" type="TRed" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Grupo de campos da reduo de aliquota</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="vCBS" type="TDec1302RTC">
							<xs:annotation>
								<xs:documentation>Valor da CBS</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="gTribRegular" type="TTribRegular" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da Tributao Regular. Informar como seria a tributao caso no cumprida a condio resolutria/suspensiva. Exemplo 1: Art. 442, 4. Operaes com ZFM e ALC. Exemplo 2: Operaes com suspenso do tributo.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gTribCompraGov" type="TTribCompraGov" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de informaes da composio do valor do IBS e da CBS em compras governamental</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRed">
		<xs:annotation>
			<xs:documentation>Tipo Reduo Base de Clculo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pRedAliq" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Percentual de reduo de aliquota do cClassTrib</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfet" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Aliquota Efetiva que ser aplicada a Base de Calculo (em percentual)</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCredPres">
		<xs:annotation>
			<xs:documentation>Tipo Crdito Presumido</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pCredPres" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Percentual do Crdito Presumido</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:choice>
				<xs:element name="vCredPres" type="TDec1302RTC">
					<xs:annotation>
						<xs:documentation>Valor do Crdito Presumido</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="vCredPresCondSus" type="TDec1302RTC">
					<xs:annotation>
						<xs:documentation>Valor do Crdito Presumido Condio Suspensiva, preencher apenas para cCredPres que possui indicao de Condio Suspensiva</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TDif">
		<xs:annotation>
			<xs:documentation>Tipo Diferimento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pDif" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Percentual do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vDif" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do diferimento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TDevTrib">
		<xs:annotation>
			<xs:documentation>Tipo Devoluo Tributo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vDevTrib" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do tributo devolvido. No fornecimento de energia eltrica, gua, esgoto e
gs natural e em outras hipteses definidas no regulamento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribRegular">
		<xs:annotation>
			<xs:documentation>Tipo Tributao Regular</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CSTReg" type="TCST">
				<xs:annotation>
					<xs:documentation>Cdigo da Situao Tributria do IBS e CBS</xs:documentation>
					<xs:documentation>Informar qual seria o CST caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cClassTribReg" type="TcClassTrib">
				<xs:annotation>
					<xs:documentation>Informar qual seria o cClassTrib caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegIBSUF" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Alquota do IBS da UF</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegIBSUF" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do IBS da UF</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegIBSMun" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Alquota do IBS do Municpio</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegIBSMun" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do IBS do Municpio</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqEfetRegCBS" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Alquota da CBS</xs:documentation>
					<xs:documentation>Informar como seria a Alquota caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vTribRegCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor da CBS</xs:documentation>
					<xs:documentation>Informar como seria o valor do Tributo caso no cumprida a condio resolutria/suspensiva</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTribCompraGov">
		<xs:annotation>
			<xs:documentation>Tipo Tributao Compra Governamental</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="pAliqIBSUF" type="TDec_0302_04RTC"/>
			<xs:element name="vTribIBSUF" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor que seria devido a UF, sem aplicao do Art. 473. da LC 214/2025</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqIBSMun" type="TDec_0302_04RTC"/>
			<xs:element name="vTribIBSMun" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor que seria devido ao municpio, sem aplicao do Art. 473. da LC 214/2025</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pAliqCBS" type="TDec_0302_04RTC"/>
			<xs:element name="vTribCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor que seria devido a CBS, sem aplicao do Art. 473. da LC 214/2025</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCompraGovReduzido">
		<xs:annotation>
			<xs:documentation>Tipo Compras Governamentais</xs:documentation>
			<xs:documentation>Cada DFe que utilizar dever utilizar esses tipo no grupo ide</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpEnteGov" type="TEnteGov">
				<xs:annotation>
					<xs:documentation>Para administrao pblica direta e suas autarquias e fundaes:
1=Unio
2=Estados
3=Distrito Federal
4=Municpios</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pRedutor" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Percentual de reduo de aliquota em compra governamental</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCompraGov">
		<xs:annotation>
			<xs:documentation>Tipo Compras Governamentais</xs:documentation>
			<xs:documentation>Cada DFe que utilizar dever utilizar esses tipo no grupo ide</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpEnteGov" type="TEnteGov">
				<xs:annotation>
					<xs:documentation>Para administrao pblica direta e suas autarquias e fundaes:
1=Unio
2=Estados
3=Distrito Federal
4=Municpios</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="pRedutor" type="TDec_0302_04RTC">
				<xs:annotation>
					<xs:documentation>Percentual de reduo de aliquota em compra governamental</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tpOperGov" type="TOperCompraGov">
				<xs:annotation>
					<xs:documentation>Tipo da operao com ente governamental:
1 - Fornecimento
2 - Recebimento do Pagamento</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TTransfCred">
		<xs:annotation>
			<xs:documentation>Tipo Transferncia de Crdito</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vIBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do IBS a ser transferido</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor da CBS a ser transferida</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEstornoCred">
		<xs:annotation>
			<xs:documentation>Tipo Estorno de Crdito</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vIBSEstCred" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do IBS a ser estornado</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCBSEstCred" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor da CBS a ser estornada</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="TCompetApur">
		<xs:annotation>
			<xs:documentation>Ano e ms referncia do perodo de apurao (AAAA-MM)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:gYearMonth">
			<xs:minInclusive value="2025-01"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:complexType name="TAjusteCompet">
		<xs:annotation>
			<xs:documentation>Tipo Ajuste de Competncia</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="competApur" type="TCompetApur">
				<xs:annotation>
					<xs:documentation>Ano e ms referncia do perodo de apurao (AAAA-MM)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vIBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do IBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCBS" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor da CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCredPresOper">
		<xs:annotation>
			<xs:documentation>Tipo Crdito Presumido da Operao</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="vBCCredPres" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor da Base de Clculo do Crdito Presumido da Operao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cCredPres" type="TcCredPres">
				<xs:annotation>
					<xs:documentation>Cdigo de Classificao do Crdito Presumido do IBS e da CBS</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gIBSCredPres" type="TCredPres" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de Informaes do Crdito Presumido referente ao IBS, quando aproveitado pelo emitente do documento. </xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="gCBSCredPres" type="TCredPres" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Grupo de Informaes do Crdito Presumido referente a CBS, quando aproveitado pelo emitente do documento. </xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TCredPresIBSZFM">
		<xs:annotation>
			<xs:documentation>Tipo Informaes do crdito presumido de IBS para fornecimentos a partir da ZFM</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="competApur" type="TCompetApur">
				<xs:annotation>
					<xs:documentation>Ano e ms referncia do perodo de apurao (AAAA-MM)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="tpCredPresIBSZFM" type="TTpCredPresIBSZFM">
				<xs:annotation>
					<xs:documentation>Classificao de acordo com o art. 450,  1, da LC 214/25 para o clculo do crdito presumido na ZFM</xs:documentation>
					<xs:documentation>0 - Sem crdito presumido;
1 - Bens de consumo final (55%);
2 - Bens de capital (75%);
3 - Bens intermedirios (90,25%);
4 - Bens de informtica e outros definidos em legislao (100%).
OBS: Percentuais definidos no art. 450,  1, da LC 214/25 para o clculo do crdito presumido
</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="vCredPresIBSZFM" type="TDec1302RTC">
				<xs:annotation>
					<xs:documentation>Valor do crdito presumido calculado sobre o saldo devedor apurado</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/evCancNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="evCancNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do evento do cancelamento 
110111</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="descEvento">
					<xs:annotation>
						<xs:documentation>Descrio do Evento - Cancelamento</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:whiteSpace value="preserve"/>
							<xs:enumeration value="Cancelamento"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="nProt" type="TProt">
					<xs:annotation>
						<xs:documentation>Nmero do Protocolo de Status da NFCom</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="xJust" type="TJust">
					<xs:annotation>
						<xs:documentation>Justificativa do Cancelamento</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/eventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="eventoNFCom" type="TEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Pedido de Registro de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/eventoNFComTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:complexType name="TEvento">
		<xs:annotation>
			<xs:documentation>Tipo Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="CNPJ" type="TCnpj">
							<xs:annotation>
								<xs:documentation>CNPJ do emissor do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de Acesso da NFCom vinculada ao evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhEvento" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e Hora do Evento, formato UTC (AAAA-MM-DDThh:mm:ssTZD)</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento">
							<xs:annotation>
								<xs:documentation>Tipo do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento">
							<xs:annotation>
								<xs:documentation>Seqencial do evento para o mesmo tipo de evento.  Para maioria dos eventos ser 1, nos casos em que possa existir mais de um evento o autor do evento deve numerar de forma seqencial.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="detEvento">
							<xs:annotation>
								<xs:documentation>Detalhamento do evento especfico</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:any processContents="skip">
										<xs:annotation>
											<xs:documentation>XML do evento
Insira neste local o XML especfico do tipo de evento (cancelamento, encerramento, registro de passagem).  </xs:documentation>
										</xs:annotation>
									</xs:any>
								</xs:sequence>
								<xs:attribute name="versaoEvento" use="required">
									<xs:simpleType>
										<xs:restriction base="xs:string">
											<xs:whiteSpace value="preserve"/>
											<xs:pattern value="1\.(0[0-9]|[1-9][0-9])"/>
										</xs:restriction>
									</xs:simpleType>
								</xs:attribute>
							</xs:complexType>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da TAG a ser assinada, a regra de formao do Id :
ID + tpEvento +  chave da NF-3e + nSeqEvento (preencher com zeros a esquerda para compor 3 digitos)</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{53}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEvento">
		<xs:annotation>
			<xs:documentation>Tipo retorno do Evento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infEvento">
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que recebeu o Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cOrgao" type="TCOrgaoIBGE">
							<xs:annotation>
								<xs:documentation>Cdigo do rgo de recepo do Evento. Utilizar a Tabela do IBGE extendida, utilizar 90 para identificar SUFRAMA</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat" type="TStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status do registro do Evento</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Chave de Acesso NFCom vinculada</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tpEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Tipo do Evento vinculado</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{6}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Descrio do Evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TString">
									<xs:minLength value="4"/>
									<xs:maxLength value="60"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="nSeqEvento" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Seqencial do evento</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:pattern value="[0-9]{1,3}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
						<xs:element name="dhRegEvento" type="TDateTimeUTC" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Data e Hora de do recebimento do evento ou do registro do evento formato AAAA-MM-DDThh:mm:ssTZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do protocolo de registro do evento</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" use="optional">
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="ID[0-9]{16}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" use="required">
			<xs:simpleType>
				<xs:restriction base="TVerEvento"/>
			</xs:simpleType>
		</xs:attribute>
	</xs:complexType>
	<xs:complexType name="TProcEvento">
		<xs:annotation>
			<xs:documentation>Tipo procEvento</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="eventoNFCom" type="TEvento"/>
			<xs:element name="retEventoNFCom" type="TRetEvento"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerEvento" use="required"/>
		<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
			<xs:annotation>
				<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
			</xs:annotation>
		</xs:attribute>
		<xs:attribute name="nPortaCon" use="optional">
			<xs:annotation>
				<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
			</xs:annotation>
			<xs:simpleType>
				<xs:restriction base="xs:string">
					<xs:pattern value="[0-9]{1,5}"/>
				</xs:restriction>
			</xs:simpleType>
		</xs:attribute>
		<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
			<xs:annotation>
				<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
			</xs:annotation>
		</xs:attribute>
	</xs:complexType>
	<xs:simpleType name="TVerEvento">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Evento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/nfcom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="NFCom" type="TNFCom">
		<xs:annotation>
			<xs:documentation>Nota Fiscal Fatura de Comunicao Eletrnica</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/nfcomTiposBasico_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2014 rel. 2 (http://www.altova.com) by private (private) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="xmldsig-core-schema_v1.01.xsd"/>
	<xs:include schemaLocation="tiposGeralNFCom_v1.00.xsd"/>
	<xs:include schemaLocation="DFeTiposBasicos_v1.00.xsd"/>
	<xs:complexType name="TNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Nota Fiscal Fatura de Comunicao</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infNFCom">
				<xs:annotation>
					<xs:documentation>Informaes da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="ide">
							<xs:annotation>
								<xs:documentation>Identificao da NFCom</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="cUF" type="TCodUfIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo da UF de emisso e autorizao da NFCom</xs:documentation>
											<xs:documentation>Cdigo da UF de emisso e autorizao do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpAmb" type="TAmb">
										<xs:annotation>
											<xs:documentation>Tipo do Ambiente</xs:documentation>
											<xs:documentation>1 - Produo; 
2 - Homologao</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="mod" type="TModNFCom">
										<xs:annotation>
											<xs:documentation>Modelo da NFCom</xs:documentation>
											<xs:documentation>Utilizar o cdigo 62 para identificao da NFCom</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="serie" type="TSerie">
										<xs:annotation>
											<xs:documentation>Srie do documento fiscal</xs:documentation>
											<xs:documentation>Informar a srie do documento fiscal (informar zero para srie nica).</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nNF" type="TNF">
										<xs:annotation>
											<xs:documentation>Nmero do documento fiscal</xs:documentation>
											<xs:documentation>Nmero que identifica o documento fiscal 1 a 999999999.</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="cNF">
										<xs:annotation>
											<xs:documentation>Cdigo numrico que compe a Chave de Acesso. </xs:documentation>
											<xs:documentation>Cdigo aleatrio gerado pelo emitente, com o objetivo de evitar acessos indevidos ao documento.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{7}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cDV">
										<xs:annotation>
											<xs:documentation>Digito verificador da chave de acesso</xs:documentation>
											<xs:documentation>Informar o dgito  de controle da chave de acesso documento fiscal, que deve ser calculado com a aplicao do algoritmo mdulo 11 (base 2,9) da chave de acesso. </xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dhEmi" type="TDateTimeUTC">
										<xs:annotation>
											<xs:documentation>Data e hora de emisso do documento fiscal</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DDTHH:MM:DD TZD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpEmis" type="TtpEmis">
										<xs:annotation>
											<xs:documentation>Forma de emisso do Documento Fiscal </xs:documentation>
											<xs:documentation>1 - Normal
; 2 - Contingncia</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nSiteAutoriz">
										<xs:annotation>
											<xs:documentation>Identificao do nmero do Site do Autorizador de recepo da NFCom</xs:documentation>
											<xs:documentation>Se o autorizador da NFCom possuir apenas um site dever ser informado com Zero (0), em caso de Autorizador trabalhar com mltiplos sites indicar o nmero do site para qual foi endereada a NFCOM (1 a 9).

Observao: o ambiente autorizador que trabalhar com mais de um Site dever divulgar para cada endereo de site qual nmero correspondente de nSiteAutoriz o contribuinte pode usar</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[0-9]{1}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="cMunFG" type="TCodMunIBGE">
										<xs:annotation>
											<xs:documentation>Cdigo do municpio de ocorrncia do fato gerador</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="finNFCom" type="TFinNFCom">
										<xs:annotation>
											<xs:documentation>Finalidade de emisso da NFCom</xs:documentation>
											<xs:documentation>0- NFCom Normal; 
3 - NFCom de Substituio; 
4 - NFCom de Ajuste;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpFat" type="TFatNFCom">
										<xs:annotation>
											<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
											<xs:documentation>0- Faturamento Normal; 1 - Faturamento centralizado; 2 - Cofaturamento</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="verProc">
										<xs:annotation>
											<xs:documentation>Verso do processo de emisso</xs:documentation>
											<xs:documentation>Informar a verso do aplicativo emissor de NFCom.</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indPrePago" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de servio pr-pago</xs:documentation>
											<xs:documentation>1  Servio pr-pago (informar a tag somente se a nota for referente a um servio exclusivamente pr-pago)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indCessaoMeiosRede" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de Sesso de Meios de Rede.</xs:documentation>
											<xs:documentation>Uma vez informado (valor = 1), essa tag dispensa gerao do grupo Fatura.
Apenas para notas dos tipos Normal e Substituio com tipo de faturamento normal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="indNotaEntrada" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Indicador de nota de entrada</xs:documentation>
											<xs:documentation>1  Informar quando for nota de ajuste e possuir itens com CFOP de entrada</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:whiteSpace value="preserve"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informar apenas
para tpEmis diferente de 1</xs:documentation>
										</xs:annotation>
										<xs:element name="dhCont" type="TDateTimeUTC">
											<xs:annotation>
												<xs:documentation>Data e Hora da entrada em contingncia</xs:documentation>
												<xs:documentation>Informar a data e hora no formato AAAA-MM-DDTHH:MM:SS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="xJust">
											<xs:annotation>
												<xs:documentation>Justificativa da entrada em contingncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="15"/>
													<xs:maxLength value="256"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:element name="gCompraGov" type="TCompraGovReduzido" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Grupo de Compras Governamentais</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="emit">
							<xs:annotation>
								<xs:documentation>Identificao do Emitente do documento fiscal</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="CNPJ" type="TCnpj">
										<xs:annotation>
											<xs:documentation>CNPJ do emitente</xs:documentation>
											<xs:documentation>Informar zeros no significativos</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIe">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IEUFDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual Virtual do emitente na UF de Destino da partilha (IE Virtual)</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TIe"/>
										</xs:simpleType>
									</xs:element>
									<xs:element name="CRT" type="TCRT">
										<xs:annotation>
											<xs:documentation>Cdigo do Regime Tributrio</xs:documentation>
											<xs:documentation>Informar: 1=Simples Nacional; 
2=Simples Nacional, excesso sublimite de receita bruta;
3=Regime Normal. 
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="xFant" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nome fantasia do emitente</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderEmit" type="TEndeEmi">
										<xs:annotation>
											<xs:documentation>Endereo do emitente</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="dest">
							<xs:annotation>
								<xs:documentation>Identificao do destinatrio / assinante </xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="xNome">
										<xs:annotation>
											<xs:documentation>Razo social ou Nome do destinatrio</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="60"/>
												<xs:minLength value="2"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpjOpc">
											<xs:annotation>
												<xs:documentation>Nmero do CNPJ</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>Nmero do CPF</xs:documentation>
												<xs:documentation>Informar os zeros no significativos.</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="idOutros">
											<xs:annotation>
												<xs:documentation>Identificao do destinatrio outros</xs:documentation>
												<xs:documentation>Identificao do destinatrio no obrigado a inscrio do CPF tais como estrangeiro, indgena e quilombola;
Em caso de no contar CPF do assinante, informar o RG</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="2"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="([!-]{0}|[!-]{2,20})?"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:choice>
									<xs:element name="indIEDest" type="TIndIEDest">
										<xs:annotation>
											<xs:documentation>Indicador da IE do Destinatrio</xs:documentation>
											<xs:documentation>1 - Contribuinte ICMS (informar a IE do destinatrio); 

2 - Contribuinte isento de Inscrio no cadastro de Contribuintes do ICMS;

 9 - No Contribuinte, que pode ou no possuir Inscrio Estadual no Cadastro de Contribuintes do ICMS. 

Nota: No caso de Contribuinte Isento de Inscrio (indIEDest=2) informar a tag IE do destinatrio com o literal ISENTO.
</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IE" type="TIeDest" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Estadual do destinatrio</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="IM" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Inscrio Municipal</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="15"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="enderDest" type="TEndeDest">
										<xs:annotation>
											<xs:documentation>Endereo do destinatrio / assinante</xs:documentation>
										</xs:annotation>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="assinante">
							<xs:annotation>
								<xs:documentation>Dados do assinante</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:element name="iCodAssinante">
										<xs:annotation>
											<xs:documentation>Cdigo nico de Identificao do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="30"/>
												<xs:pattern value="([!-]{0}|[!-]{1,30})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="tpAssinante" type="TAssinante">
										<xs:annotation>
											<xs:documentation>Tipo de assinante</xs:documentation>
											<xs:documentation>1-Comercial;
2-Industrial;
3-Residencial/Pessoa Fsica;
4-Produtor Rural;
5-rgo da administrao pblica estadual direta e suas fundaes e autarquias, quando mantidas pelo poder pblico estadual e regidas por normas de direito pblico, nos termos do Convnio ICMS 107/95; 	
6-Prestador de servio de telecomunicao responsvel pelo recolhimento do imposto incidente sobre a cesso dos meios de rede do prestador do servio ao usurio final, nos termos do Convnio ICMS 17/13 ;	
7-Misses Diplomticas, Reparties Consulares e Organismos Internacionais, nos termos do Convnio ICMS 158/94 ;	
8-Igrejas e Templos de qualquer natureza ;
99-Outros no especificados anteriormente 	</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="tpServUtil" type="TUtilizacao">
										<xs:annotation>
											<xs:documentation>Tipo de servio utilizado</xs:documentation>
											<xs:documentation>1-Telefonia; 2-Comunicao de dados; 3-TV por Assinatura;4 - Provimento de acesso  Internet; 5-Multimdia; 6-Outros; 7-Varios;</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="nContrato" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Nmero do Contrato do assinante</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="20"/>
												<xs:pattern value="([!-]{0}|[!-]{1,20})?"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="dContratoIni" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de incio do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:element name="dContratoFim" type="TData" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Data de trmino do contrato</xs:documentation>
											<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
										</xs:annotation>
									</xs:element>
									<xs:sequence minOccurs="0">
										<xs:annotation>
											<xs:documentation>Identifica o terminal principal do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermPrinc">
											<xs:annotation>
												<xs:documentation>Nmero do Terminal Principal do servio contratado</xs:documentation>
												<xs:documentation>Em se tratando de plano de prestao de servio telefnico corporativo, familiar ou similares, informar o nmero do terminal telefnico principal do plano. </xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFPrinc" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
												<xs:documentation> Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
									<xs:sequence minOccurs="0" maxOccurs="unbounded">
										<xs:annotation>
											<xs:documentation>Identifica os terminais adicionais do contrato
Sequencia XML</xs:documentation>
										</xs:annotation>
										<xs:element name="NroTermAdic">
											<xs:annotation>
												<xs:documentation>Nmero dos Terminais adicionais do servio contratado</xs:documentation>
												<xs:documentation/>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:pattern value="[0-9]{7,12}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="cUFAdic" type="TCodUfIBGE">
											<xs:annotation>
												<xs:documentation>Cdigo da UF de habilitao do terminal</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:sequence>
							<xs:annotation>
								<xs:documentation>Conjunto de informaes da NFCom </xs:documentation>
							</xs:annotation>
							<xs:element name="gSub" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes da substituio</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFCom" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom original</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary"/>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
										<xs:element name="motSub" type="TMotSub">
											<xs:annotation>
												<xs:documentation>Motivo da substituio</xs:documentation>
												<xs:documentation>01  Erro de Preo
02  Erro Cadastral
03  Deciso Judicial
04 - Erro de Tributao
05 - Descontinuidade do Servio</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gCofat" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de Informaes do Cofaturamento</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:choice>
											<xs:element name="chNFComLocal" type="TChDFe">
												<xs:annotation>
													<xs:documentation>Chave de acesso da NFCom emitida pela Operadora Local</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gNF">
												<xs:annotation>
													<xs:documentation>Informao da NF modelo 21/22 referenciada</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="CNPJ" type="TCnpj">
															<xs:annotation>
																<xs:documentation>CNPJ do Emitente</xs:documentation>
																<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="mod" type="TModNFPapel">
															<xs:annotation>
																<xs:documentation>Modelo do documento</xs:documentation>
																<xs:documentation>21 ou 22</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="serie">
															<xs:annotation>
																<xs:documentation>Serie do documento fiscal</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:minLength value="3"/>
																	<xs:maxLength value="3"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
														<xs:element name="nNF" type="TNF">
															<xs:annotation>
																<xs:documentation>Nmero do documento fiscal</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="CompetEmis" type="TCompet">
															<xs:annotation>
																<xs:documentation>Ano e ms da emisso da NF (AAAAMM)</xs:documentation>
															</xs:annotation>
														</xs:element>
														<xs:element name="hash115" minOccurs="0">
															<xs:annotation>
																<xs:documentation>Hash do registro no arquivo do convnio 115</xs:documentation>
																<xs:documentation>Campo poder ser exigido a critrio da UF  campo 36 do arquivo MESTRE DE DOCUMENTO FISCAL (Anexo nico, item 5 do Conv. 115/03)</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="xs:base64Binary"/>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:choice>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="det" maxOccurs="990">
								<xs:annotation>
									<xs:documentation>Detalhamento de Produtos e Servios </xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="prod">
											<xs:annotation>
												<xs:documentation>Dados do Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="cProd">
														<xs:annotation>
															<xs:documentation>Cdigo do produto ou servio. </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="60"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xProd">
														<xs:annotation>
															<xs:documentation>Descrio do produto ou servio</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:maxLength value="120"/>
																<xs:minLength value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="cClass">
														<xs:annotation>
															<xs:documentation>Cdigo de classificao</xs:documentation>
															<xs:documentation>Tabela de Classificao de Item da NFCom (validar por RV)</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="7"/>
																<xs:maxLength value="7"/>
																<xs:whiteSpace value="preserve"/>
																<xs:pattern value="[0-9]{7}"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="CFOP" type="TCfop" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CFOP</xs:documentation>
															<xs:documentation>Utilizar Tabela de CFOP. </xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="CNPJLD" type="TCnpj" minOccurs="0">
														<xs:annotation>
															<xs:documentation>CNPJ da operadora LD</xs:documentation>
															<xs:documentation>Informar o CNPJ da operadora LD que ir lanar o item de cofaturamento em nota do tipo faturamento 2</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="uMed" type="TUMedItem">
														<xs:annotation>
															<xs:documentation>Unidade Bsica de Medida</xs:documentation>
															<xs:documentation>1=Minuto
; 2=MB; 
3=GB; 
4=UN</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="dExpiracao" type="TData" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Data de expirao de crdito </xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="imposto">
											<xs:annotation>
												<xs:documentation>Tributos incidentes no Produto ou Servio</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:complexContent>
													<xs:extension base="TImp">
														<xs:sequence>
															<xs:choice>
																<xs:sequence>
																	<xs:choice>
																		<xs:element name="ICMS00">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao normal do ICMS</xs:documentation>
																				<xs:documentation>Tributada integralmente</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>00 - tributao normal ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="00"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS20">
																			<xs:annotation>
																				<xs:documentation>Prestao sujeito  tributao com reduo de BC do ICMS</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>20 - tributao com BC reduzida do ICMS</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="20"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="pRedBC" type="TDec_0302Opc">
																						<xs:annotation>
																							<xs:documentation>Percentual de reduo da BC</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vBC" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor da BC do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="pICMS" type="TDec_0302">
																						<xs:annotation>
																							<xs:documentation>Alquota do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:element name="vICMS" type="TDec_1302">
																						<xs:annotation>
																							<xs:documentation>Valor do ICMS</xs:documentation>
																						</xs:annotation>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
 item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS40">
																			<xs:annotation>
																				<xs:documentation>Tributao Isenta, No tributada</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>40=Isenta; 41=No tributada;
</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="40"/>
																								<xs:enumeration value="41"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS51">
																			<xs:annotation>
																				<xs:documentation>Tributao com Diferimento </xs:documentation>
																				<xs:documentation>A exigncia do preenchimento das informaes do ICMS diferido fica a critrio de cada UF</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do servio</xs:documentation>
																							<xs:documentation>Tributao pelo ICMS 51 - Diferimento</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="51"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMS90">
																			<xs:annotation>
																				<xs:documentation>ICMS Outros</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation> 90 - ICMS outros</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequncia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vBC" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor da BC do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="pICMS" type="TDec_0302">
																							<xs:annotation>
																								<xs:documentation>Alquota do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vICMS" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="vICMSDeson" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS de desonerao</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="cBenef">
																							<xs:annotation>
																								<xs:documentation>Cdigo de Benefcio Fiscal na UF aplicado ao item</xs:documentation>
																								<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																							</xs:annotation>
																							<xs:simpleType>
																								<xs:restriction base="xs:string">
																									<xs:whiteSpace value="preserve"/>
																									<xs:maxLength value="10"/>
																								</xs:restriction>
																							</xs:simpleType>
																						</xs:element>
																					</xs:sequence>
																					<xs:sequence minOccurs="0">
																						<xs:annotation>
																							<xs:documentation>Sequencia XML</xs:documentation>
																						</xs:annotation>
																						<xs:element name="pFCP" type="TDec_0302a04Opc">
																							<xs:annotation>
																								<xs:documentation>Percentual de ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																						<xs:element name="vFCP" type="TDec_1302">
																							<xs:annotation>
																								<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP).</xs:documentation>
																							</xs:annotation>
																						</xs:element>
																					</xs:sequence>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																		<xs:element name="ICMSSN">
																			<xs:annotation>
																				<xs:documentation>Simples Nacional</xs:documentation>
																			</xs:annotation>
																			<xs:complexType>
																				<xs:sequence>
																					<xs:element name="CST">
																						<xs:annotation>
																							<xs:documentation>Classificao Tributria do Servio</xs:documentation>
																							<xs:documentation>90 - Outros SN</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="90"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																					<xs:element name="indSN">
																						<xs:annotation>
																							<xs:documentation>Indica se o contribuinte  Simples Nacional			1=Sim</xs:documentation>
																						</xs:annotation>
																						<xs:simpleType>
																							<xs:restriction base="xs:string">
																								<xs:whiteSpace value="preserve"/>
																								<xs:enumeration value="1"/>
																							</xs:restriction>
																						</xs:simpleType>
																					</xs:element>
																				</xs:sequence>
																			</xs:complexType>
																		</xs:element>
																	</xs:choice>
																	<xs:element name="ICMSUFDest" minOccurs="0" maxOccurs="unbounded">
																		<xs:annotation>
																			<xs:documentation>Informaes do ICMS de partilha com a UF destinatria</xs:documentation>
																		</xs:annotation>
																		<xs:complexType>
																			<xs:sequence>
																				<xs:element name="vBCUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor da BC do ICMS na UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pFCPUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Percentual do ICMS relativo ao Fundo de Combate  pobreza (FCP) na UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="pICMSUFDest" type="TDec_0302">
																					<xs:annotation>
																						<xs:documentation>Alquota interna da UF de destino</xs:documentation>
																						<xs:documentation>Alquota adotada nas operaes internas na UF do destinatrio</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vFCPUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS relativo ao Fundo de Combate  Pobreza (FCP) da UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFDest" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de destino</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="vICMSUFEmi" type="TDec_1302">
																					<xs:annotation>
																						<xs:documentation>Valor do ICMS de partilha para a UF de emisso</xs:documentation>
																					</xs:annotation>
																				</xs:element>
																				<xs:element name="cBenefUFDest" minOccurs="0">
																					<xs:annotation>
																						<xs:documentation>Cdigo de Benefcio Fiscal na UF destino aplicado ao item</xs:documentation>
																						<xs:documentation>Cdigo de Benefcio Fiscal utilizado pela UF, aplicado ao
item.
</xs:documentation>
																					</xs:annotation>
																					<xs:simpleType>
																						<xs:restriction base="xs:string">
																							<xs:whiteSpace value="preserve"/>
																							<xs:maxLength value="10"/>
																						</xs:restriction>
																					</xs:simpleType>
																				</xs:element>
																			</xs:sequence>
																			<xs:attribute name="cUFDest" type="TCodUfIBGE" use="required"/>
																		</xs:complexType>
																	</xs:element>
																</xs:sequence>
																<xs:element name="indSemCST">
																	<xs:annotation>
																		<xs:documentation>Sem Situao Tributria para o ICMS</xs:documentation>
																		<xs:documentation>Informar para itens que no tenham nenhuma relao com o ICMS.
Quando informado o item NO PODE ter CFOP informado

Se informado esse grupo o schema no permite informar nenhum dos grupos de ICMSXX</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="xs:string">
																			<xs:whiteSpace value="preserve"/>
																			<xs:enumeration value="1"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:choice>
															<xs:element name="PIS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do PIS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do PIS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pPIS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do PIS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vPIS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="COFINS" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do COFINS</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="CST">
																			<xs:annotation>
																				<xs:documentation>classificao Tributria do COFINS</xs:documentation>
																				<xs:documentation>01  Tributvel com alquota bsica
02  Tributvel com alquota diferenciada
06  Tributvel com alquota zero
07  Operao isenta de contribuio
08  Operao sem incidncia da contribuio
09  Operao com suspenso da contribuio  
49  Outras operaes de sada
</xs:documentation>
																			</xs:annotation>
																			<xs:simpleType>
																				<xs:restriction base="xs:string">
																					<xs:whiteSpace value="preserve"/>
																					<xs:enumeration value="01"/>
																					<xs:enumeration value="02"/>
																					<xs:enumeration value="06"/>
																					<xs:enumeration value="07"/>
																					<xs:enumeration value="08"/>
																					<xs:enumeration value="09"/>
																					<xs:enumeration value="49"/>
																				</xs:restriction>
																			</xs:simpleType>
																		</xs:element>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pCOFINS" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do COFINS (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vCOFINS" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do COFINS</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUST" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUST</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUST" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUST (em percentual)</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUST" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUST</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="FUNTTEL" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Dados do FUNTTEL</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vBC" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor da BC do FUNTTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="pFUNTTEL" type="TDec_0302a04">
																			<xs:annotation>
																				<xs:documentation>Alquota do FUNTTEL (em percentual) </xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vFUNTTEL" type="TDec_1302">
																			<xs:annotation>
																				<xs:documentation>Valor do FUNTEL</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="retTrib" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes de reteno de tributos federais</xs:documentation>
																</xs:annotation>
																<xs:complexType>
																	<xs:sequence>
																		<xs:element name="vRetPIS" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do PIS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCofins" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do COFNS retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vRetCSLL" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor da CSLL retida</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vBCIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Base de clculo do IRRF</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																		<xs:element name="vIRRF" type="TDec_1302_1308">
																			<xs:annotation>
																				<xs:documentation>Valor do IRRF retido</xs:documentation>
																			</xs:annotation>
																		</xs:element>
																	</xs:sequence>
																</xs:complexType>
															</xs:element>
															<xs:element name="IBSCBS" type="TTribNFCom" minOccurs="0">
																<xs:annotation>
																	<xs:documentation>Grupo de informaes do IBS e CBS</xs:documentation>
																</xs:annotation>
															</xs:element>
														</xs:sequence>
													</xs:extension>
												</xs:complexContent>
											</xs:complexType>
										</xs:element>
										<xs:element name="gProcRef" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo Processo referenciado</xs:documentation>
												<xs:documentation>Este grupo somente dever ser preenchido quando houver processo judicial ou administrativo que altere valores.</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vItem">
														<xs:annotation>
															<xs:documentation>Valor unitrio do item</xs:documentation>
															<xs:documentation>Informar o valor sem a influncia da deciso judicial/administrativa.</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="qFaturada" type="TDec_1100_1104">
														<xs:annotation>
															<xs:documentation>Quantidade Faturada</xs:documentation>
															<xs:documentation>Informar a quantidade de comercializao do produto .</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vProd">
														<xs:annotation>
															<xs:documentation>Valor total do item</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TDec_1302_1308"/>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vDesc" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Desconto</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vOutro" type="TDec_1302Opc" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Outras despesas acessrias</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="indDevolucao" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Indicador de devoluo do valor do item</xs:documentation>
															<xs:documentation>1  Devoluo do valor do item </xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="xs:string">
																<xs:minLength value="1"/>
																<xs:maxLength value="1"/>
																<xs:whiteSpace value="preserve"/>
																<xs:enumeration value="1"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="vBC" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor da BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="pICMS" type="TDec_0302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Alquota do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vPIS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do PIS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vCOFINS" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do COFINS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Valor do Fundo de Combate  Pobreza (FCP).</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="gProc" maxOccurs="10">
														<xs:annotation>
															<xs:documentation>Grupo identificador do Processo</xs:documentation>
														</xs:annotation>
														<xs:complexType>
															<xs:sequence>
																<xs:element name="tpProc" type="TProcesso">
																	<xs:annotation>
																		<xs:documentation>Tipo de Processo</xs:documentation>
																		<xs:documentation>0 - SEFAZ; 1 - Justia Federal; 2 - Justia Estadual</xs:documentation>
																	</xs:annotation>
																</xs:element>
																<xs:element name="nProcesso">
																	<xs:annotation>
																		<xs:documentation>Nmero do Processo</xs:documentation>
																	</xs:annotation>
																	<xs:simpleType>
																		<xs:restriction base="TString">
																			<xs:minLength value="1"/>
																			<xs:maxLength value="60"/>
																		</xs:restriction>
																	</xs:simpleType>
																</xs:element>
															</xs:sequence>
														</xs:complexType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="gRessarc" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Grupo de Informaes detalhadas de item de cClass de Ressarcimento</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="tpRessarc" type="TRessarcimento">
														<xs:annotation>
															<xs:documentation>Tipo de Ressarcimento</xs:documentation>
															<xs:documentation>1 - Cobrana Indevida
2 - Interrupo
99 - Outros</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="dRef" type="TData">
														<xs:annotation>
															<xs:documentation>Data de referencia</xs:documentation>
															<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="nProcesso" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do Processo</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="nProtReclama" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Nmero do protocolo de reclamao</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="1"/>
																<xs:maxLength value="60"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
													<xs:element name="xObs" minOccurs="0">
														<xs:annotation>
															<xs:documentation>Observaes sobre o processo de ressarcimento</xs:documentation>
														</xs:annotation>
														<xs:simpleType>
															<xs:restriction base="TString">
																<xs:minLength value="15"/>
																<xs:maxLength value="100"/>
															</xs:restriction>
														</xs:simpleType>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="infAdProd" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Informaes adicionais do produto (norma referenciada, informaes complementares, etc)</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="TString">
													<xs:minLength value="1"/>
													<xs:maxLength value="500"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
									</xs:sequence>
									<xs:attribute name="nItem" use="required">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="chNFComAnt" type="TChDFe">
										<xs:annotation>
											<xs:documentation>Chave de Acesso da NFCom anterior </xs:documentation>
											<xs:documentation>Informar chave de acesso de referencia anterior
TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
									</xs:attribute>
									<xs:attribute name="nItemAnt" use="optional">
										<xs:annotation>
											<xs:documentation>Nmero do item da NFCom anterior</xs:documentation>
											<xs:documentation>Informar nro do item da chave de acesso de referencia anterior

TAG OPCIONAL, DEVE SER INFORMADA APENAS NOS CASOS PREVISTOS DE NOTA ANTERIOR REFERENCIADA</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:pattern value="[1-9]{1}[0-9]{0,3}"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
									<xs:attribute name="indNFComAntPapelFatCentral" use="optional">
										<xs:annotation>
											<xs:documentation>Indicador de Nota anterior em papel no faturamento centralizado</xs:documentation>
											<xs:documentation>Informa que a NFCom Anterior de Faturamento centralizado no  eletrnica</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="xs:string">
												<xs:whiteSpace value="preserve"/>
												<xs:minLength value="1"/>
												<xs:maxLength value="1"/>
												<xs:enumeration value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:attribute>
								</xs:complexType>
							</xs:element>
							<xs:element name="total">
								<xs:annotation>
									<xs:documentation>Dados dos totais da NFCom</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="vProd" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total dos produtos e servios</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="ICMSTot">
											<xs:annotation>
												<xs:documentation>Totais referentes ao ICMS</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vBC" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>BC do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vICMSDeson" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do ICMS desonerado</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vFCP" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor Total do FCP (Fundo de Combate  Pobreza).</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vCOFINS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do COFINS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vPIS" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do PIS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUNTTEL" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUNTTEL</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vFUST" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor do FUST</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vRetTribTot">
											<xs:annotation>
												<xs:documentation>Total da reteno de tributos federais</xs:documentation>
											</xs:annotation>
											<xs:complexType>
												<xs:sequence>
													<xs:element name="vRetPIS" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do PIS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCofins" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do COFNS retido</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vRetCSLL" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor da CSLL retida</xs:documentation>
														</xs:annotation>
													</xs:element>
													<xs:element name="vIRRF" type="TDec_1302">
														<xs:annotation>
															<xs:documentation>Valor do IRRF retido</xs:documentation>
														</xs:annotation>
													</xs:element>
												</xs:sequence>
											</xs:complexType>
										</xs:element>
										<xs:element name="vDesc" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total do Desconto</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vOutro" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Outras Despesas acessrias</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vNF" type="TDec_1302">
											<xs:annotation>
												<xs:documentation>Valor Total da NFCom</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="IBSCBSTot" type="TIBSCBSTot" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Totais de IBS e CBS</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="vTotDFe" type="TDec_1302" minOccurs="0">
											<xs:annotation>
												<xs:documentation>Valor total do documento fiscal 
(vNF + total do IBS + total da CBS) 
</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:element name="gFidelidade" minOccurs="0">
								<xs:annotation>
									<xs:documentation>Grupo de informaes do programa de fidelidade do assinante</xs:documentation>
								</xs:annotation>
								<xs:complexType>
									<xs:sequence>
										<xs:element name="qtdSaldoPts">
											<xs:annotation>
												<xs:documentation> Saldo de pontos do cliente na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefSaldoPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de aferio do saldo de pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="qtdPtsResg">
											<xs:annotation>
												<xs:documentation> Qtd de pontos resgatados na  data de referncia</xs:documentation>
											</xs:annotation>
											<xs:simpleType>
												<xs:restriction base="xs:string">
													<xs:whiteSpace value="preserve"/>
													<xs:minLength value="1"/>
													<xs:maxLength value="20"/>
													<xs:pattern value="[0-9]{1,20}"/>
												</xs:restriction>
											</xs:simpleType>
										</xs:element>
										<xs:element name="dRefResgPts" type="TData">
											<xs:annotation>
												<xs:documentation>Data de resgate dos pontos</xs:documentation>
												<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:sequence>
								</xs:complexType>
							</xs:element>
							<xs:choice>
								<xs:element name="gFat" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes de controle da Fatura</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CompetFat" type="TCompet">
												<xs:annotation>
													<xs:documentation>Ano e ms referncia do faturamento (AAAAMM)</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="dVencFat" type="TData">
												<xs:annotation>
													<xs:documentation>Data de vencimento da fatura</xs:documentation>
													<xs:documentation>Formato AAAA-MM-DD</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:annotation>
													<xs:documentation>Sequencia XML</xs:documentation>
												</xs:annotation>
												<xs:element name="dPerUsoIni" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso inicial</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
												<xs:element name="dPerUsoFim" type="TData">
													<xs:annotation>
														<xs:documentation>Perodo de uso final</xs:documentation>
														<xs:documentation>Formato AAAA-MM-DD.</xs:documentation>
													</xs:annotation>
												</xs:element>
											</xs:sequence>
											<xs:element name="codBarras">
												<xs:annotation>
													<xs:documentation>Linha digitvel do cdigo de barras</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="48"/>
														<xs:pattern value="[0-9]{1,48}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:element name="codDebAuto" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Cdigo de autorizao dbito em conta</xs:documentation>
												</xs:annotation>
												<xs:simpleType>
													<xs:restriction base="xs:string">
														<xs:whiteSpace value="preserve"/>
														<xs:minLength value="1"/>
														<xs:maxLength value="20"/>
														<xs:pattern value="[0-9]{1,20}"/>
													</xs:restriction>
												</xs:simpleType>
											</xs:element>
											<xs:sequence minOccurs="0">
												<xs:element name="codBanco">
													<xs:annotation>
														<xs:documentation>Nmero do banco para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="3"/>
															<xs:maxLength value="5"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
												<xs:element name="codAgencia">
													<xs:annotation>
														<xs:documentation>Nmero da agncia bancria para dbito em conta</xs:documentation>
													</xs:annotation>
													<xs:simpleType>
														<xs:restriction base="TString">
															<xs:minLength value="1"/>
															<xs:maxLength value="10"/>
														</xs:restriction>
													</xs:simpleType>
												</xs:element>
											</xs:sequence>
											<xs:element name="enderCorresp" type="TEndeEmi" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Endereo de entrega da fatura.</xs:documentation>
													<xs:documentation>Informar se diferente do endereo do destinatrio</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="gPIX" minOccurs="0">
												<xs:annotation>
													<xs:documentation>Grupo de informaes do PIX</xs:documentation>
												</xs:annotation>
												<xs:complexType>
													<xs:sequence>
														<xs:element name="urlQRCodePIX">
															<xs:annotation>
																<xs:documentation>URL do QRCode do PIX que ser apresentado na fatura</xs:documentation>
															</xs:annotation>
															<xs:simpleType>
																<xs:restriction base="TString">
																	<xs:maxLength value="2000"/>
																	<xs:minLength value="2"/>
																</xs:restriction>
															</xs:simpleType>
														</xs:element>
													</xs:sequence>
												</xs:complexType>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
								<xs:element name="gFatCentral" minOccurs="0">
									<xs:annotation>
										<xs:documentation>Grupo de informaes do Faturamento Centralizado</xs:documentation>
									</xs:annotation>
									<xs:complexType>
										<xs:sequence>
											<xs:element name="CNPJ" type="TCnpj">
												<xs:annotation>
													<xs:documentation>CNPJ do Emitente centralizador</xs:documentation>
													<xs:documentation>Informar o CNPJ do emitente do Documento Fiscal</xs:documentation>
												</xs:annotation>
											</xs:element>
											<xs:element name="cUF" type="TCodUfIBGE">
												<xs:annotation>
													<xs:documentation>Cdigo da UF do emitente centralizador</xs:documentation>
													<xs:documentation>Cdigo da UF do emitente do Documento Fiscal. Utilizar a
Tabela do IBGE de cdigo de unidades da federao.</xs:documentation>
												</xs:annotation>
											</xs:element>
										</xs:sequence>
									</xs:complexType>
								</xs:element>
							</xs:choice>
						</xs:sequence>
						<xs:element name="autXML" minOccurs="0" maxOccurs="10">
							<xs:annotation>
								<xs:documentation>Autorizados para download do XML do DF-e</xs:documentation>
								<xs:documentation>Informar CNPJ ou CPF. Preencher os zeros no significativos.</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:choice>
										<xs:element name="CNPJ" type="TCnpj">
											<xs:annotation>
												<xs:documentation>CNPJ do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
										<xs:element name="CPF" type="TCpf">
											<xs:annotation>
												<xs:documentation>CPF do autorizado</xs:documentation>
												<xs:documentation>Informar zeros no significativos</xs:documentation>
											</xs:annotation>
										</xs:element>
									</xs:choice>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="infAdic" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes Adicionais</xs:documentation>
							</xs:annotation>
							<xs:complexType>
								<xs:sequence>
									<xs:annotation>
										<xs:documentation>Sequencia XML</xs:documentation>
									</xs:annotation>
									<xs:element name="infAdFisco" minOccurs="0">
										<xs:annotation>
											<xs:documentation>Informaes adicionais de interesse do Fisco</xs:documentation>
											<xs:documentation>Norma referenciada, informaes complementares, etc</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:maxLength value="2000"/>
												<xs:minLength value="1"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
									<xs:element name="infCpl" minOccurs="0" maxOccurs="5">
										<xs:annotation>
											<xs:documentation>Informaes complementares de interesse do Contribuinte</xs:documentation>
										</xs:annotation>
										<xs:simpleType>
											<xs:restriction base="TString">
												<xs:minLength value="1"/>
												<xs:maxLength value="3000"/>
											</xs:restriction>
										</xs:simpleType>
									</xs:element>
								</xs:sequence>
							</xs:complexType>
						</xs:element>
						<xs:element name="gRespTec" type="TRespTec" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Informaes do Responsvel Tcnico pela emisso do DF-e</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="versao" type="TVerNFCom" use="required">
						<xs:annotation>
							<xs:documentation>Verso do leiaute</xs:documentation>
						</xs:annotation>
					</xs:attribute>
					<xs:attribute name="Id" use="required">
						<xs:annotation>
							<xs:documentation>Identificador da tag a ser assinada</xs:documentation>
							<xs:documentation>Informar a chave de acesso da NFCom e precedida do literal "NFCom"</xs:documentation>
						</xs:annotation>
						<xs:simpleType>
							<xs:restriction base="xs:ID">
								<xs:pattern value="NFCom[0-9]{6}[A-Z0-9]{12}[0-9]{26}"/>
							</xs:restriction>
						</xs:simpleType>
					</xs:attribute>
				</xs:complexType>
				<xs:unique name="pk_nItem">
					<xs:selector xpath="./*"/>
					<xs:field xpath="@nItem"/>
				</xs:unique>
			</xs:element>
			<xs:element name="infNFComSupl">
				<xs:annotation>
					<xs:documentation>Informaes suplementares da NFCom</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="qrCodNFCom">
							<xs:annotation>
								<xs:documentation>Texto com o QR-Code para consulta da NFCom</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:string">
									<xs:whiteSpace value="preserve"/>
									<xs:minLength value="50"/>
									<xs:maxLength value="1000"/>
									<xs:pattern value="((HTTPS?|https?)://.*\?chNFCom=[0-9]{6}[A-Z0-9]{12}[0-9]{26}&amp;tpAmb=[1-2](&amp;sign=[!-]{1}[ -]{0,}[!-]{1}|[!-]{1})?)"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature"/>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Pedido de Concesso de Autorizao de NFCom</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="idLote" type="TIdLote"/>
			<xs:element name="NFCom" type="TNFCom" maxOccurs="50"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TEndeEmi">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndeDest">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo Destinatario</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE)</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TEndereco">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Endereo</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="xLgr">
				<xs:annotation>
					<xs:documentation>Logradouro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="255"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="nro">
				<xs:annotation>
					<xs:documentation>Nmero</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xCpl" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Complemento</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xBairro">
				<xs:annotation>
					<xs:documentation>Bairro</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="cMun" type="TCodMunIBGE">
				<xs:annotation>
					<xs:documentation>Cdigo do municpio (utilizar a tabela do IBGE), informar 9999999 para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMun">
				<xs:annotation>
					<xs:documentation>Nome do municpio, informar EXTERIOR para operaes com o exterior.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="CEP" minOccurs="0">
				<xs:annotation>
					<xs:documentation>CEP</xs:documentation>
					<xs:documentation>Informar os zeros no significativos</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{8}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="UF" type="TUf">
				<xs:annotation>
					<xs:documentation>Sigla da UF, informar EX para operaes com o exterior.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Cdigo do pas</xs:documentation>
					<xs:documentation>Utilizar a tabela do BACEN</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{1,4}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="xPais" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Nome do pas</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="1"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="fone" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Telefone</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Endereo de E-mail</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TProtNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Protocolo de status resultado do processamento da NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="infProt">
				<xs:annotation>
					<xs:documentation>Dados do protocolo de status</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="tpAmb" type="TAmb">
							<xs:annotation>
								<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="verAplic" type="TVerAplic">
							<xs:annotation>
								<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="chNFCom" type="TChDFe">
							<xs:annotation>
								<xs:documentation>Chave de acesso da NFCom</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora de processamento, no formato AAAA-MM-DDTHH:MM:SS TZD.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="nProt" type="TProt" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Nmero do Protocolo de Status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="digVal" type="ds:DigestValueType" minOccurs="0">
							<xs:annotation>
								<xs:documentation>Digest Value da NFCom processado. Utilizado para conferir a integridade da NFCom original.</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="cStat">
							<xs:annotation>
								<xs:documentation>Cdigo do status da NFCom.</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMotivo" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Descrio literal do status da NFCom.</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
					<xs:attribute name="Id" type="xs:ID" use="optional"/>
				</xs:complexType>
			</xs:element>
			<xs:element name="infFisco" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Mensagem do Fisco</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="cMsg">
							<xs:annotation>
								<xs:documentation>Cdigo do status da mensagem do fisco</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="TStat"/>
							</xs:simpleType>
						</xs:element>
						<xs:element name="xMsg" type="TMotivo">
							<xs:annotation>
								<xs:documentation>Mensagem do Fisco</xs:documentation>
							</xs:annotation>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element ref="ds:Signature" minOccurs="0"/>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do Pedido de Autorizao de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="protNFCom" type="TProtNFCom" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Reposta ao processamento da NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TRetEnviNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Retorno do recibo de envio do lote de NFCom (Modelo 66)</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="tpAmb" type="TAmb">
				<xs:annotation>
					<xs:documentation>Identificao do Ambiente:
1 - Produo
2 - Homologao</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cUF" type="TCodUfIBGE">
				<xs:annotation>
					<xs:documentation>Identificao da UF</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="verAplic" type="TVerAplic">
				<xs:annotation>
					<xs:documentation>Verso do Aplicativo que processou a NFCom</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="cStat" type="TStat">
				<xs:annotation>
					<xs:documentation>cdigo do status do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xMotivo" type="TMotivo">
				<xs:annotation>
					<xs:documentation>Descrio literal do status do do retorno da consulta.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="infRec" minOccurs="0">
				<xs:annotation>
					<xs:documentation>Dados do Recibo do Lote</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="nRec" type="TRec">
							<xs:annotation>
								<xs:documentation>Nmero do Recibo</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="dhRecbto" type="TDateTimeUTC">
							<xs:annotation>
								<xs:documentation>Data e hora do recebimento, no formato AAAA-MM-DDTHH:MM:SS TZD</xs:documentation>
							</xs:annotation>
						</xs:element>
						<xs:element name="tMed">
							<xs:annotation>
								<xs:documentation>Tempo mdio de resposta do servio (em segundos) dos ltimos 5 minutos</xs:documentation>
							</xs:annotation>
							<xs:simpleType>
								<xs:restriction base="xs:integer">
									<xs:pattern value="[0-9]{1,4}"/>
								</xs:restriction>
							</xs:simpleType>
						</xs:element>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
		</xs:sequence>
		<xs:attribute name="versao" type="TVerNFCom" use="required"/>
	</xs:complexType>
	<xs:complexType name="TImp">
		<xs:annotation>
			<xs:documentation>Tipo Dados do Imposto NFCom</xs:documentation>
		</xs:annotation>
	</xs:complexType>
	<xs:complexType name="TEmpresaSoft">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Empresa de Software</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:choice>
				<xs:element name="CNPJ" type="TCnpj">
					<xs:annotation>
						<xs:documentation>CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="CPF" type="TCpf">
					<xs:annotation>
						<xs:documentation>CPF da pessoa fsica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
						<xs:documentation>No caso de pessoa fsica, informar o CPF do desenvolvedor do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:choice>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica/fsica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica/fsica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
		</xs:sequence>
	</xs:complexType>
	<xs:complexType name="TRespTec">
		<xs:annotation>
			<xs:documentation>Tipo Dados da Responsvel Tcnico</xs:documentation>
		</xs:annotation>
		<xs:sequence>
			<xs:element name="CNPJ" type="TCnpj">
				<xs:annotation>
					<xs:documentation>CNPJ da pessoa jurdica responsvel tcnica pelo sistema utilizado na emisso do documento fiscal eletrnico</xs:documentation>
					<xs:documentation>Informar o CNPJ da pessoa jurdica desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="xContato">
				<xs:annotation>
					<xs:documentation>Nome da pessoa a ser contatada</xs:documentation>
					<xs:documentation>Informar o nome da pessoa a ser contatada na empresa desenvolvedora do sistema utilizado na emisso do documento fiscal eletrnico. No caso de pessoa fsica, informar o respectivo nome.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="TString">
						<xs:maxLength value="60"/>
						<xs:minLength value="2"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:element name="email" type="TEmail">
				<xs:annotation>
					<xs:documentation>Email da pessoa jurdica a ser contatada</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="fone">
				<xs:annotation>
					<xs:documentation>Telefone da pessoa jurdica a ser contatada</xs:documentation>
					<xs:documentation>Preencher com o Cdigo DDD + nmero do telefone.</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:whiteSpace value="preserve"/>
						<xs:pattern value="[0-9]{7,12}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:element>
			<xs:sequence minOccurs="0">
				<xs:annotation>
					<xs:documentation>Sequencia XML</xs:documentation>
				</xs:annotation>
				<xs:element name="idCSRT">
					<xs:annotation>
						<xs:documentation>Identificador do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>Identificador do CSRT utilizado para gerao do hash</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:string">
							<xs:pattern value="[0-9]{3}"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
				<xs:element name="hashCSRT">
					<xs:annotation>
						<xs:documentation>Hash do token do cdigo de segurana do responsvel tcnico</xs:documentation>
						<xs:documentation>O hashCSRT  o resultado das funes SHA-1 e base64 do token CSRT fornecido pelo fisco + chave de acesso do DF-e. (Implementao em futura NT)

Observao: 28 caracteres so representados no schema como 20 bytes do tipo base64Binary</xs:documentation>
					</xs:annotation>
					<xs:simpleType>
						<xs:restriction base="xs:base64Binary">
							<xs:length value="20"/>
						</xs:restriction>
					</xs:simpleType>
				</xs:element>
			</xs:sequence>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="TProcEmi">
		<xs:annotation>
			<xs:documentation>Tipo processo de emisso do NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAssinante">
		<xs:annotation>
			<xs:documentation>Tipo assinante</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value="8"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIdLote">
		<xs:annotation>
			<xs:documentation>Tipo Identificador de controle do envio do lote. Nmero seqencial auto-incremental, de controle correspondente ao identificador nico do lote enviado. A responsabilidade de gerar e controlar esse nmero  do prprio contribuinte.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerNFCom">
		<xs:annotation>
			<xs:documentation> Tipo Verso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="1\.00"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUMedItem">
		<xs:annotation>
			<xs:documentation>Tipo da unidade bsica de medida</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTime">
		<xs:annotation>
			<xs:documentation> Tipo hora</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-1][0-9])|([2][0-3])):([0-5][0-9]):([0-5][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TEmail">
		<xs:annotation>
			<xs:documentation>Tipo Email</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="60"/>
			<xs:pattern value="[^@]+@[^\.]+\..+"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFinNFCom">
		<xs:annotation>
			<xs:documentation>Finalidade da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TFatNFCom">
		<xs:annotation>
			<xs:documentation>Tipo de Faturamento da NFCom</xs:documentation>
			<xs:documentation/>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDoc">
		<xs:annotation>
			<xs:documentation>Tipo de Documento de Identificao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCfop">
		<xs:annotation>
			<xs:documentation>Tipo CFOP</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[123567][0-9]([0-9][1-9]|[1-9][0-9])"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIndIEDest">
		<xs:annotation>
			<xs:documentation>Tipo indicador da IE do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="9"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCRT">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo Regime Tributrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TtpEmis">
		<xs:annotation>
			<xs:documentation>Tipo de emisso da NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUtilizacao">
		<xs:annotation>
			<xs:documentation>Tipo utilizacao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
			<xs:enumeration value=""/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompet">
		<xs:annotation>
			<xs:documentation>Tipo Competncia</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="6"/>
			<xs:maxLength value="6"/>
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFPapel">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NF papel</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotSub">
		<xs:annotation>
			<xs:documentation>Tipo Motivo Substituio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="2"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="01"/>
			<xs:enumeration value="02"/>
			<xs:enumeration value="03"/>
			<xs:enumeration value="04"/>
			<xs:enumeration value="05"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt_v2">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAjusteNFComAnt">
		<xs:annotation>
			<xs:documentation>Tipo do ajuste na NFCom anterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotAjuste">
		<xs:annotation>
			<xs:documentation>Tipo do Motivo de Ajuste</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:minLength value="1"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TTarifa">
		<xs:annotation>
			<xs:documentation>Tipo de tarifa de aplicao</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProcesso">
		<xs:annotation>
			<xs:documentation>Tipo de processo judicial</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="0"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRessarcimento">
		<xs:annotation>
			<xs:documentation>Tipo de Ressarcimento</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="2"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCompFat">
		<xs:annotation>
			<xs:documentation>Tipo componente da fatura</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:minLength value="1"/>
			<xs:maxLength value="1"/>
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
			<xs:enumeration value="3"/>
			<xs:enumeration value="4"/>
			<xs:enumeration value="5"/>
			<xs:enumeration value="6"/>
			<xs:enumeration value="7"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/procEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="procEventoNFCom" type="TProcEvento">
		<xs:annotation>
			<xs:documentation>Pedido de Registro de Evento de NFCom processado</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/procNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="nfcomProc">
		<xs:annotation>
			<xs:documentation>NFCom processada</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="NFCom" type="TNFCom"/>
				<xs:element name="protNFCom" type="TProtNFCom"/>
			</xs:sequence>
			<xs:attribute name="versao" type="TVerNFCom" use="required"/>
			<xs:attribute name="ipTransmissor" type="TIPv4" use="optional">
				<xs:annotation>
					<xs:documentation>IP do transmissor do documento fiscal para o ambiente autorizador</xs:documentation>
				</xs:annotation>
			</xs:attribute>
			<xs:attribute name="nPortaCon" use="optional">
				<xs:annotation>
					<xs:documentation>Porta de origem utilizada na conexo (De 0 a 65535)</xs:documentation>
				</xs:annotation>
				<xs:simpleType>
					<xs:restriction base="xs:string">
						<xs:pattern value="[0-9]{1,5}"/>
					</xs:restriction>
				</xs:simpleType>
			</xs:attribute>
			<xs:attribute name="dhConexao" type="TDateTimeUTC" use="optional">
				<xs:annotation>
					<xs:documentation>Data e Hora da Conexo de Origem</xs:documentation>
				</xs:annotation>
			</xs:attribute>
		</xs:complexType>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/retConsSitNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consSitNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsSitNFCom" type="TRetConsSitNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno da consulta da situao atual da NFCom.</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/retConsStatServNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="consStatServNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retConsStatServNFCom" type="TRetConsStatServ">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do Resultado da Consulta do Status do Servio de NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/retEventoNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="eventoNFComTiposBasico_v1.00.xsd"/>
	<xs:element name="retEventoNFCom" type="TRetEvento">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno Pedido de Evento da NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/retNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns="http://www.portalfiscal.inf.br/nfcom" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:include schemaLocation="nfcomTiposBasico_v1.00.xsd"/>
	<xs:element name="retNFCom" type="TRetNFCom">
		<xs:annotation>
			<xs:documentation>Schema XML de validao do retorno do NFCom</xs:documentation>
		</xs:annotation>
	</xs:element>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/tiposGeralNFCom_v1.00.xsd">
<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2008 (http://www.altova.com) by sas.softwares@procergs.rs.gov.br (PROCERGS) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.portalfiscal.inf.br/nfcom" targetNamespace="http://www.portalfiscal.inf.br/nfcom" elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xs:simpleType name="TDateTimeUTC">
		<xs:annotation>
			<xs:documentation>Data e Hora, formato UTC (AAAA-MM-DDThh:mm:ssTZD, onde TZD = +hh:mm ou -hh:mm)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(((20(([02468][048])|([13579][26]))-02-29))|(20[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))T(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d([\-,\+](0[0-9]|10|11):00|([\+](12):00))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodMunIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo do Municpio da tabela do IBGE</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{7}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCOrgaoIBGE">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo de orgo (UF da tabela do IBGE + 90 SUFRAMA + 91 RFB + 92 BRId)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="90"/>
			<xs:enumeration value="91"/>
			<xs:enumeration value="92"/>
			<xs:enumeration value="93"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCodUfIBGE_EX">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da UF da tabela do IBGE + 99 para Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="11"/>
			<xs:enumeration value="12"/>
			<xs:enumeration value="13"/>
			<xs:enumeration value="14"/>
			<xs:enumeration value="15"/>
			<xs:enumeration value="16"/>
			<xs:enumeration value="17"/>
			<xs:enumeration value="21"/>
			<xs:enumeration value="22"/>
			<xs:enumeration value="23"/>
			<xs:enumeration value="24"/>
			<xs:enumeration value="25"/>
			<xs:enumeration value="26"/>
			<xs:enumeration value="27"/>
			<xs:enumeration value="28"/>
			<xs:enumeration value="29"/>
			<xs:enumeration value="31"/>
			<xs:enumeration value="32"/>
			<xs:enumeration value="33"/>
			<xs:enumeration value="35"/>
			<xs:enumeration value="41"/>
			<xs:enumeration value="42"/>
			<xs:enumeration value="43"/>
			<xs:enumeration value="50"/>
			<xs:enumeration value="51"/>
			<xs:enumeration value="52"/>
			<xs:enumeration value="53"/>
			<xs:enumeration value="99"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TChDFe">
		<xs:annotation>
			<xs:documentation>Tipo Chave de Documento Fiscal Eletrnico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:maxLength value="44"/>
			<xs:pattern value="[0-9]{6}[A-Z0-9]{12}[0-9]{26}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSegCodBarra">
		<xs:annotation>
			<xs:documentation>Tipo Segundo Codigo Barra</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{36}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TProt">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Protocolo de Status</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TRec">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Recibo do envio de lote de DF-e</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{16}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TStat">
		<xs:annotation>
			<xs:documentation>Tipo Cdigo da Mensagem enviada</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpj">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[A-Z0-9]{12}[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCnpjOpc">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CNPJ Opcional</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0}|[A-Z0-9]{12}[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpf">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TCpfVar">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do CPF de tamanho varivel (3-11)</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{3,11}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 5 dgitos, sendo 3 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0303Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 dgitos, sendo 3 inteiros e 3 decimais usado em tags opcionais </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,2}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302_0303">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 6 ou 5 dgitos, sendo 3 inteiros e 3 ou 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,3}(\.[0-9]{2,3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros, podendo ter de 2 at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com at 3 dgitos inteiros e 2 at 4 decimais. Utilizados em TAGs opcionais, no aceita valor zero.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2,4}|[1-9]{1}[0-9]{0,2}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0302a04Max100">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 3 inteiros (no mximo 100), com at 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0(\.[0-9]{2,4})?|[1-9]{1}[0-9]{0,1}(\.[0-9]{2,4})?|100(\.0{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0402_0408">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  4 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0503">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 8 dgitos, sendo 5 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,4}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0803Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 11 dgitos, sendo 8 inteiros e 3 decimais utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,7}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0804Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 12 dgitos, sendo 8 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,7}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0906Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 6 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{6}|[1-9]{1}[0-9]{0,8}(\.[0-9]{6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_0908Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 9 inteiros e 8 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{8}|[1-9]{1}[0-9]{0,8}(\.[0-9]{8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1104Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 11 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,10}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1100_1104">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  11 dgitos inteiros e 0 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,11}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1203Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 12 inteiros e 3 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{3}|[1-9]{1}[0-9]{0,11}(\.[0-9]{3})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 de corpo e 4 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1204Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 16 dgitos, sendo 12 inteiros e 4 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{4}|[1-9]{1}[0-9]{0,11}(\.[0-9]{4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302Opc">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 15 dgitos, sendo 13 inteiros e 2 decimais, utilizado em tags opcionais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0\.[0-9]{2}|[1-9]{1}[0-9]{0,12}(\.[0-9]{2})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1306">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 6 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,6})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1308">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com 13 dgitos inteiros e 2 a 8 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,8})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TDec_1302_1304">
		<xs:annotation>
			<xs:documentation>Tipo Decimal com  13 dgitos inteiros e 2 a 4 casas decimais</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,13}(\.[0-9]{2,4})?"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIeDest">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Destinatrio</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{0,14}|ISENTO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TModNFCom">
		<xs:annotation>
			<xs:documentation>Tipo Modelo NFCom</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="62"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIe">
		<xs:annotation>
			<xs:documentation>Tipo Inscrio Estadual do Emitente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2,14}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNF">
		<xs:annotation>
			<xs:documentation>Tipo Nmero do Documento Fiscal</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[1-9]{1}[0-9]{0,8}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TSerie">
		<xs:annotation>
			<xs:documentation>Tipo Srie do Documento Fiscal </xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="0|[1-9]{1}[0-9]{0,2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
			<xs:enumeration value="EX"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TUf_sem_EX">
		<xs:annotation>
			<xs:documentation>Tipo Sigla da UF - Sem Exterior</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="AC"/>
			<xs:enumeration value="AL"/>
			<xs:enumeration value="AM"/>
			<xs:enumeration value="AP"/>
			<xs:enumeration value="BA"/>
			<xs:enumeration value="CE"/>
			<xs:enumeration value="DF"/>
			<xs:enumeration value="ES"/>
			<xs:enumeration value="GO"/>
			<xs:enumeration value="MA"/>
			<xs:enumeration value="MG"/>
			<xs:enumeration value="MS"/>
			<xs:enumeration value="MT"/>
			<xs:enumeration value="PA"/>
			<xs:enumeration value="PB"/>
			<xs:enumeration value="PE"/>
			<xs:enumeration value="PI"/>
			<xs:enumeration value="PR"/>
			<xs:enumeration value="RJ"/>
			<xs:enumeration value="RN"/>
			<xs:enumeration value="RO"/>
			<xs:enumeration value="RR"/>
			<xs:enumeration value="RS"/>
			<xs:enumeration value="SC"/>
			<xs:enumeration value="SE"/>
			<xs:enumeration value="SP"/>
			<xs:enumeration value="TO"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TAmb">
		<xs:annotation>
			<xs:documentation>Tipo Ambiente</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:enumeration value="1"/>
			<xs:enumeration value="2"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TVerAplic">
		<xs:annotation>
			<xs:documentation>Tipo Verso do Aplicativo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="20"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMotivo">
		<xs:annotation>
			<xs:documentation>Tipo Motivo</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="1"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TJust">
		<xs:annotation>
			<xs:documentation>Tipo Justificativa</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:minLength value="15"/>
			<xs:maxLength value="255"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TServ">
		<xs:annotation>
			<xs:documentation>Tipo Servio solicitado</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString"/>
	</xs:simpleType>
	<xs:simpleType name="Tano">
		<xs:annotation>
			<xs:documentation> Tipo ano</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{2}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TMed">
		<xs:annotation>
			<xs:documentation> Tipo temp mdio em segundos</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[0-9]{1,4}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TString">
		<xs:annotation>
			<xs:documentation> Tipo string genrico</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="[!-]{1}[ -]{0,}[!-]{1}|[!-]{1}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TData">
		<xs:annotation>
			<xs:documentation> Tipo data AAAA-MM-DD</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="((((20|19|18)(([02468][048])|([13579][26]))-02-29))|((20|19|18)[0-9][0-9])-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLatitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Latitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-8][0-9]\.[0-9]{6}|90\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-8][0-9]\.[0-9]{6}|-90\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TLongitude">
		<xs:annotation>
			<xs:documentation>Coordenada geogrfica Longitude</xs:documentation>
		</xs:annotation>
		<xs:restriction base="TString">
			<xs:pattern value="[0-9]\.[0-9]{6}|[1-9][0-9]\.[0-9]{6}|1[0-7][0-9]\.[0-9]{6}|180\.[0-9]{6}|-[0-9]\.[0-9]{6}|-[1-9][0-9]\.[0-9]{6}|-1[0-7][0-9]\.[0-9]{6}|-180\.[0-9]{6}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TNSU">
		<xs:annotation>
			<xs:documentation> Tipo nmero sequencial nico do AN</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:pattern value="[0-9]{15}"/>
		</xs:restriction>
	</xs:simpleType>
	<xs:simpleType name="TIPv4">
		<xs:annotation>
			<xs:documentation>Tipo IP verso 4</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:whiteSpace value="preserve"/>
			<xs:pattern value="(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"/>
		</xs:restriction>
	</xs:simpleType>
</xs:schema>
</file>

<file path="payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/xmldsig-core-schema_v1.01.xsd">
<?xml version="1.0" encoding="utf-8"?>
<!-- ***************************************************-->
<!-- ***   Schema especfico para assinaturas XML    ***-->
<!-- *** a partir de certificados do padro (X509)   ***-->
<!-- *** ICP-Brasil - Projeto Nota Fiscal Eletrnica ***-->
<!-- ***************************************************-->
<!-- Schema for XML Signatures-->
<schema xmlns="http://www.w3.org/2001/XMLSchema" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" targetNamespace="http://www.w3.org/2000/09/xmldsig#" elementFormDefault="qualified" attributeFormDefault="unqualified" version="0.1">
	<element name="Signature" type="ds:SignatureType"/>
	<complexType name="SignatureType">
		<sequence>
			<element name="SignedInfo" type="ds:SignedInfoType"/>
			<element name="SignatureValue" type="ds:SignatureValueType"/>
			<element name="KeyInfo" type="ds:KeyInfoType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="SignatureValueType">
		<simpleContent>
			<extension base="base64Binary">
				<attribute name="Id" type="ID" use="optional"/>
			</extension>
		</simpleContent>
	</complexType>
	<complexType name="SignedInfoType">
		<sequence>
			<element name="CanonicalizationMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				</complexType>
			</element>
			<element name="SignatureMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				</complexType>
			</element>
			<element name="Reference" type="ds:ReferenceType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="ReferenceType">
		<sequence>
			<element name="Transforms" type="ds:TransformsType">
				<!-- Garante a unicidade do atributo -->
				<unique name="unique_Transf_Alg">
					<selector xpath="./*"/>
					<field xpath="@Algorithm"/>
				</unique>
			</element>
			<element name="DigestMethod">
				<complexType>
					<attribute name="Algorithm" type="anyURI" use="required" fixed="http://www.w3.org/2000/09/xmldsig#sha1"/>
				</complexType>
			</element>
			<element name="DigestValue" type="ds:DigestValueType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
		<attribute name="URI" use="required">
			<simpleType>
				<restriction base="anyURI">
					<minLength value="2"/>
				</restriction>
			</simpleType>
		</attribute>
		<attribute name="Type" type="anyURI" use="optional"/>
	</complexType>
	<complexType name="TransformsType">
		<sequence>
			<element name="Transform" type="ds:TransformType" minOccurs="2" maxOccurs="2"/>
		</sequence>
	</complexType>
	<complexType name="TransformType">
		<sequence minOccurs="0" maxOccurs="unbounded">
			<element name="XPath" type="string"/>
		</sequence>
		<attribute name="Algorithm" type="ds:TTransformURI" use="required"/>
	</complexType>
	<complexType name="KeyInfoType">
		<sequence>
			<element name="X509Data" type="ds:X509DataType"/>
		</sequence>
		<attribute name="Id" type="ID" use="optional"/>
	</complexType>
	<complexType name="X509DataType">
		<sequence>
			<element name="X509Certificate" type="base64Binary"/>
		</sequence>
	</complexType>
	<simpleType name="DigestValueType">
		<restriction base="base64Binary"/>
	</simpleType>
	<simpleType name="TTransformURI">
		<restriction base="anyURI">
			<enumeration value="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
			<enumeration value="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
		</restriction>
	</simpleType>
</schema>
</file>

<file path="payisp/js/bootbox.all.js">
/*! @preserve
 * bootbox.js
 * version: 6.0.0
 * author: Nick Payne <nick@kurai.co.uk>
 * license: MIT
 * http://bootboxjs.com/
 */
(function(root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // AMD
    define(['jquery'], factory);
  } else if (typeof exports === 'object') {
    // Node, CommonJS-like
    module.exports = factory(require('jquery'));
  } else {
    // Browser globals (root is window)
    root.bootbox = factory(root.jQuery);
  }
}(this, function init($, undefined) {
  'use strict';

  let exports = {};

  let VERSION = '6.0.0';
  exports.VERSION = VERSION;

  let locales = {
    'en': {
      OK: 'OK',
      CANCEL: 'Cancel',
      CONFIRM: 'OK'
    }
  };

  let templates = {
    dialog: '<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',
    header: '<div class="modal-header"><h5 class="modal-title"></h5></div>',
    footer: '<div class="modal-footer"></div>',
    closeButton: '<button type="button" class="bootbox-close-button close btn-close" aria-hidden="true" aria-label="Close"></button>',
    form: '<form class="bootbox-form"></form>',
    button: '<button type="button" class="btn"></button>',
    option: '<option value=""></option>',
    promptMessage: '<div class="bootbox-prompt-message"></div>',
    inputs: {
      text: '<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',
      textarea: '<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',
      email: '<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',
      select: '<select class="bootbox-input bootbox-input-select form-select"></select>',
      checkbox: '<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',
      radio: '<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',
      date: '<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',
      time: '<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',
      number: '<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',
      password: '<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',
      range: '<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'
    }
  };


  let defaults = {
    // Default language used when generating buttons for alert, confirm, and prompt dialogs
    locale: 'en',
    // Show backdrop or not. Default to static so user has to interact with dialog
    backdrop: 'static',
    // Animate the modal in/out
    animate: true,
    // Additional class string applied to the top level dialog
    className: null,
    // Whether or not to include a close button
    closeButton: true,
    // Show the dialog immediately by default
    show: true,
    // Dialog container
    container: 'body',
    // Default value (used by the prompt helper)
    value: '',
    // Default input type (used by the prompt helper)
    inputType: 'text',
    // Custom error message to report if prompt fails validation
    errorMessage: null,
    // Switch button order from cancel/confirm (default) to confirm/cancel
    swapButtonOrder: false,
    // Center modal vertically in page
    centerVertical: false,
    // Append "multiple" property to the select when using the "prompt" helper
    multiple: false,
    // Automatically scroll modal content when height exceeds viewport height
    scrollable: false,
    // Whether or not to destroy the modal on hide
    reusable: false,
    // The element which triggered the dialog
    relatedTarget: null,
    // The size of the modal to generate
    size: null,
    // A unique indentifier for this modal
    id: null
  };


  // PUBLIC FUNCTIONS
  // *************************************************************************************************************

  /**
   * Return all currently registered locales, or a specific locale if "name" is defined
   * @param {string} [name]
   * @returns {(Object|Object[])} An array of the available locale objects, or a single locale object if {name} is not null
   */
  exports.locales = function(name) {
    return name ? locales[name] : locales;
  };


  /**
   * Register localized strings for the OK, CONFIRM, and CANCEL buttons
   * @param {string} name - The key used to identify the new locale in the locales array
   * @param {Object} values - An object containing the localized string for each of the OK, CANCEL, and CONFIRM properties of a locale
   * @returns The updated bootbox object
   */
  exports.addLocale = function(name, values) {
    $.each(['OK', 'CANCEL', 'CONFIRM'], function(_, v) {
      if (!values[v]) {
        throw new Error('Please supply a translation for "' + v + '"');
      }
    });

    locales[name] = {
      OK: values.OK,
      CANCEL: values.CANCEL,
      CONFIRM: values.CONFIRM
    };

    return exports;
  };


  /**
   * Remove a previously-registered locale
   * @param {string} name - The key identifying the locale to remove
   * @returns The updated bootbox object
   */
  exports.removeLocale = function(name) {
    if (name !== 'en') {
      delete locales[name];
    } else {
      throw new Error('"en" is used as the default and fallback locale and cannot be removed.');
    }

    return exports;
  };


  /**
   * Set the default locale
   * @param {string} name - The key identifying the locale to set as the default locale for all future bootbox calls 
   * @returns The updated bootbox object
   */
  exports.setLocale = function(name) {
    return exports.setDefaults('locale', name);
  };


  /**
   * Override default value(s) of Bootbox.
   * @returns The updated bootbox object
   */
  exports.setDefaults = function() {
    let values = {};

    if (arguments.length === 2) {
      // Allow passing of single key/value...
      values[arguments[0]] = arguments[1];
    } else {
      // ... and as an object too
      values = arguments[0];
    }

    $.extend(defaults, values);

    return exports;
  };


  /**
   * Hides all currently active Bootbox modals
   * @returns The current bootbox object
   */
  exports.hideAll = function() {
    $('.bootbox').modal('hide');

    return exports;
  };


  /**
   * Allows the base init() function to be overridden
   * @param {function} _$ - A function to be called when the bootbox instance is created
   * @returns The current bootbox object
   */
  exports.init = function(_$) {
    return init(_$ || $);
  };


  // CORE HELPER FUNCTIONS
  // *************************************************************************************************************

  /**
   * The core dialog helper function, which can be used to create any custom Bootstrap modal. 
   * @param {Object} options - An object used to configure the various properties which define a Bootbox dialog
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.dialog = function(options) {
    if ($.fn.modal === undefined) {
      throw new Error(
        '"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/5.1/getting-started/introduction/ for more details.'
      );
    }

    options = sanitize(options);

    if ($.fn.modal.Constructor.VERSION) {
      options.fullBootstrapVersion = $.fn.modal.Constructor.VERSION;
      let i = options.fullBootstrapVersion.indexOf('.');
      options.bootstrap = options.fullBootstrapVersion.substring(0, i);
    } else {
      // Assuming version 2.3.2, as that was the last "supported" 2.x version
      options.bootstrap = '2';
      options.fullBootstrapVersion = '2.3.2';
      console.warn('Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible.');
    }

    let dialog = $(templates.dialog);
    let innerDialog = dialog.find('.modal-dialog');
    let body = dialog.find('.modal-body');
    let header = $(templates.header);
    let footer = $(templates.footer);
    let buttons = options.buttons;

    let callbacks = {
      onEscape: options.onEscape
    };

    body.find('.bootbox-body').html(options.message);

    // Only attempt to create buttons if at least one has been defined in the options object
    if (getKeyLength(options.buttons) > 0) {
      each(buttons, function(key, b) {
        let button = $(templates.button);
        button.data('bb-handler', key);
        button.addClass(b.className);

        switch (key) {
          case 'ok':
          case 'confirm':
            button.addClass('bootbox-accept');
            break;

          case 'cancel':
            button.addClass('bootbox-cancel');
            break;
        }

        button.html(b.label);

        if (b.id) {
          button.attr({
            'id': b.id
          });
        }

        if (b.disabled === true) {
          button.prop({
            disabled: true
          });
        }

        footer.append(button);

        callbacks[key] = b.callback;
      });

      body.after(footer);
    }

    if (options.animate === true) {
      dialog.addClass('fade');
    }

    if (options.className) {
      dialog.addClass(options.className);
    }

    if (options.id) {
      dialog.attr({
        'id': options.id
      });
    }

    if (options.size) {
      // Requires Bootstrap 3.1.0 or higher
      if (options.fullBootstrapVersion.substring(0, 3) < '3.1') {
        console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }

      switch (options.size) {
        case 'small':
        case 'sm':
          innerDialog.addClass('modal-sm');
          break;

        case 'large':
        case 'lg':
          innerDialog.addClass('modal-lg');
          break;

        case 'extra-large':
        case 'xl':
          innerDialog.addClass('modal-xl');

          // Requires Bootstrap 4.2.0 or higher
          if (options.fullBootstrapVersion.substring(0, 3) < '4.2') {
            console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
          }
          break;
      }
    }

    if (options.scrollable) {
      innerDialog.addClass('modal-dialog-scrollable');

      // Requires Bootstrap 4.3.0 or higher
      if (options.fullBootstrapVersion.substring(0, 3) < '4.3') {
        console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }
    }

    if (options.title || options.closeButton) {
      if (options.title) {
        header.find('.modal-title').html(options.title);
      } else {
        header.addClass('border-0');
      }

      if (options.closeButton) {
        let closeButton = $(templates.closeButton);
        if (options.bootstrap < 5) {
          closeButton.html('&times;');
        }

        /* Note: the close button for Bootstrap 5+ does not contain content */
        if (options.bootstrap < 4) {
          /* Bootstrap 3 and under */
          header.prepend(closeButton);
        } else {
          header.append(closeButton);
        }
      }

      body.before(header);
    }

    if (options.centerVertical) {
      innerDialog.addClass('modal-dialog-centered');

      // Requires Bootstrap 4.0.0-beta.3 or higher
      if (options.fullBootstrapVersion < '4.0.0') {
        console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }
    }

    // Bootstrap event listeners; these handle extra setup & teardown required after the underlying modal has performed certain actions.

    if (!options.reusable) {
      // make sure we unbind any listeners once the dialog has definitively been dismissed
      dialog.one('hide.bs.modal', {
        dialog: dialog
      }, unbindModal);
      dialog.one('hidden.bs.modal', {
        dialog: dialog
      }, destroyModal);
    }

    if (options.onHide) {
      if ($.isFunction(options.onHide)) {
        dialog.on('hide.bs.modal', options.onHide);
      } else {
        throw new Error('Argument supplied to "onHide" must be a function');
      }
    }

    if (options.onHidden) {
      if ($.isFunction(options.onHidden)) {
        dialog.on('hidden.bs.modal', options.onHidden);
      } else {
        throw new Error('Argument supplied to "onHidden" must be a function');
      }
    }

    if (options.onShow) {
      if ($.isFunction(options.onShow)) {
        dialog.on('show.bs.modal', options.onShow);
      } else {
        throw new Error('Argument supplied to "onShow" must be a function');
      }
    }

    dialog.one('shown.bs.modal', {
      dialog: dialog
    }, focusPrimaryButton);

    if (options.onShown) {
      if ($.isFunction(options.onShown)) {
        dialog.on('shown.bs.modal', options.onShown);
      } else {
        throw new Error('Argument supplied to "onShown" must be a function');
      }
    }

    // Bootbox event listeners; used to decouple some behaviours from their respective triggers

    if (options.backdrop === true) {
      let startedOnBody = false;

      // Prevents the event from propagating to the backdrop, when something inside the dialog is clicked
      dialog.on('mousedown', '.modal-content', function(e) {
        e.stopPropagation();

        startedOnBody = true;
      });

      // A boolean true/false according to the Bootstrap docs should show a dialog the user can dismiss by clicking on the background.
      // We always only ever pass static/false to the actual $.modal function because with "true" we can't trap this event (the .modal-backdrop swallows it).
      // However, we still want to sort-of respect true and invoke the escape mechanism instead
      dialog.on('click.dismiss.bs.modal', function(e) {
        if (startedOnBody || e.target !== e.currentTarget) {
          return;
        }

        dialog.trigger('escape.close.bb');
      });
    }

    dialog.on('escape.close.bb', function(e) {
      // The if() statement looks redundant but it isn't; without it, if we *didn't* have an onEscape handler then processCallback would automatically dismiss the dialog
      if (callbacks.onEscape) {
        processCallback(e, dialog, callbacks.onEscape);
      }
    });

    dialog.on('click', '.modal-footer button:not(.disabled)', function(e) {
      let callbackKey = $(this).data('bb-handler');

      if (callbackKey !== undefined) {
        // Only process callbacks for buttons we recognize:
        processCallback(e, dialog, callbacks[callbackKey]);
      }
    });

    dialog.on('click', '.bootbox-close-button', function(e) {
      // onEscape might be falsy, but that's fine; the fact is if the user has managed to click the close button we have to close the dialog, callback or not
      processCallback(e, dialog, callbacks.onEscape);
    });

    dialog.on('keyup', function(e) {
      if (e.which === 27) {
        dialog.trigger('escape.close.bb');
      }
    });

    /*
    The remainder of this method simply deals with adding our dialog element to the DOM, augmenting it with 
    Bootstrap's modal functionality and then giving the resulting object back to our caller
    */

    $(options.container).append(dialog);

    dialog.modal({
      backdrop: options.backdrop,
      keyboard: false,
      show: false
    });

    if (options.show) {
      dialog.modal('show', options.relatedTarget);
    }

    return dialog;
  };


  /**
   * Helper function to simulate the native alert() behavior. **NOTE**: This is non-blocking, so any code that must happen after the alert is dismissed should be placed within the callback function for this alert.
   * @returns  A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.alert = function() {
    let options;

    options = mergeDialogOptions('alert', ['ok'], ['message', 'callback'], arguments);

    // @TODO: can this move inside exports.dialog when we're iterating over each button and checking its button.callback value instead?
    if (options.callback && !$.isFunction(options.callback)) {
      throw new Error('alert requires the "callback" property to be a function when provided');
    }

    // Override the ok and escape callback to make sure they just invoke the single user-supplied one (if provided)
    options.buttons.ok.callback = options.onEscape = function() {
      if ($.isFunction(options.callback)) {
        return options.callback.call(this);
      }

      return true;
    };

    return exports.dialog(options);
  };


  /**
   * Helper function to simulate the native confirm() behavior. **NOTE**: This is non-blocking, so any code that must happen after the confirm is dismissed should be placed within the callback function for this confirm.
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.confirm = function() {
    let options;

    options = mergeDialogOptions('confirm', ['cancel', 'confirm'], ['message', 'callback'], arguments);

    // confirm specific validation; they don't make sense without a callback so make sure it's present
    if (!$.isFunction(options.callback)) {
      throw new Error('confirm requires a callback');
    }

    // Overrides; undo anything the user tried to set they shouldn't have
    options.buttons.cancel.callback = options.onEscape = function() {
      return options.callback.call(this, false);
    };

    options.buttons.confirm.callback = function() {
      return options.callback.call(this, true);
    };

    return exports.dialog(options);
  };


  /**
   * Helper function to simulate the native prompt() behavior. **NOTE**: This is non-blocking, so any code that must happen after the prompt is dismissed should be placed within the callback function for this prompt.
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.prompt = function() {
    let options;
    let promptDialog;
    let form;
    let input;
    let shouldShow;
    let inputOptions;

    // We have to create our form first, otherwise its value is undefined when gearing up our options.
    // @TODO this could be solved by allowing message to be a function instead...
    form = $(templates.form);

    // prompt defaults are more complex than others in that users can override more defaults
    options = mergeDialogOptions('prompt', ['cancel', 'confirm'], ['title', 'callback'], arguments);

    if (!options.value) {
      options.value = defaults.value;
    }

    if (!options.inputType) {
      options.inputType = defaults.inputType;
    }

    // Capture the user's 'show' value; we always set this to false before spawning the dialog to give us a chance to attach some handlers to it, but we need to make sure we respect a preference not to show it
    shouldShow = (options.show === undefined) ? defaults.show : options.show;

    // This is required prior to calling the dialog builder below - we need to add an event handler just before the prompt is shown
    options.show = false;

    // Handles the 'cancel' action
    options.buttons.cancel.callback = options.onEscape = function() {
      return options.callback.call(this, null);
    };

    // Prompt submitted - extract the prompt value. This requires a bit of work, given the different input types available.
    options.buttons.confirm.callback = function() {
      let value;

      if (options.inputType === 'checkbox') {
        value = input.find('input:checked').map(function() {
          return $(this).val();
        }).get();
      } else if (options.inputType === 'radio') {
        value = input.find('input:checked').val();
      } else {
        let el = input[0];

        // Clear any previous custom error message
        if (options.errorMessage) {
          el.setCustomValidity('');
        }

        if (el.checkValidity && !el.checkValidity()) {
          // If a custom error message was provided, add it now
          if (options.errorMessage) {
            el.setCustomValidity(options.errorMessage);
          }

          if (el.reportValidity) {
            el.reportValidity();
          }

          // prevents button callback from being called
          return false;
        } else {
          if (options.inputType === 'select' && options.multiple === true) {
            value = input.find('option:selected').map(function() {
              return $(this).val();
            }).get();
          } else {
            value = input.val();
          }
        }
      }

      return options.callback.call(this, value);
    };

    // prompt-specific validation
    if (!options.title) {
      throw new Error('prompt requires a title');
    }

    if (!$.isFunction(options.callback)) {
      throw new Error('prompt requires a callback');
    }

    if (!templates.inputs[options.inputType]) {
      throw new Error('Invalid prompt type');
    }

    // Create the input based on the supplied type
    input = $(templates.inputs[options.inputType]);

    switch (options.inputType) {
      case 'text':
      case 'textarea':
      case 'email':
      case 'password':
        input.val(options.value);

        if (options.placeholder) {
          input.attr('placeholder', options.placeholder);
        }

        if (options.pattern) {
          input.attr('pattern', options.pattern);
        }

        if (options.maxlength) {
          input.attr('maxlength', options.maxlength);
        }

        if (options.required) {
          input.prop({
            'required': true
          });
        }

        if (options.rows && !isNaN(parseInt(options.rows))) {
          if (options.inputType === 'textarea') {
            input.attr({
              'rows': options.rows
            });
          }
        }
        break;

      case 'date':
      case 'time':
      case 'number':
      case 'range':
        input.val(options.value);

        if (options.placeholder) {
          input.attr('placeholder', options.placeholder);
        }

        if (options.pattern) {
          input.attr('pattern', options.pattern);
        } else {
          if (options.inputType === 'date') {
            // Add the ISO-8601 short date format as a fallback for browsers without native type="date" support
            input.attr('pattern', '\d{4}-\d{2}-\d{2}');
          } else if (options.inputType === 'time') {
            // Add an HH:MM pattern as a fallback for browsers without native type="time" support
            input.attr('pattern', '\d{2}:\d{2}');
          }
        }

        if (options.required) {
          input.prop({
            'required': true
          });
        }

        // These input types have extra attributes which affect their input validation.
        // Warning: For most browsers, date inputs are buggy in their implementation of 'step', so this attribute will have no effect. Therefore, we don't set the attribute for date inputs.
        // @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/date#Setting_maximum_and_minimum_dates
        if (options.inputType !== 'date') {
          if (options.step) {
            if (options.step === 'any' || (!isNaN(options.step) && parseFloat(options.step) > 0)) {
              input.attr('step', options.step);
            } else {
              throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');
            }
          }
        }

        if (minAndMaxAreValid(options.inputType, options.min, options.max)) {
          if (options.min !== undefined) {
            input.attr('min', options.min);
          }
          if (options.max !== undefined) {
            input.attr('max', options.max);
          }
        }
        break;

      case 'select':
        let groups = {};
        inputOptions = options.inputOptions || [];

        if (!$.isArray(inputOptions)) {
          throw new Error('Please pass an array of input options');
        }

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "select" requires at least one option');
        }

        if (options.required) {
          input.prop({
            'required': true
          });
        }

        if (options.multiple) {
          input.prop({
            'multiple': true
          });
        }

        each(inputOptions, function(_, option) {
          // Assume the element to attach to is the input...
          let elem = input;

          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          // ... but override that element if this option sits in a group

          if (option.group) {
            // Initialise group if necessary
            if (!groups[option.group]) {
              groups[option.group] = $('<optgroup />').attr('label', option.group);
            }

            elem = groups[option.group];
          }

          let o = $(templates.option);
          o.attr('value', option.value).text(option.text);
          elem.append(o);
        });

        each(groups, function(_, group) {
          input.append(group);
        });

        // Safe to set a select's value as per a normal input
        input.val(options.value);
        if (options.bootstrap < 5) {
          input.removeClass('form-select').addClass('form-control');
        }
        break;

      case 'checkbox':
        let checkboxValues = $.isArray(options.value) ? options.value : [options.value];
        inputOptions = options.inputOptions || [];

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');
        }

        // Checkboxes have to nest within a containing element, so they break the rules a bit and we end up re-assigning our 'input' element to this container instead
        input = $('<div class="bootbox-checkbox-list"></div>');

        each(inputOptions, function(_, option) {
          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          let checkbox = $(templates.inputs[options.inputType]);

          checkbox.find('input').attr('value', option.value);
          checkbox.find('label').append('\n' + option.text);

          // We've ensured values is an array, so we can always iterate over it
          each(checkboxValues, function(_, value) {
            if (value === option.value) {
              checkbox.find('input').prop('checked', true);
            }
          });

          input.append(checkbox);
        });
        break;

      case 'radio':
        // Make sure that value is not an array (only a single radio can ever be checked)
        if (options.value !== undefined && $.isArray(options.value)) {
          throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');
        }

        inputOptions = options.inputOptions || [];

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "radio" requires at least one option');
        }

        // Radiobuttons have to nest within a containing element, so they break the rules a bit and we end up re-assigning our 'input' element to this container instead
        input = $('<div class="bootbox-radiobutton-list"></div>');

        // Radiobuttons should always have an initial checked input checked in a "group".
        // If value is undefined or doesn't match an input option, select the first radiobutton
        let checkFirstRadio = true;

        each(inputOptions, function(_, option) {
          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          let radio = $(templates.inputs[options.inputType]);

          radio.find('input').attr('value', option.value);
          radio.find('label').append('\n' + option.text);

          if (options.value !== undefined) {
            if (option.value === options.value) {
              radio.find('input').prop('checked', true);
              checkFirstRadio = false;
            }
          }

          input.append(radio);
        });

        if (checkFirstRadio) {
          input.find('input[type="radio"]').first().prop('checked', true);
        }
        break;
    }

    // Now place it in our form
    form.append(input);

    form.on('submit', function(e) {
      e.preventDefault();
      // Fix for SammyJS (or similar JS routing library) hijacking the form post.
      e.stopPropagation();

      // @TODO can we actually click *the* button object instead?
      // e.g. buttons.confirm.click() or similar
      promptDialog.find('.bootbox-accept').trigger('click');
    });

    if ($.trim(options.message) !== '') {
      // Add the form to whatever content the user may have added.
      let message = $(templates.promptMessage).html(options.message);
      form.prepend(message);
      options.message = form;
    } else {
      options.message = form;
    }

    // Generate the dialog
    promptDialog = exports.dialog(options);

    // Clear the existing handler focusing the submit button...
    promptDialog.off('shown.bs.modal', focusPrimaryButton);

    // ...and replace it with one focusing our input, if possible
    promptDialog.on('shown.bs.modal', function() {
      // Need the closure here since input isn'tcan object otherwise
      input.focus();
    });

    if (shouldShow === true) {
      promptDialog.modal('show');
    }

    return promptDialog;
  };


  // INTERNAL FUNCTIONS
  // *************************************************************************************************************

  // Map a flexible set of arguments into a single returned object.
  // If args.length is already one just return it, otherwise use the properties argument to map the unnamed args to object properties.
  // So in the latter case:
  //
  //    mapArguments(["foo", $.noop], ["message", "callback"])
  //  
  //  results in
  //
  //    { message: "foo", callback: $.noop }
  //
  function mapArguments(args, properties) {
    let argsLength = args.length;
    let options = {};

    if (argsLength < 1 || argsLength > 2) {
      throw new Error('Invalid argument length');
    }

    if (argsLength === 2 || typeof args[0] === 'string') {
      options[properties[0]] = args[0];
      options[properties[1]] = args[1];
    } else {
      options = args[0];
    }

    return options;
  }


  // Merge a set of default dialog options with user supplied arguments
  function mergeArguments(defaults, args, properties) {
    return $.extend(
      // Deep merge
      true,
      // Ensure the target is an empty, unreferenced object
      {},
      // The base options object for this type of dialog (often just buttons)
      defaults,
      // 'args' could be an object or array; if it's an array properties will map it to a proper options object
      mapArguments(args, properties)
    );
  }


  // This entry-level method makes heavy use of composition to take a simple range of inputs and return valid options suitable for passing to bootbox.dialog
  function mergeDialogOptions(className, labels, properties, args) {
    let locale;
    if (args && args[0]) {
      locale = args[0].locale || defaults.locale;
      let swapButtons = args[0].swapButtonOrder || defaults.swapButtonOrder;

      if (swapButtons) {
        labels = labels.reverse();
      }
    }

    // Build up a base set of dialog properties
    let baseOptions = {
      className: 'bootbox-' + className,
      buttons: createLabels(labels, locale)
    };

    // Ensure the buttons properties generated, *after* merging with user args are still valid against the supplied labels
    return validateButtons(
      // Merge the generated base properties with user supplied arguments
      mergeArguments(
        baseOptions,
        args,
        // If args.length > 1, properties specify how each arg maps to an object key
        properties
      ),
      labels
    );
  }


  // Checks each button object to see if key is valid. 
  // This function will only be called by the alert, confirm, and prompt helpers. 
  function validateButtons(options, buttons) {
    let allowedButtons = {};
    each(buttons, function(key, value) {
      allowedButtons[value] = true;
    });

    each(options.buttons, function(key) {
      if (allowedButtons[key] === undefined) {
        throw new Error('button key "' + key + '" is not allowed (options are ' + buttons.join(' ') + ')');
      }
    });

    return options;
  }


  // From a given list of arguments, return a suitable object of button labels.
  // All this does is normalise the given labels and translate them where possible.
  // e.g. "ok", "confirm" -> { ok: "OK", cancel: "Annuleren" }
  function createLabels(labels, locale) {
    let buttons = {};

    for (let i = 0, j = labels.length; i < j; i++) {
      let argument = labels[i];
      let key = argument.toLowerCase();
      let value = argument.toUpperCase();

      buttons[key] = {
        label: getText(value, locale)
      };
    }

    return buttons;
  }


  // Get localized text from a locale. Defaults to 'en' locale if no locale provided or a non-registered locale is requested
  function getText(key, locale) {
    let labels = locales[locale];

    return labels ? labels[key] : locales.en[key];
  }


  // Filter and tidy up any user supplied parameters to this dialog.
  // Also looks for any shorthands used and ensures that the options which are returned are all normalized properly
  function sanitize(options) {
    let buttons;
    let total;

    if (typeof options !== 'object') {
      throw new Error('Please supply an object of options');
    }

    if (!options.message) {
      throw new Error('"message" option must not be null or an empty string.');
    }

    // Make sure any supplied options take precedence over defaults
    options = $.extend({}, defaults, options);

    // Make sure backdrop is either true, false, or 'static'
    if (!options.backdrop) {
      options.backdrop = (options.backdrop === false || options.backdrop === 0) ? false : 'static';
    } else {
      options.backdrop = typeof options.backdrop === 'string' && options.backdrop.toLowerCase() === 'static' ? 'static' : true;
    }

    // No buttons is still a valid dialog but it's cleaner to always have a buttons object to iterate over, even if it's empty
    if (!options.buttons) {
      options.buttons = {};
    }

    buttons = options.buttons;

    total = getKeyLength(buttons);

    each(buttons, function(key, button, index) {
      if ($.isFunction(button)) {
        // Short form, assume value is our callback. Since button isn't an object it isn't a reference either so re-assign it
        button = buttons[key] = {
          callback: button
        };
      }

      // Before any further checks, make sure button is the correct type
      if ($.type(button) !== 'object') {
        throw new Error('button with key "' + key + '" must be an object');
      }

      if (!button.label) {
        // The lack of an explicit label means we'll assume the key is good enough
        button.label = key;
      }

      if (!button.className) {
        let isPrimary = false;
        if (options.swapButtonOrder) {
          isPrimary = index === 0;
        } else {
          isPrimary = index === total - 1;
        }

        if (total <= 2 && isPrimary) {
          // always add a primary to the main option in a one or two-button dialog
          button.className = 'btn-primary';
        } else {
          // adding both classes allows us to target both BS3 and BS4+ without needing to check the version
          button.className = 'btn-secondary btn-default';
        }
      }
    });

    return options;
  }


  // Returns a count of the properties defined on the object
  function getKeyLength(obj) {
    return Object.keys(obj).length;
  }


  // Tiny wrapper function around jQuery.each; just adds index as the third parameter
  function each(collection, iterator) {
    let index = 0;
    $.each(collection, function(key, value) {
      iterator(key, value, index++);
    });
  }


  function focusPrimaryButton(e) {
    e.data.dialog.find('.bootbox-accept').first().trigger('focus');
  }


  function destroyModal(e) {
    // Ensure we don't accidentally intercept hidden events triggered by children of the current dialog. 
    // We shouldn't need to handle this anymore, now that Bootstrap namespaces its events, but still worth doing.
    if (e.target === e.data.dialog[0]) {
      e.data.dialog.remove();
    }
  }


  function unbindModal(e) {
    if (e.target === e.data.dialog[0]) {
      e.data.dialog.off('escape.close.bb');
      e.data.dialog.off('click');
    }
  }


  //  Handle the invoked dialog callback
  function processCallback(e, dialog, callback) {
    e.stopPropagation();
    e.preventDefault();

    // By default we assume a callback will get rid of the dialog, although it is given the opportunity to override this

    // If the callback can be invoked and it *explicitly returns false*, then we'll set a flag to keep the dialog active...
    let preserveDialog = $.isFunction(callback) && callback.call(dialog, e) === false;

    // ... otherwise we'll bin it
    if (!preserveDialog) {
      dialog.modal('hide');
    }
  }

  // Validate `min` and `max` values based on the current `inputType` value
  function minAndMaxAreValid(type, min, max) {
    let result = false;
    let minValid = true;
    let maxValid = true;

    if (type === 'date') {
      if (min !== undefined && !(minValid = dateIsValid(min))) {
        console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');
      } else if (max !== undefined && !(maxValid = dateIsValid(max))) {
        console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.');
      }
    } else if (type === 'time') {
      if (min !== undefined && !(minValid = timeIsValid(min))) {
        throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');
      } else if (max !== undefined && !(maxValid = timeIsValid(max))) {
        throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');
      }
    } else {
      if (min !== undefined && isNaN(min)) {
        minValid = false;
        throw new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');
      }

      if (max !== undefined && isNaN(max)) {
        maxValid = false;
        throw new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');
      }
    }

    if (minValid && maxValid) {
      if (max <= min) {
        throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');
      } else {
        result = true;
      }
    }

    return result;
  }

  function timeIsValid(value) {
    return /([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(value);
  }

  function dateIsValid(value) {
    return /(\d{4})-(\d{2})-(\d{2})/.test(value);
  }

  //  The Bootbox object
  return exports;
}));

/*! @preserve
 * bootbox.locales.js
 * version: 6.0.0
 * author: Nick Payne <nick@kurai.co.uk>
 * license: MIT
 * http://bootboxjs.com/
 */
(function(global, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    define(['bootbox'], factory);
  } else if (typeof module === 'object' && module.exports) {
    factory(require('./bootbox'));
  } else {
    factory(global.bootbox);
  }
}(this, function(bootbox) {
  'use strict';

  // locale : Arabic
  // author : Emad Omar
  bootbox.addLocale('ar', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Azerbaijani
  // author : Valentin Belousov
  bootbox.addLocale('az', {
    OK: 'OK',
    CANCEL: 'mtina et',
    CONFIRM: 'Tsdiq et'
  });
  // locale : Bulgarian
  // author :  mraiur
  bootbox.addLocale('bg-BG', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Czech
  // author : Luk Fry
  bootbox.addLocale('cs', {
    OK: 'OK',
    CANCEL: 'Zruit',
    CONFIRM: 'Potvrdit'
  });
  // locale : Danish
  // author : Frederik Alkrsig
  bootbox.addLocale('da', {
    OK: 'OK',
    CANCEL: 'Annuller',
    CONFIRM: 'Accepter'
  });
  // locale : German
  // author : Nick Payne
  bootbox.addLocale('de', {
    OK: 'OK',
    CANCEL: 'Abbrechen',
    CONFIRM: 'Akzeptieren'
  });
  // locale : Greek
  // author : Tolis Emmanouilidis
  bootbox.addLocale('el', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : English
  // author : Nick Payne
  bootbox.addLocale('en', {
    OK: 'OK',
    CANCEL: 'Cancel',
    CONFIRM: 'OK'
  });
  // locale : Spanish
  // author : Ian Leckey
  bootbox.addLocale('es', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Aceptar'
  });
  // locale : Estonian
  // author : Pavel Krlov
  bootbox.addLocale('et', {
    OK: 'OK',
    CANCEL: 'Katkesta',
    CONFIRM: 'OK'
  });
  // locale : Basque
  // author : Iker Ibarguren
  bootbox.addLocale('eu', {
    OK: 'OK',
    CANCEL: 'Ezeztatu',
    CONFIRM: 'Onartu'
  });
  // locale : Persian
  // author : Touhid Arastu
  bootbox.addLocale('fa', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Finnish
  // author : Nick Payne
  bootbox.addLocale('fi', {
    OK: 'OK',
    CANCEL: 'Peruuta',
    CONFIRM: 'OK'
  });
  // locale : French
  // author : Nick Payne, Sebastien Andary
  bootbox.addLocale('fr', {
    OK: 'OK',
    CANCEL: 'Annuler',
    CONFIRM: 'Confirmer'
  });
  // locale : Hebrew
  // author : Chen Alon
  bootbox.addLocale('he', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Croatian
  // author : Mario Bai
  bootbox.addLocale('hr', {
    OK: 'OK',
    CANCEL: 'Odustani',
    CONFIRM: 'Potvrdi'
  });
  // locale : Hungarian
  // author : Mrk Sgi-Kazr
  bootbox.addLocale('hu', {
    OK: 'OK',
    CANCEL: 'Mgsem',
    CONFIRM: 'Megerst'
  });
  // locale : Indonesian
  // author : Budi Irawan
  bootbox.addLocale('id', {
    OK: 'OK',
    CANCEL: 'Batal',
    CONFIRM: 'OK'
  });
  // locale : Italian
  // author : Mauro
  bootbox.addLocale('it', {
    OK: 'OK',
    CANCEL: 'Annulla',
    CONFIRM: 'Conferma'
  });
  // locale : Japanese
  // author : ms183
  bootbox.addLocale('ja', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Georgian
  // author : Avtandil Kikabidze aka LONGMAN (@akalongman)
  bootbox.addLocale('ka', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Korean
  // author : rigning
  bootbox.addLocale('ko', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Lithuanian
  // author : Tomas
  bootbox.addLocale('lt', {
    OK: 'Gerai',
    CANCEL: 'Ataukti',
    CONFIRM: 'Patvirtinti'
  });
  // locale : Latvian
  // author : Dmitry Bogatykh, Lauris BH
  bootbox.addLocale('lv', {
    OK: 'Labi',
    CANCEL: 'Atcelt',
    CONFIRM: 'Apstiprint'
  });
  // locale : Dutch
  // author : Bas ter Vrugt
  bootbox.addLocale('nl', {
    OK: 'OK',
    CANCEL: 'Annuleren',
    CONFIRM: 'Accepteren'
  });
  // locale : Norwegian
  // author : Nils Magnus Englund
  bootbox.addLocale('no', {
    OK: 'OK',
    CANCEL: 'Avbryt',
    CONFIRM: 'OK'
  });
  // locale : Polish
  // author : Szczepan Cielik
  bootbox.addLocale('pl', {
    OK: 'OK',
    CANCEL: 'Anuluj',
    CONFIRM: 'Potwierd'
  });
  // locale : Portuguese (Brasil)
  // author : Nick Payne
  bootbox.addLocale('pt-BR', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Sim'
  });
  // locale : Portuguese
  // author : Cludio Medina
  bootbox.addLocale('pt', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Confirmar'
  });
  // locale : Russian
  // author : ionian-wind
  bootbox.addLocale('ru', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Slovak
  // author : Stano Paka
  bootbox.addLocale('sk', {
    OK: 'OK',
    CANCEL: 'Zrui',
    CONFIRM: 'Potvrdi'
  });
  // locale : Slovenian
  // author : @metalcamp
  bootbox.addLocale('sl', {
    OK: 'OK',
    CANCEL: 'Preklii',
    CONFIRM: 'Potrdi'
  });
  // locale : Albanian
  // author : Knut Hhne
  bootbox.addLocale('sq', {
    OK: 'OK',
    CANCEL: 'Anulo',
    CONFIRM: 'Prano'
  });
  // locale : Swedish
  // author : Mattias Reichel
  bootbox.addLocale('sv', {
    OK: 'OK',
    CANCEL: 'Avbryt',
    CONFIRM: 'OK'
  });
  // locale : Swahili
  // author : Timothy Anyona
  bootbox.addLocale('sw', {
    OK: 'Sawa',
    CANCEL: 'Ghairi',
    CONFIRM: 'Thibitisha'
  });
  // locale : Tamil
  // author : Kolappan Nathan
  bootbox.addLocale('ta', {
    OK: '',
    CANCEL: ' ',
    CONFIRM: ' '
  });
  // locale : Thai
  // author : Ishmael
  bootbox.addLocale('th', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Turkish
  // author : Enes Karaca
  bootbox.addLocale('tr', {
    OK: 'Tamam',
    CANCEL: 'ptal',
    CONFIRM: 'Onayla'
  });
  // locale : Ukrainian
  // author : OlehBoiko
  bootbox.addLocale('uk', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Vietnamese
  // author :  Anh Tu Nguyen
  bootbox.addLocale('vi', {
    OK: 'OK',
    CANCEL: 'Hy b',
    CONFIRM: 'Xc nhn'
  });
  // locale : Chinese (China / People's Republic of China)
  // author : Nick Payne
  bootbox.addLocale('zh-CN', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Chinese (Taiwan / Republic of China)
  // author : Nick Payne
  bootbox.addLocale('zh-TW', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });

}));
</file>

<file path="payisp/js/bootbox.all.min.js">
/**
 * Bootbox.js  alert, confirm, prompt, and flexible dialogs for the Bootstrap framework 
 * @version: 6.0.0
 * @project: https://github.com/makeusabrew/bootbox
 * @license: MIT http://bootboxjs.com/license.txt
 */
!function(e,t){'use strict';'function'==typeof define&&define.amd?define(['jquery'],t):'object'==typeof exports?module.exports=t(require('jquery')):e.bootbox=t(e.jQuery)}(this,function t(s,c){'use strict';let r={};r.VERSION='6.0.0';let i={en:{OK:'OK',CANCEL:'Cancel',CONFIRM:'OK'}},d={dialog:'<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',header:'<div class="modal-header"><h5 class="modal-title"></h5></div>',footer:'<div class="modal-footer"></div>',closeButton:'<button type="button" class="bootbox-close-button close btn-close" aria-hidden="true" aria-label="Close"></button>',form:'<form class="bootbox-form"></form>',button:'<button type="button" class="btn"></button>',option:'<option value=""></option>',promptMessage:'<div class="bootbox-prompt-message"></div>',inputs:{text:'<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',textarea:'<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',email:'<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',select:'<select class="bootbox-input bootbox-input-select form-select"></select>',checkbox:'<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',radio:'<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',date:'<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',time:'<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',number:'<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',password:'<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',range:'<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'}},u={locale:'en',backdrop:'static',animate:!0,className:null,closeButton:!0,show:!0,container:'body',value:'',inputType:'text',errorMessage:null,swapButtonOrder:!1,centerVertical:!1,multiple:!1,scrollable:!1,reusable:!1,relatedTarget:null,size:null,id:null};function l(e,t,o){return s.extend(!0,{},e,function(e,t){var o=e.length;let a={};if(o<1||2<o)throw new Error('Invalid argument length');return 2===o||'string'==typeof e[0]?(a[t[0]]=e[0],a[t[1]]=e[1]):a=e[0],a}(t,o))}function p(e,t,a,r){let o;r&&r[0]&&(o=r[0].locale||u.locale,(r[0].swapButtonOrder||u.swapButtonOrder)&&(t=t.reverse()));e={className:'bootbox-'+e,buttons:function(o,a){let r={};for(let t=0,e=o.length;t<e;t++){let e=o[t];var n=e.toLowerCase(),l=e.toUpperCase();r[n]={label:function(e,t){t=i[t];return(t||i.en)[e]}(l,a)}}return r}(t,o)};{e=l(e,r,a);var n=t;let o={};return f(n,function(e,t){o[t]=!0}),f(e.buttons,function(e){if(o[e]===c)throw new Error('button key "'+e+'" is not allowed (options are '+n.join(' ')+')')}),e}}function b(e){return Object.keys(e).length}function f(e,o){let a=0;s.each(e,function(e,t){o(e,t,a++)})}function m(e){e.data.dialog.find('.bootbox-accept').first().trigger('focus')}function h(e){e.target===e.data.dialog[0]&&e.data.dialog.remove()}function C(e){e.target===e.data.dialog[0]&&(e.data.dialog.off('escape.close.bb'),e.data.dialog.off('click'))}function O(e,t,o){e.stopPropagation(),e.preventDefault(),s.isFunction(o)&&!1===o.call(t,e)||t.modal('hide')}function w(e){return/([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(e)}function g(e){return/(\d{4})-(\d{2})-(\d{2})/.test(e)}return r.locales=function(e){return e?i[e]:i},r.addLocale=function(e,o){return s.each(['OK','CANCEL','CONFIRM'],function(e,t){if(!o[t])throw new Error('Please supply a translation for "'+t+'"')}),i[e]={OK:o.OK,CANCEL:o.CANCEL,CONFIRM:o.CONFIRM},r},r.removeLocale=function(e){if('en'===e)throw new Error('"en" is used as the default and fallback locale and cannot be removed.');return delete i[e],r},r.setLocale=function(e){return r.setDefaults('locale',e)},r.setDefaults=function(){let e={};return 2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],s.extend(u,e),r},r.hideAll=function(){return s('.bootbox').modal('hide'),r},r.init=function(e){return t(e||s)},r.dialog=function(t){if(s.fn.modal===c)throw new Error('"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/5.1/getting-started/introduction/ for more details.');t=function(a){let r,n;if('object'!=typeof a)throw new Error('Please supply an object of options');if(!a.message)throw new Error('"message" option must not be null or an empty string.');(a=s.extend({},u,a)).backdrop?a.backdrop='string'!=typeof a.backdrop||'static'!==a.backdrop.toLowerCase()||'static':a.backdrop=!1!==a.backdrop&&0!==a.backdrop&&'static';a.buttons||(a.buttons={});return r=a.buttons,n=b(r),f(r,function(e,t,o){if(s.isFunction(t)&&(t=r[e]={callback:t}),'object'!==s.type(t))throw new Error('button with key "'+e+'" must be an object');if(t.label||(t.label=e),!t.className){let e=!1;e=a.swapButtonOrder?0===o:o===n-1,n<=2&&e?t.className='btn-primary':t.className='btn-secondary btn-default'}}),a}(t),s.fn.modal.Constructor.VERSION?(t.fullBootstrapVersion=s.fn.modal.Constructor.VERSION,l=t.fullBootstrapVersion.indexOf('.'),t.bootstrap=t.fullBootstrapVersion.substring(0,l)):(t.bootstrap='2',t.fullBootstrapVersion='2.3.2',console.warn('Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible.'));let o=s(d.dialog),e=o.find('.modal-dialog'),a=o.find('.modal-body'),r=s(d.header),n=s(d.footer);var l=t.buttons;let i={onEscape:t.onEscape};if(a.find('.bootbox-body').html(t.message),0<b(t.buttons)&&(f(l,function(e,t){let o=s(d.button);switch(o.data('bb-handler',e),o.addClass(t.className),e){case'ok':case'confirm':o.addClass('bootbox-accept');break;case'cancel':o.addClass('bootbox-cancel')}o.html(t.label),t.id&&o.attr({id:t.id}),!0===t.disabled&&o.prop({disabled:!0}),n.append(o),i[e]=t.callback}),a.after(n)),!0===t.animate&&o.addClass('fade'),t.className&&o.addClass(t.className),t.id&&o.attr({id:t.id}),t.size)switch(t.fullBootstrapVersion.substring(0,3)<'3.1'&&console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using '+t.fullBootstrapVersion+'. Please upgrade to use this option.'),t.size){case'small':case'sm':e.addClass('modal-sm');break;case'large':case'lg':e.addClass('modal-lg');break;case'extra-large':case'xl':e.addClass('modal-xl'),t.fullBootstrapVersion.substring(0,3)<'4.2'&&console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using '+t.fullBootstrapVersion+'. Please upgrade to use this option.')}if(t.scrollable&&(e.addClass('modal-dialog-scrollable'),t.fullBootstrapVersion.substring(0,3)<'4.3'&&console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using '+t.fullBootstrapVersion+'. Please upgrade to use this option.')),t.title||t.closeButton){if(t.title?r.find('.modal-title').html(t.title):r.addClass('border-0'),t.closeButton){let e=s(d.closeButton);t.bootstrap<5&&e.html('&times;'),t.bootstrap<4?r.prepend(e):r.append(e)}a.before(r)}if(t.centerVertical&&(e.addClass('modal-dialog-centered'),t.fullBootstrapVersion<'4.0.0'&&console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using '+t.fullBootstrapVersion+'. Please upgrade to use this option.')),t.reusable||(o.one('hide.bs.modal',{dialog:o},C),o.one('hidden.bs.modal',{dialog:o},h)),t.onHide){if(!s.isFunction(t.onHide))throw new Error('Argument supplied to "onHide" must be a function');o.on('hide.bs.modal',t.onHide)}if(t.onHidden){if(!s.isFunction(t.onHidden))throw new Error('Argument supplied to "onHidden" must be a function');o.on('hidden.bs.modal',t.onHidden)}if(t.onShow){if(!s.isFunction(t.onShow))throw new Error('Argument supplied to "onShow" must be a function');o.on('show.bs.modal',t.onShow)}if(o.one('shown.bs.modal',{dialog:o},m),t.onShown){if(!s.isFunction(t.onShown))throw new Error('Argument supplied to "onShown" must be a function');o.on('shown.bs.modal',t.onShown)}if(!0===t.backdrop){let t=!1;o.on('mousedown','.modal-content',function(e){e.stopPropagation(),t=!0}),o.on('click.dismiss.bs.modal',function(e){t||e.target!==e.currentTarget||o.trigger('escape.close.bb')})}return o.on('escape.close.bb',function(e){i.onEscape&&O(e,o,i.onEscape)}),o.on('click','.modal-footer button:not(.disabled)',function(e){var t=s(this).data('bb-handler');t!==c&&O(e,o,i[t])}),o.on('click','.bootbox-close-button',function(e){O(e,o,i.onEscape)}),o.on('keyup',function(e){27===e.which&&o.trigger('escape.close.bb')}),s(t.container).append(o),o.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.show&&o.modal('show',t.relatedTarget),o},r.alert=function(){let e;if((e=p('alert',['ok'],['message','callback'],arguments)).callback&&!s.isFunction(e.callback))throw new Error('alert requires the "callback" property to be a function when provided');return e.buttons.ok.callback=e.onEscape=function(){return!s.isFunction(e.callback)||e.callback.call(this)},r.dialog(e)},r.confirm=function(){let e;if(e=p('confirm',['cancel','confirm'],['message','callback'],arguments),s.isFunction(e.callback))return e.buttons.cancel.callback=e.onEscape=function(){return e.callback.call(this,!1)},e.buttons.confirm.callback=function(){return e.callback.call(this,!0)},r.dialog(e);throw new Error('confirm requires a callback')},r.prompt=function(){let n,t,e,l;var o,a;let i;if(e=s(d.form),(n=p('prompt',['cancel','confirm'],['title','callback'],arguments)).value||(n.value=u.value),n.inputType||(n.inputType=u.inputType),o=(n.show===c?u:n).show,n.show=!1,n.buttons.cancel.callback=n.onEscape=function(){return n.callback.call(this,null)},n.buttons.confirm.callback=function(){let t;if('checkbox'===n.inputType)t=l.find('input:checked').map(function(){return s(this).val()}).get();else if('radio'===n.inputType)t=l.find('input:checked').val();else{let e=l[0];if(n.errorMessage&&e.setCustomValidity(''),e.checkValidity&&!e.checkValidity())return n.errorMessage&&e.setCustomValidity(n.errorMessage),e.reportValidity&&e.reportValidity(),!1;t='select'===n.inputType&&!0===n.multiple?l.find('option:selected').map(function(){return s(this).val()}).get():l.val()}return n.callback.call(this,t)},!n.title)throw new Error('prompt requires a title');if(!s.isFunction(n.callback))throw new Error('prompt requires a callback');if(!d.inputs[n.inputType])throw new Error('Invalid prompt type');switch(l=s(d.inputs[n.inputType]),n.inputType){case'text':case'textarea':case'email':case'password':l.val(n.value),n.placeholder&&l.attr('placeholder',n.placeholder),n.pattern&&l.attr('pattern',n.pattern),n.maxlength&&l.attr('maxlength',n.maxlength),n.required&&l.prop({required:!0}),n.rows&&!isNaN(parseInt(n.rows))&&'textarea'===n.inputType&&l.attr({rows:n.rows});break;case'date':case'time':case'number':case'range':if(l.val(n.value),n.placeholder&&l.attr('placeholder',n.placeholder),n.pattern?l.attr('pattern',n.pattern):'date'===n.inputType?l.attr('pattern','d{4}-d{2}-d{2}'):'time'===n.inputType&&l.attr('pattern','d{2}:d{2}'),n.required&&l.prop({required:!0}),'date'!==n.inputType&&n.step){if(!('any'===n.step||!isNaN(n.step)&&0<parseFloat(n.step)))throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');l.attr('step',n.step)}!function(e,t,o){let a=!1,r=!0,n=!0;if('date'===e)t===c||(r=g(t))?o===c||(n=g(o))||console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.'):console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');else if('time'===e){if(t!==c&&!(r=w(t)))throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');if(o!==c&&!(n=w(o)))throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.')}else{if(t!==c&&isNaN(t))throw r=!1,new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');if(o!==c&&isNaN(o))throw n=!1,new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.')}if(r&&n){if(o<=t)throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');a=!0}return a}(n.inputType,n.min,n.max)||(n.min!==c&&l.attr('min',n.min),n.max!==c&&l.attr('max',n.max));break;case'select':let r={};if(i=n.inputOptions||[],!s.isArray(i))throw new Error('Please pass an array of input options');if(!i.length)throw new Error('prompt with "inputType" set to "select" requires at least one option');n.required&&l.prop({required:!0}),n.multiple&&l.prop({multiple:!0}),f(i,function(e,t){let o=l;if(t.value===c||t.text===c)throw new Error('each option needs a "value" property and a "text" property');t.group&&(r[t.group]||(r[t.group]=s('<optgroup />').attr('label',t.group)),o=r[t.group]);let a=s(d.option);a.attr('value',t.value).text(t.text),o.append(a)}),f(r,function(e,t){l.append(t)}),l.val(n.value),n.bootstrap<5&&l.removeClass('form-select').addClass('form-control');break;case'checkbox':let t=s.isArray(n.value)?n.value:[n.value];if(!(i=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');l=s('<div class="bootbox-checkbox-list"></div>'),f(i,function(e,o){if(o.value===c||o.text===c)throw new Error('each option needs a "value" property and a "text" property');let a=s(d.inputs[n.inputType]);a.find('input').attr('value',o.value),a.find('label').append('\n'+o.text),f(t,function(e,t){t===o.value&&a.find('input').prop('checked',!0)}),l.append(a)});break;case'radio':if(n.value!==c&&s.isArray(n.value))throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');if(!(i=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "radio" requires at least one option');l=s('<div class="bootbox-radiobutton-list"></div>');let a=!0;f(i,function(e,t){if(t.value===c||t.text===c)throw new Error('each option needs a "value" property and a "text" property');let o=s(d.inputs[n.inputType]);o.find('input').attr('value',t.value),o.find('label').append('\n'+t.text),n.value!==c&&t.value===n.value&&(o.find('input').prop('checked',!0),a=!1),l.append(o)}),a&&l.find('input[type="radio"]').first().prop('checked',!0)}return e.append(l),e.on('submit',function(e){e.preventDefault(),e.stopPropagation(),t.find('.bootbox-accept').trigger('click')}),''!==s.trim(n.message)&&(a=s(d.promptMessage).html(n.message),e.prepend(a)),n.message=e,(t=r.dialog(n)).off('shown.bs.modal',m),t.on('shown.bs.modal',function(){l.focus()}),!0===o&&t.modal('show'),t},r}),function(e,t){'use strict';'function'==typeof define&&define.amd?define(['bootbox'],t):'object'==typeof module&&module.exports?t(require('./bootbox')):t(e.bootbox)}(this,function(e){'use strict';e.addLocale('ar',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('az',{OK:'OK',CANCEL:'mtina et',CONFIRM:'Tsdiq et'}),e.addLocale('bg-BG',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('cs',{OK:'OK',CANCEL:'Zruit',CONFIRM:'Potvrdit'}),e.addLocale('da',{OK:'OK',CANCEL:'Annuller',CONFIRM:'Accepter'}),e.addLocale('de',{OK:'OK',CANCEL:'Abbrechen',CONFIRM:'Akzeptieren'}),e.addLocale('el',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('en',{OK:'OK',CANCEL:'Cancel',CONFIRM:'OK'}),e.addLocale('es',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Aceptar'}),e.addLocale('et',{OK:'OK',CANCEL:'Katkesta',CONFIRM:'OK'}),e.addLocale('eu',{OK:'OK',CANCEL:'Ezeztatu',CONFIRM:'Onartu'}),e.addLocale('fa',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('fi',{OK:'OK',CANCEL:'Peruuta',CONFIRM:'OK'}),e.addLocale('fr',{OK:'OK',CANCEL:'Annuler',CONFIRM:'Confirmer'}),e.addLocale('he',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('hr',{OK:'OK',CANCEL:'Odustani',CONFIRM:'Potvrdi'}),e.addLocale('hu',{OK:'OK',CANCEL:'Mgsem',CONFIRM:'Megerst'}),e.addLocale('id',{OK:'OK',CANCEL:'Batal',CONFIRM:'OK'}),e.addLocale('it',{OK:'OK',CANCEL:'Annulla',CONFIRM:'Conferma'}),e.addLocale('ja',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('ka',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('ko',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('lt',{OK:'Gerai',CANCEL:'Ataukti',CONFIRM:'Patvirtinti'}),e.addLocale('lv',{OK:'Labi',CANCEL:'Atcelt',CONFIRM:'Apstiprint'}),e.addLocale('nl',{OK:'OK',CANCEL:'Annuleren',CONFIRM:'Accepteren'}),e.addLocale('no',{OK:'OK',CANCEL:'Avbryt',CONFIRM:'OK'}),e.addLocale('pl',{OK:'OK',CANCEL:'Anuluj',CONFIRM:'Potwierd'}),e.addLocale('pt-BR',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Sim'}),e.addLocale('pt',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Confirmar'}),e.addLocale('ru',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('sk',{OK:'OK',CANCEL:'Zrui',CONFIRM:'Potvrdi'}),e.addLocale('sl',{OK:'OK',CANCEL:'Preklii',CONFIRM:'Potrdi'}),e.addLocale('sq',{OK:'OK',CANCEL:'Anulo',CONFIRM:'Prano'}),e.addLocale('sv',{OK:'OK',CANCEL:'Avbryt',CONFIRM:'OK'}),e.addLocale('sw',{OK:'Sawa',CANCEL:'Ghairi',CONFIRM:'Thibitisha'}),e.addLocale('ta',{OK:'',CANCEL:' ',CONFIRM:' '}),e.addLocale('th',{OK:'',CANCEL:'',CONFIRM:''}),e.addLocale('tr',{OK:'Tamam',CANCEL:'ptal',CONFIRM:'Onayla'}),e.addLocale('uk',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('vi',{OK:'OK',CANCEL:'Hy b',CONFIRM:'Xc nhn'}),e.addLocale('zh-CN',{OK:'OK',CANCEL:'',CONFIRM:''}),e.addLocale('zh-TW',{OK:'OK',CANCEL:'',CONFIRM:''})});
</file>

<file path="payisp/js/bootbox.js">
/*! @preserve
 * bootbox.js
 * version: 6.0.0
 * author: Nick Payne <nick@kurai.co.uk>
 * license: MIT
 * http://bootboxjs.com/
 */
(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // AMD
    define(['jquery'], factory);
  } else if (typeof exports === 'object') {
    // Node, CommonJS-like
    module.exports = factory(require('jquery'));
  } else {
    // Browser globals (root is window)
    root.bootbox = factory(root.jQuery);
  }
}(this, function init($, undefined) {
  'use strict';

  let exports = {};

  let VERSION = '6.0.0';
  exports.VERSION = VERSION;

  let locales = {
    'en' : {
      OK      : 'OK',
      CANCEL  : 'Cancel',
      CONFIRM : 'OK'
    }
  };

  let templates = {
    dialog:         '<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',
    header:         '<div class="modal-header"><h5 class="modal-title"></h5></div>',
    footer:         '<div class="modal-footer"></div>',
    closeButton:    '<button type="button" class="bootbox-close-button close btn-close" aria-hidden="true" aria-label="Close"></button>',
    form:           '<form class="bootbox-form"></form>',
    button:         '<button type="button" class="btn"></button>',
    option:         '<option value=""></option>',
    promptMessage:  '<div class="bootbox-prompt-message"></div>',
    inputs: {
      text:         '<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',
      textarea:     '<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',
      email:        '<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',
      select:       '<select class="bootbox-input bootbox-input-select form-select"></select>',
      checkbox:     '<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',
      radio:        '<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',
      date:         '<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',
      time:         '<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',
      number:       '<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',
      password:     '<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',
      range:        '<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'
    }
  };


  let defaults = {
    // Default language used when generating buttons for alert, confirm, and prompt dialogs
    locale: 'en',
    // Show backdrop or not. Default to static so user has to interact with dialog
    backdrop: 'static',
    // Animate the modal in/out
    animate: true,
    // Additional class string applied to the top level dialog
    className: null,
    // Whether or not to include a close button
    closeButton: true,
    // Show the dialog immediately by default
    show: true,
    // Dialog container
    container: 'body',
    // Default value (used by the prompt helper)
    value: '',
    // Default input type (used by the prompt helper)
    inputType: 'text',
    // Custom error message to report if prompt fails validation
    errorMessage: null,
    // Switch button order from cancel/confirm (default) to confirm/cancel
    swapButtonOrder: false,
    // Center modal vertically in page
    centerVertical: false,
    // Append "multiple" property to the select when using the "prompt" helper
    multiple: false,
    // Automatically scroll modal content when height exceeds viewport height
    scrollable: false,
    // Whether or not to destroy the modal on hide
    reusable: false,
    // The element which triggered the dialog
    relatedTarget: null,
    // The size of the modal to generate
    size: null,
    // A unique indentifier for this modal
    id: null
  };


  // PUBLIC FUNCTIONS
  // *************************************************************************************************************

  /**
   * Return all currently registered locales, or a specific locale if "name" is defined
   * @param {string} [name]
   * @returns {(Object|Object[])} An array of the available locale objects, or a single locale object if {name} is not null
   */
  exports.locales = function (name) {
    return name ? locales[name] : locales;
  };


  /**
   * Register localized strings for the OK, CONFIRM, and CANCEL buttons
   * @param {string} name - The key used to identify the new locale in the locales array
   * @param {Object} values - An object containing the localized string for each of the OK, CANCEL, and CONFIRM properties of a locale
   * @returns The updated bootbox object
   */
  exports.addLocale = function (name, values) {
    $.each(['OK', 'CANCEL', 'CONFIRM'], function (_, v) {
      if (!values[v]) {
        throw new Error('Please supply a translation for "' + v + '"');
      }
    });

    locales[name] = {
      OK: values.OK,
      CANCEL: values.CANCEL,
      CONFIRM: values.CONFIRM
    };

    return exports;
  };

 
  /**
   * Remove a previously-registered locale
   * @param {string} name - The key identifying the locale to remove
   * @returns The updated bootbox object
   */
  exports.removeLocale = function (name) {
    if (name !== 'en') {
      delete locales[name];
    }
    else {
      throw new Error('"en" is used as the default and fallback locale and cannot be removed.');
    }

    return exports;
  };


  /**
   * Set the default locale
   * @param {string} name - The key identifying the locale to set as the default locale for all future bootbox calls 
   * @returns The updated bootbox object
   */
  exports.setLocale = function (name) {
    return exports.setDefaults('locale', name);
  };


  /**
   * Override default value(s) of Bootbox.
   * @returns The updated bootbox object
   */
  exports.setDefaults = function () {
    let values = {};

    if (arguments.length === 2) {
      // Allow passing of single key/value...
      values[arguments[0]] = arguments[1];
    } else {
      // ... and as an object too
      values = arguments[0];
    }

    $.extend(defaults, values);

    return exports;
  };


  /**
   * Hides all currently active Bootbox modals
   * @returns The current bootbox object
   */
  exports.hideAll = function () {
    $('.bootbox').modal('hide');

    return exports;
  };

 
  /**
   * Allows the base init() function to be overridden
   * @param {function} _$ - A function to be called when the bootbox instance is created
   * @returns The current bootbox object
   */
  exports.init = function (_$) {
    return init(_$ || $);
  };


  // CORE HELPER FUNCTIONS
  // *************************************************************************************************************

  /**
   * The core dialog helper function, which can be used to create any custom Bootstrap modal. 
   * @param {Object} options - An object used to configure the various properties which define a Bootbox dialog
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.dialog = function (options) {
    if ($.fn.modal === undefined) {
      throw new Error(
        '"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/5.1/getting-started/introduction/ for more details.'
      );
    }

    options = sanitize(options);

    if ($.fn.modal.Constructor.VERSION) {
      options.fullBootstrapVersion = $.fn.modal.Constructor.VERSION;
      let i = options.fullBootstrapVersion.indexOf('.');
      options.bootstrap = options.fullBootstrapVersion.substring(0, i);
    }
    else {
      // Assuming version 2.3.2, as that was the last "supported" 2.x version
      options.bootstrap = '2';
      options.fullBootstrapVersion = '2.3.2';
      console.warn('Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible.');
    }

    let dialog = $(templates.dialog);
    let innerDialog = dialog.find('.modal-dialog');
    let body = dialog.find('.modal-body');
    let header = $(templates.header);
    let footer = $(templates.footer);
    let buttons = options.buttons;

    let callbacks = {
      onEscape: options.onEscape
    };

    body.find('.bootbox-body').html(options.message);

    // Only attempt to create buttons if at least one has been defined in the options object
    if (getKeyLength(options.buttons) > 0) {
      each(buttons, function (key, b) {
        let button = $(templates.button);
        button.data('bb-handler', key);
        button.addClass(b.className);

        switch (key) {
          case 'ok':
          case 'confirm':
            button.addClass('bootbox-accept');
            break;

          case 'cancel':
            button.addClass('bootbox-cancel');
            break;
        }

        button.html(b.label);

        if (b.id) {
          button.attr({ 'id': b.id });
        }

        if (b.disabled === true) {
          button.prop({ disabled: true });
        }

        footer.append(button);

        callbacks[key] = b.callback;
      });

      body.after(footer);
    }

    if (options.animate === true) {
      dialog.addClass('fade');
    }

    if (options.className) {
      dialog.addClass(options.className);
    }

    if (options.id) {
      dialog.attr({ 'id': options.id });
    }

    if (options.size) {
      // Requires Bootstrap 3.1.0 or higher
      if (options.fullBootstrapVersion.substring(0, 3) < '3.1') {
        console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }

      switch (options.size) {
        case 'small':
        case 'sm':
          innerDialog.addClass('modal-sm');
          break;

        case 'large':
        case 'lg':
          innerDialog.addClass('modal-lg');
          break;

        case 'extra-large':
        case 'xl':
          innerDialog.addClass('modal-xl');

          // Requires Bootstrap 4.2.0 or higher
          if (options.fullBootstrapVersion.substring(0, 3) < '4.2') {
            console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
          }
          break;
      }
    }

    if (options.scrollable) {
      innerDialog.addClass('modal-dialog-scrollable');

      // Requires Bootstrap 4.3.0 or higher
      if (options.fullBootstrapVersion.substring(0, 3) < '4.3') {
        console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }
    }

    if(options.title || options.closeButton) {
      if (options.title) {
        header.find('.modal-title').html(options.title);
      }
      else {
        header.addClass('border-0');
      }

      if (options.closeButton) {
        let closeButton = $(templates.closeButton);      
        if (options.bootstrap < 5) {
          closeButton.html('&times;');
        }

        /* Note: the close button for Bootstrap 5+ does not contain content */
        if(options.bootstrap < 4) {
          /* Bootstrap 3 and under */
          header.prepend(closeButton);
        }
        else {
          header.append(closeButton);
        }
      }

      body.before(header);
    }

    if (options.centerVertical) {
      innerDialog.addClass('modal-dialog-centered');

      // Requires Bootstrap 4.0.0-beta.3 or higher
      if (options.fullBootstrapVersion < '4.0.0') {
        console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using ' + options.fullBootstrapVersion + '. Please upgrade to use this option.');
      }
    }

    // Bootstrap event listeners; these handle extra setup & teardown required after the underlying modal has performed certain actions.

    if(!options.reusable) {
      // make sure we unbind any listeners once the dialog has definitively been dismissed
      dialog.one('hide.bs.modal', { dialog: dialog }, unbindModal);
      dialog.one('hidden.bs.modal', { dialog: dialog }, destroyModal);
    }

    if (options.onHide) {
      if ($.isFunction(options.onHide)) {
        dialog.on('hide.bs.modal', options.onHide);
      }
      else {
        throw new Error('Argument supplied to "onHide" must be a function');
      }
    }

    if (options.onHidden) {
      if ($.isFunction(options.onHidden)) {
        dialog.on('hidden.bs.modal', options.onHidden);
      }
      else {
        throw new Error('Argument supplied to "onHidden" must be a function');
      }
    }

    if (options.onShow) {
      if ($.isFunction(options.onShow)) {
        dialog.on('show.bs.modal', options.onShow);
      }
      else {
        throw new Error('Argument supplied to "onShow" must be a function');
      }
    }

    dialog.one('shown.bs.modal', { dialog: dialog }, focusPrimaryButton);

    if (options.onShown) {
      if ($.isFunction(options.onShown)) {
        dialog.on('shown.bs.modal', options.onShown);
      }
      else {
        throw new Error('Argument supplied to "onShown" must be a function');
      }
    }

    // Bootbox event listeners; used to decouple some behaviours from their respective triggers

    if (options.backdrop === true) {
      let startedOnBody = false;

      // Prevents the event from propagating to the backdrop, when something inside the dialog is clicked
      dialog.on('mousedown', '.modal-content', function(e) {
        e.stopPropagation();

        startedOnBody = true;
      });

      // A boolean true/false according to the Bootstrap docs should show a dialog the user can dismiss by clicking on the background.
      // We always only ever pass static/false to the actual $.modal function because with "true" we can't trap this event (the .modal-backdrop swallows it).
      // However, we still want to sort-of respect true and invoke the escape mechanism instead
      dialog.on('click.dismiss.bs.modal', function (e) {
        if (startedOnBody || e.target !== e.currentTarget) {
          return;
        }

        dialog.trigger('escape.close.bb');
      });
    }

    dialog.on('escape.close.bb', function (e) {
      // The if() statement looks redundant but it isn't; without it, if we *didn't* have an onEscape handler then processCallback would automatically dismiss the dialog
      if (callbacks.onEscape) {
        processCallback(e, dialog, callbacks.onEscape);
      }
    });

    dialog.on('click', '.modal-footer button:not(.disabled)', function (e) {
      let callbackKey = $(this).data('bb-handler');

      if (callbackKey !== undefined) {
        // Only process callbacks for buttons we recognize:
        processCallback(e, dialog, callbacks[callbackKey]);
      }
    });

    dialog.on('click', '.bootbox-close-button', function (e) {
      // onEscape might be falsy, but that's fine; the fact is if the user has managed to click the close button we have to close the dialog, callback or not
      processCallback(e, dialog, callbacks.onEscape);
    });

    dialog.on('keyup', function (e) {
      if (e.which === 27) {
        dialog.trigger('escape.close.bb');
      }
    });

    /*
    The remainder of this method simply deals with adding our dialog element to the DOM, augmenting it with 
    Bootstrap's modal functionality and then giving the resulting object back to our caller
    */

    $(options.container).append(dialog);

    dialog.modal({
      backdrop: options.backdrop,
      keyboard: false,
      show: false
    });

    if (options.show) {
      dialog.modal('show', options.relatedTarget);
    }

    return dialog;
  };


  /**
   * Helper function to simulate the native alert() behavior. **NOTE**: This is non-blocking, so any code that must happen after the alert is dismissed should be placed within the callback function for this alert.
   * @returns  A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.alert = function () {
    let options;

    options = mergeDialogOptions('alert', ['ok'], ['message', 'callback'], arguments);

    // @TODO: can this move inside exports.dialog when we're iterating over each button and checking its button.callback value instead?
    if (options.callback && !$.isFunction(options.callback)) {
      throw new Error('alert requires the "callback" property to be a function when provided');
    }

    // Override the ok and escape callback to make sure they just invoke the single user-supplied one (if provided)
    options.buttons.ok.callback = options.onEscape = function () {
      if ($.isFunction(options.callback)) {
        return options.callback.call(this);
      }

      return true;
    };

    return exports.dialog(options);
  };


  /**
   * Helper function to simulate the native confirm() behavior. **NOTE**: This is non-blocking, so any code that must happen after the confirm is dismissed should be placed within the callback function for this confirm.
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.confirm = function () {
    let options;

    options = mergeDialogOptions('confirm', ['cancel', 'confirm'], ['message', 'callback'], arguments);

    // confirm specific validation; they don't make sense without a callback so make sure it's present
    if (!$.isFunction(options.callback)) {
      throw new Error('confirm requires a callback');
    }

    // Overrides; undo anything the user tried to set they shouldn't have
    options.buttons.cancel.callback = options.onEscape = function () {
      return options.callback.call(this, false);
    };

    options.buttons.confirm.callback = function () {
      return options.callback.call(this, true);
    };

    return exports.dialog(options);
  };


  /**
   * Helper function to simulate the native prompt() behavior. **NOTE**: This is non-blocking, so any code that must happen after the prompt is dismissed should be placed within the callback function for this prompt.
   * @returns A jQuery object upon which Bootstrap's modal function has been called
   */
  exports.prompt = function () {
    let options;
    let promptDialog;
    let form;
    let input;
    let shouldShow;
    let inputOptions;

    // We have to create our form first, otherwise its value is undefined when gearing up our options.
    // @TODO this could be solved by allowing message to be a function instead...
    form = $(templates.form);

    // prompt defaults are more complex than others in that users can override more defaults
    options = mergeDialogOptions('prompt', ['cancel', 'confirm'], ['title', 'callback'], arguments);

    if (!options.value) {
      options.value = defaults.value;
    }

    if (!options.inputType) {
      options.inputType = defaults.inputType;
    }

    // Capture the user's 'show' value; we always set this to false before spawning the dialog to give us a chance to attach some handlers to it, but we need to make sure we respect a preference not to show it
    shouldShow = (options.show === undefined) ? defaults.show : options.show;

    // This is required prior to calling the dialog builder below - we need to add an event handler just before the prompt is shown
    options.show = false;

    // Handles the 'cancel' action
    options.buttons.cancel.callback = options.onEscape = function () {
      return options.callback.call(this, null);
    };

    // Prompt submitted - extract the prompt value. This requires a bit of work, given the different input types available.
    options.buttons.confirm.callback = function () {
      let value;

      if (options.inputType === 'checkbox') {
        value = input.find('input:checked').map(function () {
          return $(this).val();
        }).get();
      } else if (options.inputType === 'radio') {
        value = input.find('input:checked').val();
      }
      else {
        let el = input[0];
        
        // Clear any previous custom error message
        if(options.errorMessage) {
          el.setCustomValidity('');
        }

        if (el.checkValidity && !el.checkValidity()) {
          // If a custom error message was provided, add it now
          if(options.errorMessage){
            el.setCustomValidity(options.errorMessage);
          }
          
          if(el.reportValidity) { 
            el.reportValidity();
          }

          // prevents button callback from being called
          return false;
        } else {
          if (options.inputType === 'select' && options.multiple === true) {
            value = input.find('option:selected').map(function () {
              return $(this).val();
            }).get();
          }
          else {
            value = input.val();
          }
        }
      }

      return options.callback.call(this, value);
    };

    // prompt-specific validation
    if (!options.title) {
      throw new Error('prompt requires a title');
    }

    if (!$.isFunction(options.callback)) {
      throw new Error('prompt requires a callback');
    }

    if (!templates.inputs[options.inputType]) {
      throw new Error('Invalid prompt type');
    }

    // Create the input based on the supplied type
    input = $(templates.inputs[options.inputType]);

    switch (options.inputType) {
      case 'text':
      case 'textarea':
      case 'email':
      case 'password':
        input.val(options.value);

        if (options.placeholder) {
          input.attr('placeholder', options.placeholder);
        }

        if (options.pattern) {
          input.attr('pattern', options.pattern);
        }

        if (options.maxlength) {
          input.attr('maxlength', options.maxlength);
        }

        if (options.required) {
          input.prop({ 'required': true });
        }

        if (options.rows && !isNaN(parseInt(options.rows))) {
          if (options.inputType === 'textarea') {
            input.attr({ 'rows': options.rows });
          }
        }
        break;

      case 'date':
      case 'time':
      case 'number':
      case 'range':
        input.val(options.value);

        if (options.placeholder) {
          input.attr('placeholder', options.placeholder);
        }

        if (options.pattern) {
          input.attr('pattern', options.pattern);
        }
        else {
          if(options.inputType === 'date') {
            // Add the ISO-8601 short date format as a fallback for browsers without native type="date" support
            input.attr('pattern', '\d{4}-\d{2}-\d{2}');
          }
          else if(options.inputType === 'time') {
            // Add an HH:MM pattern as a fallback for browsers without native type="time" support
            input.attr('pattern', '\d{2}:\d{2}');
          }
        }

        if (options.required) {
          input.prop({ 'required': true });
        }

        // These input types have extra attributes which affect their input validation.
        // Warning: For most browsers, date inputs are buggy in their implementation of 'step', so this attribute will have no effect. Therefore, we don't set the attribute for date inputs.
        // @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/date#Setting_maximum_and_minimum_dates
        if (options.inputType !== 'date') {
          if (options.step) {
            if (options.step === 'any' || (!isNaN(options.step) && parseFloat(options.step) > 0)) {
              input.attr('step', options.step);
            }
            else {
              throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');
            }
          }
        }

        if (minAndMaxAreValid(options.inputType, options.min, options.max)) {
          if (options.min !== undefined) {
            input.attr('min', options.min);
          }
          if (options.max !== undefined) {
            input.attr('max', options.max);
          }
        }
        break;

      case 'select':
        let groups = {};
        inputOptions = options.inputOptions || [];

        if (!$.isArray(inputOptions)) {
          throw new Error('Please pass an array of input options');
        }

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "select" requires at least one option');
        }

        if (options.required) {
          input.prop({ 'required': true });
        }

        if (options.multiple) {
          input.prop({ 'multiple': true });
        }

        each(inputOptions, function (_, option) {
          // Assume the element to attach to is the input...
          let elem = input;

          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          // ... but override that element if this option sits in a group

          if (option.group) {
            // Initialise group if necessary
            if (!groups[option.group]) {
              groups[option.group] = $('<optgroup />').attr('label', option.group);
            }

            elem = groups[option.group];
          }

          let o = $(templates.option);
          o.attr('value', option.value).text(option.text);
          elem.append(o);
        });

        each(groups, function (_, group) {
          input.append(group);
        });

        // Safe to set a select's value as per a normal input
        input.val(options.value);
        if (options.bootstrap < 5) {
          input.removeClass('form-select').addClass('form-control');
        }
        break;

      case 'checkbox':
        let checkboxValues = $.isArray(options.value) ? options.value : [options.value];
        inputOptions = options.inputOptions || [];

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');
        }

        // Checkboxes have to nest within a containing element, so they break the rules a bit and we end up re-assigning our 'input' element to this container instead
        input = $('<div class="bootbox-checkbox-list"></div>');

        each(inputOptions, function (_, option) {
          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          let checkbox = $(templates.inputs[options.inputType]);

          checkbox.find('input').attr('value', option.value);
          checkbox.find('label').append('\n' + option.text);

          // We've ensured values is an array, so we can always iterate over it
          each(checkboxValues, function (_, value) {
            if (value === option.value) {
              checkbox.find('input').prop('checked', true);
            }
          });

          input.append(checkbox);
        });
        break;

      case 'radio':
        // Make sure that value is not an array (only a single radio can ever be checked)
        if (options.value !== undefined && $.isArray(options.value)) {
          throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');
        }

        inputOptions = options.inputOptions || [];

        if (!inputOptions.length) {
          throw new Error('prompt with "inputType" set to "radio" requires at least one option');
        }

        // Radiobuttons have to nest within a containing element, so they break the rules a bit and we end up re-assigning our 'input' element to this container instead
        input = $('<div class="bootbox-radiobutton-list"></div>');

        // Radiobuttons should always have an initial checked input checked in a "group".
        // If value is undefined or doesn't match an input option, select the first radiobutton
        let checkFirstRadio = true;

        each(inputOptions, function (_, option) {
          if (option.value === undefined || option.text === undefined) {
            throw new Error('each option needs a "value" property and a "text" property');
          }

          let radio = $(templates.inputs[options.inputType]);

          radio.find('input').attr('value', option.value);
          radio.find('label').append('\n' + option.text);

          if (options.value !== undefined) {
            if (option.value === options.value) {
              radio.find('input').prop('checked', true);
              checkFirstRadio = false;
            }
          }

          input.append(radio);
        });

        if (checkFirstRadio) {
          input.find('input[type="radio"]').first().prop('checked', true);
        }
        break;
    }

    // Now place it in our form
    form.append(input);

    form.on('submit', function (e) {
      e.preventDefault();
      // Fix for SammyJS (or similar JS routing library) hijacking the form post.
      e.stopPropagation();

      // @TODO can we actually click *the* button object instead?
      // e.g. buttons.confirm.click() or similar
      promptDialog.find('.bootbox-accept').trigger('click');
    });

    if ($.trim(options.message) !== '') {
      // Add the form to whatever content the user may have added.
      let message = $(templates.promptMessage).html(options.message);
      form.prepend(message);
      options.message = form;
    }
    else {
      options.message = form;
    }

    // Generate the dialog
    promptDialog = exports.dialog(options);

    // Clear the existing handler focusing the submit button...
    promptDialog.off('shown.bs.modal', focusPrimaryButton);

    // ...and replace it with one focusing our input, if possible
    promptDialog.on('shown.bs.modal', function () {
      // Need the closure here since input isn'tcan object otherwise
      input.focus();
    });

    if (shouldShow === true) {
      promptDialog.modal('show');
    }

    return promptDialog;
  };


  // INTERNAL FUNCTIONS
  // *************************************************************************************************************

  // Map a flexible set of arguments into a single returned object.
  // If args.length is already one just return it, otherwise use the properties argument to map the unnamed args to object properties.
  // So in the latter case:
  //
  //    mapArguments(["foo", $.noop], ["message", "callback"])
  //  
  //  results in
  //
  //    { message: "foo", callback: $.noop }
  //
  function mapArguments(args, properties) {
    let argsLength = args.length;
    let options = {};

    if (argsLength < 1 || argsLength > 2) {
      throw new Error('Invalid argument length');
    }

    if (argsLength === 2 || typeof args[0] === 'string') {
      options[properties[0]] = args[0];
      options[properties[1]] = args[1];
    } else {
      options = args[0];
    }

    return options;
  }


  // Merge a set of default dialog options with user supplied arguments
  function mergeArguments(defaults, args, properties) {
    return $.extend(
      // Deep merge
      true,
      // Ensure the target is an empty, unreferenced object
      {},
      // The base options object for this type of dialog (often just buttons)
      defaults,
      // 'args' could be an object or array; if it's an array properties will map it to a proper options object
      mapArguments(args, properties)
    );
  }


  // This entry-level method makes heavy use of composition to take a simple range of inputs and return valid options suitable for passing to bootbox.dialog
  function mergeDialogOptions(className, labels, properties, args) {
    let locale;
    if (args && args[0]) {
      locale = args[0].locale || defaults.locale;
      let swapButtons = args[0].swapButtonOrder || defaults.swapButtonOrder;

      if (swapButtons) {
        labels = labels.reverse();
      }
    }

    // Build up a base set of dialog properties
    let baseOptions = {
      className: 'bootbox-' + className,
      buttons: createLabels(labels, locale)
    };

    // Ensure the buttons properties generated, *after* merging with user args are still valid against the supplied labels
    return validateButtons(
      // Merge the generated base properties with user supplied arguments
      mergeArguments(
        baseOptions,
        args,
        // If args.length > 1, properties specify how each arg maps to an object key
        properties
      ),
      labels
    );
  }


  // Checks each button object to see if key is valid. 
  // This function will only be called by the alert, confirm, and prompt helpers. 
  function validateButtons(options, buttons) {
    let allowedButtons = {};
    each(buttons, function (key, value) {
      allowedButtons[value] = true;
    });

    each(options.buttons, function (key) {
      if (allowedButtons[key] === undefined) {
        throw new Error('button key "' + key + '" is not allowed (options are ' + buttons.join(' ') + ')');
      }
    });

    return options;
  }


  // From a given list of arguments, return a suitable object of button labels.
  // All this does is normalise the given labels and translate them where possible.
  // e.g. "ok", "confirm" -> { ok: "OK", cancel: "Annuleren" }
  function createLabels(labels, locale) {
    let buttons = {};

    for (let i = 0, j = labels.length; i < j; i++) {
      let argument = labels[i];
      let key = argument.toLowerCase();
      let value = argument.toUpperCase();

      buttons[key] = {
        label: getText(value, locale)
      };
    }

    return buttons;
  }


  // Get localized text from a locale. Defaults to 'en' locale if no locale provided or a non-registered locale is requested
  function getText(key, locale) {
    let labels = locales[locale];

    return labels ? labels[key] : locales.en[key];
  }


  // Filter and tidy up any user supplied parameters to this dialog.
  // Also looks for any shorthands used and ensures that the options which are returned are all normalized properly
  function sanitize(options) {
    let buttons;
    let total;

    if (typeof options !== 'object') {
      throw new Error('Please supply an object of options');
    }

    if (!options.message) {
      throw new Error('"message" option must not be null or an empty string.');
    }

    // Make sure any supplied options take precedence over defaults
    options = $.extend({}, defaults, options);

    // Make sure backdrop is either true, false, or 'static'
    if (!options.backdrop) {
      options.backdrop = (options.backdrop === false || options.backdrop === 0) ? false : 'static';
    } else {
      options.backdrop = typeof options.backdrop === 'string' && options.backdrop.toLowerCase() === 'static' ? 'static' : true;
    } 

    // No buttons is still a valid dialog but it's cleaner to always have a buttons object to iterate over, even if it's empty
    if (!options.buttons) {
      options.buttons = {};
    }
    
    buttons = options.buttons;

    total = getKeyLength(buttons);

    each(buttons, function (key, button, index) {
      if ($.isFunction(button)) {
        // Short form, assume value is our callback. Since button isn't an object it isn't a reference either so re-assign it
        button = buttons[key] = {
          callback: button
        };
      }

      // Before any further checks, make sure button is the correct type
      if ($.type(button) !== 'object') {
        throw new Error('button with key "' + key + '" must be an object');
      }

      if (!button.label) {
        // The lack of an explicit label means we'll assume the key is good enough
        button.label = key;
      }

      if (!button.className) {
        let isPrimary = false;
        if (options.swapButtonOrder) {
          isPrimary = index === 0;
        }
        else {
          isPrimary = index === total - 1;
        }

        if (total <= 2 && isPrimary) {
          // always add a primary to the main option in a one or two-button dialog
          button.className = 'btn-primary';
        } 
        else {
          // adding both classes allows us to target both BS3 and BS4+ without needing to check the version
          button.className = 'btn-secondary btn-default';
        }
      }
    });

    return options;
  }


  // Returns a count of the properties defined on the object
  function getKeyLength(obj) {
    return Object.keys(obj).length;
  }


  // Tiny wrapper function around jQuery.each; just adds index as the third parameter
  function each(collection, iterator) {
    let index = 0;
    $.each(collection, function (key, value) {
      iterator(key, value, index++);
    });
  }


  function focusPrimaryButton(e) {
    e.data.dialog.find('.bootbox-accept').first().trigger('focus');
  }


  function destroyModal(e) {
    // Ensure we don't accidentally intercept hidden events triggered by children of the current dialog. 
    // We shouldn't need to handle this anymore, now that Bootstrap namespaces its events, but still worth doing.
    if (e.target === e.data.dialog[0]) {
      e.data.dialog.remove();
    }
  }


  function unbindModal(e) {
    if (e.target === e.data.dialog[0]) {
      e.data.dialog.off('escape.close.bb');
      e.data.dialog.off('click');
    }
  }


  //  Handle the invoked dialog callback
  function processCallback(e, dialog, callback) {
    e.stopPropagation();
    e.preventDefault();

    // By default we assume a callback will get rid of the dialog, although it is given the opportunity to override this

    // If the callback can be invoked and it *explicitly returns false*, then we'll set a flag to keep the dialog active...
    let preserveDialog = $.isFunction(callback) && callback.call(dialog, e) === false;

    // ... otherwise we'll bin it
    if (!preserveDialog) {
      dialog.modal('hide');
    }
  }

  // Validate `min` and `max` values based on the current `inputType` value
  function minAndMaxAreValid(type, min, max) {
    let result = false;
    let minValid = true;
    let maxValid = true;

    if (type === 'date') {
      if (min !== undefined && !(minValid = dateIsValid(min))) {
        console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');
      }
      else if (max !== undefined && !(maxValid = dateIsValid(max))) {
        console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.');
      }
    }
    else if (type === 'time') {
      if (min !== undefined && !(minValid = timeIsValid(min))) {
        throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');
      }
      else if (max !== undefined && !(maxValid = timeIsValid(max))) {
        throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');
      }
    }
    else {
      if (min !== undefined && isNaN(min)) {
        minValid = false;
        throw new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');
      }

      if (max !== undefined && isNaN(max)) {
        maxValid = false;
        throw new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');
      }
    }

    if (minValid && maxValid) {
      if (max <= min) {
        throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');
      }
      else {
        result = true;
      }
    }

    return result;
  }

  function timeIsValid(value) {
    return /([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(value);
  }

  function dateIsValid(value) {
    return /(\d{4})-(\d{2})-(\d{2})/.test(value);
  }

  //  The Bootbox object
  return exports;
}));
</file>

<file path="payisp/js/bootbox.locales.js">
/*! @preserve
 * bootbox.locales.js
 * version: 6.0.0
 * author: Nick Payne <nick@kurai.co.uk>
 * license: MIT
 * http://bootboxjs.com/
 */
(function(global, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    define(['bootbox'], factory);
  } else if (typeof module === 'object' && module.exports) {
    factory(require('./bootbox'));
  } else {
    factory(global.bootbox);
  }
}(this, function(bootbox) {
  'use strict';

  // locale : Arabic
  // author : Emad Omar
  bootbox.addLocale('ar', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Azerbaijani
  // author : Valentin Belousov
  bootbox.addLocale('az', {
    OK: 'OK',
    CANCEL: 'mtina et',
    CONFIRM: 'Tsdiq et'
  });
  // locale : Bulgarian
  // author :  mraiur
  bootbox.addLocale('bg-BG', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Czech
  // author : Luk Fry
  bootbox.addLocale('cs', {
    OK: 'OK',
    CANCEL: 'Zruit',
    CONFIRM: 'Potvrdit'
  });
  // locale : Danish
  // author : Frederik Alkrsig
  bootbox.addLocale('da', {
    OK: 'OK',
    CANCEL: 'Annuller',
    CONFIRM: 'Accepter'
  });
  // locale : German
  // author : Nick Payne
  bootbox.addLocale('de', {
    OK: 'OK',
    CANCEL: 'Abbrechen',
    CONFIRM: 'Akzeptieren'
  });
  // locale : Greek
  // author : Tolis Emmanouilidis
  bootbox.addLocale('el', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : English
  // author : Nick Payne
  bootbox.addLocale('en', {
    OK: 'OK',
    CANCEL: 'Cancel',
    CONFIRM: 'OK'
  });
  // locale : Spanish
  // author : Ian Leckey
  bootbox.addLocale('es', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Aceptar'
  });
  // locale : Estonian
  // author : Pavel Krlov
  bootbox.addLocale('et', {
    OK: 'OK',
    CANCEL: 'Katkesta',
    CONFIRM: 'OK'
  });
  // locale : Basque
  // author : Iker Ibarguren
  bootbox.addLocale('eu', {
    OK: 'OK',
    CANCEL: 'Ezeztatu',
    CONFIRM: 'Onartu'
  });
  // locale : Persian
  // author : Touhid Arastu
  bootbox.addLocale('fa', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Finnish
  // author : Nick Payne
  bootbox.addLocale('fi', {
    OK: 'OK',
    CANCEL: 'Peruuta',
    CONFIRM: 'OK'
  });
  // locale : French
  // author : Nick Payne, Sebastien Andary
  bootbox.addLocale('fr', {
    OK: 'OK',
    CANCEL: 'Annuler',
    CONFIRM: 'Confirmer'
  });
  // locale : Hebrew
  // author : Chen Alon
  bootbox.addLocale('he', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Croatian
  // author : Mario Bai
  bootbox.addLocale('hr', {
    OK: 'OK',
    CANCEL: 'Odustani',
    CONFIRM: 'Potvrdi'
  });
  // locale : Hungarian
  // author : Mrk Sgi-Kazr
  bootbox.addLocale('hu', {
    OK: 'OK',
    CANCEL: 'Mgsem',
    CONFIRM: 'Megerst'
  });
  // locale : Indonesian
  // author : Budi Irawan
  bootbox.addLocale('id', {
    OK: 'OK',
    CANCEL: 'Batal',
    CONFIRM: 'OK'
  });
  // locale : Italian
  // author : Mauro
  bootbox.addLocale('it', {
    OK: 'OK',
    CANCEL: 'Annulla',
    CONFIRM: 'Conferma'
  });
  // locale : Japanese
  // author : ms183
  bootbox.addLocale('ja', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Georgian
  // author : Avtandil Kikabidze aka LONGMAN (@akalongman)
  bootbox.addLocale('ka', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Korean
  // author : rigning
  bootbox.addLocale('ko', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Lithuanian
  // author : Tomas
  bootbox.addLocale('lt', {
    OK: 'Gerai',
    CANCEL: 'Ataukti',
    CONFIRM: 'Patvirtinti'
  });
  // locale : Latvian
  // author : Dmitry Bogatykh, Lauris BH
  bootbox.addLocale('lv', {
    OK: 'Labi',
    CANCEL: 'Atcelt',
    CONFIRM: 'Apstiprint'
  });
  // locale : Dutch
  // author : Bas ter Vrugt
  bootbox.addLocale('nl', {
    OK: 'OK',
    CANCEL: 'Annuleren',
    CONFIRM: 'Accepteren'
  });
  // locale : Norwegian
  // author : Nils Magnus Englund
  bootbox.addLocale('no', {
    OK: 'OK',
    CANCEL: 'Avbryt',
    CONFIRM: 'OK'
  });
  // locale : Polish
  // author : Szczepan Cielik
  bootbox.addLocale('pl', {
    OK: 'OK',
    CANCEL: 'Anuluj',
    CONFIRM: 'Potwierd'
  });
  // locale : Portuguese (Brasil)
  // author : Nick Payne
  bootbox.addLocale('pt-BR', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Sim'
  });
  // locale : Portuguese
  // author : Cludio Medina
  bootbox.addLocale('pt', {
    OK: 'OK',
    CANCEL: 'Cancelar',
    CONFIRM: 'Confirmar'
  });
  // locale : Russian
  // author : ionian-wind
  bootbox.addLocale('ru', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Slovak
  // author : Stano Paka
  bootbox.addLocale('sk', {
    OK: 'OK',
    CANCEL: 'Zrui',
    CONFIRM: 'Potvrdi'
  });
  // locale : Slovenian
  // author : @metalcamp
  bootbox.addLocale('sl', {
    OK: 'OK',
    CANCEL: 'Preklii',
    CONFIRM: 'Potrdi'
  });
  // locale : Albanian
  // author : Knut Hhne
  bootbox.addLocale('sq', {
    OK: 'OK',
    CANCEL: 'Anulo',
    CONFIRM: 'Prano'
  });
  // locale : Swedish
  // author : Mattias Reichel
  bootbox.addLocale('sv', {
    OK: 'OK',
    CANCEL: 'Avbryt',
    CONFIRM: 'OK'
  });
  // locale : Swahili
  // author : Timothy Anyona
  bootbox.addLocale('sw', {
    OK: 'Sawa',
    CANCEL: 'Ghairi',
    CONFIRM: 'Thibitisha'
  });
  // locale : Tamil
  // author : Kolappan Nathan
  bootbox.addLocale('ta', {
    OK: '',
    CANCEL: ' ',
    CONFIRM: ' '
  });
  // locale : Thai
  // author : Ishmael
  bootbox.addLocale('th', {
    OK: '',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Turkish
  // author : Enes Karaca
  bootbox.addLocale('tr', {
    OK: 'Tamam',
    CANCEL: 'ptal',
    CONFIRM: 'Onayla'
  });
  // locale : Ukrainian
  // author : OlehBoiko
  bootbox.addLocale('uk', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Vietnamese
  // author :  Anh Tu Nguyen
  bootbox.addLocale('vi', {
    OK: 'OK',
    CANCEL: 'Hy b',
    CONFIRM: 'Xc nhn'
  });
  // locale : Chinese (China / People's Republic of China)
  // author : Nick Payne
  bootbox.addLocale('zh-CN', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });
  // locale : Chinese (Taiwan / Republic of China)
  // author : Nick Payne
  bootbox.addLocale('zh-TW', {
    OK: 'OK',
    CANCEL: '',
    CONFIRM: ''
  });

}));
</file>

<file path="payisp/js/bootbox.locales.min.js">
/**
 * Bootbox.js  alert, confirm, prompt, and flexible dialogs for the Bootstrap framework 
 * @version: 6.0.0
 * @project: https://github.com/makeusabrew/bootbox
 * @license: MIT http://bootboxjs.com/license.txt
 */
!function(C,a){'use strict';'function'==typeof define&&define.amd?define(['bootbox'],a):'object'==typeof module&&module.exports?a(require('./bootbox')):a(C.bootbox)}(this,function(C){'use strict';C.addLocale('ar',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('az',{OK:'OK',CANCEL:'mtina et',CONFIRM:'Tsdiq et'}),C.addLocale('bg-BG',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('cs',{OK:'OK',CANCEL:'Zruit',CONFIRM:'Potvrdit'}),C.addLocale('da',{OK:'OK',CANCEL:'Annuller',CONFIRM:'Accepter'}),C.addLocale('de',{OK:'OK',CANCEL:'Abbrechen',CONFIRM:'Akzeptieren'}),C.addLocale('el',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('en',{OK:'OK',CANCEL:'Cancel',CONFIRM:'OK'}),C.addLocale('es',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Aceptar'}),C.addLocale('et',{OK:'OK',CANCEL:'Katkesta',CONFIRM:'OK'}),C.addLocale('eu',{OK:'OK',CANCEL:'Ezeztatu',CONFIRM:'Onartu'}),C.addLocale('fa',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('fi',{OK:'OK',CANCEL:'Peruuta',CONFIRM:'OK'}),C.addLocale('fr',{OK:'OK',CANCEL:'Annuler',CONFIRM:'Confirmer'}),C.addLocale('he',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('hr',{OK:'OK',CANCEL:'Odustani',CONFIRM:'Potvrdi'}),C.addLocale('hu',{OK:'OK',CANCEL:'Mgsem',CONFIRM:'Megerst'}),C.addLocale('id',{OK:'OK',CANCEL:'Batal',CONFIRM:'OK'}),C.addLocale('it',{OK:'OK',CANCEL:'Annulla',CONFIRM:'Conferma'}),C.addLocale('ja',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('ka',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('ko',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('lt',{OK:'Gerai',CANCEL:'Ataukti',CONFIRM:'Patvirtinti'}),C.addLocale('lv',{OK:'Labi',CANCEL:'Atcelt',CONFIRM:'Apstiprint'}),C.addLocale('nl',{OK:'OK',CANCEL:'Annuleren',CONFIRM:'Accepteren'}),C.addLocale('no',{OK:'OK',CANCEL:'Avbryt',CONFIRM:'OK'}),C.addLocale('pl',{OK:'OK',CANCEL:'Anuluj',CONFIRM:'Potwierd'}),C.addLocale('pt-BR',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Sim'}),C.addLocale('pt',{OK:'OK',CANCEL:'Cancelar',CONFIRM:'Confirmar'}),C.addLocale('ru',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('sk',{OK:'OK',CANCEL:'Zrui',CONFIRM:'Potvrdi'}),C.addLocale('sl',{OK:'OK',CANCEL:'Preklii',CONFIRM:'Potrdi'}),C.addLocale('sq',{OK:'OK',CANCEL:'Anulo',CONFIRM:'Prano'}),C.addLocale('sv',{OK:'OK',CANCEL:'Avbryt',CONFIRM:'OK'}),C.addLocale('sw',{OK:'Sawa',CANCEL:'Ghairi',CONFIRM:'Thibitisha'}),C.addLocale('ta',{OK:'',CANCEL:' ',CONFIRM:' '}),C.addLocale('th',{OK:'',CANCEL:'',CONFIRM:''}),C.addLocale('tr',{OK:'Tamam',CANCEL:'ptal',CONFIRM:'Onayla'}),C.addLocale('uk',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('vi',{OK:'OK',CANCEL:'Hy b',CONFIRM:'Xc nhn'}),C.addLocale('zh-CN',{OK:'OK',CANCEL:'',CONFIRM:''}),C.addLocale('zh-TW',{OK:'OK',CANCEL:'',CONFIRM:''})});
</file>

<file path="payisp/js/bootbox.min.js">
/**
 * Bootbox.js  alert, confirm, prompt, and flexible dialogs for the Bootstrap framework 
 * @version: 6.0.0
 * @project: https://github.com/makeusabrew/bootbox
 * @license: MIT http://bootboxjs.com/license.txt
 */
!function(t,e){'use strict';'function'==typeof define&&define.amd?define(['jquery'],e):'object'==typeof exports?module.exports=e(require('jquery')):t.bootbox=e(t.jQuery)}(this,function e(s,c){'use strict';let r={};r.VERSION='6.0.0';let l={en:{OK:'OK',CANCEL:'Cancel',CONFIRM:'OK'}},u={dialog:'<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',header:'<div class="modal-header"><h5 class="modal-title"></h5></div>',footer:'<div class="modal-footer"></div>',closeButton:'<button type="button" class="bootbox-close-button close btn-close" aria-hidden="true" aria-label="Close"></button>',form:'<form class="bootbox-form"></form>',button:'<button type="button" class="btn"></button>',option:'<option value=""></option>',promptMessage:'<div class="bootbox-prompt-message"></div>',inputs:{text:'<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',textarea:'<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',email:'<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',select:'<select class="bootbox-input bootbox-input-select form-select"></select>',checkbox:'<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',radio:'<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',date:'<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',time:'<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',number:'<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',password:'<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',range:'<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'}},p={locale:'en',backdrop:'static',animate:!0,className:null,closeButton:!0,show:!0,container:'body',value:'',inputType:'text',errorMessage:null,swapButtonOrder:!1,centerVertical:!1,multiple:!1,scrollable:!1,reusable:!1,relatedTarget:null,size:null,id:null};function i(t,e,o){return s.extend(!0,{},t,function(t,e){var o=t.length;let a={};if(o<1||2<o)throw new Error('Invalid argument length');return 2===o||'string'==typeof t[0]?(a[e[0]]=t[0],a[e[1]]=t[1]):a=t[0],a}(e,o))}function d(t,e,a,r){let o;r&&r[0]&&(o=r[0].locale||p.locale,(r[0].swapButtonOrder||p.swapButtonOrder)&&(e=e.reverse()));t={className:'bootbox-'+t,buttons:function(o,a){let r={};for(let e=0,t=o.length;e<t;e++){let t=o[e];var n=t.toLowerCase(),i=t.toUpperCase();r[n]={label:function(t,e){e=l[e];return(e||l.en)[t]}(i,a)}}return r}(e,o)};{t=i(t,r,a);var n=e;let o={};return f(n,function(t,e){o[e]=!0}),f(t.buttons,function(t){if(o[t]===c)throw new Error('button key "'+t+'" is not allowed (options are '+n.join(' ')+')')}),t}}function b(t){return Object.keys(t).length}function f(t,o){let a=0;s.each(t,function(t,e){o(t,e,a++)})}function m(t){t.data.dialog.find('.bootbox-accept').first().trigger('focus')}function h(t){t.target===t.data.dialog[0]&&t.data.dialog.remove()}function w(t){t.target===t.data.dialog[0]&&(t.data.dialog.off('escape.close.bb'),t.data.dialog.off('click'))}function g(t,e,o){t.stopPropagation(),t.preventDefault(),s.isFunction(o)&&!1===o.call(e,t)||e.modal('hide')}function x(t){return/([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(t)}function v(t){return/(\d{4})-(\d{2})-(\d{2})/.test(t)}return r.locales=function(t){return t?l[t]:l},r.addLocale=function(t,o){return s.each(['OK','CANCEL','CONFIRM'],function(t,e){if(!o[e])throw new Error('Please supply a translation for "'+e+'"')}),l[t]={OK:o.OK,CANCEL:o.CANCEL,CONFIRM:o.CONFIRM},r},r.removeLocale=function(t){if('en'===t)throw new Error('"en" is used as the default and fallback locale and cannot be removed.');return delete l[t],r},r.setLocale=function(t){return r.setDefaults('locale',t)},r.setDefaults=function(){let t={};return 2===arguments.length?t[arguments[0]]=arguments[1]:t=arguments[0],s.extend(p,t),r},r.hideAll=function(){return s('.bootbox').modal('hide'),r},r.init=function(t){return e(t||s)},r.dialog=function(e){if(s.fn.modal===c)throw new Error('"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/5.1/getting-started/introduction/ for more details.');e=function(a){let r,n;if('object'!=typeof a)throw new Error('Please supply an object of options');if(!a.message)throw new Error('"message" option must not be null or an empty string.');(a=s.extend({},p,a)).backdrop?a.backdrop='string'!=typeof a.backdrop||'static'!==a.backdrop.toLowerCase()||'static':a.backdrop=!1!==a.backdrop&&0!==a.backdrop&&'static';a.buttons||(a.buttons={});return r=a.buttons,n=b(r),f(r,function(t,e,o){if(s.isFunction(e)&&(e=r[t]={callback:e}),'object'!==s.type(e))throw new Error('button with key "'+t+'" must be an object');if(e.label||(e.label=t),!e.className){let t=!1;t=a.swapButtonOrder?0===o:o===n-1,n<=2&&t?e.className='btn-primary':e.className='btn-secondary btn-default'}}),a}(e),s.fn.modal.Constructor.VERSION?(e.fullBootstrapVersion=s.fn.modal.Constructor.VERSION,i=e.fullBootstrapVersion.indexOf('.'),e.bootstrap=e.fullBootstrapVersion.substring(0,i)):(e.bootstrap='2',e.fullBootstrapVersion='2.3.2',console.warn('Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible.'));let o=s(u.dialog),t=o.find('.modal-dialog'),a=o.find('.modal-body'),r=s(u.header),n=s(u.footer);var i=e.buttons;let l={onEscape:e.onEscape};if(a.find('.bootbox-body').html(e.message),0<b(e.buttons)&&(f(i,function(t,e){let o=s(u.button);switch(o.data('bb-handler',t),o.addClass(e.className),t){case'ok':case'confirm':o.addClass('bootbox-accept');break;case'cancel':o.addClass('bootbox-cancel')}o.html(e.label),e.id&&o.attr({id:e.id}),!0===e.disabled&&o.prop({disabled:!0}),n.append(o),l[t]=e.callback}),a.after(n)),!0===e.animate&&o.addClass('fade'),e.className&&o.addClass(e.className),e.id&&o.attr({id:e.id}),e.size)switch(e.fullBootstrapVersion.substring(0,3)<'3.1'&&console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using '+e.fullBootstrapVersion+'. Please upgrade to use this option.'),e.size){case'small':case'sm':t.addClass('modal-sm');break;case'large':case'lg':t.addClass('modal-lg');break;case'extra-large':case'xl':t.addClass('modal-xl'),e.fullBootstrapVersion.substring(0,3)<'4.2'&&console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using '+e.fullBootstrapVersion+'. Please upgrade to use this option.')}if(e.scrollable&&(t.addClass('modal-dialog-scrollable'),e.fullBootstrapVersion.substring(0,3)<'4.3'&&console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using '+e.fullBootstrapVersion+'. Please upgrade to use this option.')),e.title||e.closeButton){if(e.title?r.find('.modal-title').html(e.title):r.addClass('border-0'),e.closeButton){let t=s(u.closeButton);e.bootstrap<5&&t.html('&times;'),e.bootstrap<4?r.prepend(t):r.append(t)}a.before(r)}if(e.centerVertical&&(t.addClass('modal-dialog-centered'),e.fullBootstrapVersion<'4.0.0'&&console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using '+e.fullBootstrapVersion+'. Please upgrade to use this option.')),e.reusable||(o.one('hide.bs.modal',{dialog:o},w),o.one('hidden.bs.modal',{dialog:o},h)),e.onHide){if(!s.isFunction(e.onHide))throw new Error('Argument supplied to "onHide" must be a function');o.on('hide.bs.modal',e.onHide)}if(e.onHidden){if(!s.isFunction(e.onHidden))throw new Error('Argument supplied to "onHidden" must be a function');o.on('hidden.bs.modal',e.onHidden)}if(e.onShow){if(!s.isFunction(e.onShow))throw new Error('Argument supplied to "onShow" must be a function');o.on('show.bs.modal',e.onShow)}if(o.one('shown.bs.modal',{dialog:o},m),e.onShown){if(!s.isFunction(e.onShown))throw new Error('Argument supplied to "onShown" must be a function');o.on('shown.bs.modal',e.onShown)}if(!0===e.backdrop){let e=!1;o.on('mousedown','.modal-content',function(t){t.stopPropagation(),e=!0}),o.on('click.dismiss.bs.modal',function(t){e||t.target!==t.currentTarget||o.trigger('escape.close.bb')})}return o.on('escape.close.bb',function(t){l.onEscape&&g(t,o,l.onEscape)}),o.on('click','.modal-footer button:not(.disabled)',function(t){var e=s(this).data('bb-handler');e!==c&&g(t,o,l[e])}),o.on('click','.bootbox-close-button',function(t){g(t,o,l.onEscape)}),o.on('keyup',function(t){27===t.which&&o.trigger('escape.close.bb')}),s(e.container).append(o),o.modal({backdrop:e.backdrop,keyboard:!1,show:!1}),e.show&&o.modal('show',e.relatedTarget),o},r.alert=function(){let t;if((t=d('alert',['ok'],['message','callback'],arguments)).callback&&!s.isFunction(t.callback))throw new Error('alert requires the "callback" property to be a function when provided');return t.buttons.ok.callback=t.onEscape=function(){return!s.isFunction(t.callback)||t.callback.call(this)},r.dialog(t)},r.confirm=function(){let t;if(t=d('confirm',['cancel','confirm'],['message','callback'],arguments),s.isFunction(t.callback))return t.buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,!1)},t.buttons.confirm.callback=function(){return t.callback.call(this,!0)},r.dialog(t);throw new Error('confirm requires a callback')},r.prompt=function(){let n,e,t,i;var o,a;let l;if(t=s(u.form),(n=d('prompt',['cancel','confirm'],['title','callback'],arguments)).value||(n.value=p.value),n.inputType||(n.inputType=p.inputType),o=(n.show===c?p:n).show,n.show=!1,n.buttons.cancel.callback=n.onEscape=function(){return n.callback.call(this,null)},n.buttons.confirm.callback=function(){let e;if('checkbox'===n.inputType)e=i.find('input:checked').map(function(){return s(this).val()}).get();else if('radio'===n.inputType)e=i.find('input:checked').val();else{let t=i[0];if(n.errorMessage&&t.setCustomValidity(''),t.checkValidity&&!t.checkValidity())return n.errorMessage&&t.setCustomValidity(n.errorMessage),t.reportValidity&&t.reportValidity(),!1;e='select'===n.inputType&&!0===n.multiple?i.find('option:selected').map(function(){return s(this).val()}).get():i.val()}return n.callback.call(this,e)},!n.title)throw new Error('prompt requires a title');if(!s.isFunction(n.callback))throw new Error('prompt requires a callback');if(!u.inputs[n.inputType])throw new Error('Invalid prompt type');switch(i=s(u.inputs[n.inputType]),n.inputType){case'text':case'textarea':case'email':case'password':i.val(n.value),n.placeholder&&i.attr('placeholder',n.placeholder),n.pattern&&i.attr('pattern',n.pattern),n.maxlength&&i.attr('maxlength',n.maxlength),n.required&&i.prop({required:!0}),n.rows&&!isNaN(parseInt(n.rows))&&'textarea'===n.inputType&&i.attr({rows:n.rows});break;case'date':case'time':case'number':case'range':if(i.val(n.value),n.placeholder&&i.attr('placeholder',n.placeholder),n.pattern?i.attr('pattern',n.pattern):'date'===n.inputType?i.attr('pattern','d{4}-d{2}-d{2}'):'time'===n.inputType&&i.attr('pattern','d{2}:d{2}'),n.required&&i.prop({required:!0}),'date'!==n.inputType&&n.step){if(!('any'===n.step||!isNaN(n.step)&&0<parseFloat(n.step)))throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');i.attr('step',n.step)}!function(t,e,o){let a=!1,r=!0,n=!0;if('date'===t)e===c||(r=v(e))?o===c||(n=v(o))||console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.'):console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');else if('time'===t){if(e!==c&&!(r=x(e)))throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');if(o!==c&&!(n=x(o)))throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.')}else{if(e!==c&&isNaN(e))throw r=!1,new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');if(o!==c&&isNaN(o))throw n=!1,new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.')}if(r&&n){if(o<=e)throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');a=!0}return a}(n.inputType,n.min,n.max)||(n.min!==c&&i.attr('min',n.min),n.max!==c&&i.attr('max',n.max));break;case'select':let r={};if(l=n.inputOptions||[],!s.isArray(l))throw new Error('Please pass an array of input options');if(!l.length)throw new Error('prompt with "inputType" set to "select" requires at least one option');n.required&&i.prop({required:!0}),n.multiple&&i.prop({multiple:!0}),f(l,function(t,e){let o=i;if(e.value===c||e.text===c)throw new Error('each option needs a "value" property and a "text" property');e.group&&(r[e.group]||(r[e.group]=s('<optgroup />').attr('label',e.group)),o=r[e.group]);let a=s(u.option);a.attr('value',e.value).text(e.text),o.append(a)}),f(r,function(t,e){i.append(e)}),i.val(n.value),n.bootstrap<5&&i.removeClass('form-select').addClass('form-control');break;case'checkbox':let e=s.isArray(n.value)?n.value:[n.value];if(!(l=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');i=s('<div class="bootbox-checkbox-list"></div>'),f(l,function(t,o){if(o.value===c||o.text===c)throw new Error('each option needs a "value" property and a "text" property');let a=s(u.inputs[n.inputType]);a.find('input').attr('value',o.value),a.find('label').append('\n'+o.text),f(e,function(t,e){e===o.value&&a.find('input').prop('checked',!0)}),i.append(a)});break;case'radio':if(n.value!==c&&s.isArray(n.value))throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');if(!(l=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "radio" requires at least one option');i=s('<div class="bootbox-radiobutton-list"></div>');let a=!0;f(l,function(t,e){if(e.value===c||e.text===c)throw new Error('each option needs a "value" property and a "text" property');let o=s(u.inputs[n.inputType]);o.find('input').attr('value',e.value),o.find('label').append('\n'+e.text),n.value!==c&&e.value===n.value&&(o.find('input').prop('checked',!0),a=!1),i.append(o)}),a&&i.find('input[type="radio"]').first().prop('checked',!0)}return t.append(i),t.on('submit',function(t){t.preventDefault(),t.stopPropagation(),e.find('.bootbox-accept').trigger('click')}),''!==s.trim(n.message)&&(a=s(u.promptMessage).html(n.message),t.prepend(a)),n.message=t,(e=r.dialog(n)).off('shown.bs.modal',m),e.on('shown.bs.modal',function(){i.focus()}),!0===o&&e.modal('show'),e},r});
</file>

<file path="payisp/js/bootstrap.bundle.min.js">
/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e()}(this,(function(){"use strict";const t="transitionend",e=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return e},i=t=>{const i=e(t);return i&&document.querySelector(i)?i:null},n=t=>{const i=e(t);return i?document.querySelector(i):null},s=e=>{e.dispatchEvent(new Event(t))},o=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),r=t=>o(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(t):null,a=t=>{if(!o(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const e=t.closest("summary");if(e&&e.parentNode!==i)return!1;if(null===e)return!1}return e},l=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),c=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?c(t.parentNode):null},h=()=>{},d=t=>{t.offsetHeight},u=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,f=[],p=()=>"rtl"===document.documentElement.dir,g=t=>{var e;e=()=>{const e=u();if(e){const i=t.NAME,n=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=n,t.jQueryInterface)}},"loading"===document.readyState?(f.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of f)t()})),f.push(e)):e()},m=t=>{"function"==typeof t&&t()},_=(e,i,n=!0)=>{if(!n)return void m(e);const o=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),s=Number.parseFloat(i);return n||s?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(i)+5;let r=!1;const a=({target:n})=>{n===i&&(r=!0,i.removeEventListener(t,a),m(e))};i.addEventListener(t,a),setTimeout((()=>{r||s(i)}),o)},b=(t,e,i,n)=>{const s=t.length;let o=t.indexOf(e);return-1===o?!i&&n?t[s-1]:t[0]:(o+=i?1:-1,n&&(o=(o+s)%s),t[Math.max(0,Math.min(o,s-1))])},v=/[^.]*(?=\..*)\.|.*/,y=/\..*/,w=/::\d+$/,A={};let E=1;const T={mouseenter:"mouseover",mouseleave:"mouseout"},C=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function O(t,e){return e&&`${e}::${E++}`||t.uidEvent||E++}function x(t){const e=O(t);return t.uidEvent=e,A[e]=A[e]||{},A[e]}function k(t,e,i=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===i))}function L(t,e,i){const n="string"==typeof e,s=n?i:e||i;let o=N(t);return C.has(o)||(o=t),[n,s,o]}function D(t,e,i,n,s){if("string"!=typeof e||!t)return;let[o,r,a]=L(e,i,n);if(e in T){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};r=t(r)}const l=x(t),c=l[a]||(l[a]={}),h=k(c,r,o?i:null);if(h)return void(h.oneOff=h.oneOff&&s);const d=O(r,e.replace(v,"")),u=o?function(t,e,i){return function n(s){const o=t.querySelectorAll(e);for(let{target:r}=s;r&&r!==this;r=r.parentNode)for(const a of o)if(a===r)return j(s,{delegateTarget:r}),n.oneOff&&P.off(t,s.type,e,i),i.apply(r,[s])}}(t,i,r):function(t,e){return function i(n){return j(n,{delegateTarget:t}),i.oneOff&&P.off(t,n.type,e),e.apply(t,[n])}}(t,r);u.delegationSelector=o?i:null,u.callable=r,u.oneOff=s,u.uidEvent=d,c[d]=u,t.addEventListener(a,u,o)}function S(t,e,i,n,s){const o=k(e[i],n,s);o&&(t.removeEventListener(i,o,Boolean(s)),delete e[i][o.uidEvent])}function I(t,e,i,n){const s=e[i]||{};for(const o of Object.keys(s))if(o.includes(n)){const n=s[o];S(t,e,i,n.callable,n.delegationSelector)}}function N(t){return t=t.replace(y,""),T[t]||t}const P={on(t,e,i,n){D(t,e,i,n,!1)},one(t,e,i,n){D(t,e,i,n,!0)},off(t,e,i,n){if("string"!=typeof e||!t)return;const[s,o,r]=L(e,i,n),a=r!==e,l=x(t),c=l[r]||{},h=e.startsWith(".");if(void 0===o){if(h)for(const i of Object.keys(l))I(t,l,i,e.slice(1));for(const i of Object.keys(c)){const n=i.replace(w,"");if(!a||e.includes(n)){const e=c[i];S(t,l,r,e.callable,e.delegationSelector)}}}else{if(!Object.keys(c).length)return;S(t,l,r,o,s?i:null)}},trigger(t,e,i){if("string"!=typeof e||!t)return null;const n=u();let s=null,o=!0,r=!0,a=!1;e!==N(e)&&n&&(s=n.Event(e,i),n(t).trigger(s),o=!s.isPropagationStopped(),r=!s.isImmediatePropagationStopped(),a=s.isDefaultPrevented());let l=new Event(e,{bubbles:o,cancelable:!0});return l=j(l,i),a&&l.preventDefault(),r&&t.dispatchEvent(l),l.defaultPrevented&&s&&s.preventDefault(),l}};function j(t,e){for(const[i,n]of Object.entries(e||{}))try{t[i]=n}catch(e){Object.defineProperty(t,i,{configurable:!0,get:()=>n})}return t}const M=new Map,H={set(t,e,i){M.has(t)||M.set(t,new Map);const n=M.get(t);n.has(e)||0===n.size?n.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(t,e)=>M.has(t)&&M.get(t).get(e)||null,remove(t,e){if(!M.has(t))return;const i=M.get(t);i.delete(e),0===i.size&&M.delete(t)}};function $(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function W(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const B={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${W(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${W(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const n of i){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),e[i]=$(t.dataset[n])}return e},getDataAttribute:(t,e)=>$(t.getAttribute(`data-bs-${W(e)}`))};class F{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=o(e)?B.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...o(e)?B.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const n of Object.keys(e)){const s=e[n],r=t[n],a=o(r)?"element":null==(i=r)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${a}" but expected type "${s}".`)}var i}}class z extends F{constructor(t,e){super(),(t=r(t))&&(this._element=t,this._config=this._getConfig(e),H.set(this._element,this.constructor.DATA_KEY,this))}dispose(){H.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){_(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return H.get(r(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const q=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,s=t.NAME;P.on(document,i,`[data-bs-dismiss="${s}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),l(this))return;const o=n(this)||this.closest(`.${s}`);t.getOrCreateInstance(o)[e]()}))};class R extends z{static get NAME(){return"alert"}close(){if(P.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),P.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=R.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}q(R,"close"),g(R);const V='[data-bs-toggle="button"]';class K extends z{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=K.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}P.on(document,"click.bs.button.data-api",V,(t=>{t.preventDefault();const e=t.target.closest(V);K.getOrCreateInstance(e).toggle()})),g(K);const Q={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let n=t.parentNode.closest(e);for(;n;)i.push(n),n=n.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!l(t)&&a(t)))}},X={endCallback:null,leftCallback:null,rightCallback:null},Y={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class U extends F{constructor(t,e){super(),this._element=t,t&&U.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return X}static get DefaultType(){return Y}static get NAME(){return"swipe"}dispose(){P.off(this._element,".bs.swipe")}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),m(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&m(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,"pointerdown.bs.swipe",(t=>this._start(t))),P.on(this._element,"pointerup.bs.swipe",(t=>this._end(t))),this._element.classList.add("pointer-event")):(P.on(this._element,"touchstart.bs.swipe",(t=>this._start(t))),P.on(this._element,"touchmove.bs.swipe",(t=>this._move(t))),P.on(this._element,"touchend.bs.swipe",(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const G="next",J="prev",Z="left",tt="right",et="slid.bs.carousel",it="carousel",nt="active",st={ArrowLeft:tt,ArrowRight:Z},ot={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},rt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class at extends z{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Q.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===it&&this.cycle()}static get Default(){return ot}static get DefaultType(){return rt}static get NAME(){return"carousel"}next(){this._slide(G)}nextWhenVisible(){!document.hidden&&a(this._element)&&this.next()}prev(){this._slide(J)}pause(){this._isSliding&&s(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?P.one(this._element,et,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void P.one(this._element,et,(()=>this.to(t)));const i=this._getItemIndex(this._getActive());if(i===t)return;const n=t>i?G:J;this._slide(n,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&P.on(this._element,"keydown.bs.carousel",(t=>this._keydown(t))),"hover"===this._config.pause&&(P.on(this._element,"mouseenter.bs.carousel",(()=>this.pause())),P.on(this._element,"mouseleave.bs.carousel",(()=>this._maybeEnableCycle()))),this._config.touch&&U.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of Q.find(".carousel-item img",this._element))P.on(t,"dragstart.bs.carousel",(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(Z)),rightCallback:()=>this._slide(this._directionToOrder(tt)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new U(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=st[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=Q.findOne(".active",this._indicatorsElement);e.classList.remove(nt),e.removeAttribute("aria-current");const i=Q.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(nt),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),n=t===G,s=e||b(this._getItems(),i,n,this._config.wrap);if(s===i)return;const o=this._getItemIndex(s),r=e=>P.trigger(this._element,e,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(r("slide.bs.carousel").defaultPrevented)return;if(!i||!s)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=s;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";s.classList.add(c),d(s),i.classList.add(l),s.classList.add(l),this._queueCallback((()=>{s.classList.remove(l,c),s.classList.add(nt),i.classList.remove(nt,c,l),this._isSliding=!1,r(et)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Q.findOne(".active.carousel-item",this._element)}_getItems(){return Q.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return p()?t===Z?J:G:t===Z?G:J}_orderToDirection(t){return p()?t===J?Z:tt:t===J?tt:Z}static jQueryInterface(t){return this.each((function(){const e=at.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}P.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",(function(t){const e=n(this);if(!e||!e.classList.contains(it))return;t.preventDefault();const i=at.getOrCreateInstance(e),s=this.getAttribute("data-bs-slide-to");return s?(i.to(s),void i._maybeEnableCycle()):"next"===B.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),P.on(window,"load.bs.carousel.data-api",(()=>{const t=Q.find('[data-bs-ride="carousel"]');for(const e of t)at.getOrCreateInstance(e)})),g(at);const lt="show",ct="collapse",ht="collapsing",dt='[data-bs-toggle="collapse"]',ut={parent:null,toggle:!0},ft={parent:"(null|element)",toggle:"boolean"};class pt extends z{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const n=Q.find(dt);for(const t of n){const e=i(t),n=Q.find(e).filter((t=>t===this._element));null!==e&&n.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ut}static get DefaultType(){return ft}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>pt.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(P.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(ct),this._element.classList.add(ht),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ht),this._element.classList.add(ct,lt),this._element.style[e]="",P.trigger(this._element,"shown.bs.collapse")}),this._element,!0),this._element.style[e]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(P.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,d(this._element),this._element.classList.add(ht),this._element.classList.remove(ct,lt);for(const t of this._triggerArray){const e=n(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ht),this._element.classList.add(ct),P.trigger(this._element,"hidden.bs.collapse")}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(lt)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=r(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(dt);for(const e of t){const t=n(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=Q.find(":scope .collapse .collapse",this._config.parent);return Q.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle("collapsed",!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const i=pt.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}P.on(document,"click.bs.collapse.data-api",dt,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();const e=i(this),n=Q.find(e);for(const t of n)pt.getOrCreateInstance(t,{toggle:!1}).toggle()})),g(pt);var gt="top",mt="bottom",_t="right",bt="left",vt="auto",yt=[gt,mt,_t,bt],wt="start",At="end",Et="clippingParents",Tt="viewport",Ct="popper",Ot="reference",xt=yt.reduce((function(t,e){return t.concat([e+"-"+wt,e+"-"+At])}),[]),kt=[].concat(yt,[vt]).reduce((function(t,e){return t.concat([e,e+"-"+wt,e+"-"+At])}),[]),Lt="beforeRead",Dt="read",St="afterRead",It="beforeMain",Nt="main",Pt="afterMain",jt="beforeWrite",Mt="write",Ht="afterWrite",$t=[Lt,Dt,St,It,Nt,Pt,jt,Mt,Ht];function Wt(t){return t?(t.nodeName||"").toLowerCase():null}function Bt(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ft(t){return t instanceof Bt(t).Element||t instanceof Element}function zt(t){return t instanceof Bt(t).HTMLElement||t instanceof HTMLElement}function qt(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Bt(t).ShadowRoot||t instanceof ShadowRoot)}const Rt={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},s=e.elements[t];zt(s)&&Wt(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(t){var e=n[t];!1===e?s.removeAttribute(t):s.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],s=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});zt(n)&&Wt(n)&&(Object.assign(n.style,o),Object.keys(s).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};function Vt(t){return t.split("-")[0]}var Kt=Math.max,Qt=Math.min,Xt=Math.round;function Yt(){var t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Ut(){return!/^((?!chrome|android).)*safari/i.test(Yt())}function Gt(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n=t.getBoundingClientRect(),s=1,o=1;e&&zt(t)&&(s=t.offsetWidth>0&&Xt(n.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Xt(n.height)/t.offsetHeight||1);var r=(Ft(t)?Bt(t):window).visualViewport,a=!Ut()&&i,l=(n.left+(a&&r?r.offsetLeft:0))/s,c=(n.top+(a&&r?r.offsetTop:0))/o,h=n.width/s,d=n.height/o;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function Jt(t){var e=Gt(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function Zt(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&qt(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function te(t){return Bt(t).getComputedStyle(t)}function ee(t){return["table","td","th"].indexOf(Wt(t))>=0}function ie(t){return((Ft(t)?t.ownerDocument:t.document)||window.document).documentElement}function ne(t){return"html"===Wt(t)?t:t.assignedSlot||t.parentNode||(qt(t)?t.host:null)||ie(t)}function se(t){return zt(t)&&"fixed"!==te(t).position?t.offsetParent:null}function oe(t){for(var e=Bt(t),i=se(t);i&&ee(i)&&"static"===te(i).position;)i=se(i);return i&&("html"===Wt(i)||"body"===Wt(i)&&"static"===te(i).position)?e:i||function(t){var e=/firefox/i.test(Yt());if(/Trident/i.test(Yt())&&zt(t)&&"fixed"===te(t).position)return null;var i=ne(t);for(qt(i)&&(i=i.host);zt(i)&&["html","body"].indexOf(Wt(i))<0;){var n=te(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}function re(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ae(t,e,i){return Kt(t,Qt(e,i))}function le(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ce(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}const he={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,n=t.name,s=t.options,o=i.elements.arrow,r=i.modifiersData.popperOffsets,a=Vt(i.placement),l=re(a),c=[bt,_t].indexOf(a)>=0?"height":"width";if(o&&r){var h=function(t,e){return le("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ce(t,yt))}(s.padding,i),d=Jt(o),u="y"===l?gt:bt,f="y"===l?mt:_t,p=i.rects.reference[c]+i.rects.reference[l]-r[l]-i.rects.popper[c],g=r[l]-i.rects.reference[l],m=oe(o),_=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,b=p/2-g/2,v=h[u],y=_-d[c]-h[f],w=_/2-d[c]/2+b,A=ae(v,w,y),E=l;i.modifiersData[n]=((e={})[E]=A,e.centerOffset=A-w,e)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&Zt(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function de(t){return t.split("-")[1]}var ue={top:"auto",right:"auto",bottom:"auto",left:"auto"};function fe(t){var e,i=t.popper,n=t.popperRect,s=t.placement,o=t.variation,r=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,h=t.roundOffsets,d=t.isFixed,u=r.x,f=void 0===u?0:u,p=r.y,g=void 0===p?0:p,m="function"==typeof h?h({x:f,y:g}):{x:f,y:g};f=m.x,g=m.y;var _=r.hasOwnProperty("x"),b=r.hasOwnProperty("y"),v=bt,y=gt,w=window;if(c){var A=oe(i),E="clientHeight",T="clientWidth";A===Bt(i)&&"static"!==te(A=ie(i)).position&&"absolute"===a&&(E="scrollHeight",T="scrollWidth"),(s===gt||(s===bt||s===_t)&&o===At)&&(y=mt,g-=(d&&A===w&&w.visualViewport?w.visualViewport.height:A[E])-n.height,g*=l?1:-1),s!==bt&&(s!==gt&&s!==mt||o!==At)||(v=_t,f-=(d&&A===w&&w.visualViewport?w.visualViewport.width:A[T])-n.width,f*=l?1:-1)}var C,O=Object.assign({position:a},c&&ue),x=!0===h?function(t){var e=t.x,i=t.y,n=window.devicePixelRatio||1;return{x:Xt(e*n)/n||0,y:Xt(i*n)/n||0}}({x:f,y:g}):{x:f,y:g};return f=x.x,g=x.y,l?Object.assign({},O,((C={})[y]=b?"0":"",C[v]=_?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",C)):Object.assign({},O,((e={})[y]=b?g+"px":"",e[v]=_?f+"px":"",e.transform="",e))}const pe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,s=void 0===n||n,o=i.adaptive,r=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,c={placement:Vt(e.placement),variation:de(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,fe(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,fe(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var ge={passive:!0};const me={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,s=n.scroll,o=void 0===s||s,r=n.resize,a=void 0===r||r,l=Bt(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach((function(t){t.addEventListener("scroll",i.update,ge)})),a&&l.addEventListener("resize",i.update,ge),function(){o&&c.forEach((function(t){t.removeEventListener("scroll",i.update,ge)})),a&&l.removeEventListener("resize",i.update,ge)}},data:{}};var _e={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,(function(t){return _e[t]}))}var ve={start:"end",end:"start"};function ye(t){return t.replace(/start|end/g,(function(t){return ve[t]}))}function we(t){var e=Bt(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ae(t){return Gt(ie(t)).left+we(t).scrollLeft}function Ee(t){var e=te(t),i=e.overflow,n=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function Te(t){return["html","body","#document"].indexOf(Wt(t))>=0?t.ownerDocument.body:zt(t)&&Ee(t)?t:Te(ne(t))}function Ce(t,e){var i;void 0===e&&(e=[]);var n=Te(t),s=n===(null==(i=t.ownerDocument)?void 0:i.body),o=Bt(n),r=s?[o].concat(o.visualViewport||[],Ee(n)?n:[]):n,a=e.concat(r);return s?a:a.concat(Ce(ne(r)))}function Oe(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function xe(t,e,i){return e===Tt?Oe(function(t,e){var i=Bt(t),n=ie(t),s=i.visualViewport,o=n.clientWidth,r=n.clientHeight,a=0,l=0;if(s){o=s.width,r=s.height;var c=Ut();(c||!c&&"fixed"===e)&&(a=s.offsetLeft,l=s.offsetTop)}return{width:o,height:r,x:a+Ae(t),y:l}}(t,i)):Ft(e)?function(t,e){var i=Gt(t,!1,"fixed"===e);return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}(e,i):Oe(function(t){var e,i=ie(t),n=we(t),s=null==(e=t.ownerDocument)?void 0:e.body,o=Kt(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),r=Kt(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+Ae(t),l=-n.scrollTop;return"rtl"===te(s||i).direction&&(a+=Kt(i.clientWidth,s?s.clientWidth:0)-o),{width:o,height:r,x:a,y:l}}(ie(t)))}function ke(t){var e,i=t.reference,n=t.element,s=t.placement,o=s?Vt(s):null,r=s?de(s):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(o){case gt:e={x:a,y:i.y-n.height};break;case mt:e={x:a,y:i.y+i.height};break;case _t:e={x:i.x+i.width,y:l};break;case bt:e={x:i.x-n.width,y:l};break;default:e={x:i.x,y:i.y}}var c=o?re(o):null;if(null!=c){var h="y"===c?"height":"width";switch(r){case wt:e[c]=e[c]-(i[h]/2-n[h]/2);break;case At:e[c]=e[c]+(i[h]/2-n[h]/2)}}return e}function Le(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=void 0===n?t.placement:n,o=i.strategy,r=void 0===o?t.strategy:o,a=i.boundary,l=void 0===a?Et:a,c=i.rootBoundary,h=void 0===c?Tt:c,d=i.elementContext,u=void 0===d?Ct:d,f=i.altBoundary,p=void 0!==f&&f,g=i.padding,m=void 0===g?0:g,_=le("number"!=typeof m?m:ce(m,yt)),b=u===Ct?Ot:Ct,v=t.rects.popper,y=t.elements[p?b:u],w=function(t,e,i,n){var s="clippingParents"===e?function(t){var e=Ce(ne(t)),i=["absolute","fixed"].indexOf(te(t).position)>=0&&zt(t)?oe(t):t;return Ft(i)?e.filter((function(t){return Ft(t)&&Zt(t,i)&&"body"!==Wt(t)})):[]}(t):[].concat(e),o=[].concat(s,[i]),r=o[0],a=o.reduce((function(e,i){var s=xe(t,i,n);return e.top=Kt(s.top,e.top),e.right=Qt(s.right,e.right),e.bottom=Qt(s.bottom,e.bottom),e.left=Kt(s.left,e.left),e}),xe(t,r,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(Ft(y)?y:y.contextElement||ie(t.elements.popper),l,h,r),A=Gt(t.elements.reference),E=ke({reference:A,element:v,strategy:"absolute",placement:s}),T=Oe(Object.assign({},v,E)),C=u===Ct?T:A,O={top:w.top-C.top+_.top,bottom:C.bottom-w.bottom+_.bottom,left:w.left-C.left+_.left,right:C.right-w.right+_.right},x=t.modifiersData.offset;if(u===Ct&&x){var k=x[s];Object.keys(O).forEach((function(t){var e=[_t,mt].indexOf(t)>=0?1:-1,i=[gt,mt].indexOf(t)>=0?"y":"x";O[t]+=k[i]*e}))}return O}function De(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=i.boundary,o=i.rootBoundary,r=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?kt:l,h=de(n),d=h?a?xt:xt.filter((function(t){return de(t)===h})):yt,u=d.filter((function(t){return c.indexOf(t)>=0}));0===u.length&&(u=d);var f=u.reduce((function(e,i){return e[i]=Le(t,{placement:i,boundary:s,rootBoundary:o,padding:r})[Vt(i)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}const Se={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0===r||r,l=i.fallbackPlacements,c=i.padding,h=i.boundary,d=i.rootBoundary,u=i.altBoundary,f=i.flipVariations,p=void 0===f||f,g=i.allowedAutoPlacements,m=e.options.placement,_=Vt(m),b=l||(_!==m&&p?function(t){if(Vt(t)===vt)return[];var e=be(t);return[ye(t),e,ye(e)]}(m):[be(m)]),v=[m].concat(b).reduce((function(t,i){return t.concat(Vt(i)===vt?De(e,{placement:i,boundary:h,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:g}):i)}),[]),y=e.rects.reference,w=e.rects.popper,A=new Map,E=!0,T=v[0],C=0;C<v.length;C++){var O=v[C],x=Vt(O),k=de(O)===wt,L=[gt,mt].indexOf(x)>=0,D=L?"width":"height",S=Le(e,{placement:O,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),I=L?k?_t:bt:k?mt:gt;y[D]>w[D]&&(I=be(I));var N=be(I),P=[];if(o&&P.push(S[x]<=0),a&&P.push(S[I]<=0,S[N]<=0),P.every((function(t){return t}))){T=O,E=!1;break}A.set(O,P)}if(E)for(var j=function(t){var e=v.find((function(e){var i=A.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return T=e,"break"},M=p?3:1;M>0&&"break"!==j(M);M--);e.placement!==T&&(e.modifiersData[n]._skip=!0,e.placement=T,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ie(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function Ne(t){return[gt,_t,mt,bt].some((function(e){return t[e]>=0}))}const Pe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,s=e.rects.popper,o=e.modifiersData.preventOverflow,r=Le(e,{elementContext:"reference"}),a=Le(e,{altBoundary:!0}),l=Ie(r,n),c=Ie(a,s,o),h=Ne(l),d=Ne(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}},je={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.offset,o=void 0===s?[0,0]:s,r=kt.reduce((function(t,i){return t[i]=function(t,e,i){var n=Vt(t),s=[bt,gt].indexOf(n)>=0?-1:1,o="function"==typeof i?i(Object.assign({},e,{placement:t})):i,r=o[0],a=o[1];return r=r||0,a=(a||0)*s,[bt,_t].indexOf(n)>=0?{x:a,y:r}:{x:r,y:a}}(i,e.rects,o),t}),{}),a=r[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=r}},Me={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=ke({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},He={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0!==r&&r,l=i.boundary,c=i.rootBoundary,h=i.altBoundary,d=i.padding,u=i.tether,f=void 0===u||u,p=i.tetherOffset,g=void 0===p?0:p,m=Le(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),_=Vt(e.placement),b=de(e.placement),v=!b,y=re(_),w="x"===y?"y":"x",A=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,C="function"==typeof g?g(Object.assign({},e.rects,{placement:e.placement})):g,O="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),x=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(A){if(o){var L,D="y"===y?gt:bt,S="y"===y?mt:_t,I="y"===y?"height":"width",N=A[y],P=N+m[D],j=N-m[S],M=f?-T[I]/2:0,H=b===wt?E[I]:T[I],$=b===wt?-T[I]:-E[I],W=e.elements.arrow,B=f&&W?Jt(W):{width:0,height:0},F=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=F[D],q=F[S],R=ae(0,E[I],B[I]),V=v?E[I]/2-M-R-z-O.mainAxis:H-R-z-O.mainAxis,K=v?-E[I]/2+M+R+q+O.mainAxis:$+R+q+O.mainAxis,Q=e.elements.arrow&&oe(e.elements.arrow),X=Q?"y"===y?Q.clientTop||0:Q.clientLeft||0:0,Y=null!=(L=null==x?void 0:x[y])?L:0,U=N+K-Y,G=ae(f?Qt(P,N+V-Y-X):P,N,f?Kt(j,U):j);A[y]=G,k[y]=G-N}if(a){var J,Z="x"===y?gt:bt,tt="x"===y?mt:_t,et=A[w],it="y"===w?"height":"width",nt=et+m[Z],st=et-m[tt],ot=-1!==[gt,bt].indexOf(_),rt=null!=(J=null==x?void 0:x[w])?J:0,at=ot?nt:et-E[it]-T[it]-rt+O.altAxis,lt=ot?et+E[it]+T[it]-rt-O.altAxis:st,ct=f&&ot?function(t,e,i){var n=ae(t,e,i);return n>i?i:n}(at,et,lt):ae(f?at:nt,et,f?lt:st);A[w]=ct,k[w]=ct-et}e.modifiersData[n]=k}},requiresIfExists:["offset"]};function $e(t,e,i){void 0===i&&(i=!1);var n,s,o=zt(e),r=zt(e)&&function(t){var e=t.getBoundingClientRect(),i=Xt(e.width)/t.offsetWidth||1,n=Xt(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),a=ie(e),l=Gt(t,r,i),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(o||!o&&!i)&&(("body"!==Wt(e)||Ee(a))&&(c=(n=e)!==Bt(n)&&zt(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:we(n)),zt(e)?((h=Gt(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):a&&(h.x=Ae(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function We(t){var e=new Map,i=new Set,n=[];function s(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var n=e.get(t);n&&s(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||s(t)})),n}var Be={placement:"bottom",modifiers:[],strategy:"absolute"};function Fe(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function ze(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,s=e.defaultOptions,o=void 0===s?Be:s;return function(t,e,i){void 0===i&&(i=o);var s,r,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Be,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},o,a.options,s),a.scrollParents={reference:Ft(t)?Ce(t):t.contextElement?Ce(t.contextElement):[],popper:Ce(e)};var r,c,u=function(t){var e=We(t);return $t.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}((r=[].concat(n,a.options.modifiers),c=r.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{}),Object.keys(c).map((function(t){return c[t]}))));return a.orderedModifiers=u.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,s=t.effect;if("function"==typeof s){var o=s({state:a,name:e,instance:h,options:n});l.push(o||function(){})}})),h.update()},forceUpdate:function(){if(!c){var t=a.elements,e=t.reference,i=t.popper;if(Fe(e,i)){a.rects={reference:$e(e,oe(i),"fixed"===a.options.strategy),popper:Jt(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],o=s.fn,r=s.options,l=void 0===r?{}:r,d=s.name;"function"==typeof o&&(a=o({state:a,options:l,name:d,instance:h})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(t){h.forceUpdate(),t(a)}))},function(){return r||(r=new Promise((function(t){Promise.resolve().then((function(){r=void 0,t(s())}))}))),r}),destroy:function(){d(),c=!0}};if(!Fe(t,e))return h;function d(){l.forEach((function(t){return t()})),l=[]}return h.setOptions(i).then((function(t){!c&&i.onFirstUpdate&&i.onFirstUpdate(t)})),h}}var qe=ze(),Re=ze({defaultModifiers:[me,Me,pe,Rt]}),Ve=ze({defaultModifiers:[me,Me,pe,Rt,je,Se,He,he,Pe]});const Ke=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:ze,detectOverflow:Le,createPopperBase:qe,createPopper:Ve,createPopperLite:Re,top:gt,bottom:mt,right:_t,left:bt,auto:vt,basePlacements:yt,start:wt,end:At,clippingParents:Et,viewport:Tt,popper:Ct,reference:Ot,variationPlacements:xt,placements:kt,beforeRead:Lt,read:Dt,afterRead:St,beforeMain:It,main:Nt,afterMain:Pt,beforeWrite:jt,write:Mt,afterWrite:Ht,modifierPhases:$t,applyStyles:Rt,arrow:he,computeStyles:pe,eventListeners:me,flip:Se,hide:Pe,offset:je,popperOffsets:Me,preventOverflow:He},Symbol.toStringTag,{value:"Module"})),Qe="dropdown",Xe="ArrowUp",Ye="ArrowDown",Ue="click.bs.dropdown.data-api",Ge="keydown.bs.dropdown.data-api",Je="show",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',ti=`${Ze}.show`,ei=".dropdown-menu",ii=p()?"top-end":"top-start",ni=p()?"top-start":"top-end",si=p()?"bottom-end":"bottom-start",oi=p()?"bottom-start":"bottom-end",ri=p()?"left-start":"right-start",ai=p()?"right-start":"left-start",li={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ci={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class hi extends z{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=Q.next(this._element,ei)[0]||Q.prev(this._element,ei)[0]||Q.findOne(ei,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return li}static get DefaultType(){return ci}static get NAME(){return Qe}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!P.trigger(this._element,"show.bs.dropdown",t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))P.on(t,"mouseover",h);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Je),this._element.classList.add(Je),P.trigger(this._element,"shown.bs.dropdown",t)}}hide(){if(l(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!P.trigger(this._element,"hide.bs.dropdown",t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.off(t,"mouseover",h);this._popper&&this._popper.destroy(),this._menu.classList.remove(Je),this._element.classList.remove(Je),this._element.setAttribute("aria-expanded","false"),B.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,"hidden.bs.dropdown",t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!o(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${Qe.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===Ke)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:o(this._config.reference)?t=r(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=Ve(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Je)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return ri;if(t.classList.contains("dropstart"))return ai;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?ni:ii:e?oi:si}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(B.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_selectMenuItem({key:t,target:e}){const i=Q.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>a(t)));i.length&&b(i,e,t===Ye,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=hi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=Q.find(ti);for(const i of e){const e=hi.getInstance(i);if(!e||!1===e._config.autoClose)continue;const n=t.composedPath(),s=n.includes(e._menu);if(n.includes(e._element)||"inside"===e._config.autoClose&&!s||"outside"===e._config.autoClose&&s)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const o={relatedTarget:e._element};"click"===t.type&&(o.clickEvent=t),e._completeHide(o)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i="Escape"===t.key,n=[Xe,Ye].includes(t.key);if(!n&&!i)return;if(e&&!i)return;t.preventDefault();const s=this.matches(Ze)?this:Q.prev(this,Ze)[0]||Q.next(this,Ze)[0]||Q.findOne(Ze,t.delegateTarget.parentNode),o=hi.getOrCreateInstance(s);if(n)return t.stopPropagation(),o.show(),void o._selectMenuItem(t);o._isShown()&&(t.stopPropagation(),o.hide(),s.focus())}}P.on(document,Ge,Ze,hi.dataApiKeydownHandler),P.on(document,Ge,ei,hi.dataApiKeydownHandler),P.on(document,Ue,hi.clearMenus),P.on(document,"keyup.bs.dropdown.data-api",hi.clearMenus),P.on(document,Ue,Ze,(function(t){t.preventDefault(),hi.getOrCreateInstance(this).toggle()})),g(hi);const di=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",ui=".sticky-top",fi="padding-right",pi="margin-right";class gi{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,fi,(e=>e+t)),this._setElementAttributes(di,fi,(e=>e+t)),this._setElementAttributes(ui,pi,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,fi),this._resetElementAttributes(di,fi),this._resetElementAttributes(ui,pi)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const n=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+n)return;this._saveInitialAttribute(t,e);const s=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${i(Number.parseFloat(s))}px`)}))}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&B.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=B.getDataAttribute(t,e);null!==i?(B.removeDataAttribute(t,e),t.style.setProperty(e,i)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(o(t))e(t);else for(const i of Q.find(t,this._element))e(i)}}const mi="show",_i="mousedown.bs.backdrop",bi={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},vi={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class yi extends F{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return bi}static get DefaultType(){return vi}static get NAME(){return"backdrop"}show(t){if(!this._config.isVisible)return void m(t);this._append();const e=this._getElement();this._config.isAnimated&&d(e),e.classList.add(mi),this._emulateAnimation((()=>{m(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(mi),this._emulateAnimation((()=>{this.dispose(),m(t)}))):m(t)}dispose(){this._isAppended&&(P.off(this._element,_i),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=r(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),P.on(t,_i,(()=>{m(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){_(t,this._getElement(),this._config.isAnimated)}}const wi=".bs.focustrap",Ai="backward",Ei={autofocus:!0,trapElement:null},Ti={autofocus:"boolean",trapElement:"element"};class Ci extends F{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ei}static get DefaultType(){return Ti}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,wi),P.on(document,"focusin.bs.focustrap",(t=>this._handleFocusin(t))),P.on(document,"keydown.tab.bs.focustrap",(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,wi))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=Q.focusableChildren(e);0===i.length?e.focus():this._lastTabNavDirection===Ai?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?Ai:"forward")}}const Oi="hidden.bs.modal",xi="show.bs.modal",ki="modal-open",Li="show",Di="modal-static",Si={backdrop:!0,focus:!0,keyboard:!0},Ii={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ni extends z{constructor(t,e){super(t,e),this._dialog=Q.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new gi,this._addEventListeners()}static get Default(){return Si}static get DefaultType(){return Ii}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||P.trigger(this._element,xi,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ki),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){this._isShown&&!this._isTransitioning&&(P.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Li),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){for(const t of[window,this._dialog])P.off(t,".bs.modal");this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new yi({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ci({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=Q.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),d(this._element),this._element.classList.add(Li),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,"shown.bs.modal",{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,"keydown.dismiss.bs.modal",(t=>{if("Escape"===t.key)return this._config.keyboard?(t.preventDefault(),void this.hide()):void this._triggerBackdropTransition()})),P.on(window,"resize.bs.modal",(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),P.on(this._element,"mousedown.dismiss.bs.modal",(t=>{P.one(this._element,"click.dismiss.bs.modal",(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(ki),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,Oi)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(P.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(Di)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Di),this._queueCallback((()=>{this._element.classList.remove(Di),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const t=p()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!i&&t){const t=p()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=Ni.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}P.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',(function(t){const e=n(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),P.one(e,xi,(t=>{t.defaultPrevented||P.one(e,Oi,(()=>{a(this)&&this.focus()}))}));const i=Q.findOne(".modal.show");i&&Ni.getInstance(i).hide(),Ni.getOrCreateInstance(e).toggle(this)})),q(Ni),g(Ni);const Pi="show",ji="showing",Mi="hiding",Hi=".offcanvas.show",$i="hidePrevented.bs.offcanvas",Wi="hidden.bs.offcanvas",Bi={backdrop:!0,keyboard:!0,scroll:!1},Fi={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class zi extends z{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Bi}static get DefaultType(){return Fi}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||P.trigger(this._element,"show.bs.offcanvas",{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new gi).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ji),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Pi),this._element.classList.remove(ji),P.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&(P.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Mi),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(Pi,Mi),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new gi).reset(),P.trigger(this._element,Wi)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new yi({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():P.trigger(this._element,$i)}:null})}_initializeFocusTrap(){return new Ci({trapElement:this._element})}_addEventListeners(){P.on(this._element,"keydown.dismiss.bs.offcanvas",(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():P.trigger(this._element,$i))}))}static jQueryInterface(t){return this.each((function(){const e=zi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}P.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',(function(t){const e=n(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this))return;P.one(e,Wi,(()=>{a(this)&&this.focus()}));const i=Q.findOne(Hi);i&&i!==e&&zi.getInstance(i).hide(),zi.getOrCreateInstance(e).toggle(this)})),P.on(window,"load.bs.offcanvas.data-api",(()=>{for(const t of Q.find(Hi))zi.getOrCreateInstance(t).show()})),P.on(window,"resize.bs.offcanvas",(()=>{for(const t of Q.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&zi.getOrCreateInstance(t).hide()})),q(zi),g(zi);const qi=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Ri=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Vi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Ki=(t,e)=>{const i=t.nodeName.toLowerCase();return e.includes(i)?!qi.has(i)||Boolean(Ri.test(t.nodeValue)||Vi.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(i)))},Qi={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Xi={allowList:Qi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Yi={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Ui={entry:"(string|element|function|null)",selector:"(string|element)"};class Gi extends F{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return Xi}static get DefaultType(){return Yi}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,i]of Object.entries(this._config.content))this._setContent(t,i,e);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},Ui)}_setContent(t,e,i){const n=Q.findOne(i,t);n&&((e=this._resolvePossibleFunction(e))?o(e)?this._putElementInTemplate(r(e),n):this._config.html?n.innerHTML=this._maybeSanitize(e):n.textContent=e:n.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const n=(new window.DOMParser).parseFromString(t,"text/html"),s=[].concat(...n.body.querySelectorAll("*"));for(const t of s){const i=t.nodeName.toLowerCase();if(!Object.keys(e).includes(i)){t.remove();continue}const n=[].concat(...t.attributes),s=[].concat(e["*"]||[],e[i]||[]);for(const e of n)Ki(e,s)||t.removeAttribute(e.nodeName)}return n.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return"function"==typeof t?t(this):t}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const Ji=new Set(["sanitize","allowList","sanitizeFn"]),Zi="fade",tn="show",en=".modal",nn="hide.bs.modal",sn="hover",on="focus",rn={AUTO:"auto",TOP:"top",RIGHT:p()?"left":"right",BOTTOM:"bottom",LEFT:p()?"right":"left"},an={allowList:Qi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ln={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class cn extends z{constructor(t,e){if(void 0===Ke)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return an}static get DefaultType(){return ln}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(en),nn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=P.trigger(this._element,this.constructor.eventName("show")),e=(c(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),P.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(tn),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.on(t,"mouseover",h);this._queueCallback((()=>{P.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!P.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(tn),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.off(t,"mouseover",h);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(Zi,tn),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(Zi),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new Gi({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Zi)}_isShown(){return this.tip&&this.tip.classList.contains(tn)}_createPopper(t){const e="function"==typeof this._config.placement?this._config.placement.call(this,t,this._element):this._config.placement,i=rn[e.toUpperCase()];return Ve(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return"function"==typeof t?t.call(this._element):t}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)P.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===sn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=e===sn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");P.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?on:sn]=!0,e._enter()})),P.on(this._element,i,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?on:sn]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(en),nn,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=B.getDataAttributes(this._element);for(const t of Object.keys(e))Ji.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:r(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const e in this._config)this.constructor.Default[e]!==this._config[e]&&(t[e]=this._config[e]);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=cn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}g(cn);const hn={...cn.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},dn={...cn.DefaultType,content:"(null|string|element|function)"};class un extends cn{static get Default(){return hn}static get DefaultType(){return dn}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=un.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}g(un);const fn="click.bs.scrollspy",pn="active",gn="[href]",mn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},_n={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class bn extends z{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return mn}static get DefaultType(){return _n}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=r(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,fn),P.on(this._config.target,fn,gn,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,n=e.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:n,behavior:"smooth"});i.scrollTop=n}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),i=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},n=(this._rootElement||document.documentElement).scrollTop,s=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const t=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&t){if(i(o),!n)return}else s||t||i(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=Q.find(gn,this._config.target);for(const e of t){if(!e.hash||l(e))continue;const t=Q.findOne(e.hash,this._element);a(t)&&(this._targetLinks.set(e.hash,e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(pn),this._activateParents(t),P.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))Q.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(pn);else for(const e of Q.parents(t,".nav, .list-group"))for(const t of Q.prev(e,".nav-link, .nav-item > .nav-link, .list-group-item"))t.classList.add(pn)}_clearActiveClass(t){t.classList.remove(pn);const e=Q.find("[href].active",t);for(const t of e)t.classList.remove(pn)}static jQueryInterface(t){return this.each((function(){const e=bn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}P.on(window,"load.bs.scrollspy.data-api",(()=>{for(const t of Q.find('[data-bs-spy="scroll"]'))bn.getOrCreateInstance(t)})),g(bn);const vn="ArrowLeft",yn="ArrowRight",wn="ArrowUp",An="ArrowDown",En="active",Tn="fade",Cn="show",On='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',xn=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${On}`;class kn extends z{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,"keydown.bs.tab",(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?P.trigger(e,"hide.bs.tab",{relatedTarget:t}):null;P.trigger(t,"show.bs.tab",{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){t&&(t.classList.add(En),this._activate(n(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),P.trigger(t,"shown.bs.tab",{relatedTarget:e})):t.classList.add(Cn)}),t,t.classList.contains(Tn)))}_deactivate(t,e){t&&(t.classList.remove(En),t.blur(),this._deactivate(n(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),P.trigger(t,"hidden.bs.tab",{relatedTarget:e})):t.classList.remove(Cn)}),t,t.classList.contains(Tn)))}_keydown(t){if(![vn,yn,wn,An].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=[yn,An].includes(t.key),i=b(this._getChildren().filter((t=>!l(t))),t.target,e,!0);i&&(i.focus({preventScroll:!0}),kn.getOrCreateInstance(i).show())}_getChildren(){return Q.find(xn,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=n(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`#${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains("dropdown"))return;const n=(t,n)=>{const s=Q.findOne(t,i);s&&s.classList.toggle(n,e)};n(".dropdown-toggle",En),n(".dropdown-menu",Cn),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(En)}_getInnerElement(t){return t.matches(xn)?t:Q.findOne(xn,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=kn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}P.on(document,"click.bs.tab",On,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this)||kn.getOrCreateInstance(this).show()})),P.on(window,"load.bs.tab",(()=>{for(const t of Q.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))kn.getOrCreateInstance(t)})),g(kn);const Ln="hide",Dn="show",Sn="showing",In={animation:"boolean",autohide:"boolean",delay:"number"},Nn={animation:!0,autohide:!0,delay:5e3};class Pn extends z{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Nn}static get DefaultType(){return In}static get NAME(){return"toast"}show(){P.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Ln),d(this._element),this._element.classList.add(Dn,Sn),this._queueCallback((()=>{this._element.classList.remove(Sn),P.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(P.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(Sn),this._queueCallback((()=>{this._element.classList.add(Ln),this._element.classList.remove(Sn,Dn),P.trigger(this._element,"hidden.bs.toast")}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Dn),super.dispose()}isShown(){return this._element.classList.contains(Dn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,"mouseover.bs.toast",(t=>this._onInteraction(t,!0))),P.on(this._element,"mouseout.bs.toast",(t=>this._onInteraction(t,!1))),P.on(this._element,"focusin.bs.toast",(t=>this._onInteraction(t,!0))),P.on(this._element,"focusout.bs.toast",(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=Pn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return q(Pn),g(Pn),{Alert:R,Button:K,Carousel:at,Collapse:pt,Dropdown:hi,Modal:Ni,Offcanvas:zi,Popover:un,ScrollSpy:bn,Tab:kn,Toast:Pn,Tooltip:cn}}));
//# sourceMappingURL=bootstrap.bundle.min.js.map
</file>

<file path="payisp/js/central.js">
//acoes
if(typeof window.location.pathname !== 'undefined'){
	//acoes em index e 2_via
	console.log(window.location.pathname);
	if(window.location.pathname=='/central/index.hhvm' || window.location.pathname=='/central/2_via.hhvm'){
		//botoes boletos e carnets
		for (let element of document.querySelectorAll(`a[href]`)) {
			if(element.href !== 'undefined'){
				//boletos
				if (/prepara_boleto_payisp.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/central_prepara_boleto.hhvm?"+partes[1]);
				}
				if (/prepara_boleto.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/central_prepara_boleto.hhvm?"+partes[1]);
				}
				if (/..\/boleto\/boleto_payisp.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/boleto.hhvm?"+partes[1]);
				}
				if (/..\/boleto\/boleto.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/boleto.hhvm?"+partes[1]);
				}
				//carnets
				if (/..\/boleto\/carne_payisp.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/carne.hhvm?"+partes[1]);
				}
				if (/..\/boleto\/carne.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/carne.hhvm?"+partes[1]);
				}
				if (/prepara_carne_payisp.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/central_prepara_carne.hhvm?"+partes[1]);
				}
				if (/prepara_carne.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/central_prepara_carne.hhvm?"+partes[1]);
				}
			}
		}
	}
};
</file>

<file path="payisp/js/jquery.blockUI.js">
/*!
 * jQuery blockUI plugin
 * Version 2.70.0-2014.11.23
 * Requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */

;(function() {
/*jshint eqeqeq:false curly:false latedef:false */
"use strict";

	function setup($) {
		$.fn._fadeIn = $.fn.fadeIn;

		var noOp = $.noop || function() {};

		// this bit is to ensure we don't call setExpression when we shouldn't (with extra muscle to handle
		// confusing userAgent strings on Vista)
		var msie = /MSIE/.test(navigator.userAgent);
		var ie6  = /MSIE 6.0/.test(navigator.userAgent) && ! /MSIE 8.0/.test(navigator.userAgent);
		var mode = document.documentMode || 0;
		var setExpr = $.isFunction( document.createElement('div').style.setExpression );

		// global $ methods for blocking/unblocking the entire page
		$.blockUI   = function(opts) { install(window, opts); };
		$.unblockUI = function(opts) { remove(window, opts); };

		// convenience method for quick growl-like notifications  (http://www.google.com/search?q=growl)
		$.growlUI = function(title, message, timeout, onClose) {
			var $m = $('<div class="growlUI"></div>');
			if (title) $m.append('<h1>'+title+'</h1>');
			if (message) $m.append('<h2>'+message+'</h2>');
			if (timeout === undefined) timeout = 3000;

			// Added by konapun: Set timeout to 30 seconds if this growl is moused over, like normal toast notifications
			var callBlock = function(opts) {
				opts = opts || {};

				$.blockUI({
					message: $m,
					fadeIn : typeof opts.fadeIn  !== 'undefined' ? opts.fadeIn  : 700,
					fadeOut: typeof opts.fadeOut !== 'undefined' ? opts.fadeOut : 1000,
					timeout: typeof opts.timeout !== 'undefined' ? opts.timeout : timeout,
					centerY: false,
					showOverlay: false,
					onUnblock: onClose,
					css: $.blockUI.defaults.growlCSS
				});
			};

			callBlock();
			var nonmousedOpacity = $m.css('opacity');
			$m.mouseover(function() {
				callBlock({
					fadeIn: 0,
					timeout: 30000
				});

				var displayBlock = $('.blockMsg');
				displayBlock.stop(); // cancel fadeout if it has started
				displayBlock.fadeTo(300, 1); // make it easier to read the message by removing transparency
			}).mouseout(function() {
				$('.blockMsg').fadeOut(1000);
			});
			// End konapun additions
		};

		// plugin method for blocking element content
		$.fn.block = function(opts) {
			if ( this[0] === window ) {
				$.blockUI( opts );
				return this;
			}
			var fullOpts = $.extend({}, $.blockUI.defaults, opts || {});
			this.each(function() {
				var $el = $(this);
				if (fullOpts.ignoreIfBlocked && $el.data('blockUI.isBlocked'))
					return;
				$el.unblock({ fadeOut: 0 });
			});

			return this.each(function() {
				if ($.css(this,'position') == 'static') {
					this.style.position = 'relative';
					$(this).data('blockUI.static', true);
				}
				this.style.zoom = 1; // force 'hasLayout' in ie
				install(this, opts);
			});
		};

		// plugin method for unblocking element content
		$.fn.unblock = function(opts) {
			if ( this[0] === window ) {
				$.unblockUI( opts );
				return this;
			}
			return this.each(function() {
				remove(this, opts);
			});
		};

		$.blockUI.version = 2.70; // 2nd generation blocking at no extra cost!

		// override these in your code to change the default behavior and style
		$.blockUI.defaults = {
			// message displayed when blocking (use null for no message)
			message:  '<h1>Please wait...</h1>',

			title: null,		// title string; only used when theme == true
			draggable: true,	// only used when theme == true (requires jquery-ui.js to be loaded)

			theme: false, // set to true to use with jQuery UI themes

			// styles for the message when blocking; if you wish to disable
			// these and use an external stylesheet then do this in your code:
			// $.blockUI.defaults.css = {};
			css: {
				padding:	0,
				margin:		0,
				width:		'30%',
				top:		'40%',
				left:		'35%',
				textAlign:	'center',
				color:		'#000',
				border:		'3px solid #aaa',
				backgroundColor:'#fff',
				cursor:		'wait'
			},

			// minimal style set used when themes are used
			themedCSS: {
				width:	'30%',
				top:	'40%',
				left:	'35%'
			},

			// styles for the overlay
			overlayCSS:  {
				backgroundColor:	'#000',
				opacity:			0.6,
				cursor:				'wait'
			},

			// style to replace wait cursor before unblocking to correct issue
			// of lingering wait cursor
			cursorReset: 'default',

			// styles applied when using $.growlUI
			growlCSS: {
				width:		'350px',
				top:		'10px',
				left:		'',
				right:		'10px',
				border:		'none',
				padding:	'5px',
				opacity:	0.6,
				cursor:		'default',
				color:		'#fff',
				backgroundColor: '#000',
				'-webkit-border-radius':'10px',
				'-moz-border-radius':	'10px',
				'border-radius':		'10px'
			},

			// IE issues: 'about:blank' fails on HTTPS and javascript:false is s-l-o-w
			// (hat tip to Jorge H. N. de Vasconcelos)
			/*jshint scripturl:true */
			iframeSrc: /^https/i.test(window.location.href || '') ? 'javascript:false' : 'about:blank',

			// force usage of iframe in non-IE browsers (handy for blocking applets)
			forceIframe: false,

			// z-index for the blocking overlay
			baseZ: 1000,

			// set these to true to have the message automatically centered
			centerX: true, // <-- only effects element blocking (page block controlled via css above)
			centerY: true,

			// allow body element to be stetched in ie6; this makes blocking look better
			// on "short" pages.  disable if you wish to prevent changes to the body height
			allowBodyStretch: true,

			// enable if you want key and mouse events to be disabled for content that is blocked
			bindEvents: true,

			// be default blockUI will supress tab navigation from leaving blocking content
			// (if bindEvents is true)
			constrainTabKey: true,

			// fadeIn time in millis; set to 0 to disable fadeIn on block
			fadeIn:  200,

			// fadeOut time in millis; set to 0 to disable fadeOut on unblock
			fadeOut:  400,

			// time in millis to wait before auto-unblocking; set to 0 to disable auto-unblock
			timeout: 0,

			// disable if you don't want to show the overlay
			showOverlay: true,

			// if true, focus will be placed in the first available input field when
			// page blocking
			focusInput: true,

            // elements that can receive focus
            focusableElements: ':input:enabled:visible',

			// suppresses the use of overlay styles on FF/Linux (due to performance issues with opacity)
			// no longer needed in 2012
			// applyPlatformOpacityRules: true,

			// callback method invoked when fadeIn has completed and blocking message is visible
			onBlock: null,

			// callback method invoked when unblocking has completed; the callback is
			// passed the element that has been unblocked (which is the window object for page
			// blocks) and the options that were passed to the unblock call:
			//	onUnblock(element, options)
			onUnblock: null,

			// callback method invoked when the overlay area is clicked.
			// setting this will turn the cursor to a pointer, otherwise cursor defined in overlayCss will be used.
			onOverlayClick: null,

			// don't ask; if you really must know: http://groups.google.com/group/jquery-en/browse_thread/thread/36640a8730503595/2f6a79a77a78e493#2f6a79a77a78e493
			quirksmodeOffsetHack: 4,

			// class name of the message block
			blockMsgClass: 'blockMsg',

			// if it is already blocked, then ignore it (don't unblock and reblock)
			ignoreIfBlocked: false
		};

		// private data and functions follow...

		var pageBlock = null;
		var pageBlockEls = [];

		function install(el, opts) {
			var css, themedCSS;
			var full = (el == window);
			var msg = (opts && opts.message !== undefined ? opts.message : undefined);
			opts = $.extend({}, $.blockUI.defaults, opts || {});

			if (opts.ignoreIfBlocked && $(el).data('blockUI.isBlocked'))
				return;

			opts.overlayCSS = $.extend({}, $.blockUI.defaults.overlayCSS, opts.overlayCSS || {});
			css = $.extend({}, $.blockUI.defaults.css, opts.css || {});
			if (opts.onOverlayClick)
				opts.overlayCSS.cursor = 'pointer';

			themedCSS = $.extend({}, $.blockUI.defaults.themedCSS, opts.themedCSS || {});
			msg = msg === undefined ? opts.message : msg;

			// remove the current block (if there is one)
			if (full && pageBlock)
				remove(window, {fadeOut:0});

			// if an existing element is being used as the blocking content then we capture
			// its current place in the DOM (and current display style) so we can restore
			// it when we unblock
			if (msg && typeof msg != 'string' && (msg.parentNode || msg.jquery)) {
				var node = msg.jquery ? msg[0] : msg;
				var data = {};
				$(el).data('blockUI.history', data);
				data.el = node;
				data.parent = node.parentNode;
				data.display = node.style.display;
				data.position = node.style.position;
				if (data.parent)
					data.parent.removeChild(node);
			}

			$(el).data('blockUI.onUnblock', opts.onUnblock);
			var z = opts.baseZ;

			// blockUI uses 3 layers for blocking, for simplicity they are all used on every platform;
			// layer1 is the iframe layer which is used to supress bleed through of underlying content
			// layer2 is the overlay layer which has opacity and a wait cursor (by default)
			// layer3 is the message content that is displayed while blocking
			var lyr1, lyr2, lyr3, s;
			if (msie || opts.forceIframe)
				lyr1 = $('<iframe class="blockUI" style="z-index:'+ (z++) +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+opts.iframeSrc+'"></iframe>');
			else
				lyr1 = $('<div class="blockUI" style="display:none"></div>');

			if (opts.theme)
				lyr2 = $('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+ (z++) +';display:none"></div>');
			else
				lyr2 = $('<div class="blockUI blockOverlay" style="z-index:'+ (z++) +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');

			if (opts.theme && full) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:fixed">';
				if ( opts.title ) {
					s += '<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title || '&nbsp;')+'</div>';
				}
				s += '<div class="ui-widget-content ui-dialog-content"></div>';
				s += '</div>';
			}
			else if (opts.theme) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:absolute">';
				if ( opts.title ) {
					s += '<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title || '&nbsp;')+'</div>';
				}
				s += '<div class="ui-widget-content ui-dialog-content"></div>';
				s += '</div>';
			}
			else if (full) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockPage" style="z-index:'+(z+10)+';display:none;position:fixed"></div>';
			}
			else {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockElement" style="z-index:'+(z+10)+';display:none;position:absolute"></div>';
			}
			lyr3 = $(s);

			// if we have a message, style it
			if (msg) {
				if (opts.theme) {
					lyr3.css(themedCSS);
					lyr3.addClass('ui-widget-content');
				}
				else
					lyr3.css(css);
			}

			// style the overlay
			if (!opts.theme /*&& (!opts.applyPlatformOpacityRules)*/)
				lyr2.css(opts.overlayCSS);
			lyr2.css('position', full ? 'fixed' : 'absolute');

			// make iframe layer transparent in IE
			if (msie || opts.forceIframe)
				lyr1.css('opacity',0.0);

			//$([lyr1[0],lyr2[0],lyr3[0]]).appendTo(full ? 'body' : el);
			var layers = [lyr1,lyr2,lyr3], $par = full ? $('body') : $(el);
			$.each(layers, function() {
				this.appendTo($par);
			});

			if (opts.theme && opts.draggable && $.fn.draggable) {
				lyr3.draggable({
					handle: '.ui-dialog-titlebar',
					cancel: 'li'
				});
			}

			// ie7 must use absolute positioning in quirks mode and to account for activex issues (when scrolling)
			var expr = setExpr && (!$.support.boxModel || $('object,embed', full ? null : el).length > 0);
			if (ie6 || expr) {
				// give body 100% height
				if (full && opts.allowBodyStretch && $.support.boxModel)
					$('html,body').css('height','100%');

				// fix ie6 issue when blocked element has a border width
				if ((ie6 || !$.support.boxModel) && !full) {
					var t = sz(el,'borderTopWidth'), l = sz(el,'borderLeftWidth');
					var fixT = t ? '(0 - '+t+')' : 0;
					var fixL = l ? '(0 - '+l+')' : 0;
				}

				// simulate fixed position
				$.each(layers, function(i,o) {
					var s = o[0].style;
					s.position = 'absolute';
					if (i < 2) {
						if (full)
							s.setExpression('height','Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:'+opts.quirksmodeOffsetHack+') + "px"');
						else
							s.setExpression('height','this.parentNode.offsetHeight + "px"');
						if (full)
							s.setExpression('width','jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');
						else
							s.setExpression('width','this.parentNode.offsetWidth + "px"');
						if (fixL) s.setExpression('left', fixL);
						if (fixT) s.setExpression('top', fixT);
					}
					else if (opts.centerY) {
						if (full) s.setExpression('top','(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');
						s.marginTop = 0;
					}
					else if (!opts.centerY && full) {
						var top = (opts.css && opts.css.top) ? parseInt(opts.css.top, 10) : 0;
						var expression = '((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + '+top+') + "px"';
						s.setExpression('top',expression);
					}
				});
			}

			// show the message
			if (msg) {
				if (opts.theme)
					lyr3.find('.ui-widget-content').append(msg);
				else
					lyr3.append(msg);
				if (msg.jquery || msg.nodeType)
					$(msg).show();
			}

			if ((msie || opts.forceIframe) && opts.showOverlay)
				lyr1.show(); // opacity is zero
			if (opts.fadeIn) {
				var cb = opts.onBlock ? opts.onBlock : noOp;
				var cb1 = (opts.showOverlay && !msg) ? cb : noOp;
				var cb2 = msg ? cb : noOp;
				if (opts.showOverlay)
					lyr2._fadeIn(opts.fadeIn, cb1);
				if (msg)
					lyr3._fadeIn(opts.fadeIn, cb2);
			}
			else {
				if (opts.showOverlay)
					lyr2.show();
				if (msg)
					lyr3.show();
				if (opts.onBlock)
					opts.onBlock.bind(lyr3)();
			}

			// bind key and mouse events
			bind(1, el, opts);

			if (full) {
				pageBlock = lyr3[0];
				pageBlockEls = $(opts.focusableElements,pageBlock);
				if (opts.focusInput)
					setTimeout(focus, 20);
			}
			else
				center(lyr3[0], opts.centerX, opts.centerY);

			if (opts.timeout) {
				// auto-unblock
				var to = setTimeout(function() {
					if (full)
						$.unblockUI(opts);
					else
						$(el).unblock(opts);
				}, opts.timeout);
				$(el).data('blockUI.timeout', to);
			}
		}

		// remove the block
		function remove(el, opts) {
			var count;
			var full = (el == window);
			var $el = $(el);
			var data = $el.data('blockUI.history');
			var to = $el.data('blockUI.timeout');
			if (to) {
				clearTimeout(to);
				$el.removeData('blockUI.timeout');
			}
			opts = $.extend({}, $.blockUI.defaults, opts || {});
			bind(0, el, opts); // unbind events

			if (opts.onUnblock === null) {
				opts.onUnblock = $el.data('blockUI.onUnblock');
				$el.removeData('blockUI.onUnblock');
			}

			var els;
			if (full) // crazy selector to handle odd field errors in ie6/7
				els = $('body').children().filter('.blockUI').add('body > .blockUI');
			else
				els = $el.find('>.blockUI');

			// fix cursor issue
			if ( opts.cursorReset ) {
				if ( els.length > 1 )
					els[1].style.cursor = opts.cursorReset;
				if ( els.length > 2 )
					els[2].style.cursor = opts.cursorReset;
			}

			if (full)
				pageBlock = pageBlockEls = null;

			if (opts.fadeOut) {
				count = els.length;
				els.stop().fadeOut(opts.fadeOut, function() {
					if ( --count === 0)
						reset(els,data,opts,el);
				});
			}
			else
				reset(els, data, opts, el);
		}

		// move blocking element back into the DOM where it started
		function reset(els,data,opts,el) {
			var $el = $(el);
			if ( $el.data('blockUI.isBlocked') )
				return;

			els.each(function(i,o) {
				// remove via DOM calls so we don't lose event handlers
				if (this.parentNode)
					this.parentNode.removeChild(this);
			});

			if (data && data.el) {
				data.el.style.display = data.display;
				data.el.style.position = data.position;
				data.el.style.cursor = 'default'; // #59
				if (data.parent)
					data.parent.appendChild(data.el);
				$el.removeData('blockUI.history');
			}

			if ($el.data('blockUI.static')) {
				$el.css('position', 'static'); // #22
			}

			if (typeof opts.onUnblock == 'function')
				opts.onUnblock(el,opts);

			// fix issue in Safari 6 where block artifacts remain until reflow
			var body = $(document.body), w = body.width(), cssW = body[0].style.width;
			body.width(w-1).width(w);
			body[0].style.width = cssW;
		}

		// bind/unbind the handler
		function bind(b, el, opts) {
			var full = el == window, $el = $(el);

			// don't bother unbinding if there is nothing to unbind
			if (!b && (full && !pageBlock || !full && !$el.data('blockUI.isBlocked')))
				return;

			$el.data('blockUI.isBlocked', b);

			// don't bind events when overlay is not in use or if bindEvents is false
			if (!full || !opts.bindEvents || (b && !opts.showOverlay))
				return;

			// bind anchors and inputs for mouse and key events
			var events = 'mousedown mouseup keydown keypress keyup touchstart touchend touchmove';
			if (b)
				$(document).bind(events, opts, handler);
			else
				$(document).unbind(events, handler);

		// former impl...
		//		var $e = $('a,:input');
		//		b ? $e.bind(events, opts, handler) : $e.unbind(events, handler);
		}

		// event handler to suppress keyboard/mouse events when blocking
		function handler(e) {
			// allow tab navigation (conditionally)
			if (e.type === 'keydown' && e.keyCode && e.keyCode == 9) {
				if (pageBlock && e.data.constrainTabKey) {
					var els = pageBlockEls;
					var fwd = !e.shiftKey && e.target === els[els.length-1];
					var back = e.shiftKey && e.target === els[0];
					if (fwd || back) {
						setTimeout(function(){focus(back);},10);
						return false;
					}
				}
			}
			var opts = e.data;
			var target = $(e.target);
			if (target.hasClass('blockOverlay') && opts.onOverlayClick)
				opts.onOverlayClick(e);

			// allow events within the message content
			if (target.parents('div.' + opts.blockMsgClass).length > 0)
				return true;

			// allow events for content that is not being blocked
			return target.parents().children().filter('div.blockUI').length === 0;
		}

		function focus(back) {
			if (!pageBlockEls)
				return;
			var e = pageBlockEls[back===true ? pageBlockEls.length-1 : 0];
			if (e)
				e.focus();
		}

		function center(el, x, y) {
			var p = el.parentNode, s = el.style;
			var l = ((p.offsetWidth - el.offsetWidth)/2) - sz(p,'borderLeftWidth');
			var t = ((p.offsetHeight - el.offsetHeight)/2) - sz(p,'borderTopWidth');
			if (x) s.left = l > 0 ? (l+'px') : '0';
			if (y) s.top  = t > 0 ? (t+'px') : '0';
		}

		function sz(el, p) {
			return parseInt($.css(el,p),10)||0;
		}

	}


	/*global define:true */
	if (typeof define === 'function' && define.amd && define.amd.jQuery) {
		define(['jquery'], setup);
	} else {
		setup(jQuery);
	}

})();
</file>

<file path="payisp/js/pgwmodal.min.js">
/**
 * PgwModal - Version 2.0
 *
 * Copyright 2014, Jonathan M. Piat
 * http://pgwjs.com - http://pagawa.com
 * 
 * Released under the GNU GPLv3 license - http://opensource.org/licenses/gpl-3.0
 */
(function(a){a.pgwModal=function(i){var c={};var g={mainClassName:"pgwModal",backdropClassName:"pgwModalBackdrop",maxWidth:500,titleBar:true,closable:true,closeOnEscape:true,closeOnBackgroundClick:true,closeContent:'<span class="pm-icon"></span>',loadingContent:"Loading in progress...",errorContent:"An error has occured. Please try again in a few moments."};if(typeof window.pgwModalObject!="undefined"){c=window.pgwModalObject}if((typeof i=="object")&&(!i.pushContent)){if(!i.url&&!i.target&&!i.content){throw new Error('PgwModal - There is no content to display, please provide a config parameter : "url", "target" or "content"')}c.config={};c.config=a.extend({},g,i);window.pgwModalObject=c}var k=function(){var o='<div id="pgwModalBackdrop"></div><div id="pgwModal"><div class="pm-container"><div class="pm-body"><span class="pm-close"></span><div class="pm-title"></div><div class="pm-content"></div></div></div></div>';a("body").append(o);a(document).trigger("PgwModal::Create");return true};var l=function(){a("#pgwModal .pm-title, #pgwModal .pm-content").html("");a("#pgwModal .pm-close").html("").unbind("click");return true};var f=function(){angular.element('body').injector().invoke(function($compile){var scope=angular.element($('#pgwModal .pm-content')).scope();$compile($('#pgwModal .pm-content'))(scope);scope.$digest()});return true};var d=function(o){a("#pgwModal .pm-content").html(o);if(c.config.angular){f()}m();a(document).trigger("PgwModal::PushContent");return true};var m=function(){a("#pgwModal, #pgwModalBackdrop").show();var q=a(window).height();var o=a("#pgwModal .pm-body").height();var p=Math.round((q-o)/3);if(p<=0){p=0}a("#pgwModal .pm-body").css("margin-top",p);return true};var h=function(){return c.config.modalData};var e=function(){var o=a('<div style="width:50px;height:50px;overflow:auto"><div></div></div>').appendTo("body");var q=o.children();if(typeof q.innerWidth!="function"){return 0}var p=q.innerWidth()-q.height(90).innerWidth();o.remove();return p};var b=function(){return a("body").hasClass("pgwModalOpen")};var n=function(){a("#pgwModal, #pgwModalBackdrop").removeClass().hide();a("body").css("padding-right","").removeClass("pgwModalOpen");l();a(window).unbind("resize.PgwModal");a(document).unbind("keyup.PgwModal");a("#pgwModal").unbind("click.PgwModalBackdrop");try{delete window.pgwModalObject}catch(o){window.pgwModalObject=undefined}a(document).trigger("PgwModal::Close");return true};var j=function(){if(a("#pgwModal").length==0){k()}else{l()}a("#pgwModal").removeClass().addClass(c.config.mainClassName);a("#pgwModalBackdrop").removeClass().addClass(c.config.backdropClassName);if(!c.config.closable){a("#pgwModal .pm-close").html("").unbind("click").hide()}else{a("#pgwModal .pm-close").html(c.config.closeContent).click(function(){n()}).show()}if(!c.config.titleBar){a("#pgwModal .pm-title").hide()}else{a("#pgwModal .pm-title").show()}if(c.config.title){a("#pgwModal .pm-title").text(c.config.title)}if(c.config.maxWidth){a("#pgwModal .pm-body").css("max-width",c.config.maxWidth)}if(c.config.url){if(c.config.loadingContent){a("#pgwModal .pm-content").html(c.config.loadingContent)}var o={url:i.url,success:function(q){d(q)},error:function(){a("#pgwModal .pm-content").html(c.config.errorContent)}};if(c.config.ajaxOptions){o=a.extend({},o,c.config.ajaxOptions)}a.ajax(o)}else{if(c.config.target){d(a(c.config.target).html())}else{if(c.config.content){d(c.config.content)}}}if(c.config.closeOnEscape&&c.config.closable){a(document).bind("keyup.PgwModal",function(q){if(q.keyCode==27){n()}})}if(c.config.closeOnBackgroundClick&&c.config.closable){a("#pgwModal").bind("click.PgwModalBackdrop",function(s){var r=a(s.target).hasClass("pm-container");var q=a(s.target).attr("id");if(r||q=="pgwModal"){n()}})}a("body").addClass("pgwModalOpen");var p=e();if(p>0){a("body").css("padding-right",p)}a(window).bind("resize.PgwModal",function(){m()});a(document).trigger("PgwModal::Open");return true};if((typeof i=="string")&&(i=="close")){return n()}else{if((typeof i=="string")&&(i=="reposition")){return m()}else{if((typeof i=="string")&&(i=="getData")){return h()}else{if((typeof i=="string")&&(i=="isOpen")){return b()}else{if((typeof i=="object")&&(i.pushContent)){return d(i.pushContent)}else{if(typeof i=="object"){return j()}}}}}}}})(window.Zepto||window.jQuery);
</file>

<file path="payisp/js/scripts.js">
function detalhes_banco_payisp(bancos) {
	if (bancos == '') {
		location.href = 'bancos.add.php';
	} else {
		location.href = 'bancos.add.php?cod_banco=' + bancos;
	}
}

function abrirPopup_payisp(url, w, h, fullscreen = false) {
	if (fullscreen) {
		w = screen.width;
		h = screen.height;
	}
	var newW = w + 100;
	var newH = h + 100;
	var left = (screen.width - newW) / 2;
	var top = (screen.height - newH) / 2;
	var newwindow = window.open(url, 'licenciamento', 'directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width=' + newW + ',height=' + newH + ',left=' + left + ',top=' + top);
	newwindow.resizeTo(newW, newH);
	//posiciona o popup no centro da tela
	newwindow.moveTo(left, top);
	newwindow.focus();
	return false;
}

function bloquear_tela_payisp() {
	$.unblockUI();
	$.blockUI({
		message: '<br><b>Aguarde o processamento...</b></br><br>',
		css: { border: '1px solid #CCC', 'border-radius': '5px', 'background': 'transparent', 'color': '#FFF' }
	});
}

function prompt_confirmar_remover_payisp(frase, url) {
	bootbox.prompt({
		title: 'Confirmao',
		message: frase,
		buttons: {
			confirm: {
				label: 'Confirmar',
				className: 'btn-success'
			},
			cancel: {
				label: 'Cancelar',
				className: 'btn-danger'
			}
		},
		centerVertical: true,
		callback: function (confirma) {
			console.log(confirma);
			if (confirma == 'sim' || confirma == 'SIM' || confirma == 'Sim') {
				bloquear_tela_payisp();
				location.href = url;
			}
		}
	});
}

function mk_auth_imprimir_carnet_cliente_payisp() {
	document.form_carne.setAttribute('action', "/admin/imprimir_carnes_payisp.hhvm?imp=car");
	fabrewin(815, 440);
	document.form_carne.submit();
	return false;
}
function mk_auth_imprimir_carnet_titulos_payisp() {
	jQuery("#form_combox").attr('action', "/admin/imprimir_boletos_payisp.hhvm");
	jQuery("#form_combox").attr('target', "mpg_popup");
	fabrewin(815, 440);
	jQuery("#form_combox").submit();
	return false;
}
function registrar_carnet_payisp() {
	var cliente_uuid = get_url_var_payisp('uuid');
	document.form_carne.setAttribute('action', "/admin/addons/payisp/registro.manual.php?acao=carnet&cliente_uuid=" + cliente_uuid);
	fabrewin(815, 440);
	document.form_carne.submit();
	return false;
}
function registrar_avulso_payisp() {
	var cliente_uuid = get_url_var_payisp('uuid');
	jQuery("#form_combox").attr('action', "/admin/addons/payisp/registro.manual.php?acao=avulso&cliente_uuid=" + cliente_uuid);
	jQuery("#form_combox").attr('target', "mpg_popup");
	fabrewin(815, 440);
	jQuery("#form_combox").submit();
	return false;
}
</file>

<file path="payisp/js/toastr.js.map">
{"version":3,"sources":["toastr.js"],"names":["define","$","error","message","title","optionsOverride","notify","type","toastType","iconClass","getOptions","iconClasses","getContainer","options","create","$container","containerId","length","createContainer","info","subscribe","callback","listener","success","warning","clear","$toastElement","clearOptions","clearToast","clearContainer","remove","removeToast","children","toastsToClear","i","force","hideMethod","duration","hideDuration","easing","hideEasing","complete","attr","addClass","positionClass","appendTo","target","getDefaults","tapToDismiss","toastClass","debug","showMethod","showDuration","showEasing","onShown","undefined","onHidden","extendedTimeOut","timeOut","titleClass","messageClass","closeHtml","newestOnTop","preventDuplicates","progressBar","publish","args","map","personalizeToast","setIcon","setTitle","setMessage","setCloseButton","setProgressBar","setSequence","handleEvents","hover","stickAround","delayedHideToast","onclick","click","hideToast","closeButton","$closeElement","event","stopPropagation","cancelBubble","displayToast","hide","intervalId","setTimeout","maxHideTime","parseFloat","hideEta","Date","getTime","setInterval","updateProgress","prepend","append","$titleElement","$messageElement","$progressElement","shouldExit","previousToast","override","clearTimeout","response","state","endTime","stop","percentage","width","extend","toastId","startTime","console","log","toastr","is","version","amd","deps","factory","module","exports","require","window"],"mappings":"CAaG,SAAUA,GACTA,GAAQ,UAAW,SAAUC,GACzB,MAAO,YA8BH,QAASC,GAAMC,EAASC,EAAOC,GAC3B,MAAOC,IACHC,KAAMC,EAAUN,MAChBO,UAAWC,IAAaC,YAAYT,MACpCC,QAASA,EACTE,gBAAiBA,EACjBD,MAAOA,IAIf,QAASQ,GAAaC,EAASC,GAG3B,MAFKD,KAAWA,EAAUH,KAC1BK,EAAad,EAAE,IAAMY,EAAQG,aACzBD,EAAWE,OACJF,GAEPD,IACAC,EAAaG,EAAgBL,IAE1BE,GAGX,QAASI,GAAKhB,EAASC,EAAOC,GAC1B,MAAOC,IACHC,KAAMC,EAAUW,KAChBV,UAAWC,IAAaC,YAAYQ,KACpChB,QAASA,EACTE,gBAAiBA,EACjBD,MAAOA,IAIf,QAASgB,GAAUC,GACfC,EAAWD,EAGf,QAASE,GAAQpB,EAASC,EAAOC,GAC7B,MAAOC,IACHC,KAAMC,EAAUe,QAChBd,UAAWC,IAAaC,YAAYY,QACpCpB,QAASA,EACTE,gBAAiBA,EACjBD,MAAOA,IAIf,QAASoB,GAAQrB,EAASC,EAAOC,GAC7B,MAAOC,IACHC,KAAMC,EAAUgB,QAChBf,UAAWC,IAAaC,YAAYa,QACpCrB,QAASA,EACTE,gBAAiBA,EACjBD,MAAOA,IAIf,QAASqB,GAAMC,EAAeC,GAC1B,GAAId,GAAUH,GACTK,IAAcH,EAAaC,GAC3Be,EAAWF,EAAeb,EAASc,IACpCE,EAAehB,GAIvB,QAASiB,GAAOJ,GACZ,GAAIb,GAAUH,GAEd,OADKK,IAAcH,EAAaC,GAC5Ba,GAAuD,IAAtCzB,EAAE,SAAUyB,GAAeT,WAC5Cc,GAAYL,QAGZX,EAAWiB,WAAWf,QACtBF,EAAWe,UAMnB,QAASD,GAAgBhB,GAErB,IAAK,GADDoB,GAAgBlB,EAAWiB,WACtBE,EAAID,EAAchB,OAAS,EAAGiB,GAAK,EAAGA,IAC3CN,EAAW3B,EAAEgC,EAAcC,IAAKrB,GAIxC,QAASe,GAAYF,EAAeb,EAASc,GACzC,GAAIQ,GAAQR,GAAgBA,EAAaQ,MAAQR,EAAaQ,OAAQ,CACtE,OAAIT,KAAkBS,GAA+C,IAAtClC,EAAE,SAAUyB,GAAeT,SACtDS,EAAcb,EAAQuB,aAClBC,SAAUxB,EAAQyB,aAClBC,OAAQ1B,EAAQ2B,WAChBC,SAAU,WAAcV,EAAYL,OAEjC,IAEJ,EAGX,QAASR,GAAgBL,GAQrB,MAPAE,GAAad,EAAE,UACVyC,KAAK,KAAM7B,EAAQG,aACnB2B,SAAS9B,EAAQ+B,eACjBF,KAAK,YAAa,UAClBA,KAAK,OAAQ,SAElB3B,EAAW8B,SAAS5C,EAAEY,EAAQiC,SACvB/B,EAGX,QAASgC,KACL,OACIC,cAAc,EACdC,WAAY,QACZjC,YAAa,kBACbkC,OAAO,EAEPC,WAAY,SACZC,aAAc,IACdC,WAAY,QACZC,QAASC,OACTnB,WAAY,UACZE,aAAc,IACdE,WAAY,QACZgB,SAAUD,OAEVE,gBAAiB,IACjB9C,aACIT,MAAO,cACPiB,KAAM,aACNI,QAAS,gBACTC,QAAS,iBAEbf,UAAW,aACXmC,cAAe,kBACfc,QAAS,IACTC,WAAY,cACZC,aAAc,gBACdd,OAAQ,OACRe,UAAW,yCACXC,aAAa,EACbC,mBAAmB,EACnBC,aAAa,GAIrB,QAASC,GAAQC,GACR5C,GACLA,EAAS4C,GAGb,QAAS5D,GAAO6D,GAgDZ,QAASC,KACLC,IACAC,IACAC,IACAC,IACAC,IACAC,IAGJ,QAASC,KACLjD,EAAckD,MAAMC,EAAaC,IAC5BjE,EAAQkE,SAAWlE,EAAQmC,cAC5BtB,EAAcsD,MAAMC,GAGpBpE,EAAQqE,aAAeC,GACvBA,EAAcH,MAAM,SAAUI,GACtBA,EAAMC,gBACND,EAAMC,kBACwB9B,SAAvB6B,EAAME,cAA8BF,EAAME,gBAAiB,IAClEF,EAAME,cAAe,GAEzBL,GAAU,KAIdpE,EAAQkE,SACRrD,EAAcsD,MAAM,WAChBnE,EAAQkE,UACRE,MAKZ,QAASM,KACL7D,EAAc8D,OAEd9D,EAAcb,EAAQsC,aACjBd,SAAUxB,EAAQuC,aAAcb,OAAQ1B,EAAQwC,WAAYZ,SAAU5B,EAAQyC,UAG/EzC,EAAQ6C,QAAU,IAClB+B,EAAaC,WAAWT,EAAWpE,EAAQ6C,SAC3CM,EAAY2B,YAAcC,WAAW/E,EAAQ6C,SAC7CM,EAAY6B,SAAU,GAAIC,OAAOC,UAAY/B,EAAY2B,YACrD9E,EAAQmD,cACRA,EAAYyB,WAAaO,YAAYC,EAAgB,MAKjE,QAAS5B,KACDF,EAAI1D,WACJiB,EAAciB,SAAS9B,EAAQoC,YAAYN,SAASlC,GAI5D,QAASiE,KACD7D,EAAQiD,YACR/C,EAAWmF,QAAQxE,GAEnBX,EAAWoF,OAAOzE,GAI1B,QAAS4C,KACDH,EAAI/D,QACJgG,EAAcD,OAAOhC,EAAI/D,OAAOuC,SAAS9B,EAAQ8C,YACjDjC,EAAcyE,OAAOC,IAI7B,QAAS7B,KACDJ,EAAIhE,UACJkG,EAAgBF,OAAOhC,EAAIhE,SAASwC,SAAS9B,EAAQ+C,cACrDlC,EAAcyE,OAAOE,IAI7B,QAAS7B,KACD3D,EAAQqE,cACRC,EAAcxC,SAAS,sBAAsBD,KAAK,OAAQ,UAC1DhB,EAAcwE,QAAQf,IAI9B,QAASV,KACD5D,EAAQmD,cACRsC,EAAiB3D,SAAS,kBAC1BjB,EAAcwE,QAAQI,IAI9B,QAASC,GAAW1F,EAASsD,GACzB,GAAItD,EAAQkD,kBAAmB,CAC3B,GAAII,EAAIhE,UAAYqG,EAChB,OAAO,CAEPA,GAAgBrC,EAAIhE,QAG5B,OAAO,EAGX,QAAS8E,GAAUwB,GACf,OAAIxG,EAAE,SAAUyB,GAAeT,QAAWwF,GAG1CC,aAAa1C,EAAYyB,YAClB/D,EAAcb,EAAQuB,aACzBC,SAAUxB,EAAQyB,aAClBC,OAAQ1B,EAAQ2B,WAChBC,SAAU,WACNV,EAAYL,GACRb,EAAQ2C,UAA+B,WAAnBmD,EAASC,OAC7B/F,EAAQ2C,WAEZmD,EAASC,MAAQ,SACjBD,EAASE,QAAU,GAAIf,MACvB7B,EAAQ0C,OAdhB,OAmBJ,QAAS7B,MACDjE,EAAQ6C,QAAU,GAAK7C,EAAQ4C,gBAAkB,KACjDgC,EAAaC,WAAWT,EAAWpE,EAAQ4C,iBAC3CO,EAAY2B,YAAcC,WAAW/E,EAAQ4C,iBAC7CO,EAAY6B,SAAU,GAAIC,OAAOC,UAAY/B,EAAY2B,aAIjE,QAASd,KACL6B,aAAajB,GACbzB,EAAY6B,QAAU,EACtBnE,EAAcoF,MAAK,GAAM,GAAMjG,EAAQsC,aAClCd,SAAUxB,EAAQuC,aAAcb,OAAQ1B,EAAQwC,aAIzD,QAAS4C,KACL,GAAIc,IAAe/C,EAAY6B,SAAW,GAAIC,OAAOC,WAAc/B,EAAY2B,YAAe,GAC9FW,GAAiBU,MAAMD,EAAa,KA7LxC,GAAIlG,GAAUH,IACVD,EAAY0D,EAAI1D,WAAaI,EAAQJ,SAOzC,IALqC,mBAAzB0D,GAAmB,kBAC3BtD,EAAUZ,EAAEgH,OAAOpG,EAASsD,EAAI9D,iBAChCI,EAAY0D,EAAI9D,gBAAgBI,WAAaA,IAG7C8F,EAAW1F,EAASsD,GAAxB,CAEA+C,IAEAnG,EAAaH,EAAaC,GAAS,EAEnC,IAAI4E,GAAa,KACb/D,EAAgBzB,EAAE,UAClBmG,EAAgBnG,EAAE,UAClBoG,EAAkBpG,EAAE,UACpBqG,EAAmBrG,EAAE,UACrBkF,EAAgBlF,EAAEY,EAAQgD,WAC1BG,GACAyB,WAAY,KACZI,QAAS,KACTF,YAAa,MAEbgB,GACAO,QAASA,EACTN,MAAO,UACPO,UAAW,GAAIrB,MACfjF,QAASA,EACTsD,IAAKA,EAeT,OAZAC,KAEAmB,IAEAZ,IAEAV,EAAQ0C,GAEJ9F,EAAQqC,OAASkE,SACjBA,QAAQC,IAAIV,GAGTjF,GAoJX,QAAShB,KACL,MAAOT,GAAEgH,UAAWlE,IAAeuE,EAAOzG,SAG9C,QAASkB,GAAYL,GACZX,IAAcA,EAAaH,KAC5Bc,EAAc6F,GAAG,cAGrB7F,EAAcI,SACdJ,EAAgB,KACqB,IAAjCX,EAAWiB,WAAWf,SACtBF,EAAWe,SACX0E,EAAgBjD,SAlYxB,GAAIxC,GACAO,EAsBAkF,EArBAU,EAAU,EACV1G,GACAN,MAAO,QACPiB,KAAM,OACNI,QAAS,UACTC,QAAS,WAGT8F,GACA7F,MAAOA,EACPK,OAAQA,EACR5B,MAAOA,EACPU,aAAcA,EACdO,KAAMA,EACNN,WACAO,UAAWA,EACXG,QAASA,EACTiG,QAAS,QACThG,QAASA,EAKb,OAAO8F,SA+WC,kBAAXtH,SAAyBA,OAAOyH,IAAMzH,OAAS,SAAU0H,EAAMC,GAC9C,mBAAXC,SAA0BA,OAAOC,QACxCD,OAAOC,QAAUF,EAAQG,QAAQ,WAEjCC,OAAe,OAAIJ,EAAQI,OAAe","file":"toastr.js","sourcesContent":["/*\n * Toastr\n * Copyright 2012-2015\n * Authors: John Papa, Hans Fjllemark, and Tim Ferrell.\n * All Rights Reserved.\n * Use, reproduction, distribution, and modification of this code is subject to the terms and\n * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php\n *\n * ARIA Support: Greta Krafsig\n *\n * Project: https://github.com/CodeSeven/toastr\n */\n/* global define */\n; (function (define) {\n    define(['jquery'], function ($) {\n        return (function () {\n            var $container;\n            var listener;\n            var toastId = 0;\n            var toastType = {\n                error: 'error',\n                info: 'info',\n                success: 'success',\n                warning: 'warning'\n            };\n\n            var toastr = {\n                clear: clear,\n                remove: remove,\n                error: error,\n                getContainer: getContainer,\n                info: info,\n                options: {},\n                subscribe: subscribe,\n                success: success,\n                version: '2.1.1',\n                warning: warning\n            };\n\n            var previousToast;\n\n            return toastr;\n\n            ////////////////\n\n            function error(message, title, optionsOverride) {\n                return notify({\n                    type: toastType.error,\n                    iconClass: getOptions().iconClasses.error,\n                    message: message,\n                    optionsOverride: optionsOverride,\n                    title: title\n                });\n            }\n\n            function getContainer(options, create) {\n                if (!options) { options = getOptions(); }\n                $container = $('#' + options.containerId);\n                if ($container.length) {\n                    return $container;\n                }\n                if (create) {\n                    $container = createContainer(options);\n                }\n                return $container;\n            }\n\n            function info(message, title, optionsOverride) {\n                return notify({\n                    type: toastType.info,\n                    iconClass: getOptions().iconClasses.info,\n                    message: message,\n                    optionsOverride: optionsOverride,\n                    title: title\n                });\n            }\n\n            function subscribe(callback) {\n                listener = callback;\n            }\n\n            function success(message, title, optionsOverride) {\n                return notify({\n                    type: toastType.success,\n                    iconClass: getOptions().iconClasses.success,\n                    message: message,\n                    optionsOverride: optionsOverride,\n                    title: title\n                });\n            }\n\n            function warning(message, title, optionsOverride) {\n                return notify({\n                    type: toastType.warning,\n                    iconClass: getOptions().iconClasses.warning,\n                    message: message,\n                    optionsOverride: optionsOverride,\n                    title: title\n                });\n            }\n\n            function clear($toastElement, clearOptions) {\n                var options = getOptions();\n                if (!$container) { getContainer(options); }\n                if (!clearToast($toastElement, options, clearOptions)) {\n                    clearContainer(options);\n                }\n            }\n\n            function remove($toastElement) {\n                var options = getOptions();\n                if (!$container) { getContainer(options); }\n                if ($toastElement && $(':focus', $toastElement).length === 0) {\n                    removeToast($toastElement);\n                    return;\n                }\n                if ($container.children().length) {\n                    $container.remove();\n                }\n            }\n\n            // internal functions\n\n            function clearContainer (options) {\n                var toastsToClear = $container.children();\n                for (var i = toastsToClear.length - 1; i >= 0; i--) {\n                    clearToast($(toastsToClear[i]), options);\n                }\n            }\n\n            function clearToast ($toastElement, options, clearOptions) {\n                var force = clearOptions && clearOptions.force ? clearOptions.force : false;\n                if ($toastElement && (force || $(':focus', $toastElement).length === 0)) {\n                    $toastElement[options.hideMethod]({\n                        duration: options.hideDuration,\n                        easing: options.hideEasing,\n                        complete: function () { removeToast($toastElement); }\n                    });\n                    return true;\n                }\n                return false;\n            }\n\n            function createContainer(options) {\n                $container = $('<div/>')\n                    .attr('id', options.containerId)\n                    .addClass(options.positionClass)\n                    .attr('aria-live', 'polite')\n                    .attr('role', 'alert');\n\n                $container.appendTo($(options.target));\n                return $container;\n            }\n\n            function getDefaults() {\n                return {\n                    tapToDismiss: true,\n                    toastClass: 'toast',\n                    containerId: 'toast-container',\n                    debug: false,\n\n                    showMethod: 'fadeIn', //fadeIn, slideDown, and show are built into jQuery\n                    showDuration: 300,\n                    showEasing: 'swing', //swing and linear are built into jQuery\n                    onShown: undefined,\n                    hideMethod: 'fadeOut',\n                    hideDuration: 1000,\n                    hideEasing: 'swing',\n                    onHidden: undefined,\n\n                    extendedTimeOut: 1000,\n                    iconClasses: {\n                        error: 'toast-error',\n                        info: 'toast-info',\n                        success: 'toast-success',\n                        warning: 'toast-warning'\n                    },\n                    iconClass: 'toast-info',\n                    positionClass: 'toast-top-right',\n                    timeOut: 5000, // Set timeOut and extendedTimeOut to 0 to make it sticky\n                    titleClass: 'toast-title',\n                    messageClass: 'toast-message',\n                    target: 'body',\n                    closeHtml: '<button type=\"button\">&times;</button>',\n                    newestOnTop: true,\n                    preventDuplicates: false,\n                    progressBar: false\n                };\n            }\n\n            function publish(args) {\n                if (!listener) { return; }\n                listener(args);\n            }\n\n            function notify(map) {\n                var options = getOptions();\n                var iconClass = map.iconClass || options.iconClass;\n\n                if (typeof (map.optionsOverride) !== 'undefined') {\n                    options = $.extend(options, map.optionsOverride);\n                    iconClass = map.optionsOverride.iconClass || iconClass;\n                }\n\n                if (shouldExit(options, map)) { return; }\n\n                toastId++;\n\n                $container = getContainer(options, true);\n\n                var intervalId = null;\n                var $toastElement = $('<div/>');\n                var $titleElement = $('<div/>');\n                var $messageElement = $('<div/>');\n                var $progressElement = $('<div/>');\n                var $closeElement = $(options.closeHtml);\n                var progressBar = {\n                    intervalId: null,\n                    hideEta: null,\n                    maxHideTime: null\n                };\n                var response = {\n                    toastId: toastId,\n                    state: 'visible',\n                    startTime: new Date(),\n                    options: options,\n                    map: map\n                };\n\n                personalizeToast();\n\n                displayToast();\n\n                handleEvents();\n\n                publish(response);\n\n                if (options.debug && console) {\n                    console.log(response);\n                }\n\n                return $toastElement;\n\n                function personalizeToast() {\n                    setIcon();\n                    setTitle();\n                    setMessage();\n                    setCloseButton();\n                    setProgressBar();\n                    setSequence();\n                }\n\n                function handleEvents() {\n                    $toastElement.hover(stickAround, delayedHideToast);\n                    if (!options.onclick && options.tapToDismiss) {\n                        $toastElement.click(hideToast);\n                    }\n\n                    if (options.closeButton && $closeElement) {\n                        $closeElement.click(function (event) {\n                            if (event.stopPropagation) {\n                                event.stopPropagation();\n                            } else if (event.cancelBubble !== undefined && event.cancelBubble !== true) {\n                                event.cancelBubble = true;\n                            }\n                            hideToast(true);\n                        });\n                    }\n\n                    if (options.onclick) {\n                        $toastElement.click(function () {\n                            options.onclick();\n                            hideToast();\n                        });\n                    }\n                }\n\n                function displayToast() {\n                    $toastElement.hide();\n\n                    $toastElement[options.showMethod](\n                        {duration: options.showDuration, easing: options.showEasing, complete: options.onShown}\n                    );\n\n                    if (options.timeOut > 0) {\n                        intervalId = setTimeout(hideToast, options.timeOut);\n                        progressBar.maxHideTime = parseFloat(options.timeOut);\n                        progressBar.hideEta = new Date().getTime() + progressBar.maxHideTime;\n                        if (options.progressBar) {\n                            progressBar.intervalId = setInterval(updateProgress, 10);\n                        }\n                    }\n                }\n\n                function setIcon() {\n                    if (map.iconClass) {\n                        $toastElement.addClass(options.toastClass).addClass(iconClass);\n                    }\n                }\n\n                function setSequence() {\n                    if (options.newestOnTop) {\n                        $container.prepend($toastElement);\n                    } else {\n                        $container.append($toastElement);\n                    }\n                }\n\n                function setTitle() {\n                    if (map.title) {\n                        $titleElement.append(map.title).addClass(options.titleClass);\n                        $toastElement.append($titleElement);\n                    }\n                }\n\n                function setMessage() {\n                    if (map.message) {\n                        $messageElement.append(map.message).addClass(options.messageClass);\n                        $toastElement.append($messageElement);\n                    }\n                }\n\n                function setCloseButton() {\n                    if (options.closeButton) {\n                        $closeElement.addClass('toast-close-button').attr('role', 'button');\n                        $toastElement.prepend($closeElement);\n                    }\n                }\n\n                function setProgressBar() {\n                    if (options.progressBar) {\n                        $progressElement.addClass('toast-progress');\n                        $toastElement.prepend($progressElement);\n                    }\n                }\n\n                function shouldExit(options, map) {\n                    if (options.preventDuplicates) {\n                        if (map.message === previousToast) {\n                            return true;\n                        } else {\n                            previousToast = map.message;\n                        }\n                    }\n                    return false;\n                }\n\n                function hideToast(override) {\n                    if ($(':focus', $toastElement).length && !override) {\n                        return;\n                    }\n                    clearTimeout(progressBar.intervalId);\n                    return $toastElement[options.hideMethod]({\n                        duration: options.hideDuration,\n                        easing: options.hideEasing,\n                        complete: function () {\n                            removeToast($toastElement);\n                            if (options.onHidden && response.state !== 'hidden') {\n                                options.onHidden();\n                            }\n                            response.state = 'hidden';\n                            response.endTime = new Date();\n                            publish(response);\n                        }\n                    });\n                }\n\n                function delayedHideToast() {\n                    if (options.timeOut > 0 || options.extendedTimeOut > 0) {\n                        intervalId = setTimeout(hideToast, options.extendedTimeOut);\n                        progressBar.maxHideTime = parseFloat(options.extendedTimeOut);\n                        progressBar.hideEta = new Date().getTime() + progressBar.maxHideTime;\n                    }\n                }\n\n                function stickAround() {\n                    clearTimeout(intervalId);\n                    progressBar.hideEta = 0;\n                    $toastElement.stop(true, true)[options.showMethod](\n                        {duration: options.showDuration, easing: options.showEasing}\n                    );\n                }\n\n                function updateProgress() {\n                    var percentage = ((progressBar.hideEta - (new Date().getTime())) / progressBar.maxHideTime) * 100;\n                    $progressElement.width(percentage + '%');\n                }\n            }\n\n            function getOptions() {\n                return $.extend({}, getDefaults(), toastr.options);\n            }\n\n            function removeToast($toastElement) {\n                if (!$container) { $container = getContainer(); }\n                if ($toastElement.is(':visible')) {\n                    return;\n                }\n                $toastElement.remove();\n                $toastElement = null;\n                if ($container.children().length === 0) {\n                    $container.remove();\n                    previousToast = undefined;\n                }\n            }\n\n        })();\n    });\n}(typeof define === 'function' && define.amd ? define : function (deps, factory) {\n    if (typeof module !== 'undefined' && module.exports) { //Node\n        module.exports = factory(require('jquery'));\n    } else {\n        window['toastr'] = factory(window['jQuery']);\n    }\n}));\n"],"sourceRoot":"/source/"}
</file>

<file path="payisp/js/toastr.min.js">
!function(e){e(["jquery"],function(e){return function(){function t(e,t,n){return f({type:O.error,iconClass:g().iconClasses.error,message:e,optionsOverride:n,title:t})}function n(t,n){return t||(t=g()),v=e("#"+t.containerId),v.length?v:(n&&(v=c(t)),v)}function i(e,t,n){return f({type:O.info,iconClass:g().iconClasses.info,message:e,optionsOverride:n,title:t})}function o(e){w=e}function s(e,t,n){return f({type:O.success,iconClass:g().iconClasses.success,message:e,optionsOverride:n,title:t})}function a(e,t,n){return f({type:O.warning,iconClass:g().iconClasses.warning,message:e,optionsOverride:n,title:t})}function r(e){var t=g();v||n(t),l(e,t)||u(t)}function d(t){var i=g();return v||n(i),t&&0===e(":focus",t).length?void h(t):void(v.children().length&&v.remove())}function u(t){for(var n=v.children(),i=n.length-1;i>=0;i--)l(e(n[i]),t)}function l(t,n){return t&&0===e(":focus",t).length?(t[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){h(t)}}),!0):!1}function c(t){return v=e("<div/>").attr("id",t.containerId).addClass(t.positionClass).attr("aria-live","polite").attr("role","alert"),v.appendTo(e(t.target)),v}function p(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",closeHtml:'<button type="button">&times;</button>',newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function m(e){w&&w(e)}function f(t){function i(t){return!e(":focus",l).length||t?(clearTimeout(O.intervalId),l[r.hideMethod]({duration:r.hideDuration,easing:r.hideEasing,complete:function(){h(l),r.onHidden&&"hidden"!==b.state&&r.onHidden(),b.state="hidden",b.endTime=new Date,m(b)}})):void 0}function o(){(r.timeOut>0||r.extendedTimeOut>0)&&(u=setTimeout(i,r.extendedTimeOut),O.maxHideTime=parseFloat(r.extendedTimeOut),O.hideEta=(new Date).getTime()+O.maxHideTime)}function s(){clearTimeout(u),O.hideEta=0,l.stop(!0,!0)[r.showMethod]({duration:r.showDuration,easing:r.showEasing})}function a(){var e=(O.hideEta-(new Date).getTime())/O.maxHideTime*100;f.width(e+"%")}var r=g(),d=t.iconClass||r.iconClass;if("undefined"!=typeof t.optionsOverride&&(r=e.extend(r,t.optionsOverride),d=t.optionsOverride.iconClass||d),r.preventDuplicates){if(t.message===C)return;C=t.message}T++,v=n(r,!0);var u=null,l=e("<div/>"),c=e("<div/>"),p=e("<div/>"),f=e("<div/>"),w=e(r.closeHtml),O={intervalId:null,hideEta:null,maxHideTime:null},b={toastId:T,state:"visible",startTime:new Date,options:r,map:t};return t.iconClass&&l.addClass(r.toastClass).addClass(d),t.title&&(c.append(t.title).addClass(r.titleClass),l.append(c)),t.message&&(p.append(t.message).addClass(r.messageClass),l.append(p)),r.closeButton&&(w.addClass("toast-close-button").attr("role","button"),l.prepend(w)),r.progressBar&&(f.addClass("toast-progress"),l.prepend(f)),l.hide(),r.newestOnTop?v.prepend(l):v.append(l),l[r.showMethod]({duration:r.showDuration,easing:r.showEasing,complete:r.onShown}),r.timeOut>0&&(u=setTimeout(i,r.timeOut),O.maxHideTime=parseFloat(r.timeOut),O.hideEta=(new Date).getTime()+O.maxHideTime,r.progressBar&&(O.intervalId=setInterval(a,10))),l.hover(s,o),!r.onclick&&r.tapToDismiss&&l.click(i),r.closeButton&&w&&w.click(function(e){e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble&&e.cancelBubble!==!0&&(e.cancelBubble=!0),i(!0)}),r.onclick&&l.click(function(){r.onclick(),i()}),m(b),r.debug&&console&&console.log(b),l}function g(){return e.extend({},p(),b.options)}function h(e){v||(v=n()),e.is(":visible")||(e.remove(),e=null,0===v.children().length&&(v.remove(),C=void 0))}var v,w,C,T=0,O={error:"error",info:"info",success:"success",warning:"warning"},b={clear:r,remove:d,error:t,getContainer:n,info:i,options:{},subscribe:o,success:s,version:"2.1.0",warning:a};return b}()})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.toastr=t(window.jQuery)});
//# sourceMappingURL=toastr.js.map
</file>

<file path="payisp/src/certificado.php">
<?php 
class CertificadoA1Payisp
{
    private $arquivoPfx;
    private $senha;

    public function __construct($arquivoPfx, $senha)
    {
        $this->arquivoPfx = $arquivoPfx;
        $this->senha = $senha;
    }

    public function extrairChaves()
    {
        $certs = [];
        if (openssl_pkcs12_read(file_get_contents($this->arquivoPfx), $certs, $this->senha)) {
            return [
                'chave_privada' => $certs['pkey'],
                'certificado_publico' => $certs['cert']
            ];
        } else {
            throw new Exception("No foi possvel ler o arquivo PFX/P12. Verifique a senha e o arquivo.");
        }
    }
}
</file>

<file path="payisp/src/MySQLDump.php">
<?php

/**
 * MySQL database dump.
 *
 * @author     David Grudl (http://davidgrudl.com)
 * @copyright  Copyright (c) 2008 David Grudl
 * @license    New BSD License
 */
class MySQLDump
{
	const MAX_SQL_SIZE = 1e6;

	const NONE = 0;
	const DROP = 1;
	const CREATE = 2;
	const DATA = 4;
	const TRIGGERS = 8;
	const ALL = 15; // DROP | CREATE | DATA | TRIGGERS

	/** @var array */
	public $tables = [
		'*' => self::ALL,
	];

	/** @var mysqli */
	private $connection;


	/**
	 * Connects to database.
	 * @param  mysqli connection
	 */
	public function __construct(mysqli $connection, $charset = 'utf8')
	{
		$this->connection = $connection;

		if ($connection->connect_errno) {
			throw new Exception($connection->connect_error);

		} elseif (!$connection->set_charset($charset)) { // was added in MySQL 5.0.7 and PHP 5.0.5, fixed in PHP 5.1.5)
			throw new Exception($connection->error);
		}
	}


	/**
	 * Saves dump to the file.
	 * @param  string filename
	 * @return void
	 */
	public function save($file)
	{
		$handle = strcasecmp(substr($file, -3), '.gz') ? fopen($file, 'wb') : gzopen($file, 'wb');
		if (!$handle) {
			throw new Exception("ERROR: Cannot write file '$file'.");
		}
		$this->write($handle);
	}


	/**
	 * Writes dump to logical file.
	 * @param  resource
	 * @return void
	 */
	public function write($handle = null)
	{
		if ($handle === null) {
			$handle = fopen('php://output', 'wb');
		} elseif (!is_resource($handle) || get_resource_type($handle) !== 'stream') {
			throw new Exception('Argument must be stream resource.');
		}

		$tables = $views = [];

		$res = $this->connection->query('SHOW FULL TABLES');
		while ($row = $res->fetch_row()) {
			if ($row[1] === 'VIEW') {
				$views[] = $row[0];
			} else {
				$tables[] = $row[0];
			}
		}
		$res->close();

		$tables = array_merge($tables, $views); // views must be last

		$this->connection->query('LOCK TABLES `' . implode('` READ, `', $tables) . '` READ');

		$db = $this->connection->query('SELECT DATABASE()')->fetch_row();
		fwrite($handle, '-- Created at ' . date('j.n.Y G:i') . " using David Grudl MySQL Dump Utility\n"
			. (isset($_SERVER['HTTP_HOST']) ? "-- Host: $_SERVER[HTTP_HOST]\n" : '')
			. '-- MySQL Server: ' . $this->connection->server_info . "\n"
			. '-- Database: ' . $db[0] . "\n"
			. "\n"
			. "SET NAMES utf8;\n"
			. "SET SQL_MODE='NO_AUTO_VALUE_ON_ZERO';\n"
			. "SET FOREIGN_KEY_CHECKS=0;\n"
			. "SET UNIQUE_CHECKS=0;\n"
			. "SET AUTOCOMMIT=0;\n"
		);

		foreach ($tables as $table) {
			$this->dumpTable($handle, $table);
		}

		fwrite($handle, "COMMIT;\n");
		fwrite($handle, "-- THE END\n");

		$this->connection->query('UNLOCK TABLES');
	}


	/**
	 * Dumps table to logical file.
	 * @param  resource
	 * @return void
	 */
	public function dumpTable($handle, $table)
	{
		$mode = isset($this->tables[$table]) ? $this->tables[$table] : $this->tables['*'];
		if ($mode === self::NONE) {
			return;
		}

		$delTable = $this->delimite($table);
		$res = $this->connection->query("SHOW CREATE TABLE $delTable");
		$row = $res->fetch_assoc();
		$res->close();

		fwrite($handle, "-- --------------------------------------------------------\n\n");

		$view = isset($row['Create View']);

		if ($mode & self::DROP) {
			fwrite($handle, 'DROP ' . ($view ? 'VIEW' : 'TABLE') . " IF EXISTS $delTable;\n\n");
		}

		if ($mode & self::CREATE) {
			fwrite($handle, $row[$view ? 'Create View' : 'Create Table'] . ";\n\n");
		}

		if (!$view && ($mode & self::DATA)) {
			fwrite($handle, 'ALTER ' . ($view ? 'VIEW' : 'TABLE') . ' ' . $delTable . " DISABLE KEYS;\n\n");
			$numeric = [];
			$res = $this->connection->query("SHOW COLUMNS FROM $delTable");
			$cols = [];
			while ($row = $res->fetch_assoc()) {
				$col = $row['Field'];
				$cols[] = $this->delimite($col);
				$numeric[$col] = (bool) preg_match('#^[^(]*(BYTE|COUNTER|SERIAL|INT|LONG$|CURRENCY|REAL|MONEY|FLOAT|DOUBLE|DECIMAL|NUMERIC|NUMBER)#i', $row['Type']);
			}
			$cols = '(' . implode(', ', $cols) . ')';
			$res->close();


			$size = 0;
			$res = $this->connection->query("SELECT * FROM $delTable", MYSQLI_USE_RESULT);
			while ($row = $res->fetch_assoc()) {
				$s = '(';
				foreach ($row as $key => $value) {
					if ($value === null) {
						$s .= "NULL,\t";
					} elseif ($numeric[$key]) {
						$s .= $value . ",\t";
					} else {
						$s .= "'" . $this->connection->real_escape_string($value) . "',\t";
					}
				}

				if ($size == 0) {
					$s = "INSERT INTO $delTable $cols VALUES\n$s";
				} else {
					$s = ",\n$s";
				}

				$len = strlen($s) - 1;
				$s[$len - 1] = ')';
				fwrite($handle, $s, $len);

				$size += $len;
				if ($size > self::MAX_SQL_SIZE) {
					fwrite($handle, ";\n");
					$size = 0;
				}
			}

			$res->close();
			if ($size) {
				fwrite($handle, ";\n");
			}
			fwrite($handle, 'ALTER ' . ($view ? 'VIEW' : 'TABLE') . ' ' . $delTable . " ENABLE KEYS;\n\n");
			fwrite($handle, "\n");
		}

		if ($mode & self::TRIGGERS) {
			$res = $this->connection->query("SHOW TRIGGERS LIKE '" . $this->connection->real_escape_string($table) . "'");
			if ($res->num_rows) {
				fwrite($handle, "DELIMITER ;;\n\n");
				while ($row = $res->fetch_assoc()) {
					fwrite($handle, "CREATE TRIGGER {$this->delimite($row['Trigger'])} $row[Timing] $row[Event] ON $delTable FOR EACH ROW\n$row[Statement];;\n\n");
				}
				fwrite($handle, "DELIMITER ;\n\n");
			}
			$res->close();
		}

		fwrite($handle, "\n");
	}


	private function delimite($s)
	{
		return '`' . str_replace('`', '``', $s) . '`';
	}
}
</file>

<file path="payisp/src/MySQLImport.php">
<?php

/**
 * MySQL database dump loader.
 *
 * @author     David Grudl (http://davidgrudl.com)
 * @copyright  Copyright (c) 2008 David Grudl
 * @license    New BSD License
 */
class MySQLImport
{
	/** @var callable  function (int $count, ?float $percent): void */
	public $onProgress;

	/** @var mysqli */
	private $connection;


	/**
	 * Connects to database.
	 * @param  mysqli connection
	 */
	public function __construct(mysqli $connection, $charset = 'utf8')
	{
		$this->connection = $connection;

		if ($connection->connect_errno) {
			throw new Exception($connection->connect_error);

		} elseif (!$connection->set_charset($charset)) { // was added in MySQL 5.0.7 and PHP 5.0.5, fixed in PHP 5.1.5)
			throw new Exception($connection->error);
		}
	}


	/**
	 * Loads dump from the file.
	 * @param  string filename
	 * @return int
	 */
	public function load($file)
	{
		$handle = strcasecmp(substr($file, -3), '.gz') ? fopen($file, 'rb') : gzopen($file, 'rb');
		if (!$handle) {
			throw new Exception("ERROR: Cannot open file '$file'.");
		}
		return $this->read($handle);
	}


	/**
	 * Reads dump from logical file.
	 * @param  resource
	 * @return int
	 */
	public function read($handle)
	{
		if (!is_resource($handle) || get_resource_type($handle) !== 'stream') {
			throw new Exception('Argument must be stream resource.');
		}

		$stat = fstat($handle);

		$sql = '';
		$delimiter = ';';
		$count = $size = 0;

		while (!feof($handle)) {
			$s = fgets($handle);
			$size += strlen($s);
			if (strtoupper(substr($s, 0, 10)) === 'DELIMITER ') {
				$delimiter = trim(substr($s, 10));

			} elseif (substr($ts = rtrim($s), -strlen($delimiter)) === $delimiter) {
				$sql .= substr($ts, 0, -strlen($delimiter));
				if (!$this->connection->query($sql)) {
					throw new Exception($this->connection->error . ': ' . $sql);
				}
				$sql = '';
				$count++;
				if ($this->onProgress) {
					call_user_func($this->onProgress, $count, isset($stat['size']) ? $size * 100 / $stat['size'] : null);
				}

			} else {
				$sql .= $s;
			}
		}

		if (rtrim($sql) !== '') {
			$count++;
			if (!$this->connection->query($sql)) {
				throw new Exception($this->connection->error . ': ' . $sql);
			}
			if ($this->onProgress) {
				call_user_func($this->onProgress, $count, isset($stat['size']) ? 100 : null);
			}
		}

		return $count;
	}
}
</file>

<file path="payisp/src/nfcom_cert.php">
<?php

class AssinadorNFCom
{
    /** @var resource|OpenSSLAsymmetricKey|null Chave Privada */
    private $privateKey;
    
    /** @var string|null Certificado pblico formatado (Base64 puro) */
    private $certificado;

    // Propriedades de configurao baseadas na sua funo
    private $URLdsig = 'http://www.w3.org/2000/09/xmldsig#';
    private $URLCanonMeth = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315';
    private $URLSigMeth = 'http://www.w3.org/2000/09/xmldsig#rsa-sha1';
    private $URLTransfMeth_1 = 'http://www.w3.org/2000/09/xmldsig#enveloped-signature';
    private $URLTransfMeth_2 = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315';
    private $URLDigestMeth = 'http://www.w3.org/2000/09/xmldsig#sha1';

    /**
     * Limpa a string do certificado, removendo cabealhos (lgica da sua funo __cleanCerts)
     * @param string $cert Contedo do certificado
     * @return string
     * @throws \Exception
     */
    private function formatarCertificado($cert)
    {
        $cert = str_replace("-----BEGIN CERTIFICATE-----", "", $cert);
        $cert = str_replace("-----END CERTIFICATE-----", "", $cert);
        $cert = str_replace(array("\n", "\r"), "", $cert);
        $certLimpo = trim($cert);

        if (empty($certLimpo)) {
            throw new \Exception(
                "O contedo do certificado (X509Certificate) est vazio ou em formato invlido. " .
                "Verifique se o arquivo .crt  um PEM vlido (iniciando com '-----BEGIN CERTIFICATE-----')."
            );
        }
        return $certLimpo;
    }

    /**
     * Carrega o certificado e a chave privada de arquivos separados (.crt, .key).
     *
     * @param string $caminhoCert Caminho para o arquivo .crt (certificado pblico)
     * @param string $caminhoChave Caminho para o arquivo .key (chave privada)
     * @param string|null $senhaChave Senha da chave privada, se houver.
     * @return bool
     * @throws \Exception
     */
    public function carregarChaves($caminhoCert, $caminhoChave, $senhaChave = null)
    {
        if (!file_exists($caminhoCert)) {
            throw new \Exception("Arquivo de certificado (.crt) no encontrado em: $caminhoCert");
        }
        if (!file_exists($caminhoChave)) {
            throw new \Exception("Arquivo de chave privada (.key) no encontrado em: $caminhoChave");
        }

        $certContent = file_get_contents($caminhoCert);
        $keyContent = file_get_contents($caminhoChave);

        // Carrega a chave privada
        $privateKeyResource = openssl_get_privatekey($keyContent, $senhaChave);
        if ($privateKeyResource === false) {
            $error = "No foi possvel ler a chave privada. Verifique a senha ou o formato do arquivo.";
            while ($msg = openssl_error_string()) { $error .= "\n" . $msg; }
            throw new \Exception($error);
        }

        // Formata e armazena
        $this->privateKey = $privateKeyResource;
        $this->certificado = $this->formatarCertificado($certContent);

        return true;
    }

    /**
     * Assina o XML da NFCom usando a lgica nativa do PHP (adaptada da sua funo).
     *
     * @param NFCom $nfcom Objeto NFCom preenchido
     * @return string XML assinado
     * @throws \Exception
     */
    public function assinar($docxml,$tagid = 'infNFCom')
    {
        if (empty($this->privateKey) || empty($this->certificado)) {
            throw new \Exception("Certificado ou Chave Privada no carregados. Chame carregarChaves() primeiro.");
        }

        // 2. Limpeza e carregamento do DOM
        $order = array("\r\n", "\n", "\r", "\t");
        $replace = '';
        $docxml = str_replace($order, $replace, $docxml);

        $xmldoc = new DOMDocument();
        $xmldoc->preserveWhiteSpace = false; // Importante
        $xmldoc->formatOutput = false;
        
        if (!$xmldoc->loadXML($docxml, LIBXML_NOBLANKS | LIBXML_NOEMPTYTAG)) {
            throw new \Exception("Falha ao carregar o XML gerado no DOMDocument.");
        }

        $root = $xmldoc->documentElement;

        // 3. Encontra o n a ser assinado e seu ID
        $node = $xmldoc->getElementsByTagName($tagid)->item(0);
        if (!$node) {
             throw new \Exception("Tag <$tagid> no encontrada no XML.");
        }

        $id = trim($node->getAttribute("Id"));
        if (empty($id)) {
             throw new \Exception("Tag <$tagid> no possui atributo 'Id'.");
        }
        
        // 4. Calcula o Digest (Hash SHA-1) do n
        // C14N = Canonicalizao (normalizao) do n
        $dados = $node->C14N(false, false, NULL, NULL);
        $hashValue = hash('sha1', $dados, true);
        $digValue = base64_encode($hashValue);

        // 5. Monta a estrutura da assinatura (bloco <SignedInfo>)
        $Signature = $xmldoc->createElementNS($this->URLdsig, 'Signature');
        $root->appendChild($Signature);
        $SignedInfo = $xmldoc->createElement('SignedInfo');
        $Signature->appendChild($SignedInfo);

        // 5a. CanonicalizationMethod
        $newNode = $xmldoc->createElement('CanonicalizationMethod');
        $SignedInfo->appendChild($newNode);
        $newNode->setAttribute('Algorithm', $this->URLCanonMeth);

        // 5b. SignatureMethod
        $newNode = $xmldoc->createElement('SignatureMethod');
        $SignedInfo->appendChild($newNode);
        $newNode->setAttribute('Algorithm', $this->URLSigMeth);

        // 5c. Reference
        $Reference = $xmldoc->createElement('Reference');
        $SignedInfo->appendChild($Reference);
        $Reference->setAttribute('URI', '#'.$id); // Referencia o ID da tag <infNFCom>

        // 5d. Transforms
        $Transforms = $xmldoc->createElement('Transforms');
        $Reference->appendChild($Transforms);
        
        $newNode = $xmldoc->createElement('Transform');
        $Transforms->appendChild($newNode);
        $newNode->setAttribute('Algorithm', $this->URLTransfMeth_1);
        
        $newNode = $xmldoc->createElement('Transform');
        $Transforms->appendChild($newNode);
        $newNode->setAttribute('Algorithm', $this->URLTransfMeth_2);

        // 5e. DigestMethod
        $newNode = $xmldoc->createElement('DigestMethod');
        $Reference->appendChild($newNode);
        $newNode->setAttribute('Algorithm', $this->URLDigestMeth);

        // 5f. DigestValue
        $newNode = $xmldoc->createElement('DigestValue', $digValue);
        $Reference->appendChild($newNode);

        // 6. Calcula a Assinatura (Signature) do <SignedInfo>
        $dados = $SignedInfo->C14N(false, false, NULL, NULL);
        
        $signature = '';
        if (!openssl_sign($dados, $signature, $this->privateKey)) {
             throw new \Exception("Falha ao assinar os dados com openssl_sign(). Verifique a chave privada.");
        }
        
        $signatureValue = base64_encode($signature);

        // 7. Adiciona os ns restantes  assinatura
        
        // 7a. SignatureValue
        $newNode = $xmldoc->createElement('SignatureValue', $signatureValue);
        $Signature->appendChild($newNode);

        // 7b. KeyInfo
        $KeyInfo = $xmldoc->createElement('KeyInfo');
        $Signature->appendChild($KeyInfo);

        // 7c. X509Data
        $X509Data = $xmldoc->createElement('X509Data');
        $KeyInfo->appendChild($X509Data);

        // 7d. X509Certificate (Aqui estava o erro anterior)
        // Usamos a propriedade $this->certificado que j foi carregada e formatada
        $newNode = $xmldoc->createElement('X509Certificate', $this->certificado);
        $X509Data->appendChild($newNode);

        // 8. Retorna o XML completo e assinado
        $docxml = $xmldoc->saveXML($xmldoc->documentElement);
        
        // ** 8. CORREO (Erro 599): Minifica o XML de SADA **
        // O saveXML() adiciona quebras de linha. Removemos tudo aqui.
        $docxml = str_replace($order, $replace, $docxml);
        $docxml = preg_replace('/>\s+</', '><', $docxml);
        
        // 9. Retorna o XML assinado e minificado
        return $docxml;
    }

    /**
     * Destrutor para liberar o recurso da chave privada
     */
    public function __destruct()
    {
        if (is_resource($this->privateKey)) {
            //openssl_free_key($this->privateKey);
            $this->privateKey = null;
        }
    }
}
</file>

<file path="payisp/src/nfcom_engine.php">
<?php

/**
 * ===================================================================
 * CLASSES DE DADOS DA NFCom
 * ===================================================================
 * Estas classes (POPOs) servem para armazenar os dados da nota,
 * espelhando a hierarquia do XML.
 */

class InfNFCom
{
    /** @var string */
    public $versao = '1.00';
    /** @var string */
    public $Id;
    /** @var Ide */
    public $ide;
    /** @var Emit */
    public $emit;
    /** @var Dest */
    public $dest;
    /** @var Assinante */
    public $assinante;
    /** @var Det[] */
    public $det = [];
    /** @var Total */
    public $total;
    /** @var object|null (gFat ou gFatCentral) */
    public $faturamento; // Usar GFat ou GFatCentral
    /** @var InfAdic|null */
    public $infAdic;
    /** @var AutXML[] */
    public $autXML = [];
    /** @var GRespTec|null */
    public $gRespTec;

    public function __construct()
    {
        $this->ide = new Ide();
        $this->emit = new Emit();
        $this->dest = new Dest();
        $this->assinante = new Assinante();
        $this->total = new Total();
        $this->infAdic = new InfAdic();
    }

    /** @param Det $item */
    public function addDet(Det $item)
    {
        $this->det[] = $item;
    }
}

class Ide
{
    /** @var string */
    public $cUF;
    /** @var int */
    public $tpAmb;
    /** @var string */
    public $mod = '62';
    /** @var string */
    public $serie;
    /** @var string */
    public $nNF;
    /** @var string */
    public $cNF;
    /** @var string|null */
    public $cDV;
    /** @var string */
    public $dhEmi;
    /** @var int */
    public $tpEmis;
    /** @var string */
    public $nSiteAutoriz = '0';
    /** @var string */
    public $cMunFG;
    /** @var int */
    public $finNFCom;
    /** @var int */
    public $tpFat;
    /** @var string */
    public $verProc;
    /** @var string|null */
    public $dhCont;
    /** @var string|null */
    public $xJust;
}

class Emit
{
    /** @var string */
    public $CNPJ;
    /** @var string */
    public $IE;
    /** @var string|null */
    public $IEUFDest;
    /** @var int */
    public $CRT;
    /** @var string */
    public $xNome;
    /** @var string|null */
    public $xFant;
    /** @var Endereco */
    public $enderEmit;

    public function __construct()
    {
        $this->enderEmit = new Endereco();
    }
}

class Dest
{
    /** @var string */
    public $xNome;
    /** @var string|null */
    public $CNPJ;
    /** @var string|null */
    public $CPF;
    /** @var string|null */
    public $idOutros;
    /** @var int */
    public $indIEDest;
    /** @var string|null */
    public $IE;
    /** @var string|null */
    public $IM;
    /** @var Endereco */
    public $enderDest;

    public function __construct()
    {
        $this->enderDest = new Endereco();
    }
}

class Endereco
{
    /** @var string */
    public $xLgr;
    /** @var string */
    public $nro;
    /** @var string|null */
    public $xCpl;
    /** @var string */
    public $xBairro;
    /** @var string */
    public $cMun;
    /** @var string */
    public $xMun;
    /** @var string */
    public $CEP;
    /** @var string */
    public $UF;
    /** @var string|null */
    public $fone;
    /** @var string|null */
    public $email;
}

class Assinante
{
    /** @var string */
    public $iCodAssinante;
    /** @var int */
    public $tpAssinante;
    /** @var int */
    public $tpServUtil;
    /** @var string|null */
    public $nContrato;
    /** @var string|null */
    public $dContratoIni;
    /** @var string|null */
    public $dContratoFim;
    /** @var string|null */
    public $NroTermPrinc;
    /** @var string|null */
    public $cUFPrinc; // cUF do NroTermPrinc
}

class Det
{
    /** @var int */
    public $nItem;
    /** @var Prod */
    public $prod;
    /** @var Imposto */
    public $imposto;
    /** @var string|null */
    public $infAdProd;

    public function __construct($nItem)
    {
        $this->nItem = $nItem;
        $this->prod = new Prod();
        $this->imposto = new Imposto();
    }
}

class Prod
{
    /** @var string */
    public $cProd;
    /** @var string */
    public $xProd;
    /** @var string */
    public $cClass;
    /** @var string|null */
    public $CFOP;
    /** @var string|null */
    public $CNPJLD;
    /** @var int */
    public $uMed;
    /** @var float */
    public $qFaturada;
    /** @var float */
    public $vItem;
    /** @var float|null */
    public $vDesc;
    /** @var float|null */
    public $vOutro;
    /** @var float */
    public $vProd;
    /** @var string|null */
    public $dExpiracao;
    /** @var int|null */
    public $indDevolucao;
}

class Imposto
{
    /** @var object (Icms00, Icms20, Icms40, Icms51, Icms90, IcmsSN) */
    public $icms;
    /** @var Pis */
    public $PIS;
    /** @var Cofins */
    public $COFINS;
    /** @var Fust|null */
    public $FUST;
    /** @var Funttel|null */
    public $FUNTTEL;
    /** @var RetTrib|null */
    public $retTrib;

    public function __construct()
    {
        $this->PIS = new Pis();
        $this->COFINS = new Cofins();
        $this->FUST = new Fust();
        $this->FUNTTEL = new Funttel();
        $this->retTrib = new RetTrib();
    }
}

// --- Classes de Impostos ---

class IcmsSN
{
    /** @var string */
    public $CST;
    /** @var int */
    public $indSN;
}

class Pis
{
    /** @var string */
    public $CST;
    /** @var float */
    public $vBC;
    /** @var float */
    public $pPIS;
    /** @var float */
    public $vPIS;
}

class Cofins
{
    /** @var string */
    public $CST;
    /** @var float */
    public $vBC;
    /** @var float */
    public $pCOFINS;
    /** @var float */
    public $vCOFINS;
}

class Fust
{
    /** @var float */
    public $vBC;
    /** @var float */
    public $pFUST;
    /** @var float */
    public $vFUST;
}

class Funttel
{
    /** @var float */
    public $vBC;
    /** @var float */
    public $pFUNTTEL;
    /** @var float */
    public $vFUNTTEL;
}

class RetTrib
{
    /** @var float */
    public $vRetPIS;
    /** @var float */
    public $vRetCofins;
    /** @var float */
    public $vRetCSLL;
    /** @var float */
    public $vBCIRRF;
    /** @var float */
    public $vIRRF;
}

// --- Fim Classes de Impostos ---

class Total
{
    /** @var float */
    public $vProd;
    /** @var IcmsTot */
    public $ICMSTot;
    /** @var float */
    public $vCOFINS;
    /** @var float */
    public $vPIS;
    /** @var float */
    public $vFUNTTEL;
    /** @var float */
    public $vFUST;
    /** @var RetTribTot */
    public $vRetTribTot;
    /** @var float */
    public $vDesc;
    /** @var float */
    public $vOutro;
    /** @var float */
    public $vNF;

    public function __construct()
    {
        $this->ICMSTot = new IcmsTot();
        $this->vRetTribTot = new RetTribTot();
    }
}

class IcmsTot
{
    /** @var float */
    public $vBC;
    /** @var float */
    public $vICMS;
    /** @var float */
    public $vICMSDeson;
    /** @var float */
    public $vFCP;
}

class RetTribTot
{
    /** @var float */
    public $vRetPIS;
    /** @var float */
    public $vRetCofins;
    /** @var float */
    public $vRetCSLL;
    /** @var float */
    public $vIRRF;
}

class GPIX
{
    /** @var string */
    public $urlQRCodePIX;
}

class GFat
{
    /** @var string */
    public $CompetFat;
    /** @var string */
    public $dVencFat;
    /** @var string|null */
    public $dPerUsoIni;
    /** @var string|null */
    public $dPerUsoFim;
    /** @var string|null */
    public $codBarras;
    /** @var string|null */
    public $codDebAuto;
    /** @var string|null */
    public $codBanco;
    /** @var string|null */
    public $codAgencia;
    /** @var GPIX|null */
    public $gPIX;

    public function __construct()
    {
        $this->gPIX = null;
    }
}

class InfAdic
{
    /** @var string|null */
    public $infAdFisco;
    /** @var string|null */
    public $infCpl;
}

class InfNFComSupl
{
    /** @var string */
    public $qrCodNFCom;
}
</file>

<file path="payisp/src/nfcom_eventos.php">
<?php

/**
 * ===================================================================
 * CLASSES DE DADOS E BUILDER DO EVENTO NFCom
 * ===================================================================
 */

/**
 * POPO: Representa a tag <infEvento>
 */
class InfEvento
{
    /** @var string */
    public $Id;
    /** @var string */
    public $cOrgao;
    /** @var int */
    public $tpAmb;
    /** @var string */
    public $CNPJ;
    /** @var string */
    public $chNFCom;
    /** @var string */
    public $dhEvento;
    /** @var string */
    public $tpEvento;
    /** @var int */
    public $nSeqEvento = 1;
    /** @var DetEvento */
    public $detEvento;

    public function __construct()
    {
        $this->detEvento = new DetEvento();
    }
}

/**
 * POPO: Representa a tag <detEvento>
 */
class DetEvento
{
    /** @var string */
    public $versaoEvento;
    /** @var object */
    public $eventoEspecifico; // Objeto EvCancNFCom
}

/**
 * POPO: Representa a tag <evCancNFCom> (o evento especfico de cancelamento)
 */
class EvCancNFCom
{
    /** @var string */
    public $descEvento = "Cancelamento";
    /** @var string */
    public $nProt;
    /** @var string */
    public $xJust;
}


/**
 * Classe que constri o XML de evento (no assinado)
 */
class EventoBuilder
{
    /**
     * Gera o XML de evento (ainda no assinado)
     *
     * @param InfEvento $infEvento
     * @return string XML no assinado
     * @throws \Exception
     */
    public function gerarXml(InfEvento $infEvento)
    {
        if (empty($infEvento->tpEvento) || empty($infEvento->chNFCom)) {
            throw new \Exception("tpEvento e chNFCom so obrigatrios.");
        }
        
        $nSeqFormatado = str_pad($infEvento->nSeqEvento, 3, '0', STR_PAD_LEFT);
        $infEvento->Id = "ID" . $infEvento->tpEvento . $infEvento->chNFCom . $nSeqFormatado;

        $dom = new \DOMDocument("1.0", "UTF-8");
        $dom->preserveWhiteSpace = false;
        $dom->formatOutput = false;

        $eventoNFCom = $dom->createElement("eventoNFCom");
        $eventoNFCom->setAttribute("xmlns", "http://www.portalfiscal.inf.br/nfcom");
        $eventoNFCom->setAttribute("versao", "1.00");
        $dom->appendChild($eventoNFCom);
        
        $infEventoNode = $dom->createElement("infEvento");
        $infEventoNode->setAttribute("Id", $infEvento->Id);
        
        $infEventoNode->appendChild($dom->createElement('cOrgao', $infEvento->cOrgao));
        $infEventoNode->appendChild($dom->createElement('tpAmb', $infEvento->tpAmb));
        $infEventoNode->appendChild($dom->createElement('CNPJ', $infEvento->CNPJ));
        $infEventoNode->appendChild($dom->createElement('chNFCom', $infEvento->chNFCom));
        $infEventoNode->appendChild($dom->createElement('dhEvento', $infEvento->dhEvento));
        $infEventoNode->appendChild($dom->createElement('tpEvento', $infEvento->tpEvento));
        $infEventoNode->appendChild($dom->createElement('nSeqEvento', $infEvento->nSeqEvento));
        
        $detEventoNode = $dom->createElement("detEvento");
        $detEventoNode->setAttribute("versaoEvento", $infEvento->detEvento->versaoEvento);

        if ($infEvento->detEvento->eventoEspecifico instanceof EvCancNFCom) {
            $evCanc = $infEvento->detEvento->eventoEspecifico;
            $evCancNode = $dom->createElement('evCancNFCom');
            $evCancNode->appendChild($dom->createElement('descEvento', $evCanc->descEvento));
            $evCancNode->appendChild($dom->createElement('nProt', $evCanc->nProt));
            $evCancNode->appendChild($dom->createElement('xJust', $evCanc->xJust));
            $detEventoNode->appendChild($evCancNode);
        }

        $infEventoNode->appendChild($detEventoNode);
        $eventoNFCom->appendChild($infEventoNode);
        
        // Salva apenas o n raiz (fragmento) para evitar HTTP 400
        $xmlString = $dom->saveXML($dom->documentElement); 

        // Minifica o XML para evitar Rejeio 599
        $order = array("\r\n", "\n", "\r", "\t");
        $replace = '';
        $xmlString = str_replace($order, $replace, $xmlString);
        return preg_replace('/>\s+</', '><', $xmlString);
    }
}

?>
</file>

<file path="payisp/src/nfcom_tools.php">
<?php

/**
 * NFComClient
 *
 * Classe completa para comunicao com todos os Web Services da NFCom (modelo 62).
 * CORREES APLICADAS:
 * 1. XPath de todas as 4 funes de servio corrigido para '.../nfcomResultMsg'.
 * 2. Adicionado 'minifyXml' para limpar os XMLs de consulta (Status e Situao),
 * corrigindo a Rejeio 599 (caracteres de edio).
 */
class NFComClient
{
    private $endpoints;
    private $caminhoCert;
    private $caminhoKey;
    private $senhaKey;

    public function __construct(array $endpoints)
    {
        $this->endpoints = $endpoints;
    }

    public function setCertificados($caminhoCert, $caminhoKey, $senhaKey = null)
    {
        if (!file_exists($caminhoCert)) {
            throw new \Exception("Arquivo do certificado no encontrado: $caminhoCert");
        }
        if (!file_exists($caminhoKey)) {
            throw new \Exception("Arquivo da chave privada no encontrado: $caminhoKey");
        }
        $this->caminhoCert = $caminhoCert;
        $this->caminhoKey = $caminhoKey;
        $this->senhaKey = $senhaKey;
    }

    // ===================================================================
    // 1. SERVIO: ENVIO DE NFCOM (NFComRecepcao)
    // ===================================================================

    public function enviarNFCom($xmlAssinado, $tpAmb)
    {
        $ambiente = ($tpAmb == 1) ? 'producao' : 'homologacao';
        $servico = 'recepcao';
        $soapAction = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcao/nfcomRecepcao';

        $url = $this->getEndpointUrl($ambiente, $servico);
        $payload = base64_encode(gzencode($xmlAssinado, 9));
        $soapRequest = $this->criarEnvelopeSOAPEnvio($payload);
        $soapResponse = $this->executeCurlRequest($url, $soapRequest, $soapAction);

        // ** XPATH CORRIGIDO **
        $xpathQuery = '//soap:Body/ns1:nfcomResultMsg';
        $namespace = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcao';

        $innerXML = $this->parseSoapResponse($soapResponse, $xpathQuery, $namespace);
        return new \SimpleXMLElement($innerXML);
    }

    private function criarEnvelopeSOAPEnvio($payloadGzipBase64)
    {
        // O payload Gzip j  uma string nica, no precisa minificar.
        $soapEnvelope = <<<SOAP
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
                 xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <nfcomDadosMsg xmlns="http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcao">{$payloadGzipBase64}</nfcomDadosMsg>
  </soap12:Body>
</soap12:Envelope>
SOAP;

        // ** APLICA A CORREO **
        // Minifica o ENVELOPE SOAP para remover quebras de linha e espaos
        // e assim atender  Rejeio 599.
        return $this->minifyXml($soapEnvelope);
    }

    // ===================================================================
    // 2. SERVIO: CONSULTA DE STATUS (NFComStatusServico)
    // ===================================================================

    public function consultarStatus($tpAmb)
    {
        $ambiente = ($tpAmb == 1) ? 'producao' : 'homologacao';
        $servico = 'status_servico';
        $soapAction = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComStatusServico/nfcomStatusServicoNF';

        $url = $this->getEndpointUrl($ambiente, $servico);

        // ** CORREO ERRO 599: Minifica o XML de payload **
        $xmlPayload = $this->criarXmlPayloadStatus($tpAmb);

        $soapRequest = $this->criarEnvelopeSOAPStatus($xmlPayload);
        $soapResponse = $this->executeCurlRequest($url, $soapRequest, $soapAction);

        // ** XPATH CORRIGIDO **
        $xpathQuery = '//soap:Body/ns1:nfcomResultMsg';
        $namespace = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComStatusServico';

        $innerXML = $this->parseSoapResponse($soapResponse, $xpathQuery, $namespace);
        return new \SimpleXMLElement($innerXML);
    }

    private function criarXmlPayloadStatus($tpAmb)
    {
        $xml = <<<XML
<consStatServNFCom xmlns="http://www.portalfiscal.inf.br/nfcom" versao="1.00">
    <tpAmb>{$tpAmb}</tpAmb>
    <xServ>STATUS</xServ>
</consStatServNFCom>
XML;
        // CORREO ERRO 599: Remove quebras de linha e tabs
        return $this->minifyXml($xml);
    }

    private function criarEnvelopeSOAPStatus($xmlPayload)
    {
        // O $xmlPayload j vem minificado
        return $this->minifyXml(<<<SOAP
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
                 xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <nfcomDadosMsg xmlns="http://www.portalfiscal.inf.br/nfcom/wsdl/NFComStatusServico">
      {$xmlPayload}
    </nfcomDadosMsg>
  </soap12:Body>
</soap12:Envelope>
SOAP);
    }

    // ===================================================================
    // 3. SERVIO: CONSULTA DE SITUAO (NFComConsulta)
    // ===================================================================

    public function consultarNFCom($chNFCom, $tpAmb)
    {
        $ambiente = ($tpAmb == 1) ? 'producao' : 'homologacao';
        $servico = 'consulta';
        $soapAction = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComConsulta/nfcomConsultaNF';

        $url = $this->getEndpointUrl($ambiente, $servico);

        // ** CORREO ERRO 599: Minifica o XML de payload **
        $xmlPayload = $this->criarXmlPayloadConsulta($chNFCom, $tpAmb);

        $soapRequest = $this->criarEnvelopeSOAPConsulta($xmlPayload);
        $soapResponse = $this->executeCurlRequest($url, $soapRequest, $soapAction);

        // ** XPATH CORRIGIDO **
        $xpathQuery = '//soap:Body/ns1:nfcomResultMsg';
        $namespace = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComConsulta';

        $innerXML = $this->parseSoapResponse($soapResponse, $xpathQuery, $namespace);
        return new \SimpleXMLElement($innerXML);
    }

    private function criarXmlPayloadConsulta($chNFCom, $tpAmb)
    {
        $xml = <<<XML
<consSitNFCom xmlns="http://www.portalfiscal.inf.br/nfcom" versao="1.00">
    <tpAmb>{$tpAmb}</tpAmb>
    <xServ>CONSULTAR</xServ>
    <chNFCom>{$chNFCom}</chNFCom>
</consSitNFCom>
XML;
        // CORREO ERRO 599: Remove quebras de linha e tabs
        return $this->minifyXml($xml);
    }

    private function criarEnvelopeSOAPConsulta($xmlPayload)
    {
        // O $xmlPayload j vem minificado
        return $this->minifyXml(<<<SOAP
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
                 xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <nfcomDadosMsg xmlns="http://www.portalfiscal.inf.br/nfcom/wsdl/NFComConsulta">
      {$xmlPayload}
    </nfcomDadosMsg>
  </soap12:Body>
</soap12:Envelope>
SOAP);
    }

    // ===================================================================
    // 4. SERVIO: ENVIO DE EVENTO (NFComRecepcaoEvento)
    // ===================================================================

    public function enviarEvento($xmlAssinado, $tpAmb)
    {
        $ambiente = ($tpAmb == 1) ? 'producao' : 'homologacao';
        $servico = 'recepcao_evento';
        $soapAction = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcaoEvento/nfcomRecepcaoEvento';

        $url = $this->getEndpointUrl($ambiente, $servico);
        $soapRequest = $this->criarEnvelopeSOAPEvento($xmlAssinado);
        $soapResponse = $this->executeCurlRequest($url, $soapRequest, $soapAction);

        // ** XPATH CORRIGIDO (sem o ...Response) **
        $xpathQuery = '//soap:Body/ns1:nfcomResultMsg';
        $namespace = 'http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcaoEvento';

        $innerXML = $this->parseSoapResponse($soapResponse, $xpathQuery, $namespace);
        return new \SimpleXMLElement($innerXML);
    }

    private function criarEnvelopeSOAPEvento($xmlPayload)
    {
        // O $xmlPayload (evento assinado) j deve vir minificado
        return $this->minifyXml(<<<SOAP
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
                 xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <nfcomDadosMsg xmlns="http://www.portalfiscal.inf.br/nfcom/wsdl/NFComRecepcaoEvento">
      {$xmlPayload}
    </nfcomDadosMsg>
  </soap12:Body>
</soap12:Envelope>
SOAP);
    }
    
    // ===================================================================
    // MTODOS AUXILIARES (cURL, Parsers, Minify)
    // ===================================================================

    /**
     * Remove quebras de linha, tabs e espaos entre tags
     */
    private function minifyXml($xml)
    {
        $order = array("\r\n", "\n", "\r", "\t");
        $replace = '';
        $xml = str_replace($order, $replace, $xml);
        $xml = preg_replace('/>\s+</', '><', $xml); // Remove espaos entre tags
        return trim($xml);
    }

    /**
     * Centraliza a execuo do cURL (COM CORREO DO SOAP 1.2 HEADER)
     */
    private function executeCurlRequest($url, $soapRequest, $soapAction)
    {
        if (empty($this->caminhoCert) || empty($this->caminhoKey)) {
            throw new \Exception("Certificado e chave privada no foram definidos. Use setCertificados().");
        }

        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $soapRequest);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
        //curl_setopt($ch, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1_2); 
        curl_setopt($ch, CURLOPT_SSLCERT, $this->caminhoCert);
        curl_setopt($ch, CURLOPT_SSLKEY, $this->caminhoKey);
        if ($this->senhaKey) {
            curl_setopt($ch, CURLOPT_SSLKEYPASSWD, $this->senhaKey);
        }

        // Headers do SOAP 1.2: O 'action'  um parmetro do 'Content-Type'
        curl_setopt($ch, CURLOPT_HTTPHEADER, [
            'Content-Type: application/soap+xml; charset=utf-8; action="' . $soapAction . '"'
        ]);

        $soapResponse = curl_exec($ch);

        if (curl_errno($ch)) {
            $error = curl_error($ch);
            curl_close($ch);
            throw new \Exception("Falha na requisio cURL: " . $error);
        }

        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        curl_close($ch);

        if ($httpCode != 200) {
            //throw new \Exception("Servidor retornou cdigo HTTP $httpCode. Resposta: (xml ocultado)");
            throw new \Exception("Servidor retornou cdigo HTTP $httpCode. Resposta: " . ($soapResponse));
        }

        return $soapResponse;
    }

    /**
     * Extrai o XML de resultado de dentro de um envelope SOAP genrico
     */
    private function parseSoapResponse($soapResponse, $xpathQuery, $namespace)
    {
        $dom = new \DOMDocument();
        @$dom->loadXML($soapResponse);

        $xpath = new \DOMXPath($dom);
        $xpath->registerNamespace('soap', 'http://www.w3.org/2003/05/soap-envelope');
        $xpath->registerNamespace('ns1', $namespace);

        // ** XPATH CORRIGIDO ** (Query agora  passada como parmetro e est correta)
        $resultNode = $xpath->query($xpathQuery);

        if ($resultNode->length == 0) {
            $fault = $xpath->query('//soap:Body/soap:Fault');
            if ($fault->length > 0) {
                $reasonNode = $xpath->query('//soap:Fault/soap:Reason/soap:Text');
                $reason = $reasonNode->length > 0 ? $reasonNode->item(0)->nodeValue : 'Razo no informada';
                $codeNode = $xpath->query('//soap:Fault/soap:Code/soap:Value');
                $code = $codeNode->length > 0 ? $codeNode->item(0)->nodeValue : 'Cdigo no informado';
                throw new \Exception("Falha SOAP: $code - $reason");
            }
            throw new \Exception("Tag de resultado no encontrada na resposta SOAP. Query: $xpathQuery. Resposta recebida: " . htmlspecialchars($soapResponse));
        }

        $firstChild = $resultNode->item(0)->firstChild;
        if ($firstChild === null) {
            throw new \Exception("Resposta SOAP vazia ou malformada (o n de resultado estava vazio).");
        }

        return $firstChild->C14N(); // Retorna o XML interno (o <retConsStatServNFCom>)
    }

    /**
     * Busca a URL do endpoint no array de configurao
     */
    private function getEndpointUrl($ambiente, $servico)
    {
        if (!isset($this->endpoints[$ambiente]['webservice'][$servico]['url'])) {
            throw new \Exception("URL para '$servico' no ambiente '$ambiente' no encontrada nos endpoints.");
        }
        return $this->endpoints[$ambiente]['webservice'][$servico]['url'];
    }
}
</file>

<file path="payisp/src/nfcom_xml.php">
<?php

/**
 * ===================================================================
 * CLASSE PRINCIPAL NFCom - MONTADOR E GERADOR DE XML (CORRIGIDA)
 * ===================================================================
 */

class NFCom
{

    /** @var InfNFCom */
    public $infNFCom;
    /** @var InfNFComSupl */
    public $infNFComSupl;
    /** @var string Chave de Acesso gerada */
    public $chave;

    /** @var \DOMDocument */
    private $dom;
    /** @var \DOMElement */
    private $root;

    /** @var string|null */
    private $assinaturaChaveContingencia = null;
    /** @var string|null */
    private $urlBaseQrcodeUF = null;

    public function __construct()
    {
        $this->infNFCom = new InfNFCom();
        $this->infNFComSupl = new InfNFComSupl();
    }

    /**
     * Define a URL base da SEFAZ para consulta do QR Code.
     * Esta URL  especfica de cada UF.
     * @param string $url A URL base da UF (ex: https://dfe-portal.svrs.rs.gov.br/NFCom/qrcode)
     */
    public function setUrlBaseQrCode($url)
    {
        $this->urlBaseQrcodeUF = $url;
    }

    /**
     * Define a assinatura da chave para uso no QR Code em contingncia (tpEmis=2).
     * @param string $assinaturaBase64 Assinatura (RSA-SHA1 em Base64) da chave de 44 dgitos.
     */
    public function setAssinaturaChaveContingencia($assinaturaBase64)
    {
        $this->assinaturaChaveContingencia = $assinaturaBase64;
    }

    /**
     * Gera e retorna a string XML da NFCom.
     * @return string
     * @throws \Exception
     */
    public function gerarXml()
    {
        // 1. Preparar dados dinmicos (Chave de Acesso, DV, Id, URL QR Code)
        $this->prepararDados();

        // 2. Iniciar o DOMDocument
        $this->dom = new \DOMDocument("1.0", "UTF-8");
        $this->dom->preserveWhiteSpace = false;
        $this->dom->formatOutput = false; // MOC probe formatao

        // 3. N Raiz <NFCom>
        $this->root = $this->dom->createElement("NFCom");
        $this->root->setAttribute("xmlns", "http://www.portalfiscal.inf.br/nfcom");
        $this->dom->appendChild($this->root);

        // 4. Bloco <infNFCom>
        $infNFComNode = $this->dom->createElement("infNFCom");
        $infNFComNode->setAttribute("versao", $this->infNFCom->versao);
        $infNFComNode->setAttribute("Id", $this->infNFCom->Id);
        $this->root->appendChild($infNFComNode);

        // 5. Montar blocos internos da <infNFCom>
        $this->buildIde($infNFComNode, $this->infNFCom->ide);
        $this->buildEmit($infNFComNode, $this->infNFCom->emit);
        $this->buildDest($infNFComNode, $this->infNFCom->dest);
        $this->buildAssinante($infNFComNode, $this->infNFCom->assinante);

        foreach ($this->infNFCom->det as $det) {
            $this->buildDet($infNFComNode, $det);
        }

        $this->buildTotal($infNFComNode, $this->infNFCom->total);

        if ($this->infNFCom->faturamento instanceof GFat) {
            $this->buildGFat($infNFComNode, $this->infNFCom->faturamento);
        }
        // Adicionar else if para GFatCentral se necessrio

        $this->buildInfAdic($infNFComNode, $this->infNFCom->infAdic);

        // Adicionar buildAutXML e buildGRespTec se necessrio

        // 6. Bloco <infNFComSupl>
        $this->buildInfNFComSupl($this->root, $this->infNFComSupl);

        // 7. Retornar XML (sem assinatura)
        // A assinatura do XML (<Signature>...) deve ser feita externamente, sobre este XML.
        return $this->dom->saveXML($this->root);
    }

    /**
     * Prepara Chave, DV, Id e QR Code
     */
    private function prepararDados()
    {
        $ide = $this->infNFCom->ide;
        // CORREO: Busca o CNPJ do bloco 'emit'
        $cnpj = $this->infNFCom->emit->CNPJ;

        if (
            empty($ide->cUF) || empty($ide->dhEmi) || empty($cnpj) || empty($ide->mod) ||
            empty($ide->serie) || empty($ide->nNF) || !isset($ide->tpEmis) || empty($ide->cNF)
        ) {
            throw new \Exception("Campos da IDE ou CNPJ do Emitente insuficientes para gerar a Chave de Acesso.");
        }

        // CORREO: Valida se a URL do QR Code foi definida
        if (empty($this->urlBaseQrcodeUF)) {
            throw new \Exception("URL base do QR Code no definida. Use setUrlBaseQrCode().");
        }

        // Formata AAMM da emisso
        $aamm = substr(str_replace('-', '', $ide->dhEmi), 2, 4);

        // Monta a chave sem o DV
        $chaveSemDV = sprintf(
            '%02d%s%s%02d%03d%09d%01d%01d%07d',
            $ide->cUF,
            $aamm,
            $cnpj, // Correo: varivel $cnpj usada aqui
            $ide->mod,
            (int)$ide->serie,
            (int)$ide->nNF,
            $ide->tpEmis,
            $ide->nSiteAutoriz,
            $ide->cNF
        );

        $ide->cDV = $this->calcularDV($chaveSemDV);
        $chaveCompleta = $chaveSemDV . $ide->cDV;
        $this->chave = $chaveCompleta;

        // O Id da tag <infNFCom>  "NFCom" + Chave de Acesso
        $this->infNFCom->Id = 'NFCom' . $chaveCompleta;

        // CORREO: Gera a URL do QR Code (normal ou contingncia)
        $this->infNFComSupl->qrCodNFCom = $this->gerarUrlQrCode(
            $this->urlBaseQrcodeUF,
            $chaveCompleta,
            $ide->tpAmb,
            $ide->tpEmis,
            $this->assinaturaChaveContingencia // Ser nulo se no for contingncia
        );
    }

    /**
     * Monta o Bloco <ide>
     * @param \DOMElement $parent
     * @param Ide $ide
     */
    private function buildIde(\DOMElement $parent, Ide $ide)
    {
        $node = $this->dom->createElement('ide');
        $this->appendNode($node, 'cUF', $ide->cUF);
        $this->appendNode($node, 'tpAmb', $ide->tpAmb);
        $this->appendNode($node, 'mod', $ide->mod);
        $this->appendNode($node, 'serie', $ide->serie);
        $this->appendNode($node, 'nNF', $ide->nNF);
        $this->appendNode($node, 'cNF', $ide->cNF);
        $this->appendNode($node, 'cDV', $ide->cDV);
        $this->appendNode($node, 'dhEmi', $ide->dhEmi);
        $this->appendNode($node, 'tpEmis', $ide->tpEmis);
        // CORREO AQUI:
        $this->appendNode($node, 'nSiteAutoriz', $ide->nSiteAutoriz);
        $this->appendNode($node, 'cMunFG', $ide->cMunFG);
        $this->appendNode($node, 'finNFCom', $ide->finNFCom);
        $this->appendNode($node, 'tpFat', $ide->tpFat);
        $this->appendNode($node, 'verProc', $ide->verProc);
        $this->appendNode($node, 'dhCont', $ide->dhCont);
        $this->appendNode($node, 'xJust', $ide->xJust);
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <emit>
     * @param \DOMElement $parent
     * @param Emit $emit
     */
    private function buildEmit(\DOMElement $parent, Emit $emit)
    {
        $node = $this->dom->createElement('emit');
        $this->appendNode($node, 'CNPJ', $emit->CNPJ);
        $this->appendNode($node, 'IE', $emit->IE);
        $this->appendNode($node, 'IEUFDest', $emit->IEUFDest);
        $this->appendNode($node, 'CRT', $emit->CRT);
        $this->appendNode($node, 'xNome', $emit->xNome);
        $this->appendNode($node, 'xFant', $emit->xFant);
        $this->buildEndereco($node, $emit->enderEmit, 'enderEmit');
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <dest>
     * @param \DOMElement $parent
     * @param Dest $dest
     */
    private function buildDest(\DOMElement $parent, Dest $dest)
    {
        $node = $this->dom->createElement('dest');
        $this->appendNode($node, 'xNome', $dest->xNome);
        $this->appendNode($node, 'CNPJ', $dest->CNPJ);
        $this->appendNode($node, 'CPF', $dest->CPF);
        $this->appendNode($node, 'idOutros', $dest->idOutros);
        $this->appendNode($node, 'indIEDest', $dest->indIEDest);
        $this->appendNode($node, 'IE', $dest->IE);
        $this->appendNode($node, 'IM', $dest->IM);
        $this->buildEndereco($node, $dest->enderDest, 'enderDest');
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <assinante>
     * @param \DOMElement $parent
     * @param Assinante $assinante
     */
    private function buildAssinante(\DOMElement $parent, Assinante $assinante)
    {
        $node = $this->dom->createElement('assinante');
        $this->appendNode($node, 'iCodAssinante', $assinante->iCodAssinante);
        $this->appendNode($node, 'tpAssinante', $assinante->tpAssinante);
        $this->appendNode($node, 'tpServUtil', $assinante->tpServUtil);
        $this->appendNode($node, 'nContrato', $assinante->nContrato);
        $this->appendNode($node, 'dContratoIni', $assinante->dContratoIni);
        $this->appendNode($node, 'dContratoFim', $assinante->dContratoFim);
        $this->appendNode($node, 'NroTermPrinc', $assinante->NroTermPrinc);
        $this->appendNode($node, 'cUF', $assinante->cUFPrinc);
        $parent->appendChild($node);
    }

    /**
     * Monta um Bloco <enderEmit> ou <enderDest>
     * @param \DOMElement $parent
     * @param Endereco $end
     * @param string $nodeName
     */
    private function buildEndereco(\DOMElement $parent, Endereco $end, $nodeName)
    {
        $node = $this->dom->createElement($nodeName);
        $this->appendNode($node, 'xLgr', $end->xLgr);
        $this->appendNode($node, 'nro', $end->nro);
        $this->appendNode($node, 'xCpl', $end->xCpl);
        $this->appendNode($node, 'xBairro', $end->xBairro);
        $this->appendNode($node, 'cMun', $end->cMun);
        $this->appendNode($node, 'xMun', $end->xMun);
        $this->appendNode($node, 'CEP', $end->CEP);
        $this->appendNode($node, 'UF', $end->UF);
        $this->appendNode($node, 'fone', $end->fone);
        $this->appendNode($node, 'email', $end->email);
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <det>
     * @param \DOMElement $parent
     * @param Det $det
     */
    private function buildDet(\DOMElement $parent, Det $det)
    {
        $node = $this->dom->createElement('det');
        $node->setAttribute('nItem', $det->nItem);

        // <prod>
        $prodNode = $this->dom->createElement('prod');
        $this->appendNode($prodNode, 'cProd', $det->prod->cProd);
        $this->appendNode($prodNode, 'xProd', $det->prod->xProd);
        $this->appendNode($prodNode, 'cClass', $det->prod->cClass);
        $this->appendNode($prodNode, 'CFOP', $det->prod->CFOP);
        $this->appendNode($prodNode, 'uMed', $det->prod->uMed);
        $this->appendNode($prodNode, 'qFaturada', $this->formatValue($det->prod->qFaturada, 4));
        $this->appendNode($prodNode, 'vItem', $this->formatValue($det->prod->vItem, 8));
        $this->appendNode($prodNode, 'vProd', $this->formatValue($det->prod->vProd, 8));
        $node->appendChild($prodNode);

        // <imposto>
        $impostoNode = $this->dom->createElement('imposto');
        $this->buildImposto($impostoNode, $det->imposto);
        $node->appendChild($impostoNode);

        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <imposto>
     * @param \DOMElement $parent
     * @param Imposto $imposto
     */
    private function buildImposto(\DOMElement $parent, Imposto $imposto)
    {
        // Bloco de Escolha do ICMS
        if ($imposto->icms instanceof IcmsSN) {
            $icmsNode = $this->dom->createElement('ICMSSN');
            $this->appendNode($icmsNode, 'CST', $imposto->icms->CST);
            $this->appendNode($icmsNode, 'indSN', $imposto->icms->indSN);
            $parent->appendChild($icmsNode);
        }
        // Adicionar 'else if' para outros tipos de ICMS (ICMS00, ICMS20, etc.)

        // PIS
        $pisNode = $this->dom->createElement('PIS');
        $this->appendNode($pisNode, 'CST', $imposto->PIS->CST);
        $this->appendNode($pisNode, 'vBC', $this->formatValue($imposto->PIS->vBC, 2));
        $this->appendNode($pisNode, 'pPIS', $this->formatValue($imposto->PIS->pPIS, 2));
        $this->appendNode($pisNode, 'vPIS', $this->formatValue($imposto->PIS->vPIS, 2));
        $parent->appendChild($pisNode);

        // COFINS
        $cofinsNode = $this->dom->createElement('COFINS');
        $this->appendNode($cofinsNode, 'CST', $imposto->COFINS->CST);
        $this->appendNode($cofinsNode, 'vBC', $this->formatValue($imposto->COFINS->vBC, 2));
        $this->appendNode($cofinsNode, 'pCOFINS', $this->formatValue($imposto->COFINS->pCOFINS, 2));
        $this->appendNode($cofinsNode, 'vCOFINS', $this->formatValue($imposto->COFINS->vCOFINS, 2));
        $parent->appendChild($cofinsNode);

        // FUST
        $fustNode = $this->dom->createElement('FUST');
        $this->appendNode($fustNode, 'vBC', $this->formatValue($imposto->FUST->vBC, 2));
        $this->appendNode($fustNode, 'pFUST', $this->formatValue($imposto->FUST->pFUST, 2));
        $this->appendNode($fustNode, 'vFUST', $this->formatValue($imposto->FUST->vFUST, 2));
        $parent->appendChild($fustNode);

        // FUNTTEL
        $funttelNode = $this->dom->createElement('FUNTTEL');
        $this->appendNode($funttelNode, 'vBC', $this->formatValue($imposto->FUNTTEL->vBC, 2));
        $this->appendNode($funttelNode, 'pFUNTTEL', $this->formatValue($imposto->FUNTTEL->pFUNTTEL, 2));
        $this->appendNode($funttelNode, 'vFUNTTEL', $this->formatValue($imposto->FUNTTEL->vFUNTTEL, 2));
        $parent->appendChild($funttelNode);

        // retTrib
        $retTribNode = $this->dom->createElement('retTrib');
        $this->appendNode($retTribNode, 'vRetPIS', $this->formatValue($imposto->retTrib->vRetPIS, 8));
        $this->appendNode($retTribNode, 'vRetCofins', $this->formatValue($imposto->retTrib->vRetCofins, 8));
        $this->appendNode($retTribNode, 'vRetCSLL', $this->formatValue($imposto->retTrib->vRetCSLL, 8));
        $this->appendNode($retTribNode, 'vBCIRRF', $this->formatValue($imposto->retTrib->vBCIRRF, 8));
        $this->appendNode($retTribNode, 'vIRRF', $this->formatValue($imposto->retTrib->vIRRF, 8));
        $parent->appendChild($retTribNode);
    }

    /**
     * Monta o Bloco <total>
     * @param \DOMElement $parent
     * @param Total $total
     */
    private function buildTotal(\DOMElement $parent, Total $total)
    {
        $node = $this->dom->createElement('total');
        $this->appendNode($node, 'vProd', $this->formatValue($total->vProd, 2));

        $icmsTotNode = $this->dom->createElement('ICMSTot');
        $this->appendNode($icmsTotNode, 'vBC', $this->formatValue($total->ICMSTot->vBC, 2));
        $this->appendNode($icmsTotNode, 'vICMS', $this->formatValue($total->ICMSTot->vICMS, 2));
        $this->appendNode($icmsTotNode, 'vICMSDeson', $this->formatValue($total->ICMSTot->vICMSDeson, 2));
        $this->appendNode($icmsTotNode, 'vFCP', $this->formatValue($total->ICMSTot->vFCP, 2));
        $node->appendChild($icmsTotNode);

        $this->appendNode($node, 'vCOFINS', $this->formatValue($total->vCOFINS, 2));
        $this->appendNode($node, 'vPIS', $this->formatValue($total->vPIS, 2));
        $this->appendNode($node, 'vFUNTTEL', $this->formatValue($total->vFUNTTEL, 2));
        $this->appendNode($node, 'vFUST', $this->formatValue($total->vFUST, 2));

        $retTribTotNode = $this->dom->createElement('vRetTribTot');
        $this->appendNode($retTribTotNode, 'vRetPIS', $this->formatValue($total->vRetTribTot->vRetPIS, 2));
        $this->appendNode($retTribTotNode, 'vRetCofins', $this->formatValue($total->vRetTribTot->vRetCofins, 2));
        $this->appendNode($retTribTotNode, 'vRetCSLL', $this->formatValue($total->vRetTribTot->vRetCSLL, 2));
        $this->appendNode($retTribTotNode, 'vIRRF', $this->formatValue($total->vRetTribTot->vIRRF, 2));
        $node->appendChild($retTribTotNode);

        $this->appendNode($node, 'vDesc', $this->formatValue($total->vDesc, 2));
        $this->appendNode($node, 'vOutro', $this->formatValue($total->vOutro, 2));
        $this->appendNode($node, 'vNF', $this->formatValue($total->vNF, 2));

        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <gFat>
     * @param \DOMElement $parent
     * @param GFat $gFat
     */
    private function buildGFat(\DOMElement $parent, GFat $gFat)
    {
        $node = $this->dom->createElement('gFat');
        $this->appendNode($node, 'CompetFat', $gFat->CompetFat);
        $this->appendNode($node, 'dVencFat', $gFat->dVencFat);
        $this->appendNode($node, 'dPerUsoIni', $gFat->dPerUsoIni);
        $this->appendNode($node, 'dPerUsoFim', $gFat->dPerUsoFim);
        $this->appendNode($node, 'codBarras', $gFat->codBarras);
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <infAdic>
     * @param \DOMElement $parent
     * @param InfAdic $infAdic
     */
    private function buildInfAdic(\DOMElement $parent, InfAdic $infAdic)
    {
        if (empty($infAdic->infAdFisco) && empty($infAdic->infCpl)) {
            return; // Bloco opcional
        }
        $node = $this->dom->createElement('infAdic');
        $this->appendNode($node, 'infAdFisco', $infAdic->infAdFisco);
        $this->appendNode($node, 'infCpl', $infAdic->infCpl);
        $parent->appendChild($node);
    }

    /**
     * Monta o Bloco <infNFComSupl>
     * @param \DOMElement $parent
     * @param InfNFComSupl $infSupl
     */
    private function buildInfNFComSupl(\DOMElement $parent, InfNFComSupl $infSupl)
    {
        $node = $this->dom->createElement('infNFComSupl');
        $qrCodeNode = $this->dom->createElement('qrCodNFCom');
        $qrCodeNode->appendChild($this->dom->createCDATASection($infSupl->qrCodNFCom));
        $node->appendChild($qrCodeNode);
        $parent->appendChild($node);
    }

    /**
     * Adiciona um n filho ao n pai, apenas se o valor no for nulo,
     * vazio ou um zero numrico que no deva ser explicitado.
     * @param \DOMElement $parent
     * @param string $name
     * @param string|int|float|null $value
     */
    private function appendNode(\DOMElement $parent, $name, $value)
    {
        if ($value !== null && $value !== '') {
            $parent->appendChild($this->dom->createElement($name, $value));
        }
    }

    /**
     * Formata um valor numrico para o padro XML (ex: 70.00)
     * @param float $value
     * @param int $decimals
     * @return string
     */
    private function formatValue($value, $decimals)
    {
        if ($value === null) return null;
        return number_format((float)$value, $decimals, '.', '');
    }

    /**
     * Gera a URL do QR Code (Normal ou Contingncia)
     * @param string $urlBaseUF A URL base de consulta da UF (ex: https://.../NFCom/qrcode)
     * @param string $chave 44 dgitos
     * @param int $tpAmb
     * @param int $tpEmis
     * @param string|null $assinaturaChave Assinatura da chave para contingncia (tpEmis=2)
     * @return string
     * @throws \Exception
     */
    private function gerarUrlQrCode($urlBaseUF, $chave, $tpAmb, $tpEmis, $assinaturaChave = null)
    {
        $params = [
            'chNFCom' => $chave,
            'tpAmb' => $tpAmb
        ];

        // Se for Contingncia Off-line (tpEmis=2), adiciona a assinatura da chave
        if ($tpEmis == 2) {
            if (empty($assinaturaChave)) {
                // A assinatura  obrigatria em modo de contingncia
                throw new \Exception("Emisso em contingncia (tpEmis=2) exige a assinatura da chave de acesso para o QR Code. Use setAssinaturaChaveContingencia().");
            }
            $params['sign'] = $assinaturaChave;
        }

        return $urlBaseUF . '?' . http_build_query($params);
    }

    /**
     * Calcula o Dgito Verificador (Mdulo 11) da Chave de Acesso
     * @param string $chave 43 dgitos
     * @return int
     */
    private function calcularDV($chave)
    {
        $soma = 0;
        $multiplicadores = [2, 3, 4, 5, 6, 7, 8, 9];
        $i = strlen($chave) - 1;
        $j = 0;

        while ($i >= 0) {
            $soma += (int)$chave[$i] * $multiplicadores[$j];
            $j++;
            if ($j >= count($multiplicadores)) {
                $j = 0;
            }
            $i--;
        }

        $resto = $soma % 11;

        if ($resto == 0 || $resto == 1) {
            return 0;
        } else {
            return 11 - $resto;
        }
    }
}
</file>

<file path="payisp/src/nfcom_xsd.php">
<?php

/**
 * NFComValidator
 *
 * Classe responsvel por validar um XML da NFCom contra o seu
 * Schema XSD oficial (e suas dependncias).
 */
class NFComValidator
{
    /**
     * @var string Caminho para o arquivo XSD principal (ex: nfcom_v1.00.xsd)
     */
    private $xsdPath;

    /**
     * @param string $xsdBasePath Caminho para o ARQUIVO PRINCIPAL XSD (ex: schemas/nfcom/nfcom_v1.00.xsd)
     * @throws \Exception
     */
    public function __construct(string $xsdBasePath)
    {
        if (!file_exists($xsdBasePath)) {
            throw new \Exception("Arquivo XSD principal no encontrado: $xsdBasePath");
        }
        $this->xsdPath = $xsdBasePath;
    }

    /**
     * Valida uma string XML contra o Schema.
     *
     * @param string $xmlString O XML da NFCom (gerado pela classe NFCom)
     * @return bool Retorna true se for vlido.
     * @throws \Exception Lana uma exceo com os erros de validao.
     */
    public function validate(string $xmlString)
    {
        // Ativa o manuseio de erros interno do libxml
        libxml_use_internal_errors(true);

        $dom = new \DOMDocument();

        // Carrega o XML. Usamos @ para suprimir warnings, pois vamos trat-los.
        if (!@$dom->loadXML($xmlString)) {
            $this->throwLibxmlErrors("Falha ao carregar o XML. Verifique se  bem formado.");
        }

        // Valida o XML contra o XSD
        if (!@$dom->schemaValidate($this->xsdPath)) {
            // Se falhar, coleta os erros e lana uma exceo
            $this->throwLibxmlErrors("Falha na validao do Schema XSD.");
        }

        // Limpa os erros e desativa o manuseio interno
        libxml_clear_errors();
        libxml_use_internal_errors(false);

        // Se chegou aqui, o XML  vlido
        return true;
    }

    /**
     * Coleta os erros do libxml e os lana em uma nica exceo formatada.
     *
     * @param string $baseMessage A mensagem principal da exceo.
     * @throws \Exception
     */
    private function throwLibxmlErrors(string $baseMessage)
    {
        $errors = libxml_get_errors();
        $errorMessages = [];

        foreach ($errors as $error) {
            $errorMessages[] = sprintf(
                "[Linha: %d, Coluna: %d, Nvel: %d] Erro %d: %s",
                $error->line,
                $error->column,
                $error->level,
                $error->code,
                trim($error->message)
            );
        }

        libxml_clear_errors();
        libxml_use_internal_errors(false);

        throw new \Exception(
            $baseMessage . "\n\n" . implode("\n", $errorMessages)
        );
    }
}
</file>

<file path="payisp/vendor/composer/autoload_classmap.php">
<?php

// autoload_classmap.php @generated by Composer

$vendorDir = dirname(__DIR__);
$baseDir = dirname($vendorDir);

return array(
    'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php',
    'MySQLDump' => $baseDir . '/src/MySQLDump.php',
    'MySQLImport' => $baseDir . '/src/MySQLImport.php',
);
</file>

<file path="payisp/vendor/composer/autoload_namespaces.php">
<?php

// autoload_namespaces.php @generated by Composer

$vendorDir = dirname(__DIR__);
$baseDir = dirname($vendorDir);

return array(
);
</file>

<file path="payisp/vendor/composer/autoload_psr4.php">
<?php

// autoload_psr4.php @generated by Composer

$vendorDir = dirname(__DIR__);
$baseDir = dirname($vendorDir);

return array(
    'RobRichards\\XMLSecLibs\\' => array($vendorDir . '/robrichards/xmlseclibs/src'),
);
</file>

<file path="payisp/vendor/composer/autoload_real.php">
<?php

// autoload_real.php @generated by Composer

class ComposerAutoloaderInit518a6773f70c2b492a0f6286d3031f47
{
    private static $loader;

    public static function loadClassLoader($class)
    {
        if ('Composer\Autoload\ClassLoader' === $class) {
            require __DIR__ . '/ClassLoader.php';
        }
    }

    /**
     * @return \Composer\Autoload\ClassLoader
     */
    public static function getLoader()
    {
        if (null !== self::$loader) {
            return self::$loader;
        }

        require __DIR__ . '/platform_check.php';

        spl_autoload_register(array('ComposerAutoloaderInit518a6773f70c2b492a0f6286d3031f47', 'loadClassLoader'), true, true);
        self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(__DIR__));
        spl_autoload_unregister(array('ComposerAutoloaderInit518a6773f70c2b492a0f6286d3031f47', 'loadClassLoader'));

        require __DIR__ . '/autoload_static.php';
        call_user_func(\Composer\Autoload\ComposerStaticInit518a6773f70c2b492a0f6286d3031f47::getInitializer($loader));

        $loader->register(true);

        return $loader;
    }
}
</file>

<file path="payisp/vendor/composer/autoload_static.php">
<?php

// autoload_static.php @generated by Composer

namespace Composer\Autoload;

class ComposerStaticInit518a6773f70c2b492a0f6286d3031f47
{
    public static $prefixLengthsPsr4 = array (
        'R' => 
        array (
            'RobRichards\\XMLSecLibs\\' => 23,
        ),
    );

    public static $prefixDirsPsr4 = array (
        'RobRichards\\XMLSecLibs\\' => 
        array (
            0 => __DIR__ . '/..' . '/robrichards/xmlseclibs/src',
        ),
    );

    public static $classMap = array (
        'Composer\\InstalledVersions' => __DIR__ . '/..' . '/composer/InstalledVersions.php',
        'MySQLDump' => __DIR__ . '/../..' . '/src/MySQLDump.php',
        'MySQLImport' => __DIR__ . '/../..' . '/src/MySQLImport.php',
    );

    public static function getInitializer(ClassLoader $loader)
    {
        return \Closure::bind(function () use ($loader) {
            $loader->prefixLengthsPsr4 = ComposerStaticInit518a6773f70c2b492a0f6286d3031f47::$prefixLengthsPsr4;
            $loader->prefixDirsPsr4 = ComposerStaticInit518a6773f70c2b492a0f6286d3031f47::$prefixDirsPsr4;
            $loader->classMap = ComposerStaticInit518a6773f70c2b492a0f6286d3031f47::$classMap;

        }, null, ClassLoader::class);
    }
}
</file>

<file path="payisp/vendor/composer/ClassLoader.php">
<?php

/*
 * This file is part of Composer.
 *
 * (c) Nils Adermann <naderman@naderman.de>
 *     Jordi Boggiano <j.boggiano@seld.be>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Composer\Autoload;

/**
 * ClassLoader implements a PSR-0, PSR-4 and classmap class loader.
 *
 *     $loader = new \Composer\Autoload\ClassLoader();
 *
 *     // register classes with namespaces
 *     $loader->add('Symfony\Component', __DIR__.'/component');
 *     $loader->add('Symfony',           __DIR__.'/framework');
 *
 *     // activate the autoloader
 *     $loader->register();
 *
 *     // to enable searching the include path (eg. for PEAR packages)
 *     $loader->setUseIncludePath(true);
 *
 * In this example, if you try to use a class in the Symfony\Component
 * namespace or one of its children (Symfony\Component\Console for instance),
 * the autoloader will first look for the class under the component/
 * directory, and it will then fallback to the framework/ directory if not
 * found before giving up.
 *
 * This class is loosely based on the Symfony UniversalClassLoader.
 *
 * @author Fabien Potencier <fabien@symfony.com>
 * @author Jordi Boggiano <j.boggiano@seld.be>
 * @see    https://www.php-fig.org/psr/psr-0/
 * @see    https://www.php-fig.org/psr/psr-4/
 */
class ClassLoader
{
    /** @var \Closure(string):void */
    private static $includeFile;

    /** @var string|null */
    private $vendorDir;

    // PSR-4
    /**
     * @var array<string, array<string, int>>
     */
    private $prefixLengthsPsr4 = array();
    /**
     * @var array<string, list<string>>
     */
    private $prefixDirsPsr4 = array();
    /**
     * @var list<string>
     */
    private $fallbackDirsPsr4 = array();

    // PSR-0
    /**
     * List of PSR-0 prefixes
     *
     * Structured as array('F (first letter)' => array('Foo\Bar (full prefix)' => array('path', 'path2')))
     *
     * @var array<string, array<string, list<string>>>
     */
    private $prefixesPsr0 = array();
    /**
     * @var list<string>
     */
    private $fallbackDirsPsr0 = array();

    /** @var bool */
    private $useIncludePath = false;

    /**
     * @var array<string, string>
     */
    private $classMap = array();

    /** @var bool */
    private $classMapAuthoritative = false;

    /**
     * @var array<string, bool>
     */
    private $missingClasses = array();

    /** @var string|null */
    private $apcuPrefix;

    /**
     * @var array<string, self>
     */
    private static $registeredLoaders = array();

    /**
     * @param string|null $vendorDir
     */
    public function __construct($vendorDir = null)
    {
        $this->vendorDir = $vendorDir;
        self::initializeIncludeClosure();
    }

    /**
     * @return array<string, list<string>>
     */
    public function getPrefixes()
    {
        if (!empty($this->prefixesPsr0)) {
            return call_user_func_array('array_merge', array_values($this->prefixesPsr0));
        }

        return array();
    }

    /**
     * @return array<string, list<string>>
     */
    public function getPrefixesPsr4()
    {
        return $this->prefixDirsPsr4;
    }

    /**
     * @return list<string>
     */
    public function getFallbackDirs()
    {
        return $this->fallbackDirsPsr0;
    }

    /**
     * @return list<string>
     */
    public function getFallbackDirsPsr4()
    {
        return $this->fallbackDirsPsr4;
    }

    /**
     * @return array<string, string> Array of classname => path
     */
    public function getClassMap()
    {
        return $this->classMap;
    }

    /**
     * @param array<string, string> $classMap Class to filename map
     *
     * @return void
     */
    public function addClassMap(array $classMap)
    {
        if ($this->classMap) {
            $this->classMap = array_merge($this->classMap, $classMap);
        } else {
            $this->classMap = $classMap;
        }
    }

    /**
     * Registers a set of PSR-0 directories for a given prefix, either
     * appending or prepending to the ones previously set for this prefix.
     *
     * @param string              $prefix  The prefix
     * @param list<string>|string $paths   The PSR-0 root directories
     * @param bool                $prepend Whether to prepend the directories
     *
     * @return void
     */
    public function add($prefix, $paths, $prepend = false)
    {
        $paths = (array) $paths;
        if (!$prefix) {
            if ($prepend) {
                $this->fallbackDirsPsr0 = array_merge(
                    $paths,
                    $this->fallbackDirsPsr0
                );
            } else {
                $this->fallbackDirsPsr0 = array_merge(
                    $this->fallbackDirsPsr0,
                    $paths
                );
            }

            return;
        }

        $first = $prefix[0];
        if (!isset($this->prefixesPsr0[$first][$prefix])) {
            $this->prefixesPsr0[$first][$prefix] = $paths;

            return;
        }
        if ($prepend) {
            $this->prefixesPsr0[$first][$prefix] = array_merge(
                $paths,
                $this->prefixesPsr0[$first][$prefix]
            );
        } else {
            $this->prefixesPsr0[$first][$prefix] = array_merge(
                $this->prefixesPsr0[$first][$prefix],
                $paths
            );
        }
    }

    /**
     * Registers a set of PSR-4 directories for a given namespace, either
     * appending or prepending to the ones previously set for this namespace.
     *
     * @param string              $prefix  The prefix/namespace, with trailing '\\'
     * @param list<string>|string $paths   The PSR-4 base directories
     * @param bool                $prepend Whether to prepend the directories
     *
     * @throws \InvalidArgumentException
     *
     * @return void
     */
    public function addPsr4($prefix, $paths, $prepend = false)
    {
        $paths = (array) $paths;
        if (!$prefix) {
            // Register directories for the root namespace.
            if ($prepend) {
                $this->fallbackDirsPsr4 = array_merge(
                    $paths,
                    $this->fallbackDirsPsr4
                );
            } else {
                $this->fallbackDirsPsr4 = array_merge(
                    $this->fallbackDirsPsr4,
                    $paths
                );
            }
        } elseif (!isset($this->prefixDirsPsr4[$prefix])) {
            // Register directories for a new namespace.
            $length = strlen($prefix);
            if ('\\' !== $prefix[$length - 1]) {
                throw new \InvalidArgumentException("A non-empty PSR-4 prefix must end with a namespace separator.");
            }
            $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
            $this->prefixDirsPsr4[$prefix] = $paths;
        } elseif ($prepend) {
            // Prepend directories for an already registered namespace.
            $this->prefixDirsPsr4[$prefix] = array_merge(
                $paths,
                $this->prefixDirsPsr4[$prefix]
            );
        } else {
            // Append directories for an already registered namespace.
            $this->prefixDirsPsr4[$prefix] = array_merge(
                $this->prefixDirsPsr4[$prefix],
                $paths
            );
        }
    }

    /**
     * Registers a set of PSR-0 directories for a given prefix,
     * replacing any others previously set for this prefix.
     *
     * @param string              $prefix The prefix
     * @param list<string>|string $paths  The PSR-0 base directories
     *
     * @return void
     */
    public function set($prefix, $paths)
    {
        if (!$prefix) {
            $this->fallbackDirsPsr0 = (array) $paths;
        } else {
            $this->prefixesPsr0[$prefix[0]][$prefix] = (array) $paths;
        }
    }

    /**
     * Registers a set of PSR-4 directories for a given namespace,
     * replacing any others previously set for this namespace.
     *
     * @param string              $prefix The prefix/namespace, with trailing '\\'
     * @param list<string>|string $paths  The PSR-4 base directories
     *
     * @throws \InvalidArgumentException
     *
     * @return void
     */
    public function setPsr4($prefix, $paths)
    {
        if (!$prefix) {
            $this->fallbackDirsPsr4 = (array) $paths;
        } else {
            $length = strlen($prefix);
            if ('\\' !== $prefix[$length - 1]) {
                throw new \InvalidArgumentException("A non-empty PSR-4 prefix must end with a namespace separator.");
            }
            $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
            $this->prefixDirsPsr4[$prefix] = (array) $paths;
        }
    }

    /**
     * Turns on searching the include path for class files.
     *
     * @param bool $useIncludePath
     *
     * @return void
     */
    public function setUseIncludePath($useIncludePath)
    {
        $this->useIncludePath = $useIncludePath;
    }

    /**
     * Can be used to check if the autoloader uses the include path to check
     * for classes.
     *
     * @return bool
     */
    public function getUseIncludePath()
    {
        return $this->useIncludePath;
    }

    /**
     * Turns off searching the prefix and fallback directories for classes
     * that have not been registered with the class map.
     *
     * @param bool $classMapAuthoritative
     *
     * @return void
     */
    public function setClassMapAuthoritative($classMapAuthoritative)
    {
        $this->classMapAuthoritative = $classMapAuthoritative;
    }

    /**
     * Should class lookup fail if not found in the current class map?
     *
     * @return bool
     */
    public function isClassMapAuthoritative()
    {
        return $this->classMapAuthoritative;
    }

    /**
     * APCu prefix to use to cache found/not-found classes, if the extension is enabled.
     *
     * @param string|null $apcuPrefix
     *
     * @return void
     */
    public function setApcuPrefix($apcuPrefix)
    {
        $this->apcuPrefix = function_exists('apcu_fetch') && filter_var(ini_get('apc.enabled'), FILTER_VALIDATE_BOOLEAN) ? $apcuPrefix : null;
    }

    /**
     * The APCu prefix in use, or null if APCu caching is not enabled.
     *
     * @return string|null
     */
    public function getApcuPrefix()
    {
        return $this->apcuPrefix;
    }

    /**
     * Registers this instance as an autoloader.
     *
     * @param bool $prepend Whether to prepend the autoloader or not
     *
     * @return void
     */
    public function register($prepend = false)
    {
        spl_autoload_register(array($this, 'loadClass'), true, $prepend);

        if (null === $this->vendorDir) {
            return;
        }

        if ($prepend) {
            self::$registeredLoaders = array($this->vendorDir => $this) + self::$registeredLoaders;
        } else {
            unset(self::$registeredLoaders[$this->vendorDir]);
            self::$registeredLoaders[$this->vendorDir] = $this;
        }
    }

    /**
     * Unregisters this instance as an autoloader.
     *
     * @return void
     */
    public function unregister()
    {
        spl_autoload_unregister(array($this, 'loadClass'));

        if (null !== $this->vendorDir) {
            unset(self::$registeredLoaders[$this->vendorDir]);
        }
    }

    /**
     * Loads the given class or interface.
     *
     * @param  string    $class The name of the class
     * @return true|null True if loaded, null otherwise
     */
    public function loadClass($class)
    {
        if ($file = $this->findFile($class)) {
            $includeFile = self::$includeFile;
            $includeFile($file);

            return true;
        }

        return null;
    }

    /**
     * Finds the path to the file where the class is defined.
     *
     * @param string $class The name of the class
     *
     * @return string|false The path if found, false otherwise
     */
    public function findFile($class)
    {
        // class map lookup
        if (isset($this->classMap[$class])) {
            return $this->classMap[$class];
        }
        if ($this->classMapAuthoritative || isset($this->missingClasses[$class])) {
            return false;
        }
        if (null !== $this->apcuPrefix) {
            $file = apcu_fetch($this->apcuPrefix.$class, $hit);
            if ($hit) {
                return $file;
            }
        }

        $file = $this->findFileWithExtension($class, '.php');

        // Search for Hack files if we are running on HHVM
        if (false === $file && defined('HHVM_VERSION')) {
            $file = $this->findFileWithExtension($class, '.hh');
        }

        if (null !== $this->apcuPrefix) {
            apcu_add($this->apcuPrefix.$class, $file);
        }

        if (false === $file) {
            // Remember that this class does not exist.
            $this->missingClasses[$class] = true;
        }

        return $file;
    }

    /**
     * Returns the currently registered loaders keyed by their corresponding vendor directories.
     *
     * @return array<string, self>
     */
    public static function getRegisteredLoaders()
    {
        return self::$registeredLoaders;
    }

    /**
     * @param  string       $class
     * @param  string       $ext
     * @return string|false
     */
    private function findFileWithExtension($class, $ext)
    {
        // PSR-4 lookup
        $logicalPathPsr4 = strtr($class, '\\', DIRECTORY_SEPARATOR) . $ext;

        $first = $class[0];
        if (isset($this->prefixLengthsPsr4[$first])) {
            $subPath = $class;
            while (false !== $lastPos = strrpos($subPath, '\\')) {
                $subPath = substr($subPath, 0, $lastPos);
                $search = $subPath . '\\';
                if (isset($this->prefixDirsPsr4[$search])) {
                    $pathEnd = DIRECTORY_SEPARATOR . substr($logicalPathPsr4, $lastPos + 1);
                    foreach ($this->prefixDirsPsr4[$search] as $dir) {
                        if (file_exists($file = $dir . $pathEnd)) {
                            return $file;
                        }
                    }
                }
            }
        }

        // PSR-4 fallback dirs
        foreach ($this->fallbackDirsPsr4 as $dir) {
            if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr4)) {
                return $file;
            }
        }

        // PSR-0 lookup
        if (false !== $pos = strrpos($class, '\\')) {
            // namespaced class name
            $logicalPathPsr0 = substr($logicalPathPsr4, 0, $pos + 1)
                . strtr(substr($logicalPathPsr4, $pos + 1), '_', DIRECTORY_SEPARATOR);
        } else {
            // PEAR-like class name
            $logicalPathPsr0 = strtr($class, '_', DIRECTORY_SEPARATOR) . $ext;
        }

        if (isset($this->prefixesPsr0[$first])) {
            foreach ($this->prefixesPsr0[$first] as $prefix => $dirs) {
                if (0 === strpos($class, $prefix)) {
                    foreach ($dirs as $dir) {
                        if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
                            return $file;
                        }
                    }
                }
            }
        }

        // PSR-0 fallback dirs
        foreach ($this->fallbackDirsPsr0 as $dir) {
            if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
                return $file;
            }
        }

        // PSR-0 include paths.
        if ($this->useIncludePath && $file = stream_resolve_include_path($logicalPathPsr0)) {
            return $file;
        }

        return false;
    }

    /**
     * @return void
     */
    private static function initializeIncludeClosure()
    {
        if (self::$includeFile !== null) {
            return;
        }

        /**
         * Scope isolated include.
         *
         * Prevents access to $this/self from included files.
         *
         * @param  string $file
         * @return void
         */
        self::$includeFile = \Closure::bind(static function($file) {
            include $file;
        }, null, null);
    }
}
</file>

<file path="payisp/vendor/composer/installed.json">
{
    "packages": [
        {
            "name": "robrichards/xmlseclibs",
            "version": "3.1.3",
            "version_normalized": "3.1.3.0",
            "source": {
                "type": "git",
                "url": "https://github.com/robrichards/xmlseclibs.git",
                "reference": "2bdfd742624d739dfadbd415f00181b4a77aaf07"
            },
            "dist": {
                "type": "zip",
                "url": "https://api.github.com/repos/robrichards/xmlseclibs/zipball/2bdfd742624d739dfadbd415f00181b4a77aaf07",
                "reference": "2bdfd742624d739dfadbd415f00181b4a77aaf07",
                "shasum": ""
            },
            "require": {
                "ext-openssl": "*",
                "php": ">= 5.4"
            },
            "time": "2024-11-20T21:13:56+00:00",
            "type": "library",
            "installation-source": "dist",
            "autoload": {
                "psr-4": {
                    "RobRichards\\XMLSecLibs\\": "src"
                }
            },
            "notification-url": "https://packagist.org/downloads/",
            "license": [
                "BSD-3-Clause"
            ],
            "description": "A PHP library for XML Security",
            "homepage": "https://github.com/robrichards/xmlseclibs",
            "keywords": [
                "security",
                "signature",
                "xml",
                "xmldsig"
            ],
            "support": {
                "issues": "https://github.com/robrichards/xmlseclibs/issues",
                "source": "https://github.com/robrichards/xmlseclibs/tree/3.1.3"
            },
            "install-path": "../robrichards/xmlseclibs"
        }
    ],
    "dev": true,
    "dev-package-names": []
}
</file>

<file path="payisp/vendor/composer/installed.php">
<?php return array(
    'root' => array(
        'name' => 'dg/mysql-dump',
        'pretty_version' => '1.0.0+no-version-set',
        'version' => '1.0.0.0',
        'reference' => null,
        'type' => 'library',
        'install_path' => __DIR__ . '/../../',
        'aliases' => array(),
        'dev' => true,
    ),
    'versions' => array(
        'dg/mysql-dump' => array(
            'pretty_version' => '1.0.0+no-version-set',
            'version' => '1.0.0.0',
            'reference' => null,
            'type' => 'library',
            'install_path' => __DIR__ . '/../../',
            'aliases' => array(),
            'dev_requirement' => false,
        ),
        'robrichards/xmlseclibs' => array(
            'pretty_version' => '3.1.3',
            'version' => '3.1.3.0',
            'reference' => '2bdfd742624d739dfadbd415f00181b4a77aaf07',
            'type' => 'library',
            'install_path' => __DIR__ . '/../robrichards/xmlseclibs',
            'aliases' => array(),
            'dev_requirement' => false,
        ),
    ),
);
</file>

<file path="payisp/vendor/composer/InstalledVersions.php">
<?php

/*
 * This file is part of Composer.
 *
 * (c) Nils Adermann <naderman@naderman.de>
 *     Jordi Boggiano <j.boggiano@seld.be>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Composer;

use Composer\Autoload\ClassLoader;
use Composer\Semver\VersionParser;

/**
 * This class is copied in every Composer installed project and available to all
 *
 * See also https://getcomposer.org/doc/07-runtime.md#installed-versions
 *
 * To require its presence, you can require `composer-runtime-api ^2.0`
 *
 * @final
 */
class InstalledVersions
{
    /**
     * @var string|null if set (by reflection by Composer), this should be set to the path where this class is being copied to
     * @internal
     */
    private static $selfDir = null;

    /**
     * @var mixed[]|null
     * @psalm-var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}|array{}|null
     */
    private static $installed;

    /**
     * @var bool
     */
    private static $installedIsLocalDir;

    /**
     * @var bool|null
     */
    private static $canGetVendors;

    /**
     * @var array[]
     * @psalm-var array<string, array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
     */
    private static $installedByVendor = array();

    /**
     * Returns a list of all package names which are present, either by being installed, replaced or provided
     *
     * @return string[]
     * @psalm-return list<string>
     */
    public static function getInstalledPackages()
    {
        $packages = array();
        foreach (self::getInstalled() as $installed) {
            $packages[] = array_keys($installed['versions']);
        }

        if (1 === \count($packages)) {
            return $packages[0];
        }

        return array_keys(array_flip(\call_user_func_array('array_merge', $packages)));
    }

    /**
     * Returns a list of all package names with a specific type e.g. 'library'
     *
     * @param  string   $type
     * @return string[]
     * @psalm-return list<string>
     */
    public static function getInstalledPackagesByType($type)
    {
        $packagesByType = array();

        foreach (self::getInstalled() as $installed) {
            foreach ($installed['versions'] as $name => $package) {
                if (isset($package['type']) && $package['type'] === $type) {
                    $packagesByType[] = $name;
                }
            }
        }

        return $packagesByType;
    }

    /**
     * Checks whether the given package is installed
     *
     * This also returns true if the package name is provided or replaced by another package
     *
     * @param  string $packageName
     * @param  bool   $includeDevRequirements
     * @return bool
     */
    public static function isInstalled($packageName, $includeDevRequirements = true)
    {
        foreach (self::getInstalled() as $installed) {
            if (isset($installed['versions'][$packageName])) {
                return $includeDevRequirements || !isset($installed['versions'][$packageName]['dev_requirement']) || $installed['versions'][$packageName]['dev_requirement'] === false;
            }
        }

        return false;
    }

    /**
     * Checks whether the given package satisfies a version constraint
     *
     * e.g. If you want to know whether version 2.3+ of package foo/bar is installed, you would call:
     *
     *   Composer\InstalledVersions::satisfies(new VersionParser, 'foo/bar', '^2.3')
     *
     * @param  VersionParser $parser      Install composer/semver to have access to this class and functionality
     * @param  string        $packageName
     * @param  string|null   $constraint  A version constraint to check for, if you pass one you have to make sure composer/semver is required by your package
     * @return bool
     */
    public static function satisfies(VersionParser $parser, $packageName, $constraint)
    {
        $constraint = $parser->parseConstraints((string) $constraint);
        $provided = $parser->parseConstraints(self::getVersionRanges($packageName));

        return $provided->matches($constraint);
    }

    /**
     * Returns a version constraint representing all the range(s) which are installed for a given package
     *
     * It is easier to use this via isInstalled() with the $constraint argument if you need to check
     * whether a given version of a package is installed, and not just whether it exists
     *
     * @param  string $packageName
     * @return string Version constraint usable with composer/semver
     */
    public static function getVersionRanges($packageName)
    {
        foreach (self::getInstalled() as $installed) {
            if (!isset($installed['versions'][$packageName])) {
                continue;
            }

            $ranges = array();
            if (isset($installed['versions'][$packageName]['pretty_version'])) {
                $ranges[] = $installed['versions'][$packageName]['pretty_version'];
            }
            if (array_key_exists('aliases', $installed['versions'][$packageName])) {
                $ranges = array_merge($ranges, $installed['versions'][$packageName]['aliases']);
            }
            if (array_key_exists('replaced', $installed['versions'][$packageName])) {
                $ranges = array_merge($ranges, $installed['versions'][$packageName]['replaced']);
            }
            if (array_key_exists('provided', $installed['versions'][$packageName])) {
                $ranges = array_merge($ranges, $installed['versions'][$packageName]['provided']);
            }

            return implode(' || ', $ranges);
        }

        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
    }

    /**
     * @param  string      $packageName
     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as version, use satisfies or getVersionRanges if you need to know if a given version is present
     */
    public static function getVersion($packageName)
    {
        foreach (self::getInstalled() as $installed) {
            if (!isset($installed['versions'][$packageName])) {
                continue;
            }

            if (!isset($installed['versions'][$packageName]['version'])) {
                return null;
            }

            return $installed['versions'][$packageName]['version'];
        }

        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
    }

    /**
     * @param  string      $packageName
     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as version, use satisfies or getVersionRanges if you need to know if a given version is present
     */
    public static function getPrettyVersion($packageName)
    {
        foreach (self::getInstalled() as $installed) {
            if (!isset($installed['versions'][$packageName])) {
                continue;
            }

            if (!isset($installed['versions'][$packageName]['pretty_version'])) {
                return null;
            }

            return $installed['versions'][$packageName]['pretty_version'];
        }

        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
    }

    /**
     * @param  string      $packageName
     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as reference
     */
    public static function getReference($packageName)
    {
        foreach (self::getInstalled() as $installed) {
            if (!isset($installed['versions'][$packageName])) {
                continue;
            }

            if (!isset($installed['versions'][$packageName]['reference'])) {
                return null;
            }

            return $installed['versions'][$packageName]['reference'];
        }

        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
    }

    /**
     * @param  string      $packageName
     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as install path. Packages of type metapackages also have a null install path.
     */
    public static function getInstallPath($packageName)
    {
        foreach (self::getInstalled() as $installed) {
            if (!isset($installed['versions'][$packageName])) {
                continue;
            }

            return isset($installed['versions'][$packageName]['install_path']) ? $installed['versions'][$packageName]['install_path'] : null;
        }

        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
    }

    /**
     * @return array
     * @psalm-return array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}
     */
    public static function getRootPackage()
    {
        $installed = self::getInstalled();

        return $installed[0]['root'];
    }

    /**
     * Returns the raw installed.php data for custom implementations
     *
     * @deprecated Use getAllRawData() instead which returns all datasets for all autoloaders present in the process. getRawData only returns the first dataset loaded, which may not be what you expect.
     * @return array[]
     * @psalm-return array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}
     */
    public static function getRawData()
    {
        @trigger_error('getRawData only returns the first dataset loaded, which may not be what you expect. Use getAllRawData() instead which returns all datasets for all autoloaders present in the process.', E_USER_DEPRECATED);

        if (null === self::$installed) {
            // only require the installed.php file if this file is loaded from its dumped location,
            // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937
            if (substr(__DIR__, -8, 1) !== 'C') {
                self::$installed = include __DIR__ . '/installed.php';
            } else {
                self::$installed = array();
            }
        }

        return self::$installed;
    }

    /**
     * Returns the raw data of all installed.php which are currently loaded for custom implementations
     *
     * @return array[]
     * @psalm-return list<array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
     */
    public static function getAllRawData()
    {
        return self::getInstalled();
    }

    /**
     * Lets you reload the static array from another file
     *
     * This is only useful for complex integrations in which a project needs to use
     * this class but then also needs to execute another project's autoloader in process,
     * and wants to ensure both projects have access to their version of installed.php.
     *
     * A typical case would be PHPUnit, where it would need to make sure it reads all
     * the data it needs from this class, then call reload() with
     * `require $CWD/vendor/composer/installed.php` (or similar) as input to make sure
     * the project in which it runs can then also use this class safely, without
     * interference between PHPUnit's dependencies and the project's dependencies.
     *
     * @param  array[] $data A vendor/composer/installed.php data set
     * @return void
     *
     * @psalm-param array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $data
     */
    public static function reload($data)
    {
        self::$installed = $data;
        self::$installedByVendor = array();

        // when using reload, we disable the duplicate protection to ensure that self::$installed data is
        // always returned, but we cannot know whether it comes from the installed.php in __DIR__ or not,
        // so we have to assume it does not, and that may result in duplicate data being returned when listing
        // all installed packages for example
        self::$installedIsLocalDir = false;
    }

    /**
     * @return string
     */
    private static function getSelfDir()
    {
        if (self::$selfDir === null) {
            self::$selfDir = strtr(__DIR__, '\\', '/');
        }

        return self::$selfDir;
    }

    /**
     * @return array[]
     * @psalm-return list<array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
     */
    private static function getInstalled()
    {
        if (null === self::$canGetVendors) {
            self::$canGetVendors = method_exists('Composer\Autoload\ClassLoader', 'getRegisteredLoaders');
        }

        $installed = array();
        $copiedLocalDir = false;

        if (self::$canGetVendors) {
            $selfDir = self::getSelfDir();
            foreach (ClassLoader::getRegisteredLoaders() as $vendorDir => $loader) {
                $vendorDir = strtr($vendorDir, '\\', '/');
                if (isset(self::$installedByVendor[$vendorDir])) {
                    $installed[] = self::$installedByVendor[$vendorDir];
                } elseif (is_file($vendorDir.'/composer/installed.php')) {
                    /** @var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $required */
                    $required = require $vendorDir.'/composer/installed.php';
                    self::$installedByVendor[$vendorDir] = $required;
                    $installed[] = $required;
                    if (self::$installed === null && $vendorDir.'/composer' === $selfDir) {
                        self::$installed = $required;
                        self::$installedIsLocalDir = true;
                    }
                }
                if (self::$installedIsLocalDir && $vendorDir.'/composer' === $selfDir) {
                    $copiedLocalDir = true;
                }
            }
        }

        if (null === self::$installed) {
            // only require the installed.php file if this file is loaded from its dumped location,
            // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937
            if (substr(__DIR__, -8, 1) !== 'C') {
                /** @var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $required */
                $required = require __DIR__ . '/installed.php';
                self::$installed = $required;
            } else {
                self::$installed = array();
            }
        }

        if (self::$installed !== array() && !$copiedLocalDir) {
            $installed[] = self::$installed;
        }

        return $installed;
    }
}
</file>

<file path="payisp/vendor/composer/LICENSE">
Copyright (c) Nils Adermann, Jordi Boggiano

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is furnished
to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
</file>

<file path="payisp/vendor/composer/platform_check.php">
<?php

// platform_check.php @generated by Composer

$issues = array();

if (!(PHP_VERSION_ID >= 50600)) {
    $issues[] = 'Your Composer dependencies require a PHP version ">= 5.6.0". You are running ' . PHP_VERSION . '.';
}

if ($issues) {
    if (!headers_sent()) {
        header('HTTP/1.1 500 Internal Server Error');
    }
    if (!ini_get('display_errors')) {
        if (PHP_SAPI === 'cli' || PHP_SAPI === 'phpdbg') {
            fwrite(STDERR, 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . implode(PHP_EOL, $issues) . PHP_EOL.PHP_EOL);
        } elseif (!headers_sent()) {
            echo 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . str_replace('You are running '.PHP_VERSION.'.', '', implode(PHP_EOL, $issues)) . PHP_EOL.PHP_EOL;
        }
    }
    throw new \RuntimeException(
        'Composer detected issues in your platform: ' . implode(' ', $issues)
    );
}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/.github/workflows/ci.yml">
name: Tests

on: [push, pull_request]

jobs:
  tests-legacy:
    name: PHP ${{ matrix.php-versions }} Tests
    runs-on: ${{ matrix.operating-system }}
    strategy:
      matrix:
        operating-system: ['ubuntu-latest']
        php-versions: ['5.4', '5.5', '5.6']

    steps:
      - uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-versions }}
          extensions: openssl
          tools: phpunit:4.8

      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Run tests
        run: phpunit --coverage-clover clover.xml tests

      - uses: codecov/codecov-action@v2
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./clover.xml

  tests-older:
    name: PHP ${{ matrix.php-versions }} Tests
    runs-on: ${{ matrix.operating-system }}
    strategy:
      matrix:
        operating-system: ['ubuntu-latest']
        php-versions: ['7.0', '7.1']

    steps:
      - uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-versions }}
          extensions: openssl
          tools: phpunit:6.5

      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Run tests
        run: phpunit --coverage-clover clover.xml tests

      - uses: codecov/codecov-action@v2
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./clover.xml

  tests-old:
    name: PHP ${{ matrix.php-versions }} Tests
    runs-on: ${{ matrix.operating-system }}
    strategy:
      matrix:
        operating-system: ['ubuntu-latest']
        php-versions: ['7.2', '7.3', '7.4']

    steps:
      - uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-versions }}
          extensions: openssl
          tools: phpunit:8.5

      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Run tests
        run: phpunit --coverage-clover clover.xml tests

      - uses: codecov/codecov-action@v2
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./clover.xml

  tests:
    name: PHP ${{ matrix.php-versions }} Tests
    runs-on: ${{ matrix.operating-system }}
    strategy:
      matrix:
        operating-system: ['ubuntu-latest']
        php-versions: ['8.0', '8.1']

    steps:
      - uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-versions }}
          extensions: openssl
          tools: phpunit/phpunit:9.5

      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Run tests
        run: phpunit --coverage-clover clover.xml tests

      - uses: codecov/codecov-action@v2
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./clover.xml
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/src/Utils/XPath.php">
<?php

namespace RobRichards\XMLSecLibs\Utils;

class XPath
{
    const ALPHANUMERIC = '\w\d';
    const NUMERIC = '\d';
    const LETTERS = '\w';
    const EXTENDED_ALPHANUMERIC = '\w\d\s\-_:\.';

    const SINGLE_QUOTE = '\'';
    const DOUBLE_QUOTE = '"';
    const ALL_QUOTES = '[\'"]';


    /**
     * Filter an attribute value for save inclusion in an XPath query.
     *
     * @param string $value The value to filter.
     * @param string $quotes The quotes used to delimit the value in the XPath query.
     *
     * @return string The filtered attribute value.
     */
    public static function filterAttrValue($value, $quotes = self::ALL_QUOTES)
    {
        return preg_replace('#'.$quotes.'#', '', $value);
    }


    /**
     * Filter an attribute name for save inclusion in an XPath query.
     *
     * @param string $name The attribute name to filter.
     * @param mixed $allow The set of characters to allow. Can be one of the constants provided by this class, or a
     * custom regex excluding the '#' character (used as delimiter).
     *
     * @return string The filtered attribute name.
     */
    public static function filterAttrName($name, $allow = self::EXTENDED_ALPHANUMERIC)
    {
        return preg_replace('#[^'.$allow.']#', '', $name);
    }
}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/src/XMLSecEnc.php">
<?php
namespace RobRichards\XMLSecLibs;

use DOMDocument;
use DOMElement;
use DOMNode;
use DOMXPath;
use Exception;
use RobRichards\XMLSecLibs\Utils\XPath as XPath;

/**
 * xmlseclibs.php
 *
 * Copyright (c) 2007-2024, Robert Richards <rrichards@cdatazone.org>.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   * Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   * Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in
 *     the documentation and/or other materials provided with the
 *     distribution.
 *
 *   * Neither the name of Robert Richards nor the names of his
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @author    Robert Richards <rrichards@cdatazone.org>
 * @copyright 2007-2024 Robert Richards <rrichards@cdatazone.org>
 * @license   http://www.opensource.org/licenses/bsd-license.php  BSD License
 */

class XMLSecEnc
{
    const template = "<xenc:EncryptedData xmlns:xenc='http://www.w3.org/2001/04/xmlenc#'>
   <xenc:CipherData>
      <xenc:CipherValue></xenc:CipherValue>
   </xenc:CipherData>
</xenc:EncryptedData>";

    const Element = 'http://www.w3.org/2001/04/xmlenc#Element';
    const Content = 'http://www.w3.org/2001/04/xmlenc#Content';
    const URI = 3;
    const XMLENCNS = 'http://www.w3.org/2001/04/xmlenc#';

    /** @var null|DOMDocument */
    private $encdoc = null;

    /** @var null|DOMNode  */
    private $rawNode = null;

    /** @var null|string */
    public $type = null;

    /** @var null|DOMElement */
    public $encKey = null;

    /** @var array */
    private $references = array();

    public function __construct()
    {
        $this->_resetTemplate();
    }

    private function _resetTemplate()
    {
        $this->encdoc = new DOMDocument();
        $this->encdoc->loadXML(self::template);
    }

    /**
     * @param string $name
     * @param DOMNode $node
     * @param string $type
     * @throws Exception
     */
    public function addReference($name, $node, $type)
    {
        if (! $node instanceOf DOMNode) {
            throw new Exception('$node is not of type DOMNode');
        }
        $curencdoc = $this->encdoc;
        $this->_resetTemplate();
        $encdoc = $this->encdoc;
        $this->encdoc = $curencdoc;
        $refuri = XMLSecurityDSig::generateGUID();
        $element = $encdoc->documentElement;
        $element->setAttribute("Id", $refuri);
        $this->references[$name] = array("node" => $node, "type" => $type, "encnode" => $encdoc, "refuri" => $refuri);
    }

    /**
     * @param DOMNode $node
     */
    public function setNode($node)
    {
        $this->rawNode = $node;
    }

    /**
     * Encrypt the selected node with the given key.
     *
     * @param XMLSecurityKey $objKey  The encryption key and algorithm.
     * @param bool           $replace Whether the encrypted node should be replaced in the original tree. Default is true.
     * @throws Exception
     *
     * @return DOMElement  The <xenc:EncryptedData>-element.
     */
    public function encryptNode($objKey, $replace = true)
    {
        $data = '';
        if (empty($this->rawNode)) {
            throw new Exception('Node to encrypt has not been set');
        }
        if (! $objKey instanceof XMLSecurityKey) {
            throw new Exception('Invalid Key');
        }
        $doc = $this->rawNode->ownerDocument;
        $xPath = new DOMXPath($this->encdoc);
        $objList = $xPath->query('/xenc:EncryptedData/xenc:CipherData/xenc:CipherValue');
        $cipherValue = $objList->item(0);
        if ($cipherValue == null) {
            throw new Exception('Error locating CipherValue element within template');
        }
        switch ($this->type) {
            case (self::Element):
                $data = $doc->saveXML($this->rawNode);
                $this->encdoc->documentElement->setAttribute('Type', self::Element);
                break;
            case (self::Content):
                $children = $this->rawNode->childNodes;
                foreach ($children AS $child) {
                    $data .= $doc->saveXML($child);
                }
                $this->encdoc->documentElement->setAttribute('Type', self::Content);
                break;
            default:
                throw new Exception('Type is currently not supported');
        }

        $encMethod = $this->encdoc->documentElement->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:EncryptionMethod'));
        $encMethod->setAttribute('Algorithm', $objKey->getAlgorithm());
        $cipherValue->parentNode->parentNode->insertBefore($encMethod, $cipherValue->parentNode->parentNode->firstChild);

        $strEncrypt = base64_encode($objKey->encryptData($data));
        $value = $this->encdoc->createTextNode($strEncrypt);
        $cipherValue->appendChild($value);

        if ($replace) {
            switch ($this->type) {
                case (self::Element):
                    if ($this->rawNode->nodeType == XML_DOCUMENT_NODE) {
                        return $this->encdoc;
                    }
                    $importEnc = $this->rawNode->ownerDocument->importNode($this->encdoc->documentElement, true);
                    $this->rawNode->parentNode->replaceChild($importEnc, $this->rawNode);
                    return $importEnc;
                case (self::Content):
                    $importEnc = $this->rawNode->ownerDocument->importNode($this->encdoc->documentElement, true);
                    while ($this->rawNode->firstChild) {
                        $this->rawNode->removeChild($this->rawNode->firstChild);
                    }
                    $this->rawNode->appendChild($importEnc);
                    return $importEnc;
            }
        } else {
            return $this->encdoc->documentElement;
        }
    }

    /**
     * @param XMLSecurityKey $objKey
     * @throws Exception
     */
    public function encryptReferences($objKey)
    {
        $curRawNode = $this->rawNode;
        $curType = $this->type;
        foreach ($this->references AS $name => $reference) {
            $this->encdoc = $reference["encnode"];
            $this->rawNode = $reference["node"];
            $this->type = $reference["type"];
            try {
                $encNode = $this->encryptNode($objKey);
                $this->references[$name]["encnode"] = $encNode;
            } catch (Exception $e) {
                $this->rawNode = $curRawNode;
                $this->type = $curType;
                throw $e;
            }
        }
        $this->rawNode = $curRawNode;
        $this->type = $curType;
    }

    /**
     * Retrieve the CipherValue text from this encrypted node.
     *
     * @throws Exception
     * @return string|null  The Ciphervalue text, or null if no CipherValue is found.
     */
    public function getCipherValue()
    {
        if (empty($this->rawNode)) {
            throw new Exception('Node to decrypt has not been set');
        }

        $doc = $this->rawNode->ownerDocument;
        $xPath = new DOMXPath($doc);
        $xPath->registerNamespace('xmlencr', self::XMLENCNS);
        /* Only handles embedded content right now and not a reference */
        $query = "./xmlencr:CipherData/xmlencr:CipherValue";
        $nodeset = $xPath->query($query, $this->rawNode);
        $node = $nodeset->item(0);

        if (!$node) {
                return null;
        }

        return base64_decode($node->nodeValue);
    }

    /**
     * Decrypt this encrypted node.
     *
     * The behaviour of this function depends on the value of $replace.
     * If $replace is false, we will return the decrypted data as a string.
     * If $replace is true, we will insert the decrypted element(s) into the
     * document, and return the decrypted element(s).
     *
     * @param XMLSecurityKey $objKey  The decryption key that should be used when decrypting the node.
     * @param boolean        $replace Whether we should replace the encrypted node in the XML document with the decrypted data. The default is true.
     *
     * @return string|DOMElement  The decrypted data.
     */
    public function decryptNode($objKey, $replace=true)
    {
        if (! $objKey instanceof XMLSecurityKey) {
            throw new Exception('Invalid Key');
        }

        $encryptedData = $this->getCipherValue();
        if ($encryptedData) {
            $decrypted = $objKey->decryptData($encryptedData);
            if ($replace) {
                switch ($this->type) {
                    case (self::Element):
                        $newdoc = new DOMDocument();
                        $newdoc->loadXML($decrypted);
                        if ($this->rawNode->nodeType == XML_DOCUMENT_NODE) {
                            return $newdoc;
                        }
                        $importEnc = $this->rawNode->ownerDocument->importNode($newdoc->documentElement, true);
                        $this->rawNode->parentNode->replaceChild($importEnc, $this->rawNode);
                        return $importEnc;
                    case (self::Content):
                        if ($this->rawNode->nodeType == XML_DOCUMENT_NODE) {
                            $doc = $this->rawNode;
                        } else {
                            $doc = $this->rawNode->ownerDocument;
                        }
                        $newFrag = $doc->createDocumentFragment();
                        $newFrag->appendXML($decrypted);
                        $parent = $this->rawNode->parentNode;
                        $parent->replaceChild($newFrag, $this->rawNode);
                        return $parent;
                    default:
                        return $decrypted;
                }
            } else {
                return $decrypted;
            }
        } else {
            throw new Exception("Cannot locate encrypted data");
        }
    }

    /**
     * Encrypt the XMLSecurityKey
     *
     * @param XMLSecurityKey $srcKey
     * @param XMLSecurityKey $rawKey
     * @param bool $append
     * @throws Exception
     */
    public function encryptKey($srcKey, $rawKey, $append=true)
    {
        if ((! $srcKey instanceof XMLSecurityKey) || (! $rawKey instanceof XMLSecurityKey)) {
            throw new Exception('Invalid Key');
        }
        $strEncKey = base64_encode($srcKey->encryptData($rawKey->key));
        $root = $this->encdoc->documentElement;
        $encKey = $this->encdoc->createElementNS(self::XMLENCNS, 'xenc:EncryptedKey');
        if ($append) {
            $keyInfo = $root->insertBefore($this->encdoc->createElementNS('http://www.w3.org/2000/09/xmldsig#', 'dsig:KeyInfo'), $root->firstChild);
            $keyInfo->appendChild($encKey);
        } else {
            $this->encKey = $encKey;
        }
        $encMethod = $encKey->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:EncryptionMethod'));
        $encMethod->setAttribute('Algorithm', $srcKey->getAlgorith());
        if (! empty($srcKey->name)) {
            $keyInfo = $encKey->appendChild($this->encdoc->createElementNS('http://www.w3.org/2000/09/xmldsig#', 'dsig:KeyInfo'));
            $keyInfo->appendChild($this->encdoc->createElementNS('http://www.w3.org/2000/09/xmldsig#', 'dsig:KeyName', $srcKey->name));
        }
        $cipherData = $encKey->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:CipherData'));
        $cipherData->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:CipherValue', $strEncKey));
        if (is_array($this->references) && count($this->references) > 0) {
            $refList = $encKey->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:ReferenceList'));
            foreach ($this->references AS $name => $reference) {
                $refuri = $reference["refuri"];
                $dataRef = $refList->appendChild($this->encdoc->createElementNS(self::XMLENCNS, 'xenc:DataReference'));
                $dataRef->setAttribute("URI", '#' . $refuri);
            }
        }
        return;
    }

    /**
     * @param XMLSecurityKey $encKey
     * @return DOMElement|string
     * @throws Exception
     */
    public function decryptKey($encKey)
    {
        if (! $encKey->isEncrypted) {
            throw new Exception("Key is not Encrypted");
        }
        if (empty($encKey->key)) {
            throw new Exception("Key is missing data to perform the decryption");
        }
        return $this->decryptNode($encKey, false);
    }

    /**
     * @param DOMDocument $element
     * @return DOMNode|null
     */
    public function locateEncryptedData($element)
    {
        if ($element instanceof DOMDocument) {
            $doc = $element;
        } else {
            $doc = $element->ownerDocument;
        }
        if ($doc) {
            $xpath = new DOMXPath($doc);
            $query = "//*[local-name()='EncryptedData' and namespace-uri()='".self::XMLENCNS."']";
            $nodeset = $xpath->query($query);
            return $nodeset->item(0);
        }
        return null;
    }

    /**
     * Returns the key from the DOM
     * @param null|DOMNode $node
     * @return null|XMLSecurityKey
     */
    public function locateKey($node=null)
    {
        if (empty($node)) {
            $node = $this->rawNode;
        }
        if (! $node instanceof DOMNode) {
            return null;
        }
        if ($doc = $node->ownerDocument) {
            $xpath = new DOMXPath($doc);
            $xpath->registerNamespace('xmlsecenc', self::XMLENCNS);
            $query = ".//xmlsecenc:EncryptionMethod";
            $nodeset = $xpath->query($query, $node);
            if ($encmeth = $nodeset->item(0)) {
                   $attrAlgorithm = $encmeth->getAttribute("Algorithm");
                try {
                    $objKey = new XMLSecurityKey($attrAlgorithm, array('type' => 'private'));
                } catch (Exception $e) {
                    return null;
                }
                return $objKey;
            }
        }
        return null;
    }

    /**
     * @param null|XMLSecurityKey $objBaseKey
     * @param null|DOMNode $node
     * @return null|XMLSecurityKey
     * @throws Exception
     */
    public static function staticLocateKeyInfo($objBaseKey=null, $node=null)
    {
        if (empty($node) || (! $node instanceof DOMNode)) {
            return null;
        }
        $doc = $node->ownerDocument;
        if (!$doc) {
            return null;
        }

        $xpath = new DOMXPath($doc);
        $xpath->registerNamespace('xmlsecenc', self::XMLENCNS);
        $xpath->registerNamespace('xmlsecdsig', XMLSecurityDSig::XMLDSIGNS);
        $query = "./xmlsecdsig:KeyInfo";
        $nodeset = $xpath->query($query, $node);
        $encmeth = $nodeset->item(0);
        if (!$encmeth) {
            /* No KeyInfo in EncryptedData / EncryptedKey. */
            return $objBaseKey;
        }

        foreach ($encmeth->childNodes AS $child) {
            switch ($child->localName) {
                case 'KeyName':
                    if (! empty($objBaseKey)) {
                        $objBaseKey->name = $child->nodeValue;
                    }
                    break;
                case 'KeyValue':
                    foreach ($child->childNodes AS $keyval) {
                        switch ($keyval->localName) {
                            case 'DSAKeyValue':
                                throw new Exception("DSAKeyValue currently not supported");
                            case 'RSAKeyValue':
                                $modulus = null;
                                $exponent = null;
                                if ($modulusNode = $keyval->getElementsByTagName('Modulus')->item(0)) {
                                    $modulus = base64_decode($modulusNode->nodeValue);
                                }
                                if ($exponentNode = $keyval->getElementsByTagName('Exponent')->item(0)) {
                                    $exponent = base64_decode($exponentNode->nodeValue);
                                }
                                if (empty($modulus) || empty($exponent)) {
                                    throw new Exception("Missing Modulus or Exponent");
                                }
                                $publicKey = XMLSecurityKey::convertRSA($modulus, $exponent);
                                $objBaseKey->loadKey($publicKey);
                                break;
                        }
                    }
                    break;
                case 'RetrievalMethod':
                    $type = $child->getAttribute('Type');
                    if ($type !== 'http://www.w3.org/2001/04/xmlenc#EncryptedKey') {
                        /* Unsupported key type. */
                        break;
                    }
                    $uri = $child->getAttribute('URI');
                    if ($uri[0] !== '#') {
                        /* URI not a reference - unsupported. */
                        break;
                    }
                    $id = substr($uri, 1);

                    $query = '//xmlsecenc:EncryptedKey[@Id="'.XPath::filterAttrValue($id, XPath::DOUBLE_QUOTE).'"]';
                    $keyElement = $xpath->query($query)->item(0);
                    if (!$keyElement) {
                        throw new Exception("Unable to locate EncryptedKey with @Id='$id'.");
                    }

                    return XMLSecurityKey::fromEncryptedKeyElement($keyElement);
                case 'EncryptedKey':
                    return XMLSecurityKey::fromEncryptedKeyElement($child);
                case 'X509Data':
                    if ($x509certNodes = $child->getElementsByTagName('X509Certificate')) {
                        if ($x509certNodes->length > 0) {
                            $x509cert = $x509certNodes->item(0)->textContent;
                            $x509cert = str_replace(array("\r", "\n", " ", "\t"), "", $x509cert);
                            $x509cert = "-----BEGIN CERTIFICATE-----\n".chunk_split($x509cert, 64, "\n")."-----END CERTIFICATE-----\n";
                            $objBaseKey->loadKey($x509cert, false, true);
                        }
                    }
                    break;
            }
        }
        return $objBaseKey;
    }

    /**
     * @param null|XMLSecurityKey $objBaseKey
     * @param null|DOMNode $node
     * @return null|XMLSecurityKey
     */
    public function locateKeyInfo($objBaseKey=null, $node=null)
    {
        if (empty($node)) {
            $node = $this->rawNode;
        }
        return self::staticLocateKeyInfo($objBaseKey, $node);
    }
}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/src/XMLSecurityDSig.php">
<?php
namespace RobRichards\XMLSecLibs;

use DOMDocument;
use DOMElement;
use DOMNode;
use DOMXPath;
use Exception;
use RobRichards\XMLSecLibs\Utils\XPath as XPath;

/**
 * xmlseclibs.php
 *
 * Copyright (c) 2007-2024, Robert Richards <rrichards@cdatazone.org>.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   * Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   * Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in
 *     the documentation and/or other materials provided with the
 *     distribution.
 *
 *   * Neither the name of Robert Richards nor the names of his
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @author    Robert Richards <rrichards@cdatazone.org>
 * @copyright 2007-2024 Robert Richards <rrichards@cdatazone.org>
 * @license   http://www.opensource.org/licenses/bsd-license.php  BSD License
 */

class XMLSecurityDSig
{
    const XMLDSIGNS = 'http://www.w3.org/2000/09/xmldsig#';
    const SHA1 = 'http://www.w3.org/2000/09/xmldsig#sha1';
    const SHA256 = 'http://www.w3.org/2001/04/xmlenc#sha256';
    const SHA384 = 'http://www.w3.org/2001/04/xmldsig-more#sha384';
    const SHA512 = 'http://www.w3.org/2001/04/xmlenc#sha512';
    const RIPEMD160 = 'http://www.w3.org/2001/04/xmlenc#ripemd160';

    const C14N = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315';
    const C14N_COMMENTS = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments';
    const EXC_C14N = 'http://www.w3.org/2001/10/xml-exc-c14n#';
    const EXC_C14N_COMMENTS = 'http://www.w3.org/2001/10/xml-exc-c14n#WithComments';

    const template = '<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
  <ds:SignedInfo>
    <ds:SignatureMethod />
  </ds:SignedInfo>
</ds:Signature>';

    const BASE_TEMPLATE = '<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
  <SignedInfo>
    <SignatureMethod />
  </SignedInfo>
</Signature>';

    /** @var DOMElement|null */
    public $sigNode = null;

    /** @var array */
    public $idKeys = array();

    /** @var array */
    public $idNS = array();

    /** @var string|null */
    private $signedInfo = null;

    /** @var DomXPath|null */
    private $xPathCtx = null;

    /** @var string|null */
    private $canonicalMethod = null;

    /** @var string */
    private $prefix = '';

    /** @var string */
    private $searchpfx = 'secdsig';

    /**
     * This variable contains an associative array of validated nodes.
     * @var array|null
     */
    private $validatedNodes = null;

    /**
     * @param string $prefix
     */
    public function __construct($prefix='ds')
    {
        $template = self::BASE_TEMPLATE;
        if (! empty($prefix)) {
            $this->prefix = $prefix.':';
            $search = array("<S", "</S", "xmlns=");
            $replace = array("<$prefix:S", "</$prefix:S", "xmlns:$prefix=");
            $template = str_replace($search, $replace, $template);
        }
        $sigdoc = new DOMDocument();
        $sigdoc->loadXML($template);
        $this->sigNode = $sigdoc->documentElement;
    }

    /**
     * Reset the XPathObj to null
     */
    private function resetXPathObj()
    {
        $this->xPathCtx = null;
    }

    /**
     * Returns the XPathObj or null if xPathCtx is set and sigNode is empty.
     *
     * @return DOMXPath|null
     */
    private function getXPathObj()
    {
        if (empty($this->xPathCtx) && ! empty($this->sigNode)) {
            $xpath = new DOMXPath($this->sigNode->ownerDocument);
            $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
            $this->xPathCtx = $xpath;
        }
        return $this->xPathCtx;
    }

    /**
     * Generate guid
     *
     * @param string $prefix Prefix to use for guid. defaults to pfx
     *
     * @return string The generated guid
     */
    public static function generateGUID($prefix='pfx')
    {
        $uuid = md5(uniqid(mt_rand(), true));
        $guid = $prefix.substr($uuid, 0, 8)."-".
                substr($uuid, 8, 4)."-".
                substr($uuid, 12, 4)."-".
                substr($uuid, 16, 4)."-".
                substr($uuid, 20, 12);
        return $guid;
    }

    /**
     * Generate guid
     *
     * @param string $prefix Prefix to use for guid. defaults to pfx
     *
     * @return string The generated guid
     *
     * @deprecated Method deprecated in Release 1.4.1
     */
    public static function generate_GUID($prefix='pfx')
    {
        return self::generateGUID($prefix);
    }

    /**
     * @param DOMDocument $objDoc
     * @param int $pos
     * @return DOMNode|null
     */
    public function locateSignature($objDoc, $pos=0)
    {
        if ($objDoc instanceof DOMDocument) {
            $doc = $objDoc;
        } else {
            $doc = $objDoc->ownerDocument;
        }
        if ($doc) {
            $xpath = new DOMXPath($doc);
            $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
            $query = ".//secdsig:Signature";
            $nodeset = $xpath->query($query, $objDoc);
            $this->sigNode = $nodeset->item($pos);
            $query = "./secdsig:SignedInfo";
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($nodeset->length > 1) {
                throw new Exception("Invalid structure - Too many SignedInfo elements found");
            }
            return $this->sigNode;
        }
        return null;
    }

    /**
     * @param string $name
     * @param null|string $value
     * @return DOMElement
     */
    public function createNewSignNode($name, $value=null)
    {
        $doc = $this->sigNode->ownerDocument;
        if (! is_null($value)) {
            $node = $doc->createElementNS(self::XMLDSIGNS, $this->prefix.$name, $value);
        } else {
            $node = $doc->createElementNS(self::XMLDSIGNS, $this->prefix.$name);
        }
        return $node;
    }

    /**
     * @param string $method
     * @throws Exception
     */
    public function setCanonicalMethod($method)
    {
        switch ($method) {
            case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315':
            case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments':
            case 'http://www.w3.org/2001/10/xml-exc-c14n#':
            case 'http://www.w3.org/2001/10/xml-exc-c14n#WithComments':
                $this->canonicalMethod = $method;
                break;
            default:
                throw new Exception('Invalid Canonical Method');
        }
        if ($xpath = $this->getXPathObj()) {
            $query = './'.$this->searchpfx.':SignedInfo';
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($sinfo = $nodeset->item(0)) {
                $query = './'.$this->searchpfx.'CanonicalizationMethod';
                $nodeset = $xpath->query($query, $sinfo);
                if (! ($canonNode = $nodeset->item(0))) {
                    $canonNode = $this->createNewSignNode('CanonicalizationMethod');
                    $sinfo->insertBefore($canonNode, $sinfo->firstChild);
                }
                $canonNode->setAttribute('Algorithm', $this->canonicalMethod);
            }
        }
    }

    /**
     * @param DOMNode $node
     * @param string $canonicalmethod
     * @param null|array $arXPath
     * @param null|array $prefixList
     * @return string
     */
    private function canonicalizeData($node, $canonicalmethod, $arXPath=null, $prefixList=null)
    {
        $exclusive = false;
        $withComments = false;
        switch ($canonicalmethod) {
            case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315':
                $exclusive = false;
                $withComments = false;
                break;
            case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments':
                $withComments = true;
                break;
            case 'http://www.w3.org/2001/10/xml-exc-c14n#':
                $exclusive = true;
                break;
            case 'http://www.w3.org/2001/10/xml-exc-c14n#WithComments':
                $exclusive = true;
                $withComments = true;
                break;
        }

        if (is_null($arXPath) && ($node instanceof DOMNode) && ($node->ownerDocument !== null) && $node->isSameNode($node->ownerDocument->documentElement)) {
            /* Check for any PI or comments as they would have been excluded */
            $element = $node;
            while ($refnode = $element->previousSibling) {
                if ($refnode->nodeType == XML_PI_NODE || (($refnode->nodeType == XML_COMMENT_NODE) && $withComments)) {
                    break;
                }
                $element = $refnode;
            }
            if ($refnode == null) {
                $node = $node->ownerDocument;
            }
        }

        return $node->C14N($exclusive, $withComments, $arXPath, $prefixList);
    }

    /**
     * @return null|string
     */
    public function canonicalizeSignedInfo()
    {

        $doc = $this->sigNode->ownerDocument;
        $canonicalmethod = null;
        if ($doc) {
            $xpath = $this->getXPathObj();
            $query = "./secdsig:SignedInfo";
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($nodeset->length > 1) {
                throw new Exception("Invalid structure - Too many SignedInfo elements found");
            }
            if ($signInfoNode = $nodeset->item(0)) {
                $query = "./secdsig:CanonicalizationMethod";
                $nodeset = $xpath->query($query, $signInfoNode);
                $prefixList = null;
                if ($canonNode = $nodeset->item(0)) {
                    $canonicalmethod = $canonNode->getAttribute('Algorithm');
                    foreach ($canonNode->childNodes as $node)
                    {
                        if ($node->localName == 'InclusiveNamespaces') {
                            if ($pfx = $node->getAttribute('PrefixList')) {
                                $arpfx = array_filter(explode(' ', $pfx));
                                if (count($arpfx) > 0) {
                                    $prefixList = array_merge($prefixList ? $prefixList : array(), $arpfx);
                                }
                            }
                        }
                    }
                }
                $this->signedInfo = $this->canonicalizeData($signInfoNode, $canonicalmethod, null, $prefixList);
                return $this->signedInfo;
            }
        }
        return null;
    }

    /**
     * @param string $digestAlgorithm
     * @param string $data
     * @param bool $encode
     * @return string
     * @throws Exception
     */
    public function calculateDigest($digestAlgorithm, $data, $encode = true)
    {
        switch ($digestAlgorithm) {
            case self::SHA1:
                $alg = 'sha1';
                break;
            case self::SHA256:
                $alg = 'sha256';
                break;
            case self::SHA384:
                $alg = 'sha384';
                break;
            case self::SHA512:
                $alg = 'sha512';
                break;
            case self::RIPEMD160:
                $alg = 'ripemd160';
                break;
            default:
                throw new Exception("Cannot validate digest: Unsupported Algorithm <$digestAlgorithm>");
        }

        $digest = hash($alg, $data, true);
        if ($encode) {
            $digest = base64_encode($digest);
        }
        return $digest;

    }

    /**
     * @param $refNode
     * @param string $data
     * @return bool
     */
    public function validateDigest($refNode, $data)
    {
        $xpath = new DOMXPath($refNode->ownerDocument);
        $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
        $query = 'string(./secdsig:DigestMethod/@Algorithm)';
        $digestAlgorithm = $xpath->evaluate($query, $refNode);
        $digValue = $this->calculateDigest($digestAlgorithm, $data, false);
        $query = 'string(./secdsig:DigestValue)';
        $digestValue = $xpath->evaluate($query, $refNode);
        return ($digValue === base64_decode($digestValue));
    }

    /**
     * @param $refNode
     * @param DOMNode $objData
     * @param bool $includeCommentNodes
     * @return string
     */
    public function processTransforms($refNode, $objData, $includeCommentNodes = true)
    {
        $data = $objData;
        $xpath = new DOMXPath($refNode->ownerDocument);
        $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
        $query = './secdsig:Transforms/secdsig:Transform';
        $nodelist = $xpath->query($query, $refNode);
        $canonicalMethod = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315';
        $arXPath = null;
        $prefixList = null;
        foreach ($nodelist AS $transform) {
            $algorithm = $transform->getAttribute("Algorithm");
            switch ($algorithm) {
                case 'http://www.w3.org/2001/10/xml-exc-c14n#':
                case 'http://www.w3.org/2001/10/xml-exc-c14n#WithComments':

                    if (!$includeCommentNodes) {
                        /* We remove comment nodes by forcing it to use a canonicalization
                         * without comments.
                         */
                        $canonicalMethod = 'http://www.w3.org/2001/10/xml-exc-c14n#';
                    } else {
                        $canonicalMethod = $algorithm;
                    }

                    $node = $transform->firstChild;
                    while ($node) {
                        if ($node->localName == 'InclusiveNamespaces') {
                            if ($pfx = $node->getAttribute('PrefixList')) {
                                $arpfx = array();
                                $pfxlist = explode(" ", $pfx);
                                foreach ($pfxlist AS $pfx) {
                                    $val = trim($pfx);
                                    if (! empty($val)) {
                                        $arpfx[] = $val;
                                    }
                                }
                                if (count($arpfx) > 0) {
                                    $prefixList = $arpfx;
                                }
                            }
                            break;
                        }
                        $node = $node->nextSibling;
                    }
            break;
                case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315':
                case 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments':
                    if (!$includeCommentNodes) {
                        /* We remove comment nodes by forcing it to use a canonicalization
                         * without comments.
                         */
                        $canonicalMethod = 'http://www.w3.org/TR/2001/REC-xml-c14n-20010315';
                    } else {
                        $canonicalMethod = $algorithm;
                    }

                    break;
                case 'http://www.w3.org/TR/1999/REC-xpath-19991116':
                    $node = $transform->firstChild;
                    while ($node) {
                        if ($node->localName == 'XPath') {
                            $arXPath = array();
                            $arXPath['query'] = '(.//. | .//@* | .//namespace::*)['.$node->nodeValue.']';
                            $arXPath['namespaces'] = array();
                            $nslist = $xpath->query('./namespace::*', $node);
                            foreach ($nslist AS $nsnode) {
                                if ($nsnode->localName != "xml") {
                                    $arXPath['namespaces'][$nsnode->localName] = $nsnode->nodeValue;
                                }
                            }
                            break;
                        }
                        $node = $node->nextSibling;
                    }
                    break;
            }
        }
        if ($data instanceof DOMNode) {
            $data = $this->canonicalizeData($objData, $canonicalMethod, $arXPath, $prefixList);
        }
        return $data;
    }

    /**
     * @param DOMNode $refNode
     * @return bool
     */
    public function processRefNode($refNode)
    {
        $dataObject = null;

        /*
         * Depending on the URI, we may not want to include comments in the result
         * See: http://www.w3.org/TR/xmldsig-core/#sec-ReferenceProcessingModel
         */
        $includeCommentNodes = true;

        if ($uri = $refNode->getAttribute("URI")) {
            $arUrl = parse_url($uri);
            if (empty($arUrl['path'])) {
                if ($identifier = $arUrl['fragment']) {

                    /* This reference identifies a node with the given id by using
                     * a URI on the form "#identifier". This should not include comments.
                     */
                    $includeCommentNodes = false;

                    $xPath = new DOMXPath($refNode->ownerDocument);
                    if ($this->idNS && is_array($this->idNS)) {
                        foreach ($this->idNS as $nspf => $ns) {
                            $xPath->registerNamespace($nspf, $ns);
                        }
                    }
                    $iDlist = '@Id="'.XPath::filterAttrValue($identifier, XPath::DOUBLE_QUOTE).'"';
                    if (is_array($this->idKeys)) {
                        foreach ($this->idKeys as $idKey) {
                            $iDlist .= " or @".XPath::filterAttrName($idKey).'="'.
                                XPath::filterAttrValue($identifier, XPath::DOUBLE_QUOTE).'"';
                        }
                    }
                    $query = '//*['.$iDlist.']';
                    $dataObject = $xPath->query($query)->item(0);
                } else {
                    $dataObject = $refNode->ownerDocument;
                }
            }
        } else {
            /* This reference identifies the root node with an empty URI. This should
             * not include comments.
             */
            $includeCommentNodes = false;

            $dataObject = $refNode->ownerDocument;
        }
        $data = $this->processTransforms($refNode, $dataObject, $includeCommentNodes);
        if (!$this->validateDigest($refNode, $data)) {
            return false;
        }

        if ($dataObject instanceof DOMNode) {
            /* Add this node to the list of validated nodes. */
            if (! empty($identifier)) {
                $this->validatedNodes[$identifier] = $dataObject;
            } else {
                $this->validatedNodes[] = $dataObject;
            }
        }

        return true;
    }

    /**
     * @param DOMNode $refNode
     * @return null
     */
    public function getRefNodeID($refNode)
    {
        if ($uri = $refNode->getAttribute("URI")) {
            $arUrl = parse_url($uri);
            if (empty($arUrl['path'])) {
                if ($identifier = $arUrl['fragment']) {
                    return $identifier;
                }
            }
        }
        return null;
    }

    /**
     * @return array
     * @throws Exception
     */
    public function getRefIDs()
    {
        $refids = array();

        $xpath = $this->getXPathObj();
        $query = "./secdsig:SignedInfo[1]/secdsig:Reference";
        $nodeset = $xpath->query($query, $this->sigNode);
        if ($nodeset->length == 0) {
            throw new Exception("Reference nodes not found");
        }
        foreach ($nodeset AS $refNode) {
            $refids[] = $this->getRefNodeID($refNode);
        }
        return $refids;
    }

    /**
     * @return bool
     * @throws Exception
     */
    public function validateReference()
    {
        $docElem = $this->sigNode->ownerDocument->documentElement;
        if (! $docElem->isSameNode($this->sigNode)) {
            if ($this->sigNode->parentNode != null) {
                $this->sigNode->parentNode->removeChild($this->sigNode);
            }
        }
        $xpath = $this->getXPathObj();
        $query = "./secdsig:SignedInfo[1]/secdsig:Reference";
        $nodeset = $xpath->query($query, $this->sigNode);
        if ($nodeset->length == 0) {
            throw new Exception("Reference nodes not found");
        }

        /* Initialize/reset the list of validated nodes. */
        $this->validatedNodes = array();

        foreach ($nodeset AS $refNode) {
            if (! $this->processRefNode($refNode)) {
                /* Clear the list of validated nodes. */
                $this->validatedNodes = null;
                throw new Exception("Reference validation failed");
            }
        }
        return true;
    }

    /**
     * @param DOMNode $sinfoNode
     * @param DOMDocument $node
     * @param string $algorithm
     * @param null|array $arTransforms
     * @param null|array $options
     */
    private function addRefInternal($sinfoNode, $node, $algorithm, $arTransforms=null, $options=null)
    {
        $prefix = null;
        $prefix_ns = null;
        $id_name = 'Id';
        $overwrite_id  = true;
        $force_uri = false;

        if (is_array($options)) {
            $prefix = empty($options['prefix']) ? null : $options['prefix'];
            $prefix_ns = empty($options['prefix_ns']) ? null : $options['prefix_ns'];
            $id_name = empty($options['id_name']) ? 'Id' : $options['id_name'];
            $overwrite_id = !isset($options['overwrite']) ? true : (bool) $options['overwrite'];
            $force_uri = !isset($options['force_uri']) ? false : (bool) $options['force_uri'];
        }

        $attname = $id_name;
        if (! empty($prefix)) {
            $attname = $prefix.':'.$attname;
        }

        $refNode = $this->createNewSignNode('Reference');
        $sinfoNode->appendChild($refNode);

        if (! $node instanceof DOMDocument) {
            $uri = null;
            if (! $overwrite_id) {
                $uri = $prefix_ns ? $node->getAttributeNS($prefix_ns, $id_name) : $node->getAttribute($id_name);
            }
            if (empty($uri)) {
                $uri = self::generateGUID();
                $node->setAttributeNS($prefix_ns, $attname, $uri);
            }
            $refNode->setAttribute("URI", '#'.$uri);
        } elseif ($force_uri) {
            $refNode->setAttribute("URI", '');
        }

        $transNodes = $this->createNewSignNode('Transforms');
        $refNode->appendChild($transNodes);

        if (is_array($arTransforms)) {
            foreach ($arTransforms AS $transform) {
                $transNode = $this->createNewSignNode('Transform');
                $transNodes->appendChild($transNode);
                if (is_array($transform) &&
                    (! empty($transform['http://www.w3.org/TR/1999/REC-xpath-19991116'])) &&
                    (! empty($transform['http://www.w3.org/TR/1999/REC-xpath-19991116']['query']))) {
                    $transNode->setAttribute('Algorithm', 'http://www.w3.org/TR/1999/REC-xpath-19991116');
                    $XPathNode = $this->createNewSignNode('XPath', $transform['http://www.w3.org/TR/1999/REC-xpath-19991116']['query']);
                    $transNode->appendChild($XPathNode);
                    if (! empty($transform['http://www.w3.org/TR/1999/REC-xpath-19991116']['namespaces'])) {
                        foreach ($transform['http://www.w3.org/TR/1999/REC-xpath-19991116']['namespaces'] AS $prefix => $namespace) {
                            $XPathNode->setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:$prefix", $namespace);
                        }
                    }
                } else {
                    $transNode->setAttribute('Algorithm', $transform);
                }
            }
        } elseif (! empty($this->canonicalMethod)) {
            $transNode = $this->createNewSignNode('Transform');
            $transNodes->appendChild($transNode);
            $transNode->setAttribute('Algorithm', $this->canonicalMethod);
        }

        $canonicalData = $this->processTransforms($refNode, $node);
        $digValue = $this->calculateDigest($algorithm, $canonicalData);

        $digestMethod = $this->createNewSignNode('DigestMethod');
        $refNode->appendChild($digestMethod);
        $digestMethod->setAttribute('Algorithm', $algorithm);

        $digestValue = $this->createNewSignNode('DigestValue', $digValue);
        $refNode->appendChild($digestValue);
    }

    /**
     * @param DOMDocument $node
     * @param string $algorithm
     * @param null|array $arTransforms
     * @param null|array $options
     */
    public function addReference($node, $algorithm, $arTransforms=null, $options=null)
    {
        if ($xpath = $this->getXPathObj()) {
            $query = "./secdsig:SignedInfo";
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($sInfo = $nodeset->item(0)) {
                $this->addRefInternal($sInfo, $node, $algorithm, $arTransforms, $options);
            }
        }
    }

    /**
     * @param array $arNodes
     * @param string $algorithm
     * @param null|array $arTransforms
     * @param null|array $options
     */
    public function addReferenceList($arNodes, $algorithm, $arTransforms=null, $options=null)
    {
        if ($xpath = $this->getXPathObj()) {
            $query = "./secdsig:SignedInfo";
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($sInfo = $nodeset->item(0)) {
                foreach ($arNodes AS $node) {
                    $this->addRefInternal($sInfo, $node, $algorithm, $arTransforms, $options);
                }
            }
        }
    }

    /**
     * @param DOMElement|string $data
     * @param null|string $mimetype
     * @param null|string $encoding
     * @return DOMElement
     */
    public function addObject($data, $mimetype=null, $encoding=null)
    {
        $objNode = $this->createNewSignNode('Object');
        $this->sigNode->appendChild($objNode);
        if (! empty($mimetype)) {
            $objNode->setAttribute('MimeType', $mimetype);
        }
        if (! empty($encoding)) {
            $objNode->setAttribute('Encoding', $encoding);
        }

        if ($data instanceof DOMElement) {
            $newData = $this->sigNode->ownerDocument->importNode($data, true);
        } else {
            $newData = $this->sigNode->ownerDocument->createTextNode($data);
        }
        $objNode->appendChild($newData);

        return $objNode;
    }

    /**
     * @param null|DOMNode $node
     * @return null|XMLSecurityKey
     */
    public function locateKey($node=null)
    {
        if (empty($node)) {
            $node = $this->sigNode;
        }
        if (! $node instanceof DOMNode) {
            return null;
        }
        if ($doc = $node->ownerDocument) {
            $xpath = new DOMXPath($doc);
            $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
            $query = "string(./secdsig:SignedInfo/secdsig:SignatureMethod/@Algorithm)";
            $algorithm = $xpath->evaluate($query, $node);
            if ($algorithm) {
                try {
                    $objKey = new XMLSecurityKey($algorithm, array('type' => 'public'));
                } catch (Exception $e) {
                    return null;
                }
                return $objKey;
            }
        }
        return null;
    }

    /**
     * Returns:
     *  Bool when verifying HMAC_SHA1;
     *  Int otherwise, with following meanings:
     *    1 on succesful signature verification,
     *    0 when signature verification failed,
     *   -1 if an error occurred during processing.
     *
     * NOTE: be very careful when checking the int return value, because in
     * PHP, -1 will be cast to True when in boolean context. Always check the
     * return value in a strictly typed way, e.g. "$obj->verify(...) === 1".
     *
     * @param XMLSecurityKey $objKey
     * @return bool|int
     * @throws Exception
     */
    public function verify($objKey)
    {
        $doc = $this->sigNode->ownerDocument;
        $xpath = new DOMXPath($doc);
        $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
        $query = "string(./secdsig:SignatureValue)";
        $sigValue = $xpath->evaluate($query, $this->sigNode);
        if (empty($sigValue)) {
            throw new Exception("Unable to locate SignatureValue");
        }
        return $objKey->verifySignature($this->signedInfo, base64_decode($sigValue));
    }

    /**
     * @param XMLSecurityKey $objKey
     * @param string $data
     * @return mixed|string
     */
    public function signData($objKey, $data)
    {
        return $objKey->signData($data);
    }

    /**
     * @param XMLSecurityKey $objKey
     * @param null|DOMNode $appendToNode
     */
    public function sign($objKey, $appendToNode = null)
    {
        // If we have a parent node append it now so C14N properly works
        if ($appendToNode != null) {
            $this->resetXPathObj();
            $this->appendSignature($appendToNode);
            $this->sigNode = $appendToNode->lastChild;
        }
        if ($xpath = $this->getXPathObj()) {
            $query = "./secdsig:SignedInfo";
            $nodeset = $xpath->query($query, $this->sigNode);
            if ($sInfo = $nodeset->item(0)) {
                $query = "./secdsig:SignatureMethod";
                $nodeset = $xpath->query($query, $sInfo);
                $sMethod = $nodeset->item(0);
                $sMethod->setAttribute('Algorithm', $objKey->type);
                $data = $this->canonicalizeData($sInfo, $this->canonicalMethod);
                $sigValue = base64_encode($this->signData($objKey, $data));
                $sigValueNode = $this->createNewSignNode('SignatureValue', $sigValue);
                if ($infoSibling = $sInfo->nextSibling) {
                    $infoSibling->parentNode->insertBefore($sigValueNode, $infoSibling);
                } else {
                    $this->sigNode->appendChild($sigValueNode);
                }
            }
        }
    }

    public function appendCert()
    {

    }

    /**
     * @param XMLSecurityKey $objKey
     * @param null|DOMNode $parent
     */
    public function appendKey($objKey, $parent=null)
    {
        $objKey->serializeKey($parent);
    }


    /**
     * This function inserts the signature element.
     *
     * The signature element will be appended to the element, unless $beforeNode is specified. If $beforeNode
     * is specified, the signature element will be inserted as the last element before $beforeNode.
     *
     * @param DOMNode $node       The node the signature element should be inserted into.
     * @param DOMNode $beforeNode The node the signature element should be located before.
     *
     * @return DOMNode The signature element node
     */
    public function insertSignature($node, $beforeNode = null)
    {

        $document = $node->ownerDocument;
        $signatureElement = $document->importNode($this->sigNode, true);

        if ($beforeNode == null) {
            return $node->insertBefore($signatureElement);
        } else {
            return $node->insertBefore($signatureElement, $beforeNode);
        }
    }

    /**
     * @param DOMNode $parentNode
     * @param bool $insertBefore
     * @return DOMNode
     */
    public function appendSignature($parentNode, $insertBefore = false)
    {
        $beforeNode = $insertBefore ? $parentNode->firstChild : null;
        return $this->insertSignature($parentNode, $beforeNode);
    }

    /**
     * @param string $cert
     * @param bool $isPEMFormat
     * @return string
     */
    public static function get509XCert($cert, $isPEMFormat=true)
    {
        $certs = self::staticGet509XCerts($cert, $isPEMFormat);
        if (! empty($certs)) {
            return $certs[0];
        }
        return '';
    }

    /**
     * @param string $certs
     * @param bool $isPEMFormat
     * @return array
     */
    public static function staticGet509XCerts($certs, $isPEMFormat=true)
    {
        if ($isPEMFormat) {
            $data = '';
            $certlist = array();
            $arCert = explode("\n", $certs);
            $inData = false;
            foreach ($arCert AS $curData) {
                if (! $inData) {
                    if (strncmp($curData, '-----BEGIN CERTIFICATE', 22) == 0) {
                        $inData = true;
                    }
                } else {
                    if (strncmp($curData, '-----END CERTIFICATE', 20) == 0) {
                        $inData = false;
                        $certlist[] = $data;
                        $data = '';
                        continue;
                    }
                    $data .= trim($curData);
                }
            }
            return $certlist;
        } else {
            return array($certs);
        }
    }

    /**
     * @param DOMElement $parentRef
     * @param string $cert
     * @param bool $isPEMFormat
     * @param bool $isURL
     * @param null|DOMXPath $xpath
     * @param null|array $options
     * @throws Exception
     */
    public static function staticAdd509Cert($parentRef, $cert, $isPEMFormat=true, $isURL=false, $xpath=null, $options=null)
    {
        if ($isURL) {
            $cert = file_get_contents($cert);
        }
        if (! $parentRef instanceof DOMElement) {
            throw new Exception('Invalid parent Node parameter');
        }
        $baseDoc = $parentRef->ownerDocument;

        if (empty($xpath)) {
            $xpath = new DOMXPath($parentRef->ownerDocument);
            $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
        }

        $query = "./secdsig:KeyInfo";
        $nodeset = $xpath->query($query, $parentRef);
        $keyInfo = $nodeset->item(0);
        $dsig_pfx = '';
        if (! $keyInfo) {
            $pfx = $parentRef->lookupPrefix(self::XMLDSIGNS);
            if (! empty($pfx)) {
                $dsig_pfx = $pfx.":";
            }
            $inserted = false;
            $keyInfo = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'KeyInfo');

            $query = "./secdsig:Object";
            $nodeset = $xpath->query($query, $parentRef);
            if ($sObject = $nodeset->item(0)) {
                $sObject->parentNode->insertBefore($keyInfo, $sObject);
                $inserted = true;
            }

            if (! $inserted) {
                $parentRef->appendChild($keyInfo);
            }
        } else {
            $pfx = $keyInfo->lookupPrefix(self::XMLDSIGNS);
            if (! empty($pfx)) {
                $dsig_pfx = $pfx.":";
            }
        }

        // Add all certs if there are more than one
        $certs = self::staticGet509XCerts($cert, $isPEMFormat);

        // Attach X509 data node
        $x509DataNode = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509Data');
        $keyInfo->appendChild($x509DataNode);

        $issuerSerial = false;
        $subjectName = false;
        if (is_array($options)) {
            if (! empty($options['issuerSerial'])) {
                $issuerSerial = true;
            }
            if (! empty($options['subjectName'])) {
                $subjectName = true;
            }
        }

        // Attach all certificate nodes and any additional data
        foreach ($certs as $X509Cert) {
            if ($issuerSerial || $subjectName) {
                if ($certData = openssl_x509_parse("-----BEGIN CERTIFICATE-----\n".chunk_split($X509Cert, 64, "\n")."-----END CERTIFICATE-----\n")) {
                    if ($subjectName && ! empty($certData['subject'])) {
                        if (is_array($certData['subject'])) {
                            $parts = array();
                            foreach ($certData['subject'] AS $key => $value) {
                                if (is_array($value)) {
                                    foreach ($value as $valueElement) {
                                        array_unshift($parts, "$key=$valueElement");
                                    }
                                } else {
                                    array_unshift($parts, "$key=$value");
                                }
                            }
                            $subjectNameValue = implode(',', $parts);
                        } else {
                            $subjectNameValue = $certData['subject'];
                        }
                        $x509SubjectNode = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509SubjectName', $subjectNameValue);
                        $x509DataNode->appendChild($x509SubjectNode);
                    }
                    if ($issuerSerial && ! empty($certData['issuer']) && ! empty($certData['serialNumber'])) {
                        if (is_array($certData['issuer'])) {
                            $parts = array();
                            foreach ($certData['issuer'] AS $key => $value) {
                                array_unshift($parts, "$key=$value");
                            }
                            $issuerName = implode(',', $parts);
                        } else {
                            $issuerName = $certData['issuer'];
                        }

                        $x509IssuerNode = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509IssuerSerial');
                        $x509DataNode->appendChild($x509IssuerNode);

                        $x509Node = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509IssuerName', $issuerName);
                        $x509IssuerNode->appendChild($x509Node);
                        $x509Node = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509SerialNumber', $certData['serialNumber']);
                        $x509IssuerNode->appendChild($x509Node);
                    }
                }

            }
            $x509CertNode = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'X509Certificate', $X509Cert);
            $x509DataNode->appendChild($x509CertNode);
        }
    }

    /**
     * @param string $cert
     * @param bool $isPEMFormat
     * @param bool $isURL
     * @param null|array $options
     */
    public function add509Cert($cert, $isPEMFormat=true, $isURL=false, $options=null)
    {
        if ($xpath = $this->getXPathObj()) {
            self::staticAdd509Cert($this->sigNode, $cert, $isPEMFormat, $isURL, $xpath, $options);
        }
    }

    /**
     * This function appends a node to the KeyInfo.
     *
     * The KeyInfo element will be created if one does not exist in the document.
     *
     * @param DOMNode $node The node to append to the KeyInfo.
     *
     * @return DOMNode The KeyInfo element node
     */
    public function appendToKeyInfo($node)
    {
        $parentRef = $this->sigNode;
        $baseDoc = $parentRef->ownerDocument;

        $xpath = $this->getXPathObj();
        if (empty($xpath)) {
            $xpath = new DOMXPath($parentRef->ownerDocument);
            $xpath->registerNamespace('secdsig', self::XMLDSIGNS);
        }

        $query = "./secdsig:KeyInfo";
        $nodeset = $xpath->query($query, $parentRef);
        $keyInfo = $nodeset->item(0);
        if (! $keyInfo) {
            $dsig_pfx = '';
            $pfx = $parentRef->lookupPrefix(self::XMLDSIGNS);
            if (! empty($pfx)) {
                $dsig_pfx = $pfx.":";
            }
            $inserted = false;
            $keyInfo = $baseDoc->createElementNS(self::XMLDSIGNS, $dsig_pfx.'KeyInfo');

            $query = "./secdsig:Object";
            $nodeset = $xpath->query($query, $parentRef);
            if ($sObject = $nodeset->item(0)) {
                $sObject->parentNode->insertBefore($keyInfo, $sObject);
                $inserted = true;
            }

            if (! $inserted) {
                $parentRef->appendChild($keyInfo);
            }
        }

        $keyInfo->appendChild($node);

        return $keyInfo;
    }

    /**
     * This function retrieves an associative array of the validated nodes.
     *
     * The array will contain the id of the referenced node as the key and the node itself
     * as the value.
     *
     * Returns:
     *  An associative array of validated nodes or null if no nodes have been validated.
     *
     *  @return array Associative array of validated nodes
     */
    public function getValidatedNodes()
    {
        return $this->validatedNodes;
    }
}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/src/XMLSecurityKey.php">
<?php
namespace RobRichards\XMLSecLibs;

use DOMElement;
use Exception;

/**
 * xmlseclibs.php
 *
 * Copyright (c) 2007-2024, Robert Richards <rrichards@cdatazone.org>.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   * Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   * Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in
 *     the documentation and/or other materials provided with the
 *     distribution.
 *
 *   * Neither the name of Robert Richards nor the names of his
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @author    Robert Richards <rrichards@cdatazone.org>
 * @copyright 2007-2024 Robert Richards <rrichards@cdatazone.org>
 * @license   http://www.opensource.org/licenses/bsd-license.php  BSD License
 */

class XMLSecurityKey
{
    const TRIPLEDES_CBC = 'http://www.w3.org/2001/04/xmlenc#tripledes-cbc';
    const AES128_CBC = 'http://www.w3.org/2001/04/xmlenc#aes128-cbc';
    const AES192_CBC = 'http://www.w3.org/2001/04/xmlenc#aes192-cbc';
    const AES256_CBC = 'http://www.w3.org/2001/04/xmlenc#aes256-cbc';
    const AES128_GCM = 'http://www.w3.org/2009/xmlenc11#aes128-gcm';
    const AES192_GCM = 'http://www.w3.org/2009/xmlenc11#aes192-gcm';
    const AES256_GCM = 'http://www.w3.org/2009/xmlenc11#aes256-gcm';
    const RSA_1_5 = 'http://www.w3.org/2001/04/xmlenc#rsa-1_5';
    const RSA_OAEP_MGF1P = 'http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p';
    const RSA_OAEP = 'http://www.w3.org/2009/xmlenc11#rsa-oaep';
    const DSA_SHA1 = 'http://www.w3.org/2000/09/xmldsig#dsa-sha1';
    const RSA_SHA1 = 'http://www.w3.org/2000/09/xmldsig#rsa-sha1';
    const RSA_SHA256 = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha256';
    const RSA_SHA384 = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha384';
    const RSA_SHA512 = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha512';
    const HMAC_SHA1 = 'http://www.w3.org/2000/09/xmldsig#hmac-sha1';
    const AUTHTAG_LENGTH = 16;

    /** @var array */
    private $cryptParams = array();

    /** @var int|string */
    public $type = 0;

    /** @var mixed|null */
    public $key = null;

    /** @var string  */
    public $passphrase = "";

    /** @var string|null */
    public $iv = null;

    /** @var string|null */
    public $name = null;

    /** @var mixed|null */
    public $keyChain = null;

    /** @var bool */
    public $isEncrypted = false;

    /** @var XMLSecEnc|null */
    public $encryptedCtx = null;

    /** @var mixed|null */
    public $guid = null;

    /**
     * This variable contains the certificate as a string if this key represents an X509-certificate.
     * If this key doesn't represent a certificate, this will be null.
     * @var string|null
     */
    private $x509Certificate = null;

    /**
     * This variable contains the certificate thumbprint if we have loaded an X509-certificate.
     * @var string|null
     */
    private $X509Thumbprint = null;

    /**
     * @param string $type
     * @param null|array $params
     * @throws Exception
     */
    public function __construct($type, $params=null)
    {
        switch ($type) {
            case (self::TRIPLEDES_CBC):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'des-ede3-cbc';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#tripledes-cbc';
                $this->cryptParams['keysize'] = 24;
                $this->cryptParams['blocksize'] = 8;
                break;
            case (self::AES128_CBC):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-128-cbc';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#aes128-cbc';
                $this->cryptParams['keysize'] = 16;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::AES192_CBC):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-192-cbc';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#aes192-cbc';
                $this->cryptParams['keysize'] = 24;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::AES256_CBC):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-256-cbc';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#aes256-cbc';
                $this->cryptParams['keysize'] = 32;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::AES128_GCM):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-128-gcm';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2009/xmlenc11#aes128-gcm';
                $this->cryptParams['keysize'] = 16;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::AES192_GCM):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-192-gcm';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2009/xmlenc11#aes192-gcm';
                $this->cryptParams['keysize'] = 24;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::AES256_GCM):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['cipher'] = 'aes-256-gcm';
                $this->cryptParams['type'] = 'symmetric';
                $this->cryptParams['method'] = 'http://www.w3.org/2009/xmlenc11#aes256-gcm';
                $this->cryptParams['keysize'] = 32;
                $this->cryptParams['blocksize'] = 16;
                break;
            case (self::RSA_1_5):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_PADDING;
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#rsa-1_5';
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_OAEP_MGF1P):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_OAEP_PADDING;
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p';
                $this->cryptParams['hash'] = null;
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_OAEP):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_OAEP_PADDING;
                $this->cryptParams['method'] = 'http://www.w3.org/2009/xmlenc11#rsa-oaep';
                $this->cryptParams['hash'] = 'http://www.w3.org/2009/xmlenc11#mgf1sha1';
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_SHA1):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['method'] = 'http://www.w3.org/2000/09/xmldsig#rsa-sha1';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_PADDING;
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_SHA256):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha256';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_PADDING;
                $this->cryptParams['digest'] = 'SHA256';
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_SHA384):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha384';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_PADDING;
                $this->cryptParams['digest'] = 'SHA384';
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::RSA_SHA512):
                $this->cryptParams['library'] = 'openssl';
                $this->cryptParams['method'] = 'http://www.w3.org/2001/04/xmldsig-more#rsa-sha512';
                $this->cryptParams['padding'] = OPENSSL_PKCS1_PADDING;
                $this->cryptParams['digest'] = 'SHA512';
                if (is_array($params) && ! empty($params['type'])) {
                    if ($params['type'] == 'public' || $params['type'] == 'private') {
                        $this->cryptParams['type'] = $params['type'];
                        break;
                    }
                }
                throw new Exception('Certificate "type" (private/public) must be passed via parameters');
            case (self::HMAC_SHA1):
                $this->cryptParams['library'] = $type;
                $this->cryptParams['method'] = 'http://www.w3.org/2000/09/xmldsig#hmac-sha1';
                break;
            default:
                throw new Exception('Invalid Key Type');
        }
        $this->type = $type;
    }

    /**
     * Retrieve the key size for the symmetric encryption algorithm..
     *
     * If the key size is unknown, or this isn't a symmetric encryption algorithm,
     * null is returned.
     *
     * @return int|null  The number of bytes in the key.
     */
    public function getSymmetricKeySize()
    {
        if (! isset($this->cryptParams['keysize'])) {
            return null;
        }
        return $this->cryptParams['keysize'];
    }

    /**
     * Generates a session key using the openssl-extension.
     * In case of using DES3-CBC the key is checked for a proper parity bits set.
     * @return string
     * @throws Exception
     */
    public function generateSessionKey()
    {
        if (!isset($this->cryptParams['keysize'])) {
            throw new Exception('Unknown key size for type "' . $this->type . '".');
        }
        $keysize = $this->cryptParams['keysize'];
        
        $key = openssl_random_pseudo_bytes($keysize);
        
        if ($this->type === self::TRIPLEDES_CBC) {
            /* Make sure that the generated key has the proper parity bits set.
             * Mcrypt doesn't care about the parity bits, but others may care.
            */
            for ($i = 0; $i < strlen($key); $i++) {
                $byte = ord($key[$i]) & 0xfe;
                $parity = 1;
                for ($j = 1; $j < 8; $j++) {
                    $parity ^= ($byte >> $j) & 1;
                }
                $byte |= $parity;
                $key[$i] = chr($byte);
            }
        }
        
        $this->key = $key;
        return $key;
    }

    /**
     * Get the raw thumbprint of a certificate
     *
     * @param string $cert
     * @return null|string
     */
    public static function getRawThumbprint($cert)
    {

        $arCert = explode("\n", $cert);
        $data = '';
        $inData = false;

        foreach ($arCert AS $curData) {
            if (! $inData) {
                if (strncmp($curData, '-----BEGIN CERTIFICATE', 22) == 0) {
                    $inData = true;
                }
            } else {
                if (strncmp($curData, '-----END CERTIFICATE', 20) == 0) {
                    break;
                }
                $data .= trim($curData);
            }
        }

        if (! empty($data)) {
            return strtolower(sha1(base64_decode($data)));
        }

        return null;
    }

    /**
     * Loads the given key, or - with isFile set true - the key from the keyfile.
     *
     * @param string $key
     * @param bool $isFile
     * @param bool $isCert
     * @throws Exception
     */
    public function loadKey($key, $isFile=false, $isCert = false)
    {
        if ($isFile) {
            $this->key = file_get_contents($key);
        } else {
            $this->key = $key;
        }
        if ($isCert) {
            $this->key = openssl_x509_read($this->key);
            openssl_x509_export($this->key, $str_cert);
            $this->x509Certificate = $str_cert;
            $this->key = $str_cert;
        } else {
            $this->x509Certificate = null;
        }
        if ($this->cryptParams['library'] == 'openssl') {
            switch ($this->cryptParams['type']) {
                case 'public':
	                if ($isCert) {
	                    /* Load the thumbprint if this is an X509 certificate. */
	                    $this->X509Thumbprint = self::getRawThumbprint($this->key);
	                }
	                $this->key = openssl_get_publickey($this->key);
	                if (! $this->key) {
	                    throw new Exception('Unable to extract public key');
	                }
	                break;

	            case 'private':
                    $this->key = openssl_get_privatekey($this->key, $this->passphrase);
                    break;

                case'symmetric':
                    if (strlen($this->key) < $this->cryptParams['keysize']) {
                        throw new Exception('Key must contain at least '.$this->cryptParams['keysize'].' characters for this cipher, contains '.strlen($this->key));
                    }
                    break;

                default:
                    throw new Exception('Unknown type');
            }
        }
    }

    /**
     * ISO 10126 Padding
     *
     * @param string $data
     * @param integer $blockSize
     * @throws Exception
     * @return string
     */
    private function padISO10126($data, $blockSize)
    {
        if ($blockSize > 256) {
            throw new Exception('Block size higher than 256 not allowed');
        }
        $padChr = $blockSize - (strlen($data) % $blockSize);
        $pattern = chr($padChr);
        return $data . str_repeat($pattern, $padChr);
    }

    /**
     * Remove ISO 10126 Padding
     *
     * @param string $data
     * @return string
     */
    private function unpadISO10126($data)
    {
        $padChr = substr($data, -1);
        $padLen = ord($padChr);
        return substr($data, 0, -$padLen);
    }

    /**
     * Encrypts the given data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     */
    private function encryptSymmetric($data)
    {
        $this->iv = openssl_random_pseudo_bytes(openssl_cipher_iv_length($this->cryptParams['cipher']));
        $authTag = null;
        if(in_array($this->cryptParams['cipher'], ['aes-128-gcm', 'aes-192-gcm', 'aes-256-gcm'])) {
            if (version_compare(PHP_VERSION, '7.1.0') < 0) {
                throw new Exception('PHP 7.1.0 is required to use AES GCM algorithms');
            }
            $authTag = openssl_random_pseudo_bytes(self::AUTHTAG_LENGTH);
            $encrypted = openssl_encrypt($data, $this->cryptParams['cipher'], $this->key, OPENSSL_RAW_DATA, $this->iv, $authTag);
        } else {
            $data = $this->padISO10126($data, $this->cryptParams['blocksize']);
            $encrypted = openssl_encrypt($data, $this->cryptParams['cipher'], $this->key, OPENSSL_RAW_DATA | OPENSSL_ZERO_PADDING, $this->iv);
        }
        
        if (false === $encrypted) {
            throw new Exception('Failure encrypting Data (openssl symmetric) - ' . openssl_error_string());
        }
        return $this->iv . $encrypted . $authTag;
    }

    /**
     * Decrypts the given data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     */
    private function decryptSymmetric($data)
    {
        $iv_length = openssl_cipher_iv_length($this->cryptParams['cipher']);
        $this->iv = substr($data, 0, $iv_length);
        $data = substr($data, $iv_length);
        $authTag = null;
        if(in_array($this->cryptParams['cipher'], ['aes-128-gcm', 'aes-192-gcm', 'aes-256-gcm'])) {
            if (version_compare(PHP_VERSION, '7.1.0') < 0) {
                throw new Exception('PHP 7.1.0 is required to use AES GCM algorithms');
            }
            // obtain and remove the authentication tag
            $offset = 0 - self::AUTHTAG_LENGTH;
            $authTag = substr($data, $offset);
            $data = substr($data, 0, $offset);
            $decrypted = openssl_decrypt($data, $this->cryptParams['cipher'], $this->key, OPENSSL_RAW_DATA, $this->iv, $authTag);
        } else {
            $decrypted = openssl_decrypt($data, $this->cryptParams['cipher'], $this->key, OPENSSL_RAW_DATA | OPENSSL_ZERO_PADDING, $this->iv);
        }
        
        if (false === $decrypted) {
            throw new Exception('Failure decrypting Data (openssl symmetric) - ' . openssl_error_string());
        }
        return null !== $authTag ? $decrypted : $this->unpadISO10126($decrypted);
    }

    /**
     * Encrypts the given public data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     * @throws Exception
     */
    private function encryptPublic($data)
    {
        if (! openssl_public_encrypt($data, $encrypted, $this->key, $this->cryptParams['padding'])) {
            throw new Exception('Failure encrypting Data (openssl public) - ' . openssl_error_string());
        }
        return $encrypted;
    }

    /**
     * Decrypts the given public data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     * @throws Exception
     */
    private function decryptPublic($data)
    {
        if (! openssl_public_decrypt($data, $decrypted, $this->key, $this->cryptParams['padding'])) {
            throw new Exception('Failure decrypting Data (openssl public) - ' . openssl_error_string());
        }
        return $decrypted;
    }

    /**
     * Encrypts the given private data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     * @throws Exception
     */
    private function encryptPrivate($data)
    {
        if (! openssl_private_encrypt($data, $encrypted, $this->key, $this->cryptParams['padding'])) {
            throw new Exception('Failure encrypting Data (openssl private) - ' . openssl_error_string());
        }
        return $encrypted;
    }

    /**
     * Decrypts the given private data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     * @throws Exception
     */
    private function decryptPrivate($data)
    {
        if (! openssl_private_decrypt($data, $decrypted, $this->key, $this->cryptParams['padding'])) {
            throw new Exception('Failure decrypting Data (openssl private) - ' . openssl_error_string());
        }
        return $decrypted;
    }

    /**
     * Signs the given data (string) using the openssl-extension
     *
     * @param string $data
     * @return string
     * @throws Exception
     */
    private function signOpenSSL($data)
    {
        $algo = OPENSSL_ALGO_SHA1;
        if (! empty($this->cryptParams['digest'])) {
            $algo = $this->cryptParams['digest'];
        }
        if (! openssl_sign($data, $signature, $this->key, $algo)) {
            throw new Exception('Failure Signing Data: ' . openssl_error_string() . ' - ' . $algo);
        }
        return $signature;
    }

    /**
     * Verifies the given data (string) belonging to the given signature using the openssl-extension
     *
     * Returns:
     *  1 on succesful signature verification,
     *  0 when signature verification failed,
     *  -1 if an error occurred during processing.
     *
     * NOTE: be very careful when checking the return value, because in PHP,
     * -1 will be cast to True when in boolean context. So always check the
     * return value in a strictly typed way, e.g. "$obj->verify(...) === 1".
     *
     * @param string $data
     * @param string $signature
     * @return int
     */
    private function verifyOpenSSL($data, $signature)
    {
        $algo = OPENSSL_ALGO_SHA1;
        if (! empty($this->cryptParams['digest'])) {
            $algo = $this->cryptParams['digest'];
        }
        return openssl_verify($data, $signature, $this->key, $algo);
    }

    /**
     * Encrypts the given data (string) using the regarding php-extension, depending on the library assigned to algorithm in the contructor.
     *
     * @param string $data
     * @return mixed|string
     */
    public function encryptData($data)
    {
        if ($this->cryptParams['library'] === 'openssl') {
            switch ($this->cryptParams['type']) {
                case 'symmetric':
                    return $this->encryptSymmetric($data);
                case 'public':
                    return $this->encryptPublic($data);
                case 'private':
                    return $this->encryptPrivate($data);
            }
        }
    }

    /**
     * Decrypts the given data (string) using the regarding php-extension, depending on the library assigned to algorithm in the contructor.
     *
     * @param string $data
     * @return mixed|string
     */
    public function decryptData($data)
    {
        if ($this->cryptParams['library'] === 'openssl') {
            switch ($this->cryptParams['type']) {
                case 'symmetric':
                    return $this->decryptSymmetric($data);
                case 'public':
                    return $this->decryptPublic($data);
                case 'private':
                    return $this->decryptPrivate($data);
            }
        }
    }

    /**
     * Signs the data (string) using the extension assigned to the type in the constructor.
     *
     * @param string $data
     * @return mixed|string
     */
    public function signData($data)
    {
        switch ($this->cryptParams['library']) {
            case 'openssl':
                return $this->signOpenSSL($data);
            case (self::HMAC_SHA1):
                return hash_hmac("sha1", $data, $this->key, true);
        }
    }

    /**
     * Verifies the data (string) against the given signature using the extension assigned to the type in the constructor.
     *
     * Returns in case of openSSL:
     *  1 on succesful signature verification,
     *  0 when signature verification failed,
     *  -1 if an error occurred during processing.
     *
     * NOTE: be very careful when checking the return value, because in PHP,
     * -1 will be cast to True when in boolean context. So always check the
     * return value in a strictly typed way, e.g. "$obj->verify(...) === 1".
     *
     * @param string $data
     * @param string $signature
     * @return bool|int
     */
    public function verifySignature($data, $signature)
    {
        switch ($this->cryptParams['library']) {
            case 'openssl':
                return $this->verifyOpenSSL($data, $signature);
            case (self::HMAC_SHA1):
                $expectedSignature = hash_hmac("sha1", $data, $this->key, true);
                return strcmp($signature, $expectedSignature) == 0;
        }
    }

    /**
     * @deprecated
     * @see getAlgorithm()
     * @return mixed
     */
    public function getAlgorith()
    {
        return $this->getAlgorithm();
    }

    /**
     * @return mixed
     */
    public function getAlgorithm()
    {
        return $this->cryptParams['method'];
    }

    /**
     *
     * @param int $type
     * @param string $string
     * @return null|string
     */
    public static function makeAsnSegment($type, $string)
    {
        switch ($type) {
            case 0x02:
                if (ord($string) > 0x7f)
                    $string = chr(0).$string;
                break;
            case 0x03:
                $string = chr(0).$string;
                break;
        }

        $length = strlen($string);

        if ($length < 128) {
            $output = sprintf("%c%c%s", $type, $length, $string);
        } else if ($length < 0x0100) {
            $output = sprintf("%c%c%c%s", $type, 0x81, $length, $string);
        } else if ($length < 0x010000) {
            $output = sprintf("%c%c%c%c%s", $type, 0x82, $length / 0x0100, $length % 0x0100, $string);
        } else {
            $output = null;
        }
        return $output;
    }

    /**
     *
     * Hint: Modulus and Exponent must already be base64 decoded
     * @param string $modulus
     * @param string $exponent
     * @return string
     */
    public static function convertRSA($modulus, $exponent)
    {
        /* make an ASN publicKeyInfo */
        $exponentEncoding = self::makeAsnSegment(0x02, $exponent);
        $modulusEncoding = self::makeAsnSegment(0x02, $modulus);
        $sequenceEncoding = self::makeAsnSegment(0x30, $modulusEncoding.$exponentEncoding);
        $bitstringEncoding = self::makeAsnSegment(0x03, $sequenceEncoding);
        $rsaAlgorithmIdentifier = pack("H*", "300D06092A864886F70D0101010500");
        $publicKeyInfo = self::makeAsnSegment(0x30, $rsaAlgorithmIdentifier.$bitstringEncoding);

        /* encode the publicKeyInfo in base64 and add PEM brackets */
        $publicKeyInfoBase64 = base64_encode($publicKeyInfo);
        $encoding = "-----BEGIN PUBLIC KEY-----\n";
        $offset = 0;
        while ($segment = substr($publicKeyInfoBase64, $offset, 64)) {
            $encoding = $encoding.$segment."\n";
            $offset += 64;
        }
        return $encoding."-----END PUBLIC KEY-----\n";
    }

    /**
     * @param mixed $parent
     */
    public function serializeKey($parent)
    {

    }

    /**
     * Retrieve the X509 certificate this key represents.
     *
     * Will return the X509 certificate in PEM-format if this key represents
     * an X509 certificate.
     *
     * @return string The X509 certificate or null if this key doesn't represent an X509-certificate.
     */
    public function getX509Certificate()
    {
        return $this->x509Certificate;
    }

    /**
     * Get the thumbprint of this X509 certificate.
     *
     * Returns:
     *  The thumbprint as a lowercase 40-character hexadecimal number, or null
     *  if this isn't a X509 certificate.
     *
     *  @return string Lowercase 40-character hexadecimal number of thumbprint
     */
    public function getX509Thumbprint()
    {
        return $this->X509Thumbprint;
    }


    /**
     * Create key from an EncryptedKey-element.
     *
     * @param DOMElement $element The EncryptedKey-element.
     * @throws Exception
     *
     * @return XMLSecurityKey The new key.
     */
    public static function fromEncryptedKeyElement(DOMElement $element)
    {

        $objenc = new XMLSecEnc();
        $objenc->setNode($element);
        if (! $objKey = $objenc->locateKey()) {
            throw new Exception("Unable to locate algorithm for this Encrypted Key");
        }
        $objKey->isEncrypted = true;
        $objKey->encryptedCtx = $objenc;
        XMLSecEnc::staticLocateKeyInfo($objKey, $element);
        return $objKey;
    }

}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/CHANGELOG.txt">
xmlseclibs.php
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
20, Nov 2024, 3.1.3
Bug Fixes:
- remove loadKey check due to BC issues

20, Nov 2024, 3.1.2
Improvements:
- Add tab to list of whitespace values to remove from cert. refs #252
- loadKey should check return value for openssl_get_privatekey (sammarshallou)
- Switch to GitHub actions (SharkMachine)

05, Sep 2020, 3.1.1
Features:
- Support OAEP (iggyvolz)

Bug Fixes:
- Fix AES128 (iggyvolz)

Improvements:
- Fix tests for older PHP

22, Apr 2020, 3.1.0
Features:
- Support AES-GCM. Requires PHP 7.1. (Franois Kooman)

Improvements:
- Fix Travis tests for older PHP versions.
- Use DOMElement interface to fix some IDEs reporting documentation errors

Bug Fixes:
- FIX missing InclusiveNamespaces PrefixList from Java + Apache WSS4J. (njake)

06, Nov 2019, 3.0.4
Security Improvements:
- Insure only a single SignedInfo element exists within a signature during 
  verification. Refs CVE-2019-3465.
Bug Fixes:
- Fix variable casing.

15, Nov 2018, 3.0.3
Bug Fixes:
- Fix casing of class name. (Willem Stuursma-Ruwen)
- Fix Xpath casing. (Tim van Dijen)

Improvements:
- Make PCRE2 compliant. (Stefan Winter)
- Add PHP 7.3 support. (Stefan Winter)

27, Sep 2018, 3.0.2
Security Improvements:
- OpenSSL is now a requirement rather than suggestion. (Slaven Bacelic)
- Filter input to avoid XPath injection. (Jaime Prez)

Bug Fixes:
- Fix missing parentheses (Tim van Dijen)

Improvements:
- Use strict comparison operator to compare digest values. (Jaime Prez)
- Remove call to file_get_contents that doesn't even work. (Jaime Prez)
- Document potentially dangerous return value behaviour. (Thijs Kinkhorst)

31, Aug 2017, 3.0.1
Bug Fixes:
- Fixed missing () in function call. (Dennis Vversted)

Improvements:
- Add OneLogin to supported software.
- Add .gitattributes to remove unneeded files. (Filippo Tessarotto)
- Fix bug in example code. (Dan Church)
- Travis: add PHP 7.1, move hhvm to allowed failures. (Thijs Kinkhorst)
- Drop failing extract-win-cert test (Thijs Kinkhorst). (Thijs Kinkhorst)
- Add comments to warn about return values of verify(). (Thijs Kinkhorst)
- Fix tests to properly check return code of verify(). (Thijs Kinkhorst)
- Restore support for PHP >= 5.4. (Jaime Prez)

25, May 2017, 3.0.0
Improvements:
- Remove use of mcrypt (skymeyer)

08, Sep 2016, 2.0.1
Bug Fixes:
- Strip whitespace characters when parsing X509Certificate. fixes #84
  (klemen.bratec)
- Certificate 'subject' values can be arrays. fixes #80 (Andreas Stangl)
- HHVM signing node with ID attribute w/out namespace regenerates ID value.
  fixes #88 (Milos Tomic)

Improvements:
- Fix typos and add some PHPDoc Blocks. (gfaust-qb)
- Update lightSAML link. (Milos Tomic)
- Update copyright dates.

31, Jul 2015, 2.0.0
Features:
- Namespace support. Classes now in the RobRichards\XMLSecLibs\ namespace.

Improvements:
- Dropped support for PHP 5.2

31, Jul 2015, 1.4.1
Bug Fixes:
- Allow for large digest values that may have line breaks. fixes #62

Features:
- Support for locating specific signature when multiple exist in 
  document. (griga3k)

Improvements:
- Add optional argument to XMLSecurityDSig to define the prefix to be used, 
  also allowing for null to use no prefix, for the dsig namespace. fixes #13
- Code cleanup
- Depreciated XMLSecurityDSig::generate_GUID for XMLSecurityDSig::generateGUID

23, Jun 2015, 1.4.0
Features:
- Support for PSR-0 standard.
- Support for X509SubjectName. (Milos Tomic)
- Add HMAC-SHA1 support.

Improvements:
- Add how to install to README. (Bernardo Vieira da Silva)
- Code cleanup. (Jaime Prez)
- Normalilze tests. (Hidde Wieringa)
- Add basic usage to README. (Hidde Wieringa)

21, May 2015, 1.3.2
Bug Fixes:
- Fix Undefined variable notice. (dpieper85)
- Fix typo when setting MimeType attribute. (Eugene OZ)
- Fix validateReference() with enveloping signatures

Features:
- canonicalizeData performance optimization. (Jaime Prez)
- Add composer support (Maks3w)

19, Jun 2013, 1.3.1
Features:
- return encrypted node from XMLSecEnc::encryptNode() when replace is set to 
  false. (Olav)
- Add support for RSA SHA384 and RSA_SHA512 and SHA384 digest. (Jaime Prez)
- Add options parameter to the add cert methods.
- Add optional issuerSerial creation with cert

Bug Fixes:
- Fix persisted Id when namespaced. (Koen Thomeer)

Improvements:
- Add LICENSE file
- Convert CHANGELOG.txt to UTF-8

26, Sep 2011, 1.3.0
Features:
- Add param to append sig to node when signing. Fixes a problem when using 
  inclusive canonicalization to append a signature within a namespaced subtree.
  ex. $objDSig->sign($objKey, $appendToNode); 
- Add ability to encrypt by reference
- Add support for refences within an encrypted key
- Add thumbprint generation capability (XMLSecurityKey->getX509Thumbprint() and 
  XMLSecurityKey::getRawThumbprint($cert))
- Return signature element node from XMLSecurityDSig::insertSignature() and 
  XMLSecurityDSig::appendSignature() methods
- Support for <ds:RetrievalMethod> with simple URI Id reference.
- Add XMLSecurityKey::getSymmetricKeySize() method (Olav)
- Add XMLSecEnc::getCipherValue() method (Olav)
- Improve XMLSecurityKey:generateSessionKey() logic (Olav)

Bug Fixes:
- Change split() to explode() as split is now depreciated
- ds:References using empty or simple URI Id reference should never include 
  comments in canonicalized data.
- Make sure that the elements in EncryptedData are emitted in the correct 
  sequence.

11 Jan 2010, 1.2.2
Features:
- Add support XPath support when creating signature. Provides support for 
  working with EBXML documents.
- Add reference option to force creation of URI attribute. For use
  when adding a DOM Document where by default no URI attribute is added.
- Add support for RSA-SHA256

Bug Fixes:
- fix bug #5: createDOMDocumentFragment() in decryptNode when data is node 
  content (patch by Francois Wang)


08 Jul 2008, 1.2.1
Features:
- Attempt to use mhash when hash extension is not present. (Alfredo Cubitos).
- Add fallback to built-in sha1 if both hash and mhash are not available and 
  throw error for other for other missing hashes. (patch by Olav Morken).
- Add getX509Certificate method to retrieve the x509 cert used for Key. 
  (patch by Olav Morken).
- Add getValidatedNodes method to retrieve the elements signed by the 
  signature. (patch by Olav Morken).
- Add insertSignature method for precision signature insertion. Merge 
  functionality from appendSignature in the process. (Olav Morken, Rob).
- Finally add some tests

Bug Fixes:
- Fix canonicalization for Document node when using PHP < 5.2.
- Add padding for RSA_SHA1. (patch by Olav Morken).


27 Nov 2007, 1.2.0
Features:
- New addReference/List option (overwrite). Boolean flag indicating if URI
  value should be overwritten if already existing within document.
  Default is TRUE to maintain BC.

18 Nov 2007, 1.1.2
Bug Fixes:
- Remove closing PHP tag to fix extra whitespace characters from being output

11 Nov 2007, 1.1.1
Features:
- Add getRefNodeID() and getRefIDs() methods missed in previous release.
  Provide functionality to find URIs of existing reference nodes.
  Required by simpleSAMLphp project

Bug Fixes:
- Remove erroneous whitespace causing issues under certain circumastances.

18 Oct 2007, 1.1.0
Features:
- Enable creation of enveloping signature. This allows the creation of
  managed information cards.
- Add addObject method for enveloping signatures.
- Add staticGet509XCerts method. Chained certificates within a PEM file can
  now be added within the X509Data node.
- Add xpath support within transformations
- Add InclusiveNamespaces prefix list support within exclusive transformations.

Bug Fixes:
- Initialize random number generator for mcrypt_create_iv. (Joan Cornad).
- Fix an interoperability issue with .NET when encrypting data in CBC mode.
  (Joan Cornad).
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/composer.json">
{
  "name": "robrichards/xmlseclibs",
  "description": "A PHP library for XML Security",
  "license": "BSD-3-Clause",
  "keywords": [
    "xml",
    "xmldsig",
    "signature",
    "security"
  ],
  "homepage": "https://github.com/robrichards/xmlseclibs",
  "autoload": {
    "psr-4": {
      "RobRichards\\XMLSecLibs\\": "src"
    }
  },
  "require": {
    "php": ">= 5.4",
    "ext-openssl": "*"
  }
}
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/LICENSE">
Copyright (c) 2007-2024, Robert Richards <rrichards@cdatazone.org>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

  * Neither the name of Robert Richards nor the names of his
    contributors may be used to endorse or promote products derived
    from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/phpunit.xml">
<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://schema.phpunit.de/6.5/phpunit.xsd">
	<filter>
		<whitelist addUncoveredFilesFromWhitelist="false">
			<directory suffix=".php">src</directory>
		</whitelist>
	</filter>
</phpunit>
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/README.md">
#xmlseclibs 

xmlseclibs is a library written in PHP for working with XML Encryption and Signatures.

The author of xmlseclibs is Rob Richards.

# Branches
Master is currently the only actively maintained branch.
* master/3.1: Added AES-GCM support requiring 7.1+
* 3.0: Removes mcrypt usage requiring 5.4+ (5.6.24+ recommended for security reasons)
* 2.0: Contains namespace support requiring 5.3+
* 1.4: Contains auto-loader support while also maintaining backwards compatiblity with the older 1.3 version using the xmlseclibs.php file. Supports PHP 5.2+

# Requirements

xmlseclibs requires PHP version 5.4 or greater. **5.6.24+ recommended for security reasons**


## How to Install

Install with [`composer.phar`](http://getcomposer.org).

```sh
php composer.phar require "robrichards/xmlseclibs"
```


## Use cases

xmlseclibs is being used in many different software.

* [SimpleSAMLPHP](https://github.com/simplesamlphp/simplesamlphp)
* [LightSAML](https://github.com/lightsaml/lightsaml)
* [OneLogin](https://github.com/onelogin/php-saml)

## Basic usage

The example below shows basic usage of xmlseclibs, with a SHA-256 signature.

```php
use RobRichards\XMLSecLibs\XMLSecurityDSig;
use RobRichards\XMLSecLibs\XMLSecurityKey;

// Load the XML to be signed
$doc = new DOMDocument();
$doc->load('./path/to/file/tobesigned.xml');

// Create a new Security object 
$objDSig = new XMLSecurityDSig();
// Use the c14n exclusive canonicalization
$objDSig->setCanonicalMethod(XMLSecurityDSig::EXC_C14N);
// Sign using SHA-256
$objDSig->addReference(
    $doc, 
    XMLSecurityDSig::SHA256, 
    array('http://www.w3.org/2000/09/xmldsig#enveloped-signature')
);

// Create a new (private) Security key
$objKey = new XMLSecurityKey(XMLSecurityKey::RSA_SHA256, array('type'=>'private'));
/*
If key has a passphrase, set it using
$objKey->passphrase = '<passphrase>';
*/
// Load the private key
$objKey->loadKey('./path/to/privatekey.pem', TRUE);

// Sign the XML file
$objDSig->sign($objKey);

// Add the associated public key to the signature
$objDSig->add509Cert(file_get_contents('./path/to/file/mycert.pem'));

// Append the signature to the XML
$objDSig->appendSignature($doc->documentElement);
// Save the signed XML
$doc->save('./path/to/signed.xml');
```

## How to Contribute

* [Open Issues](https://github.com/robrichards/xmlseclibs/issues)
* [Open Pull Requests](https://github.com/robrichards/xmlseclibs/pulls)

Mailing List: https://groups.google.com/forum/#!forum/xmlseclibs
</file>

<file path="payisp/vendor/robrichards/xmlseclibs/xmlseclibs.php">
<?php
/**
 * xmlseclibs.php
 *
 * Copyright (c) 2007-2024, Robert Richards <rrichards@cdatazone.org>.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   * Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   * Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in
 *     the documentation and/or other materials provided with the
 *     distribution.
 *
 *   * Neither the name of Robert Richards nor the names of his
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @author    Robert Richards <rrichards@cdatazone.org>
 * @copyright 2007-2024 Robert Richards <rrichards@cdatazone.org>
 * @license   http://www.opensource.org/licenses/bsd-license.php  BSD License
 * @version   3.1.3
 */

$xmlseclibs_srcdir = dirname(__FILE__) . '/src/';
require $xmlseclibs_srcdir . '/XMLSecurityKey.php';
require $xmlseclibs_srcdir . '/XMLSecurityDSig.php';
require $xmlseclibs_srcdir . '/XMLSecEnc.php';
require $xmlseclibs_srcdir . '/Utils/XPath.php';
</file>

<file path="payisp/vendor/autoload.php">
<?php

// autoload.php @generated by Composer

if (PHP_VERSION_ID < 50600) {
    if (!headers_sent()) {
        header('HTTP/1.1 500 Internal Server Error');
    }
    $err = 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP_EOL;
    if (!ini_get('display_errors')) {
        if (PHP_SAPI === 'cli' || PHP_SAPI === 'phpdbg') {
            fwrite(STDERR, $err);
        } elseif (!headers_sent()) {
            echo $err;
        }
    }
    throw new RuntimeException($err);
}

require_once __DIR__ . '/composer/autoload_real.php';

return ComposerAutoloaderInit518a6773f70c2b492a0f6286d3031f47::getLoader();
</file>

<file path="payisp/ajax.registrar.php">
<?php
include(dirname(__FILE__) . '/init.php');
$resultados = $registro = $sucesso = array();
$atualizar = false;
//valida se o cliente esta atrelado a um banco vlido 
$uuid = valor_antigo_payisp('cliente_uuid');
$cliente = dados_cliente_mkauth_payisp($uuid);
if ($cliente) {
	if ((int)$cliente['conta'] == 0) {
		$registro[] = array('erro' => true, 'log' => 'No foi possivel fazer o registro automatico das faturas para este cliente pois o mesmo no possui uma conta boleto relacionada, altere o cliente > financeiro > conta boleto e escolha uma conta vlida.');
	} else {
		$banco_mk = dados_banco_mkauth_payisp((int)$cliente['conta']);
		$banco_payisp = dados_banco_uuid_payisp($banco_mk['uuid_boleto']);
		if (!isset($banco_payisp['id'])) {
			$registro[] = array('erro' => true, 'log' => 'No foi possivel fazer o registro automatico das faturas para este cliente pois a conta boleto deste cliente no  uma conta gerenciada via PAYISP, altere o cliente > financeiro > conta boleto e escolha uma conta vlida.');
		} else {
			//se o registro automatico ta ativo
			if ($banco_payisp['auto_registro'] == 1) {
				//class de registro do boleto 
				$obj = class_banco_payisp($banco_payisp['cod_banco']);
				if (is_object($obj) && method_exists($obj, 'registrar')) {
					//lista os titulos sem registro e tenta fazer o registro 
					$sql_boletos = "SELECT * FROM `vtab_titulos` WHERE titulo >= " . (int)$id_fatura_inicial_cron . " AND deltitulo = 0 AND status = 'aberto' AND uuid_cliente = '" . $uuid . "' AND (fcartaobandeira = '' OR fcartaobandeira IS NULL) AND (conta = 0 || conta = " . (int)$cliente['conta'] . ") LIMIT " . (($sandbox) ? '1' : '36') . "";
					$results = $mysqli->query($sql_boletos);
					if ($results->num_rows > 0) {
						while ($row = $results->fetch_array()) {
							//inclui adicionais ao total de registro
							$total_inicial = $row['valor'];
							$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
							$results_adicionais = $mysqli->query($sql_adicionais);
							while ($rowad = $results_adicionais->fetch_array()) {
								if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
									$total_inicial -= $rowad['valor'];
								} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
									$total_inicial += $rowad['valor'];
								}
							}
							$row['valor'] = $total_inicial;
							//registro
							$resultado = $obj->registrar($row, $banco_payisp, $banco_mk);
							if (isset($resultado['erro']) && $resultado['erro'] == false) {
								//cria o pix 
								if (isset($resultado['qrcode']) && !empty($resultado['qrcode'])) {
									$sql = "INSERT INTO sis_qrpix SET titulo = '" . $row['uuid_lanc'] . "', qrcode = '" . $resultado['qrcode'] . "'";
									$mysqli->query($sql);
								}
								//atualiza o lancamento
								$sql = "UPDATE sis_lanc SET nossonum = '" . $resultado['nosso_numero'] . "', linhadig = '" . preg_replace('/\D/', '', $resultado['linha']) . "', num_recibos = 1, fcartaobandeira = '" . $resultado['tid'] . "', fcartaonumero = '" . $banco_payisp['cod_banco'] . "', id_empresa = '" . $resultado['nosso_numero'] . "', fchequenumero = 'registrado', fchequebanco = '" . preg_replace('/\D/', '', $resultado['linha']) . "', fchequeagcc = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
								$mysqli->query($sql);
								//codigo de barras 
								$sql = "UPDATE sis_lanc SET codigo_barras = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
								$mysqli->query($sql);
								//cria o registro individual
								$sql = "INSERT INTO payisp_faturas SET cod_banco = '" . $banco_payisp['cod_banco'] . "', nosso_numero = '" . $resultado['nosso_numero'] . "', linha = '" . preg_replace('/\D/', '', $resultado['linha']) . "', cod_barra = '" . preg_replace('/\D/', '', $resultado['barras']) . "', fatura_mkauth = '" . $row['titulo'] . "', valor_fatura = '" . number_format($row['valor'], 2, '.', '') . "', valor_desconto = '" . number_format($resultado['desconto'], 2, '.', '') . "', tipo_desconto = '" . $resultado['tipo_desconto'] . "', status = 'aberto', data_desconto = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_validade = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_emissao = '" . date('Y-m-d') . "', pix = '" . $resultado['qrcode'] . "', txid = '" . $resultado['txid'] . "', cod = '" . $resultado['tid'] . "'";
								$mysqli->query($sql);
								//ok
								$atualizar = true;
								$sucesso[] = $row['titulo'];
								$registro[] = array('erro' => false, 'log' => $resultado['log'], 'raw' => $resultado);
							} else {
								//erro
								$registro[] = array('erro' => true, 'log' => $resultado['log'], 'raw' => $resultado);
							}
						}
					}
				}
			}
		}
	}
	//log
	if (count($sucesso) > 0) {
		criar_log_mkauth_payisp('Titulo(s) ' . implode(',', $sucesso) . ' Registados Ajax via PAY ISP [' . $banco_payisp['cod_banco'] . '].', 'admin');
	}
}
@header("Content-type: application/json; charset=utf-8");
$resultados = array('atualizar' => $atualizar, 'logs' => $registro);
die(json_encode($resultados));
</file>

<file path="payisp/api.php">
<?php
//detalhes de api
$sandbox = false;
$token_sandbox = '1301865f-c6bc-38f3-9f49-666dbcfc59c3';
$numeroContratoCobranca = 1;
//caminho do XSD nfcom
$caminhoXsdNfcom = '/opt/mk-auth/admin/addons/payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/nfcom_v1.00.xsd';
$caminhoXsdNfcomEventos = '/opt/mk-auth/admin/addons/payisp/esquemas/PL_NFCOM_1.00_NT2025.001_RTC_1.10/eventoNFCom_v1.00.xsd';
//lista de bancos que usam certificados digitais
$bancosComCertificadoPFX = array(
    'bancodobrasil' => true,
    'sicoob' => true,
    'sicredi' => true,
);
//estados nfcom
$estadosNfcom = array(
    'RO' => 11,
    'AC' => 12,
    'AM' => 13,
    'RR' => 14,
    'PA' => 15,
    'AP' => 16,
    'TO' => 17,
    'MA' => 21,
    'PI' => 22,
    'CE' => 23,
    'RN' => 24,
    'PB' => 25,
    'PE' => 26,
    'AL' => 27,
    'SE' => 28,
    'BA' => 29,
    'MG' => 31,
    'ES' => 32,
    'RJ' => 33,
    'SP' => 35,
    'PR' => 41,
    'SC' => 42,
    'RS' => 43,
    'MS' => 50,
    'MT' => 51,
    'GO' => 52,
    'DF' => 53
);
//tipos de assinante nfcom
$tpServUtilNfcom = array(
    1 => 'Telefonia',
    2 => 'Comunicao de dados',
    3 => 'TV por Assinatura',
    4 => 'Provimento de acesso  Internet',
    5 => 'Multimdia',
    6 => 'Outros',
    7 => 'Vrios'
);
//unidades de medida
$unidadesNfcomDeMedida = [
    '1' => 'Minuto',
    '2' => 'MB',
    '3' => 'GB',
    '4' => 'UN',
];
//cfops nfcom
$cfopsNfcomPublicos = array(
    '1205' => 'Anulao de valor relativo  prestao de de servio de comunicao',
    '5301' => 'Prestao de servio de comunicao para execuo de servio da mesma natureza',
    '5302' => 'Prestao de servio de comunicao a estabelecimento industrial',
    '5303' => 'Prestao de servio de comunicao a estabelecimento comercial',
    '5304' => 'Prestao de servio de comunicao a estabelecimento de prestador de servio de transporte',
    '5305' => 'Prestao de servio de comunicao a estabelecimento de geradora ou de distribuidora de energia eltrica',
    '5306' => 'Prestao de servio de comunicao a estabelecimento de produtor rural',
    '5307' => 'Prestao de servio de comunicao a no contribuinte',
    '5933' => 'Prestao de servio tributado pelo ISSQN',
    '6301' => 'Prestao de servio de comunicao para execuo de servio da mesma natureza',
    '6302' => 'Prestao de servio de comunicao a estabelecimento industrial',
    '6303' => 'Prestao de servio de comunicao a estabelecimento comercial',
    '6304' => 'Prestao de servio de comunicao a estabelecimento de prestador de servio de transporte',
    '6305' => 'Prestao de servio de comunicao a estabelecimento de geradora ou de distribuidora de energia eltrica',
    '6306' => 'Prestao de servio de comunicao a estabelecimento de produtor rural',
    '6307' => 'Prestao de servio de comunicao a no contribuinte',
    '7301' => 'Prestao de servio de comunicao para execuo de servio da mesma natureza',
);
//tabela de classificacao de servicos de telecomunicacoes nfcom
$tabelaNfcomCClass = array(
    "0100101" => "Assinatura de servios de telefonia",
    "0100201" => "Assinatura de servios de comunicao de dados",
    "0100301" => "Assinatura de servios de TV por Assinatura",
    "0100401" => "Assinatura de servios de comunicao multimdia",
    "0200101" => "Habilitao de servios de telefonia",
    "0200201" => "Habilitao de servios de comunicao de dados",
    "0200301" => "Habilitao de TV por Assinatura",
    "0300101" => "Servio Medido - Chamadas locais",
    "0300102" => "Servio Medido - Chamadas longa distncia nacional",
    "0300103" => "Servio Medido - Chamadas longa distncia  internacionais",
    "0300104" => "Servio Medido - Chamadas originadas em Roaming",
    "0300105" => "Servio Medido - Chamadas recebidas em Roaming",
    "0300106" => "Servio Medido - Adicional de chamada",
    "0300107" => "Servio Medido - Nmeros Especiais (0300/0500/0600/0800/etc.)",
    "0300108" => "Servio Medido - Mensagem SMS",
    "0300109" => "Servio Medido - Mensagem MMS",
    "0300201" => "Servio Medido - Comunicao de dados",
    "0300301" => "Servio Medido - Pay-per-view (programao TV)",
    "0300401" => "Servio Medido - Comunicao multimidia",
    "0400101" => "Servio No Medido - Telefonia",
    "0400201" => "Servio No Medido - Comunicao de dados",
    "0400301" => "Servio No Medido - TV por Assinatura",
    "0400401" => "Servio No Medido - Provimento  internet",
    "0400501" => "Servio No Medido - Comunicao multimdia",
    "0450101" => "Servios Combinados (dados, voz, mensagens e outros)",
    "0500101" => "Carto Telefnico - Telefonia Fixa",
    "0500102" => "Carga / Recarga de Crditos - Telefonia Fixa",
    "0500201" => "Carga / Recarga de Crditos - Telefonia Mvel",
    "0500301" => "Carga / Recarga de Crditos - Servio de Comunicao Multimdia",
    "0500401" => "Carga / Recarga de Crditos - TV por assinatura",
    "0500501" => "Recarga de Crditos - Antecipao",
    "0500601" => "Repasse de Pr-pago",
    "0600101" => "Facilidades Adicionais (identificador, caixa postal, no-perturbe, etc)",
    "0600201" => "Streaming de vdeo e audio",
    "0600301" => "Servio de Rastreamento",
    "0600401" => "Veiculao de publicidade e propaganda em qualquer meio",
    "0600402" => "Veiculao de publicidade por rdio e TV de recepo livre e gratuita",
    "0600501" => "Outros Servios (substituio de nmero, troca de aparelho, instalao, software, visita tcnica, etc.)",
    "0600601" => "Outros servios de valor adicionado",
    "0700101" => "Interconexo",
    "0700201" => "Roaming",
    "0700301" => "Explorao Industrial de Linha Dedicada - EILD",
    "0700401" => "Lanamento de ICMS proporcional s sadas isentas, no tributadas ou com reduo de base de clculo ( 1, Clusula terceira, Convnio ICMS 17/2013)",
    "0700501" => "Lanamento de ICMS proporcional s cesses de meio destinadas a consumo prprio ( 1 Clusula terceira, Convnio ICMS 17/2013)",
    "0700601" => "Lanamento de ICMS complementar, na condio de responsvel tributrio",
    "0800101" => "Aparelho telefnico",
    "0800201" => "Aparelho Identificador de chamadas",
    "0800301" => "Modem",
    "0800401" => "Rack",
    "0800501" => "Sala/Recinto",
    "0800601" => "Roteador",
    "0800701" => "Servidor",
    "0800801" => "Multiplexador",
    "0800901" => "Decodificador/Conversor",
    "0801001" => "Outros equipamentos",
    "0801101" => "Fibra apagada",
    "0801201" => "Capacidade Satelital",
    "0801301" => "Antenas",
    "0801401" => "Dutos e Postes",
    "1000101" => "Cobrana de seguros",
    "1000201" => "Cobrana de parcelamento",
    "1000301" => "Cobrana de juros de mora",
    "1000401" => "Cobrana de multa de mora",
    "1000402" => "Cobrana de multa por descumprimento de contrato (fidelizao)",
    "1000501" => "Cobrana de conta de meses anteriores",
    "1000601" => "Correo monetria",
    "1000701" => "Taxas",
    "1000801" => "Adiantamento relativo a servios de comunicao por radiodifuso de recepo livre e gratuita",
    "1000901" => "Cobrana por venda de mercadorias",
    "1100101" => "Cobrana de Servios de Terceiros",
    "1100201" => "Cobrana de Seguros",
    "1100301" => "Cobrana de Juros de Mora",
    "1100401" => "Cobrana de Multa de Mora",
    "1100501" => "Cobrana de Conta de meses anteriores",
    "1100601" => "Correo Monetria",
    "1100701" => "Doaes",
    "1100801" => "Cobrana por disponibilizao de equipamentos",
    "1100901" => "Cobrana por venda de mercadorias",
    "1200101" => "Item lanado em outra NFCom - Cobrana centralizada",
    "1300101" => "Item lanado em outra NFCom - Cobrana por cofaturamento",
    "5900101" => "Deduo relativa a impugnao de servios",
    "5900201" => "Deduo referente ajuste de conta",
    "5900301" => "Deduo relativa  multa pela interrupo de fornecimento",
    "5900401" => "Deduo por pagamento em duplicidade",
    "5900501" => "Outras dedues",
);
//endpoints nfcom
$nfcomEndpoints = [];
$nfcomEndpoints['SVRS'] = [
    'producao' => [
        'visualizacao' => [
            'qrcode' => [
                'versao' => '1.00',
                'url'    => 'https://dfe-portal.svrs.rs.gov.br/nfCom/qrCode',
            ],
            'consulta_nfcom' => [
                'versao' => '1.00',
                'url'    => 'https://dfe-portal.svrs.rs.gov.br/nfCom/Consulta',
            ],
        ],
        'webservice' => [
            'recepcao' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom.svrs.rs.gov.br/WS/NFComRecepcao/NFComRecepcao.asmx',
            ],
            'recepcao_evento' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom.svrs.rs.gov.br/WS/NFComRecepcaoEvento/NFComRecepcaoEvento.asmx',
            ],
            'consulta' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom.svrs.rs.gov.br/WS/NFComConsulta/NFComConsulta.asmx',
            ],
            'status_servico' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom.svrs.rs.gov.br/WS/NFComStatusServico/NFComStatusServico.asmx',
            ],
        ],
    ],
    'homologacao' => [
        'visualizacao' => [
            'qrcode' => [
                'versao' => '1.00',
                'url'    => 'https://dfe-portal.svrs.rs.gov.br/nfCom/qrCode',
            ],
            'consulta_nfcom' => [
                'versao' => '1.00',
                'url'    => 'https://dfe-portal.svrs.rs.gov.br/nfCom/Consulta',
            ],
        ],
        'webservice' => [
            'recepcao' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom-homologacao.svrs.rs.gov.br/WS/NFComRecepcao/NFComRecepcao.asmx',
            ],
            'recepcao_evento' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom-homologacao.svrs.rs.gov.br/WS/NFComRecepcaoEvento/NFComRecepcaoEvento.asmx',
            ],
            'consulta' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom-homologacao.svrs.rs.gov.br/WS/NFComConsulta/NFComConsulta.asmx',
            ],
            'status_servico' => [
                'versao' => '1.00',
                'url'    => 'https://nfcom-homologacao.svrs.rs.gov.br/WS/NFComStatusServico/NFComStatusServico.asmx',
            ],
        ],
    ],
];
</file>

<file path="payisp/backup.php">
<?php 
require_once 'init.php';
//include 
require __DIR__ . '/src/MySQLDump.php';
//nome do arquivo 
$file = '/tmp/payisp-'.date('d-m-Y His').'.sql.gz';
//salva no bd 
$mysqli->query("UPDATE `payisp_configuracoes` SET ultimo_backup = '".$file."' WHERE id = 1");
//faz o backup 
$dump = new MySQLDump(new mysqli('localhost', 'root', 'vertrigo', 'mkradius'));
$dump->tables = array(
	'payisp_baixas' => 15,
	'payisp_config' => 15,
	'payisp_configuracoes' => 15,
	'payisp_faturas' => 15,
	'payisp_inter' => 15,
	'payisp_payisp_tokens' => 15,
);
$dump->save($file);
//fora o download do arquivo
if (file_exists($file)) {
	//fora o download
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename="'.basename($file).'"');
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    readfile($file);
    exit;
}
?>
</file>

<file path="payisp/bancos.add.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php $breadcrumbActual = 'Cadastrar Banco'; ?>
<?php include 'lay.header.php'; ?>
<?php
//lista dos bancos suportados
$bancos_suportados = payisp_lista_bancos_suportados();
//campos 
$campos = detalhes_campos_payisp(valor_antigo_payisp('cod_banco'));
//valida e cadastra o banco
$erro_list = validar_cadastrar_banco_payisp($bancos_suportados, valor_antigo_payisp('cod_banco'), $campos);
//cod do banco 
$cod_banco = valor_antigo_payisp('cod_banco');
?>

<body>

	<div style="height: 15px;"></div>
	<?php include('../../topo.php'); ?>

	<!-- Novo Cabealho com Breadcrumb -->
	<div class="container-fluid pt-3">
		<nav aria-label="breadcrumb" class="mb-4">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="bancos.index.php"><i class="fa fa-university me-1"></i> Bancos</a></li>
				<li class="breadcrumb-item active" aria-current="page"><i class="fa fa-plus-circle me-1"></i> Cadastrar Novo Banco [<?php echo $cod_banco; ?>]</li>
			</ol>
		</nav>

		<h3 class="mb-4">Configurar Nova Conta Bancria</h3>

		<!-- Mensagens de Erro -->
		<?php if (count($erro_list) > 0) { ?>
			<div class="alert alert-danger alert-dismissible fade show" role="alert">
				<h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros de Validao:</h5>
				<ul class="mb-0">
					<?php foreach ($erro_list as $erro) { ?>
						<li><?php echo $erro; ?></li>
					<?php } ?>
				</ul>
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
		<?php } ?>

		<!-- Bloco Informativo Inicial -->
		<div class="alert alert-info d-flex align-items-center mb-4" role="alert">
			<i class="fa fa-info-circle me-2 fs-5"></i>
			<div>
				Selecione o Banco que deseja cadastrar para que os campos especficos de credenciais sejam carregados. Preencha todos os dados corretamente.
			</div>
		</div>

		<form onsubmit="bloquear_tela_payisp();" id="configuracao" class="needs-validation" method="POST" action="bancos.add.php?cod_banco=<?php echo valor_antigo_payisp('cod_banco'); ?>" novalidate>

			<!-- Card 1: Seleo do Banco e Dados Gerais -->
			<div class="card shadow-sm mb-4">
				<div class="card-header">
					<i class="fa fa-pencil-alt me-2"></i> 1. Seleo e Informaes Bsicas
				</div>
				<div class="card-body">
					<div class="row">
						<!-- Campo de Seleo do Banco (Sempre visvel) -->
						<div class="col-md-4 mb-3">
							<label for="cod_banco" class="form-label">Banco <span class="text-danger">*</span></label>
							<select onchange="detalhes_banco_payisp(this.value);" class="form-select" id="cod_banco" name="cod_banco" required>
								<option value="">Selecione</option>
								<?php foreach ($bancos_suportados as $banco) { ?>
									<option value="<?php echo $banco['class'] ?>" <?php echo valor_antigo_payisp('cod_banco') == $banco['class'] ? ' selected' : ''; ?>><?php echo $banco['titulo'] ?> (<?php echo $banco['cod'] ?>)</option>
								<?php } ?>
							</select>
							<div id="cod_banco" class="form-text text-muted">Selecione o banco desejado.</div>
						</div>

						<?php if (valor_antigo_payisp('cod_banco')) { ?>
							<!-- Campos Comuns (Visveis apenas aps a seleo do banco) -->
							<div class="col-md-4 mb-3">
								<label for="empresa" class="form-label">Nome da Empresa <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('empresa'); ?>" placeholder="Provedor X Telecom" type="text" class="form-control" id="empresa" name="empresa" required>
								<div class="form-text text-muted">Nome fantasia ou razo social da sua empresa.</div>
							</div>
							<div class="col-md-4 mb-3">
								<label for="cnpj" class="form-label">CNPJ da Empresa <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('cnpj'); ?>" placeholder="00.000.000/0000-00" type="text" class="form-control" id="cnpj" name="cnpj" required>
								<div class="form-text text-muted">CNPJ de sua empresa.</div>
							</div>
						<?php } ?>
					</div>
				</div>
			</div>

			<!-- Card 2: Credenciais Especficas (Mostrado condicionalmente) -->
			<?php if (valor_antigo_payisp('cod_banco')) { ?>
				<div class="card shadow-sm mb-4">
					<div class="card-header">
						<i class="fa fa-lock me-2"></i> 2. Credenciais API e Conta Bancria
					</div>
					<div class="card-body">
						<div class="row">
							<!-- Campos especficos do Banco (Gerados dinamicamente) -->
							<?php if (isset($campos['client_id'])) { ?>
								<div class="col-md-<?php echo $campos['client_id']['col']; ?> mb-3">
									<label for="client_id" class="form-label"><?php echo $campos['client_id']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('client_id'); ?>" placeholder="*" type="text" class="form-control" id="client_id" name="client_id" required>
									<div class="form-text text-muted"><?php echo $campos['client_id']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['client_secret'])) { ?>
								<div class="col-md-<?php echo $campos['client_secret']['col']; ?> mb-3">
									<label for="client_secret" class="form-label"><?php echo $campos['client_secret']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('client_secret'); ?>" placeholder="*" type="text" class="form-control" id="client_secret" name="client_secret" required>
									<div class="form-text text-muted"><?php echo $campos['client_secret']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['token'])) { ?>
								<div class="col-md-<?php echo $campos['token']['col']; ?> mb-3">
									<label for="token" class="form-label"><?php echo $campos['token']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('token'); ?>" placeholder="*" type="text" class="form-control" id="token" name="token" required>
									<div class="form-text text-muted"><?php echo $campos['token']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['cod_acesso'])) { ?>
								<div class="col-md-<?php echo $campos['cod_acesso']['col']; ?> mb-3">
									<label for="cod_acesso" class="form-label"><?php echo $campos['cod_acesso']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('cod_acesso'); ?>" placeholder="*" type="text" class="form-control" id="cod_acesso" name="cod_acesso" required>
									<div class="form-text text-muted"><?php echo $campos['cod_acesso']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['agencia'])) { ?>
								<div class="col-md-<?php echo $campos['agencia']['col']; ?> mb-3">
									<label for="agencia" class="form-label"><?php echo $campos['agencia']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('agencia'); ?>" placeholder="" type="text" class="form-control" id="agencia" name="agencia" required>
									<div class="form-text text-muted"><?php echo $campos['agencia']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['posto'])) { ?>
								<div class="col-md-<?php echo $campos['posto']['col']; ?> mb-3">
									<label for="posto" class="form-label"><?php echo $campos['posto']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('posto'); ?>" placeholder="" type="text" class="form-control" id="posto" name="posto" required>
									<div class="form-text text-muted"><?php echo $campos['posto']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['conta'])) { ?>
								<div class="col-md-<?php echo $campos['conta']['col']; ?> mb-3">
									<label for="conta" class="form-label"><?php echo $campos['conta']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('conta'); ?>" placeholder="" type="text" class="form-control" id="conta" name="conta" required>
									<div class="form-text text-muted"><?php echo $campos['conta']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['cooperativa'])) { ?>
								<div class="col-md-<?php echo $campos['cooperativa']['col']; ?> mb-3">
									<label for="cooperativa" class="form-label"><?php echo $campos['cooperativa']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('cooperativa'); ?>" placeholder="" type="text" class="form-control" id="cooperativa" name="cooperativa" required>
									<div class="form-text text-muted"><?php echo $campos['cooperativa']['desc']; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['carteira'])) { ?>
								<div class="col-md-<?php echo $campos['carteira']['col']; ?> mb-3">
									<label for="carteira" class="form-label"><?php echo $campos['carteira']['titulo']; ?> <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('carteira'); ?>" placeholder="" type="text" class="form-control" id="carteira" name="carteira" required>
									<div class="form-text text-muted"><?php echo $campos['carteira']['desc']; ?></div>
								</div>
							<?php } ?>

							<!-- Campos de Certificado (Quando aplicvel) -->
							<?php if (isset($campos['certificado']) || isset($campos['chave'])) { ?>
								<div class="col-md-12">
									<h6 class="mt-3 border-bottom pb-2">Certificados Digitais (API)</h6>
								</div>
								<?php if (isset($campos['certificado'])) { ?>
									<div class="col-md-6 mb-3">
										<label for="certificado-input" class="form-label"><?php echo $campos['certificado']['titulo']; ?> <span class="text-danger">*</span></label>
										<textarea style="min-height:200px;" class="form-control" id="certificado-input" name="certificado" required><?php echo valor_antigo_payisp('certificado'); ?></textarea>
										<div class="form-text text-muted"><?php echo $campos['certificado']['desc']; ?></div>
									</div>
								<?php } ?>
								<?php if (isset($campos['chave'])) { ?>
									<div class="col-md-6 mb-3">
										<label for="chave-input" class="form-label"><?php echo $campos['chave']['titulo']; ?> <span class="text-danger">*</span></label>
										<textarea style="min-height:200px;" class="form-control" id="chave-input" name="chave" required><?php echo valor_antigo_payisp('chave'); ?></textarea>
										<div class="form-text text-muted"><?php echo $campos['chave']['desc']; ?></div>
									</div>
								<?php } ?>

								<?php if (isset($campos['certificado']) && isset($campos['chave']) && isset($bancosComCertificadoPFX[$cod_banco])) { ?>
									<div class="col-md-12">
										<div class="alert alert-warning" role="alert">
											<i class="fa fa-key me-2"></i> Para este banco, voc pode usar um certificado no formato PFX. <a href="javascript:void(0);" onclick="abrirPopup_payisp('bancos.certificados.php', 800, 800);" class="alert-link">Clique aqui</a> e use nossa ferramenta de extrao automtica dos arquivos CRT e KEY.
										</div>
									</div>
								<?php } ?>
							<?php } ?>
							<!-- Fim dos Campos Especficos -->
						</div>
					</div>
				</div>

				<!-- Card 3: Configuraes de Boleto e Tarifa -->
				<div class="card shadow-sm mb-4">
					<div class="card-header">
						<i class="fa fa-cogs me-2"></i> 3. Configuraes de Boleto, Pix e Tarifas
					</div>
					<div class="card-body">
						<div class="row">
							<h6 class="border-bottom pb-2 mb-3">Instrues de Boleto</h6>
							<div class="col-md-4 mb-3">
								<label for="in1" class="form-label">Instrues Boleto 01 <span class="text-danger">*</span></label>
								<input maxlength="40" value="<?php echo valor_antigo_payisp('in1'); ?>" placeholder="" type="text" class="form-control" id="in1" name="in1" required>
								<div class="form-text text-muted">Mx. 40 caracteres.</div>
							</div>
							<div class="col-md-4 mb-3">
								<label for="in2" class="form-label">Instrues Boleto 02</label>
								<input maxlength="40" value="<?php echo valor_antigo_payisp('in2'); ?>" placeholder="" type="text" class="form-control" id="in2" name="in2">
								<div class="form-text text-muted">Mx. 40 caracteres.</div>
							</div>
							<div class="col-md-4 mb-3">
								<label for="in3" class="form-label">Instrues Boleto 03</label>
								<input maxlength="40" value="<?php echo valor_antigo_payisp('in3'); ?>" placeholder="" type="text" class="form-control" id="in3" name="in3">
								<div class="form-text text-muted">Mx. 40 caracteres.</div>
							</div>
						</div>

						<div class="row mt-3">
							<h6 class="border-bottom pb-2 mb-3">Opes de Emisso e Baixa</h6>
							<div class="col-md-3 mb-3">
								<label for="acao_carnet" class="form-label">Ao Imprimir Carnet <span class="text-danger">*</span></label>
								<select class="form-select" id="acao_carnet" name="acao_carnet" required>
									<option value="0" <?php echo valor_antigo_payisp('acao_carnet') == 0 ? ' selected' : ''; ?>>Imprimir Boletos</option>
									<option value="1" <?php echo valor_antigo_payisp('acao_carnet') == 1 ? ' selected' : ''; ?>>Imprimir Boletos + Capa</option>
								</select>
							</div>
							<div class="col-md-3 mb-3">
								<label for="auto_registro" class="form-label">Registro Automtico Ativo (Ajax) <span class="text-danger">*</span></label>
								<select class="form-select" id="auto_registro" name="auto_registro" required>
									<option value="0" <?php echo valor_antigo_payisp('auto_registro') == 0 ? ' selected' : ''; ?>>No</option>
									<option value="1" <?php echo valor_antigo_payisp('auto_registro') == 1 ? ' selected' : ''; ?>>Sim</option>
								</select>
								<div class="form-text text-muted">Registro automtico dos boletos emitidos.</div>
							</div>
							<div class="col-md-3 mb-3">
								<label for="baixa_automatica" class="form-label">Pagamentos Aps Vencimento <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('baixa_automatica', 30); ?>" type="number" class="form-control" id="baixa_automatica" name="baixa_automatica" required>
								<div class="form-text text-muted">Aceita pagamentos em at X dias de vencimento.</div>
							</div>
							<div class="col-md-3 mb-3">
								<label for="pix_no_boleto" class="form-label">Ativar Pix no Boleto (Boletopix) <span class="text-danger">*</span></label>
								<select class="form-select" id="pix_no_boleto" name="pix_no_boleto" required>
									<option value="0" <?php echo valor_antigo_payisp('pix_no_boleto', 1) == 0 ? ' selected' : ''; ?>>No</option>
									<option value="1" <?php echo valor_antigo_payisp('pix_no_boleto', 1) == 1 ? ' selected' : ''; ?>>Sim</option>
								</select>
							</div>
						</div>

						<div class="row mt-3">
							<h6 class="border-bottom pb-2 mb-3">Tarifas e Log (Desenvolvedor)</h6>
							<div class="col-md-4 mb-3">
								<label for="desconto_fatura" class="form-label">Aplicar Descontos em Faturas Avulsas <span class="text-danger">*</span></label>
								<select class="form-select" id="desconto_fatura" name="desconto_fatura" required>
									<option value="0" <?php echo valor_antigo_payisp('desconto_fatura') == 0 ? ' selected' : ''; ?>>No</option>
									<option value="1" <?php echo valor_antigo_payisp('desconto_fatura') == 1 ? ' selected' : ''; ?>>Sim</option>
								</select>
							</div>
							<div class="col-md-4 mb-3">
								<label for="tarifa_boleto" class="form-label">Tarifa Boleto Pago (R$) <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('tarifa_boleto', 1.99); ?>" placeholder="0.00" type="text" class="form-control dinheiro_format" id="tarifa_boleto" name="tarifa_boleto" required>
							</div>
							<div class="col-md-4 mb-3">
								<label for="tarifa_pix" class="form-label">Tarifa Pix Pago (R$) <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('tarifa_pix', 0.99); ?>" placeholder="0.00" type="text" class="form-control dinheiro_format" id="tarifa_pix" name="tarifa_pix" required>
							</div>
							<div class="col-md-6 mb-3">
								<label for="qtd_check_cron" class="form-label">Registros por Cron <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('qtd_check_cron', 50); ?>" type="number" class="form-control" id="qtd_check_cron" name="qtd_check_cron" required>
								<div class="form-text text-muted">Quantidade de registros a ser processado por vez em cada execuo do Cron.</div>
							</div>
							<div class="col-md-6 mb-3">
								<label for="modo_debug" class="form-label">Ativar Modo Debug <span class="text-danger">*</span></label>
								<select class="form-select" id="modo_debug" name="modo_debug" required>
									<option value="0" <?php echo valor_antigo_payisp('modo_debug') == 0 ? ' selected' : ''; ?>>No</option>
									<option value="1" <?php echo valor_antigo_payisp('modo_debug') == 1 ? ' selected' : ''; ?>>Sim</option>
								</select>
								<div class="form-text text-muted">Ativa logs de erros e modo desenvolvedor.</div>
							</div>
						</div>
					</div>
				</div>
			<?php } ?>
			<!-- Fim dos Cards -->

			<div class="row mb-5">
				<div class="col-md-12 d-flex justify-content-center">
					<button type="submit" class="btn btn-primary btn-lg w-75"><i class="fa fa-save me-2"></i> Cadastrar Banco</button>
				</div>
			</div>

		</form>

	</div>

	<!-- Script de funo de comunicao entre janelas -->
	<script>
		function aplicar_certificado_chave_pfx_payisp(certificado, chave) {
			// Garante que a aplicao s ocorra se os campos especficos existirem no formulrio
			var certInput = document.getElementById('certificado-input');
			var chaveInput = document.getElementById('chave-input');

			if (certInput) {
				certInput.value = certificado;
			} else {
				console.warn("Campo 'certificado-input' no encontrado. Valor do certificado no aplicado.");
			}

			if (chaveInput) {
				chaveInput.value = chave;
			} else {
				console.warn("Campo 'chave-input' no encontrado. Valor da chave no aplicado.");
			}
		}
	</script>

	<?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/bancos.certificados.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?PHP require(dirname(__FILE__) . '/src/certificado.php'); ?>
<?php
//acoes 
$certificado_extraido = false;
$msg_erro = '';

if (valor_antigo_payisp('acao') == 'extrair_certificado') {
    try {
        //valida o upload
        if (!isset($_FILES['certificado_pfx']) || $_FILES['certificado_pfx']['error'] != UPLOAD_ERR_OK) {
            throw new Exception("Erro no upload do arquivo do certificado digital. Verifique se o arquivo foi selecionado corretamente.");
        }
        //pega a senha
        $senha_certificado = isset($_POST['senha_certificado']) ? $_POST['senha_certificado'] : '';
        if (trim($senha_certificado) == '') {
            throw new Exception("A senha do certificado digital  obrigatria.");
        }
        //caminho temporrio do arquivo enviado
        $caminho_arquivo_temp = $_FILES['certificado_pfx']['tmp_name'];
        //extrai as chaves
        $certificado = new CertificadoA1Payisp($caminho_arquivo_temp, $senha_certificado);
        $chaves = $certificado->extrairChaves();
        //mensagem de sucesso
        $certificado_extraido = true;
    } catch (Exception $e) {
        $msg_erro = $e->getMessage();
    }
}
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrao de Certificado Digital</title>
    <!-- Incluindo Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }

        .container {
            max-width: 500px;
        }
    </style>
</head>

<body>
    <div class="container py-4">

        <h3 class="mb-4 text-center">
            <i class="fa fa-upload text-primary me-2"></i> Extrao de Certificado Digital PFX
        </h3>
        <hr>

        <?php if (isset($msg_erro) && $msg_erro != '') { ?>
            <!-- Mensagem de Erro -->
            <div class="alert alert-danger" role="alert">
                <i class="fa fa-exclamation-triangle me-2"></i> <strong>Erro na Extrao:</strong> <?php echo htmlspecialchars($msg_erro); ?>
            </div>
        <?php } ?>

        <?php if ($certificado_extraido) { ?>

            <!-- Processamento Concludo -->
            <div class="alert alert-success text-center" role="alert">
                <i class="fa fa-check-circle me-2 fa-2x"></i>
                <h5 class="mt-2">Extrao Concluda com Sucesso!</h5>
                O certificado e a chave foram enviados para a janela principal.
            </div>

            <script>
                // O script de aplicao e fechamento foi movido para o sucesso
                // para garantir que a janela no feche antes da aplicao.

                // Variveis para comunicao entre janelas
                var certificado = `<?php echo trim(addslashes($chaves['certificado_publico'])); ?>`;
                var chave = `<?php echo trim(addslashes($chaves['chave_privada'])); ?>`;

                // 1. Aplica os valores extrados na janela principal
                if (self.opener && typeof self.opener.aplicar_certificado_chave_pfx_payisp === 'function') {
                    self.opener.aplicar_certificado_chave_pfx_payisp(certificado, chave);

                    // 2. Feedback visual (Substitui o alert() nativo por bootbox.alert())
                    bootbox.alert({
                        title: "Sucesso!",
                        message: "Certificado e chave extrados com sucesso! Os campos foram preenchidos na janela principal.",
                        callback: function() {
                            // 3. Fecha a janela aps o usurio fechar o alerta
                            window.close();
                        }
                    });
                } else {
                    // Caso a funo na janela principal no exista (erro ou contexto inesperado)
                    bootbox.alert("Certificado extrado, mas a funo de aplicao na janela principal no foi encontrada. Feche a janela manualmente.");
                }
            </script>
            <div class="text-center">
                <!-- Boto de fechamento manual (apenas fallback visual) -->
                <button class="btn btn-secondary mt-3" onclick="window.close();">
                    <i class="fa fa-times"></i> Fechar Janela
                </button>
            </div>
        <?php } else { ?>

            <!-- Formulrio de Upload -->
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="alert alert-info" role="alert">
                        <i class="fa fa-key me-2"></i> Esta ferramenta extrai o certificado pblico e a chave privada do seu arquivo PFX/P12 para preencher os campos automaticamente.
                    </div>

                    <form method="post" action="bancos.certificados.php" enctype="multipart/form-data">
                        <input type="hidden" name="acao" value="extrair_certificado">
                        <div class="mb-3">
                            <label for="certificado_pfx" class="form-label">Arquivo do Certificado Digital (PFX/P12): <span class="text-danger">*</span></label>
                            <input type="file" class="form-control" id="certificado_pfx" name="certificado_pfx" accept=".pfx,.p12" required>
                            <div class="form-text text-muted">Apenas arquivos .pfx ou .p12 so aceitos.</div>
                        </div>
                        <div class="mb-4">
                            <label for="senha_certificado" class="form-label">Senha do Certificado Digital: <span class="text-danger">*</span></label>
                            <input type="password" class="form-control" id="senha_certificado" name="senha_certificado" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fa fa-search me-2"></i> Extrair Certificado e Chave
                        </button>
                    </form>
                </div>
            </div>
        <?php } ?>
    </div>
</body>

</html>
</file>

<file path="payisp/bancos.editar.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php $breadcrumbActual = 'Editar Banco'; ?>
<?php include 'lay.header.php'; ?>
<?php
//banco selecionado
$dados_banco = dados_banco_payisp(valor_antigo_payisp('id'));

// Verifica se o banco existe antes de continuar
if (!$dados_banco) {
	// Redireciona caso o ID seja invlido
	$aviso = "Banco no encontrado.";
	$redir = "bancos.index.php";
	redir_com_aviso_payisp($aviso, $redir);
	exit;
}

//lista dos bancos suportados
$bancos_suportados = payisp_lista_bancos_suportados();
//campos 
$campos = detalhes_campos_payisp($dados_banco['cod_banco']);
//valida e cadastra o banco
$erro_list = validar_editar_banco_payisp($bancos_suportados, $dados_banco['cod_banco'], $campos, $dados_banco);

// --- Verificao de Status do Certificado e Chave ---
$cert_validade_msg = 'n/a';
$cert_alerta_class = 'alert-info'; // Padro
$cert_file_status = false;

if (isset($campos['certificado'])) {
	if (!file_exists('/tmp/certificado-' . $dados_banco['cod_banco'] . '.crt')) {
		$cert_file_status = false;
		$cert_alerta_class = 'alert-danger';
		$erro_list = array_merge($erro_list, array('Arquivo do certificado /tmp/certificado-' . $dados_banco['cod_banco'] . '.crt ainda no existe, informe o mesmo nos campos correspondentes!'));
	} else {
		$cert_file_status = true;
		// Tenta obter informaes de validade
		$certinfo = openssl_x509_parse(file_get_contents('/tmp/certificado-' . $dados_banco['cod_banco'] . '.crt'));
		if (isset($certinfo['validTo_time_t'])) {
			$valid_to_timestamp = (int)$certinfo['validTo_time_t'];
			$valid_to_date = date('d/m/Y H:i:s', $valid_to_timestamp);
			$cert_validade_msg = $valid_to_date;

			$periodo_alerta = 7 * 24 * 60 * 60; // 7 dias
			$agora = time();

			if ($agora >= $valid_to_timestamp) {
				$cert_alerta_class = 'alert-danger';
				$erro_list = array_merge($erro_list, array('O certificado de seu banco est expirado (' . $valid_to_date . '), atualize o quanto antes o mesmo.'));
			} elseif ($agora >= ($valid_to_timestamp - $periodo_alerta)) {
				$cert_alerta_class = 'alert-warning';
				$erro_list = array_merge($erro_list, array('O certificado de seu banco est prximo de expirar (' . $valid_to_date . '), atualize o quanto antes o mesmo.'));
			} else {
				$cert_alerta_class = 'alert-success';
			}
		}
	}
}
if (isset($campos['chave'])) {
	if (!file_exists('/tmp/chave-' . $dados_banco['cod_banco'] . '.key')) {
		$cert_alerta_class = 'alert-danger';
		$erro_list = array_merge($erro_list, array('Arquivo da chave privada /tmp/chave-' . $dados_banco['cod_banco'] . '.key ainda no existe, informe o mesmo nos campos correspondentes!'));
	}
}

//banco selecionado (reload)
// Re-carrega os dados do banco, garantindo que se o POST/GET falhar, os dados originais sejam usados.
// Mantido no final para que os erros sejam gerados com base nas verificaes acima.
$dados_banco = dados_banco_payisp(valor_antigo_payisp('id'));
?>

<body>

	<div style="height: 15px;"></div>
	<?php include('../../topo.php'); ?>

	<!-- Novo Cabealho com Breadcrumb -->
	<div class="container-fluid pt-3">
		<nav aria-label="breadcrumb" class="mb-4">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="bancos.index.php"><i class="fa fa-university me-1"></i> Bancos</a></li>
				<li class="breadcrumb-item active" aria-current="page"><i class="fa fa-edit me-1"></i> Editar Banco: <?php echo $dados_banco['titulo']; ?> (<?php echo $dados_banco['cod_banco']; ?>)</li>
			</ol>
		</nav>

		<h3 class="mb-4">Atualizar Configuraes: <?php echo htmlspecialchars($dados_banco['titulo']); ?></h3>

		<!-- Mensagens de Erro -->
		<?php if (count($erro_list) > 0) { ?>
			<div class="alert alert-danger alert-dismissible fade show" role="alert">
				<h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros / Avisos Importantes:</h5>
				<ul class="mb-0">
					<?php
					// Removendo HTML e tags de <b> para garantir que o Bootstrap cuide do estilo
					foreach ($erro_list as $erro) {
						// Uso de strip_tags para remover o <b> que foi adicionado na lgica do certificado
						$clean_erro = str_replace(['<b>', '</b>'], '', $erro);
					?>
						<li><?php echo $clean_erro; ?></li>
					<?php } ?>
				</ul>
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
		<?php } ?>

		<!-- Bloco Informativo Principal -->
		<div class="alert alert-primary d-flex align-items-center mb-4" role="alert">
			<i class="fa fa-info-circle me-2 fs-5"></i>
			<div>
				Edite o Banco de recebimentos em seu MK-Auth via <?php echo $nome_do_sistema; ?>. Mantenha os dados de credenciais e certificados atualizados.
			</div>
		</div>

		<form onsubmit="bloquear_tela_payisp();" id="configuracao" class="needs-validation" method="POST" action="bancos.editar.php?id=<?php echo $dados_banco['id']; ?>" novalidate>
			<input type="hidden" name="id" value="<?php echo $dados_banco['id']; ?>">

			<!-- Card 1: Dados Gerais e Conta -->
			<div class="card shadow-sm mb-4">
				<div class="card-header">
					<i class="fa fa-pencil-alt me-2"></i> 1. Informaes da Empresa e Status
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-md-4 mb-3">
							<label for="cod_banco" class="form-label">Banco <span class="text-danger">*</span></label>
							<input type="text" readonly class="form-control-plaintext fw-bold" id="cod_banco" value="<?php echo $dados_banco['titulo']; ?> (<?php echo $dados_banco['cod_banco']; ?>)">
							<div class="form-text text-muted">Banco selecionado no cadastro.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="empresa" class="form-label">Empresa <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('empresa', $dados_banco['empresa']); ?>" placeholder="Provedor X Telecom" type="text" class="form-control" id="empresa" name="empresa" required>
							<div class="form-text text-muted">Nome de sua empresa.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="cnpj" class="form-label">CNPJ <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('cnpj', $dados_banco['cnpj']); ?>" placeholder="00.000.000/0000-00" type="text" class="form-control" id="cnpj" name="cnpj" required>
							<div class="form-text text-muted">CNPJ de sua empresa.</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Card 2: Credenciais Especficas -->
			<div class="card shadow-sm mb-4">
				<div class="card-header">
					<i class="fa fa-lock me-2"></i> 2. Credenciais API e Conta Bancria
				</div>
				<div class="card-body">
					<div class="row">
						<!-- Credenciais de API -->
						<?php if (isset($campos['client_id'])) { ?>
							<div class="col-md-<?php echo $campos['client_id']['col']; ?> mb-3">
								<label for="client_id" class="form-label"><?php echo $campos['client_id']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('client_id', $dados_banco['client_id']); ?>" placeholder="*" type="text" class="form-control" id="client_id" name="client_id">
								<div class="form-text text-muted"><?php echo $campos['client_id']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['client_secret'])) { ?>
							<div class="col-md-<?php echo $campos['client_secret']['col']; ?> mb-3">
								<label for="client_secret" class="form-label"><?php echo $campos['client_secret']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('client_secret', $dados_banco['client_secret']); ?>" placeholder="*" type="text" class="form-control" id="client_secret" name="client_secret">
								<div class="form-text text-muted"><?php echo $campos['client_secret']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['token'])) { ?>
							<div class="col-md-<?php echo $campos['token']['col']; ?> mb-3">
								<label for="token" class="form-label"><?php echo $campos['token']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('token', $dados_banco['token']); ?>" placeholder="*" type="text" class="form-control" id="token" name="token">
								<div class="form-text text-muted"><?php echo $campos['token']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['cod_acesso'])) { ?>
							<div class="col-md-<?php echo $campos['cod_acesso']['col']; ?> mb-3">
								<label for="cod_acesso" class="form-label"><?php echo $campos['cod_acesso']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('cod_acesso', $dados_banco['cod_acesso']); ?>" placeholder="*" type="text" class="form-control" id="cod_acesso" name="cod_acesso">
								<div class="form-text text-muted"><?php echo $campos['cod_acesso']['desc']; ?></div>
							</div>
						<?php } ?>

						<!-- Dados da Conta -->
						<?php if (isset($campos['agencia'])) { ?>
							<div class="col-md-<?php echo $campos['agencia']['col']; ?> mb-3">
								<label for="agencia" class="form-label"><?php echo $campos['agencia']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('agencia', $dados_banco['agencia']); ?>" placeholder="" type="text" class="form-control" id="agencia" name="agencia">
								<div class="form-text text-muted"><?php echo $campos['agencia']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['posto'])) { ?>
							<div class="col-md-<?php echo $campos['posto']['col']; ?> mb-3">
								<label for="posto" class="form-label"><?php echo $campos['posto']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('posto', $dados_banco['posto']); ?>" placeholder="" type="text" class="form-control" id="posto" name="posto">
								<div class="form-text text-muted"><?php echo $campos['posto']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['conta'])) { ?>
							<div class="col-md-<?php echo $campos['conta']['col']; ?> mb-3">
								<label for="conta" class="form-label"><?php echo $campos['conta']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('conta', $dados_banco['conta']); ?>" placeholder="" type="text" class="form-control" id="conta" name="conta">
								<div class="form-text text-muted"><?php echo $campos['conta']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['cooperativa'])) { ?>
							<div class="col-md-<?php echo $campos['cooperativa']['col']; ?> mb-3">
								<label for="cooperativa" class="form-label"><?php echo $campos['cooperativa']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('cooperativa', $dados_banco['cooperativa']); ?>" placeholder="" type="text" class="form-control" id="cooperativa" name="cooperativa">
								<div class="form-text text-muted"><?php echo $campos['cooperativa']['desc']; ?></div>
							</div>
						<?php } ?>
						<?php if (isset($campos['carteira'])) { ?>
							<div class="col-md-<?php echo $campos['carteira']['col']; ?> mb-3">
								<label for="carteira" class="form-label"><?php echo $campos['carteira']['titulo']; ?> <span class="text-danger">*</span></label>
								<input value="<?php echo valor_antigo_payisp('carteira', $dados_banco['carteira']); ?>" placeholder="" type="text" class="form-control" id="carteira" name="carteira">
								<div class="form-text text-muted"><?php echo $campos['carteira']['desc']; ?></div>
							</div>
						<?php } ?>

						<!-- Certificados -->
						<?php if (isset($campos['certificado']) || isset($campos['chave'])) { ?>
							<div class="col-md-12">
								<h6 class="mt-3 border-bottom pb-2">Certificados Digitais (API)</h6>
							</div>
							<?php if (isset($campos['certificado'])) { ?>
								<div class="col-md-6 mb-3">
									<label for="certificado-input" class="form-label"><?php echo $campos['certificado']['titulo']; ?> <span class="text-danger">*</span></label>
									<textarea style="min-height:200px;" class="form-control" id="certificado-input" name="certificado" required><?php echo valor_antigo_payisp_sem_escape('certificado', $dados_banco['certificado']); ?></textarea>
									<div class="form-text text-muted"><?php echo $campos['certificado']['desc']; ?> Certificado  vlido at <?php echo $cert_validade_msg; ?></div>
								</div>
							<?php } ?>
							<?php if (isset($campos['chave'])) { ?>
								<div class="col-md-6 mb-3">
									<label for="chave-input" class="form-label"><?php echo $campos['chave']['titulo']; ?> <span class="text-danger">*</span></label>
									<textarea style="min-height:200px;" class="form-control" id="chave-input" name="chave" required><?php echo valor_antigo_payisp_sem_escape('chave', $dados_banco['chave']); ?></textarea>
									<div class="form-text text-muted"><?php echo $campos['chave']['desc']; ?></div>
								</div>
							<?php } ?>

							<?php if (isset($campos['certificado']) && isset($campos['chave']) && isset($bancosComCertificadoPFX[$dados_banco['cod_banco']])) { ?>
								<div class="col-md-12">
									<div class="alert alert-warning" role="alert">
										<i class="fa fa-key me-2"></i> Para o banco selecionado  possvel utilizar um certificado no formato PFX. <a href="javascript:void(0);" onclick="abrirPopup_payisp('bancos.certificados.php', 800, 800);" class="alert-link">Clique aqui</a> e use nossa ferramenta de extrao automtica dos arquivos CRT e KEY.
									</div>
								</div>
							<?php } ?>
						<?php } ?>
					</div>
				</div>
			</div>

			<!-- Card 3: Webhook e Instrues -->
			<?php if (banco_com_webhook_payisp($dados_banco['cod_banco']) == true || !empty(banco_instrucoes_webhook_payisp($dados_banco['cod_banco']))) { ?>
				<div class="card shadow-sm mb-4">
					<div class="card-header">
						<i class="fa fa-link me-2"></i> 3. Configurao de WebHook/Retorno
					</div>
					<div class="card-body">
						<div class="row">
							<?php if (banco_com_webhook_payisp($dados_banco['cod_banco']) == true) { ?>
								<div class="col-md-12 mb-3">
									<label for="url_retorno" class="form-label">URL WebHook (Deve ter acesso externo)</label>
									<input value="<?php echo valor_antigo_payisp('url_retorno', $dados_banco['url_retorno']); ?>" placeholder="https://www.seuprovedor.com/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?>" type="text" class="form-control" id="url_retorno" name="url_retorno">
									<div class="form-text text-muted">
										URL a ser configurada no <?php echo $dados_banco['titulo']; ?>, deve ser em `https://` e ter acesso externo.
										Padro do MK-Auth: <a href="<?php echo url_link_payisp(); ?>/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?>" target="_blank"><?php echo url_link_payisp(); ?>/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?></a>.
										<br>Para consultar o log do Webhook <a href="<?php echo url_link_payisp(); ?>/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?>&verlog=true" target="_blank">clique aqui</a>.
									</div>
								</div>
							<?php } elseif (!empty(banco_instrucoes_webhook_payisp($dados_banco['cod_banco']))) { ?>
								<div class="col-md-12 mb-3">
									<p class="mb-1 fw-bold">Instrues para Retorno:</p>
									<?php echo banco_instrucoes_webhook_payisp($dados_banco['cod_banco']); ?>
									<p class="mt-2 mb-0">A URL gerada pelo sistema : <a href="<?php echo url_link_payisp(); ?>/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?>" target="_blank"><?php echo url_link_payisp(); ?>/admin/addons/payisp/ipn.php?b=<?php echo $dados_banco['cod_banco']; ?></a></p>
								</div>
							<?php } ?>
						</div>
					</div>
				</div>
			<?php } ?>

			<!-- Card 4: Configuraes de Boleto, Pix e Tarifas -->
			<div class="card shadow-sm mb-4">
				<div class="card-header">
					<i class="fa fa-cogs me-2"></i> 4. Configuraes de Boleto, Pix e Tarifas
				</div>
				<div class="card-body">
					<div class="row">
						<h6 class="border-bottom pb-2 mb-3">Instrues de Boleto</h6>
						<div class="col-md-4 mb-3">
							<label for="in1" class="form-label">Instrues Boleto 01 <span class="text-danger">*</span></label>
							<input maxlength="40" value="<?php echo valor_antigo_payisp('in1', $dados_banco['in1']); ?>" placeholder="" type="text" class="form-control" id="in1" name="in1" required>
							<div class="form-text text-muted">Mx. 40 caracteres.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="in2" class="form-label">Instrues Boleto 02</label>
							<input maxlength="40" value="<?php echo valor_antigo_payisp('in2', $dados_banco['in2']); ?>" placeholder="" type="text" class="form-control" id="in2" name="in2">
							<div class="form-text text-muted">Mx. 40 caracteres.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="in3" class="form-label">Instrues Boleto 03</label>
							<input maxlength="40" value="<?php echo valor_antigo_payisp('in3', $dados_banco['in3']); ?>" placeholder="" type="text" class="form-control" id="in3" name="in3">
							<div class="form-text text-muted">Mx. 40 caracteres.</div>
						</div>
					</div>

					<div class="row mt-3">
						<h6 class="border-bottom pb-2 mb-3">Opes de Emisso, Baixa e Status</h6>
						<div class="col-md-3 mb-3">
							<label for="acao_carnet" class="form-label">Ao Imprimir Carnet <span class="text-danger">*</span></label>
							<select class="form-select" id="acao_carnet" name="acao_carnet">
								<option value="0" <?php echo valor_antigo_payisp('acao_carnet', $dados_banco['acao_carnet']) == 0 ? ' selected' : ''; ?>>Imprimir Boletos</option>
								<option value="1" <?php echo valor_antigo_payisp('acao_carnet', $dados_banco['acao_carnet']) == 1 ? ' selected' : ''; ?>>Imprimir Boletos + Capa</option>
							</select>
						</div>
						<div class="col-md-3 mb-3">
							<label for="auto_registro" class="form-label">Registro Automtico Ativo <span class="text-danger">*</span></label>
							<select class="form-select" id="auto_registro" name="auto_registro">
								<option value="0" <?php echo valor_antigo_payisp('auto_registro', $dados_banco['auto_registro']) == 0 ? ' selected' : ''; ?>>No</option>
								<option value="1" <?php echo valor_antigo_payisp('auto_registro', $dados_banco['auto_registro']) == 1 ? ' selected' : ''; ?>>Sim</option>
							</select>
							<div class="form-text text-muted">Ativa o registro automtico dos boletos.</div>
						</div>
						<div class="col-md-3 mb-3">
							<label for="baixa_automatica" class="form-label">Pagamentos Aps Vencimento <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('baixa_automatica', $dados_banco['baixa_automatica']); ?>" type="number" class="form-control" id="baixa_automatica" name="baixa_automatica" required>
							<div class="form-text text-muted">Aceita pagamentos em at X dias de vencimento.</div>
						</div>
						<div class="col-md-3 mb-3">
							<label for="pix_no_boleto" class="form-label">Ativar Pix no Boleto <span class="text-danger">*</span></label>
							<select class="form-select" id="pix_no_boleto" name="pix_no_boleto">
								<option value="0" <?php echo valor_antigo_payisp('pix_no_boleto', $dados_banco['pix_no_boleto']) == 0 ? ' selected' : ''; ?>>No</option>
								<option value="1" <?php echo valor_antigo_payisp('pix_no_boleto', $dados_banco['pix_no_boleto']) == 1 ? ' selected' : ''; ?>>Sim</option>
							</select>
						</div>
					</div>

					<div class="row mt-3">
						<div class="col-md-4 mb-3">
							<label for="desconto_fatura" class="form-label">Aplicar Descontos Avulsos <span class="text-danger">*</span></label>
							<select class="form-select" id="desconto_fatura" name="desconto_fatura">
								<option value="0" <?php echo valor_antigo_payisp('desconto_fatura', $dados_banco['desconto_fatura']) == 0 ? ' selected' : ''; ?>>No</option>
								<option value="1" <?php echo valor_antigo_payisp('desconto_fatura', $dados_banco['desconto_fatura']) == 1 ? ' selected' : ''; ?>>Sim</option>
							</select>
						</div>
						<div class="col-md-4 mb-3">
							<label for="tarifa_boleto" class="form-label">Tarifa Boleto Pago (R$) <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('tarifa_boleto', $dados_banco['tarifa_boleto']); ?>" placeholder="0.00" type="text" class="form-control dinheiro_format" id="tarifa_boleto" name="tarifa_boleto" required>
						</div>
						<div class="col-md-4 mb-3">
							<label for="tarifa_pix" class="form-label">Tarifa Pix Pago (R$) <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('tarifa_pix', $dados_banco['tarifa_pix']); ?>" placeholder="0.00" type="text" class="form-control dinheiro_format" id="tarifa_pix" name="tarifa_pix" required>
						</div>
					</div>

					<div class="row mt-3">
						<div class="col-md-4 mb-3">
							<label for="qtd_check_cron" class="form-label">Registros por Cron <span class="text-danger">*</span></label>
							<input value="<?php echo valor_antigo_payisp('qtd_check_cron', $dados_banco['qtd_check_cron']); ?>" type="number" class="form-control" id="qtd_check_cron" name="qtd_check_cron" required>
						</div>
						<div class="col-md-4 mb-3">
							<label for="modo_debug" class="form-label">Ativar Modo Debug <span class="text-danger">*</span></label>
							<select class="form-select" id="modo_debug" name="modo_debug">
								<option value="0" <?php echo valor_antigo_payisp('modo_debug', $dados_banco['modo_debug']) == 0 ? ' selected' : ''; ?>>No</option>
								<option value="1" <?php echo valor_antigo_payisp('modo_debug', $dados_banco['modo_debug']) == 1 ? ' selected' : ''; ?>>Sim</option>
							</select>
						</div>
						<div class="col-md-4 mb-3">
							<label for="status" class="form-label">Status do Banco <span class="text-danger">*</span></label>
							<select class="form-select" id="status" name="status">
								<option value="0" <?php echo valor_antigo_payisp('status', $dados_banco['status']) == 0 ? ' selected' : ''; ?>>Inativo</option>
								<option value="1" <?php echo valor_antigo_payisp('status', $dados_banco['status']) == 1 ? ' selected' : ''; ?>>Ativo</option>
							</select>
							<div class="form-text text-muted">Ativa ou inativa o uso deste banco no sistema.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="padrao" class="form-label">Banco Padro <span class="text-danger">*</span></label>
							<select class="form-select" id="padrao" name="padrao">
								<option value="0" <?php echo valor_antigo_payisp('padrao', $dados_banco['padrao']) == 0 ? ' selected' : ''; ?>>No</option>
								<option value="1" <?php echo valor_antigo_payisp('padrao', $dados_banco['padrao']) == 1 ? ' selected' : ''; ?>>Sim</option>
							</select>
							<div class="form-text text-muted">Define este como o banco padro para novas faturas.</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Boto de Ao Final -->
			<div class="row mb-5">
				<div class="col-md-12 d-flex justify-content-center">
					<button type="submit" class="btn btn-primary btn-lg w-75"><i class="fa fa-save me-2"></i> Atualizar Configuraes</button>
				</div>
			</div>

		</form>

	</div>

	<!-- Script de funo de comunicao entre janelas (PFX Extractor) -->
	<script>
		function aplicar_certificado_chave_pfx_payisp(certificado, chave) {
			// Aplica os valores extrados nos campos de textarea
			var certInput = document.getElementById('certificado-input');
			var chaveInput = document.getElementById('chave-input');

			if (certInput) {
				certInput.value = certificado;
			} else {
				console.warn("Campo 'certificado-input' no encontrado. Valor do certificado no aplicado.");
			}

			if (chaveInput) {
				chaveInput.value = chave;
			} else {
				console.warn("Campo 'chave-input' no encontrado. Valor da chave no aplicado.");
			}
		}
	</script>

	<?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/bancos.index.php">
<?php require_once 'init.php';?>
<?php 
//registros por pagina 
$total_reg_por_pagina = $quantidade_registros_por_pagina;
//paginacao 
$pagina = isset($_GET['pagina'])?(int)$_GET['pagina']:1;
$inicio = $pagina - 1;
$inicio = $inicio * $total_reg_por_pagina;
//filtros 
$tag = '';
$where = '';
//tudo
$sql_tudo = "SELECT * FROM `payisp_config` WHERE 1=1 $where ORDER BY id DESC";
$sql_tudo_result = $mysqli->query($sql_tudo);
$qtd_registros = $sql_tudo_result->num_rows;
$paginas = ceil($qtd_registros/$total_reg_por_pagina);
//lista os bancos
$sql = "SELECT * FROM `payisp_config` WHERE 1=1 $where ORDER BY id DESC LIMIT $inicio,$total_reg_por_pagina";
$result = $mysqli->query($sql);
//tem atualizaao 
$atualizado = addon_atualizado_payisp();
?>
<?php $breadcrumbActual = 'Bancos'; ?>
<?php include 'lay.header.php'; ?>
<body>
<script>
</script>
    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <div class="container-fluid pt-3">
        
        <!-- Ttulo e Contagem -->
        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
            <h2 class="h4 mb-0"><i class="fa fa-university text-primary me-2"></i> Gesto de Bancos Integrados</h2>
            <span class="badge bg-primary fs-6"><?= str_pad($qtd_registros, 4, "0", STR_PAD_LEFT); ?> Contas</span>
        </div>

        <!-- Alerta de Atualizao (Mantido conforme original, mas com estilo Bootstrap) -->
        <?php if(isset($atualizado['atualizado']) && $atualizado['atualizado']==1){ ?>
            <div class="alert alert-danger d-flex align-items-center" role="alert">
                <i class="fa fa-exclamation-triangle me-2 fs-5"></i>
                <div>
                    <strong>ALERTA DE ATUALIZAO:</strong> Existe uma nova atualizao para seu Addon <?php echo $atualizado['addon'];?>. Atualmente est instalada a verso <?php echo $atualizado['atual'];?>, e a mais recente  a <?php echo $atualizado['nova'];?>. Faa o backup e <a href="https://www.mkauth-addons.com.br/knowledgebase.php?article=10" target="_blank" class="alert-link">clique aqui</a> para seguir as instrues.
                </div>
            </div>
        <?php } ?>
        
        <?php exibir_aviso_payisp(); ?>
        
        <!-- Bloco Informativo Principal -->
        <div class="alert alert-info d-flex align-items-center" role="alert">
            <i class="fa fa-info-circle me-2 fs-5"></i>
            <div>
                Cadastre e gerencie todas as suas contas de recebimento via <?php echo $nome_do_sistema;?>. Lembre-se: ao adicionar um novo banco,  gerada uma licena de teste de 15 dias. Para continuar, use o menu Aes > Licena.
            </div>
        </div>
        
        <!-- Boto Adicionar -->
        <div class="d-flex justify-content-start mb-4">
            <button onclick="location.href='bancos.add.php';" type="button" class="btn btn-primary shadow-sm"><i class="fa fa-plus me-2"></i> Adicionar Novo Banco</button>
        </div>

        <!-- Tabela de Bancos -->
        <div class="table-responsive" style="min-height:600px;">
            <table class="table table-striped table-hover table-sm align-middle">
                <thead class="table-light">
                    <tr>
                        <th style="width:80px;">ID</th>
                        <th>Banco / Detalhes</th>
                        <th class="text-center" style="width:120px;">Faturas</th>
                        <th class="text-center" style="width:120px;">Carnets</th>
                        <th class="text-center" style="width:120px;">Status</th>
                        <th class="text-center" style="width:120px;">Padro</th>
                        <th style="width:100px;">Aes</th>
                    </tr>
                </thead>
                <tbody>
                    <?php
                    $i=0; 
                    while ($row = $result->fetch_array()) { 
                    $banco = dados_banco_mkauth_uuid_payisp($row['cod_banco_mkauth']); 
                    // Determinar classes para Status e Padro
                    $status_class = $row['status'] ? 'bg-success' : 'bg-danger';
                    $status_icon = $row['status'] ? 'fa-check' : 'fa-times';
                    $status_text = $row['status'] ? 'Ativo' : 'Inativo';
                    
                    $padrao_class = $row['padrao'] ? 'bg-success' : 'bg-secondary';
                    $padrao_icon = $row['padrao'] ? 'fa-check' : 'fa-minus';
                    $padrao_text = $row['padrao'] ? 'Sim' : 'No';
                    ?>
                        <tr>
                            <th scope="row" class="align-middle">
                                <a href="bancos.editar.php?id=<?php echo $row['id'];?>" class="text-decoration-none text-dark">#<?php echo str_pad($row['id'], 4, "0", STR_PAD_LEFT);?></a>
                            </th>
                            <td>
                                <a href="bancos.editar.php?id=<?php echo $row['id'];?>" class="fw-bold text-decoration-none"><?php echo $row['titulo'];?> (<?php echo $row['cod_banco'];?>)</a><br>
                                <small class="text-muted"><?php echo exibir_detalhes_geral_payisp($row);?></small>
                            </td>
                            <td class="text-center">
                                <a href="faturas.index.php?banco=<?php echo $banco['id'];?>" class="text-decoration-none">
                                    <span class="badge bg-primary"><?php echo qtd_faturas_banco_payisp($row['cod_banco']);?> <span class="fa fa-arrow-right"></span></span>
                                </a>
                            </td>
                            <td class="text-center">
                                <a href="carnets.index.php?banco=<?php echo $banco['id'];?>" class="text-decoration-none">
                                    <span class="badge bg-warning text-dark"><?php echo qtd_carnets_banco_payisp($row['cod_banco']);?> <span class="fa fa-arrow-right"></span></span>
                                </a>
                            </td>
                            <td class="text-center">
                                <span class="badge <?php echo $status_class;?>"><span class="fa <?php echo $status_icon;?>"></span> <?php echo $status_text; ?></span>
                            </td>
                            <td class="text-center">
                                <span class="badge <?php echo $padrao_class;?>"><span class="fa <?php echo $padrao_icon;?>"></span> <?php echo $padrao_text; ?></span>
                            </td>
                            <td>
                                <!-- Dropdown de Aes -->
                                <div class="dropdown dropstart">
                                    <button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Aes
                                    </button>
                                    <div class="dropdown-menu">
                                        <h6 class="dropdown-header">Banco #<?php echo $row['id'];?></h6>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="bancos.editar.php?id=<?php echo $row['id'];?>"><span class="fa fa-edit me-2"></span> Editar Configurao</a>
                                        <a class="dropdown-item" onclick="abrirPopup_payisp('bancos.licenca.php?id=<?php echo $row['id'];?>&serial=<?php echo $row['serial'];?>&md5=<?php echo md5($row['serial']);?>',600,600);" href="javascript:void(0);"><span class="fa fa-key me-2"></span> Licena</a>
                                        <div class="dropdown-divider"></div>
                                        <a onclick="prompt_confirmar_remover_payisp('Confirma remover o registro do banco selecionado? Digite SIM para confirmar!','bancos.remover.php?id=<?php echo $row['id'];?>');" title="Remover" class="dropdown-item text-danger" href="javascript:void(0);"><span class="fa fa-trash-alt me-2"></span> Remover</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    <?php 
                    $i++;
                    } 
                    ?>
                    <?php 
                    if($qtd_registros==0){
                    ?>
                        <tr>
                            <td colspan="7" class="text-center py-4 text-muted">Nenhuma conta bancria cadastrada.</td>
                        </tr>
                    <?php 
                    }
                    ?>
                </tbody>
            </table>
        </div>
        
        <!-- Paginao -->
        <?php if($paginas > 1){ ?>
            <nav class="mt-4" aria-label="Navegao de Bancos">
                <ul class="pagination justify-content-center">
                    <!-- Boto Anterior -->
                    <li class="page-item <?php echo ($pagina == 1) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="bancos.index.php?pagina=<?php echo max(1, $pagina - 1); ?><?php echo $tag; ?>" aria-label="Anterior">
                            <span aria-hidden="true">&laquo;</span> Anterior
                        </a>
                    </li>
                    
                    <?php
                    $max_links = 5;
                    $start_page = max(1, $pagina - floor($max_links / 2));
                    $end_page = min($paginas, $start_page + $max_links - 1);

                    if ($end_page - $start_page < $max_links - 1) {
                        $start_page = max(1, $end_page - $max_links + 1);
                    }
                    
                    for($i = $start_page; $i <= $end_page; $i++) {
                        $active_class = ($i == $pagina) ? 'active' : '';
                        echo '<li class="page-item '.$active_class.'"><a class="page-link" href="bancos.index.php?pagina='.$i.''.$tag.'">'.$i.'</a></li>';
                    }
                    ?>

                    <!-- Boto Prxima -->
                    <li class="page-item <?php echo ($pagina >= $paginas) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="bancos.index.php?pagina=<?php echo min($paginas, $pagina + 1); ?><?php echo $tag; ?>" aria-label="Prxima">
                            Prxima <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        <?php } ?>

    </div>

    <?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/bancos.licenca.php">
<?php require_once 'init.php'; ?>
<?php
//banco
$sql = "SELECT * FROM `payisp_config` WHERE id = " . (int)$_GET['id'] . " LIMIT 1";
$result = $mysqli->query($sql);
$banco = $result->fetch_array(MYSQLI_ASSOC);
if (isset($_REQUEST['atualizar_licensa'])) {
  //atualiza
  atualizar_dados_da_licenca_payisp($banco);
  sleep(2);
  //recarrega banco
  $sql = "SELECT * FROM `payisp_config` WHERE id = " . (int)$_GET['id'] . " LIMIT 1";
  $result = $mysqli->query($sql);
  $banco = $result->fetch_array(MYSQLI_ASSOC);
}
//dados da licensa
$dados_da_licensa = dados_da_licenca_payisp($banco);

// Calcula dias restantes para determinar o alerta
$dias_restantes = diff_date_php_days_payisp($banco['valido_ate']);
$alerta_class = 'alert-info';
$alerta_icon = 'fa-info-circle';

if ($dias_restantes <= 0) {
  $alerta_class = 'alert-danger';
  $alerta_icon = 'fa-times-circle';
} elseif ($dias_restantes <= 30) {
  $alerta_class = 'alert-warning';
  $alerta_icon = 'fa-exclamation-triangle';
}
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="iso-8859-1">
  <title>Licena: <?php echo $banco['serial']; ?> (<?php echo $banco['cod_banco']; ?>)</title>
  <!-- Incluindo Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/toastr.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <script src="../../scripts/jquery.js"></script>
  <script src="../../scripts/mk-auth.js"></script>
  <script src="../../menu.js.php"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/toastr.min.js"></script>
  <script src="js/jquery.blockUI.js"></script>
  <script src="js/bootbox.all.js"></script>
  <script src="js/scripts.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
    }

    .container-fluid {
      max-width: 600px;
    }

    .card-header {
      background-color: #0d6efd !important;
      color: white;
    }
  </style>
  <script>
    // atualizar host da licenca 
    function atualizar() {
      bootbox.confirm({
        title: "Atualizar Host/IP da Licena",
        message: "Esta ao solicitar a atualizao do host/IP licenciado. Confirma que o IP atual do seu MK-Auth  o novo endereo de host?",
        buttons: {
          confirm: {
            label: '<i class="fa fa-sync-alt"></i> Sim, Atualizar',
            className: 'btn-warning'
          },
          cancel: {
            label: '<i class="fa fa-times"></i> Cancelar',
            className: 'btn-secondary'
          }
        },
        callback: function(result) {
          if (result) {
            bloquear_tela_payisp();
            $.ajax({
              url: 'bancos.licensa.reset.php',
              type: 'POST',
              data: {
                serial_resetar: '<?php echo $banco['serial']; ?>',
                banco: '<?php echo $banco['id']; ?>',
                'atualizar_licensa': true
              },
              dataType: 'JSON',
              cache: false,
              success: function(data) {
                console.log(data);
                // Notifica o sucesso e recarrega
                toastr.success('Host/IP da Licena atualizado com sucesso!', 'Sucesso');
                if (window.opener && typeof window.opener.location.reload === 'function') {
                  window.opener.location.reload(false);
                }
                location.reload(true);
              },
              error: function(xhr, status, error) {
                // Em caso de erro na requisio AJAX
                console.error("Erro ao atualizar a licena:", error);
                toastr.error('Falha ao atualizar o host/IP. Verifique o console ou tente novamente mais tarde.', 'Erro');
                desbloquear_tela_payisp();
              }
            });
          }
        }
      });
    }
  </script>
</head>

<body>
  <div class="container-fluid py-4">

    <!-- Card Principal -->
    <div class="card shadow">
      <div class="card-header">
        <h5 class="mb-0 d-flex align-items-center">
          <i class="fa fa-key me-2"></i>
          Licena: <?php echo $banco['titulo']; ?> (<?php echo $banco['cod_banco']; ?>)
        </h5>
      </div>
      <div class="card-body">

        <!-- Alerta Informativo -->
        <div class="alert alert-primary" role="alert">
          <i class="fa-solid fa-circle-info me-2"></i>
          Compre ou atualize sua licena PAY ISP usando o boto abaixo. Os dados do seu provedor sero utilizados no faturamento.
        </div>

        <form onsubmit="bloquear_tela_payisp();" action="https://locasistemas.com/clientes/payisp/buy.lic.php?serial=<?php echo $banco['serial']; ?>" method="post">
          <input type="hidden" name="licensa" value="<?php echo $banco['serial']; ?>">
          <input type="hidden" name="retorno" value="<?php echo base64_encode(url_full_payisp()); ?>">
          <?php foreach (dados_do_provedor_payisp() as $k => $v) { ?>
            <input type="hidden" name="<?php echo $k; ?>" value="<?php echo $v; ?>">
          <?php } ?>

          <!-- Detalhes da Licena (Lista de Definio para clareza) -->
          <dl class="row mb-4">
            <dt class="col-sm-4">Status:</dt>
            <dd class="col-sm-8 fw-bold">
              <?php echo exibir_detalhes_geral_payisp($banco); ?>
            </dd>

            <dt class="col-sm-4">Licena Serial:</dt>
            <dd class="col-sm-8"><code class="bg-light p-1 rounded"><?php echo $banco['serial']; ?></code></dd>
            <dd class="col-sm-12 text-muted small">A Licena  nica por banco e intransfervel.</dd>

            <dt class="col-sm-4">Host/IP Licenciado:</dt>
            <dd class="col-sm-8">
              <strong><?php echo isset($dados_da_licensa->key_data['hostname']) ? $dados_da_licensa->key_data['hostname'] : 'n/a'; ?></strong>
            </dd>
            <dd class="col-sm-12 text-muted small">
              Trocou de host/ip e est sem acesso? <a href="javascript:void(0);" onclick="atualizar()" class="text-decoration-underline">Clique aqui para atualizar</a>.
            </dd>

            <dt class="col-sm-4 mt-2">Expira Em:</dt>
            <dd class="col-sm-8 mt-2 fw-bold">
              <?php echo date('d/m/Y H:i:s', strtotime($banco['valido_ate'])); ?>
              [<?php echo $dias_restantes; ?> dia(s)]
            </dd>
          </dl>

          <div class="mt-4">
            <?php if ($dias_restantes <= 30) { ?>
              <button type="submit" class="btn btn-primary btn-lg w-100 shadow-sm"><span class="fa fa-qrcode me-2"></span> Comprar/Renovar Licena (1 ano de uso)</button>
            <?php } else { ?>
              <div class="alert alert-success" role="alert">
                <i class="fa-solid fa-check-circle me-2"></i> Sua licena est ativa e vlida! A opo de renovao ser exibida 30 dias antes da data de expirao.
              </div>
            <?php } ?>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>

</html>
</file>

<file path="payisp/bancos.licensa.reset.php">
<?php require_once 'init.php';?>
<?php 
@header('Content-type: application/json');
//banco
$sql = "SELECT * FROM `payisp_config` WHERE id = ".(int)$_REQUEST['banco']." LIMIT 1";
$result = $mysqli->query($sql);
$banco = $result->fetch_array(MYSQLI_ASSOC);
//reset da licena
echo json_encode(resetar_serial_payisp($banco));
exit;
?>
</file>

<file path="payisp/bancos.remover.php">
<?php require_once 'init.php'; ?>
<?php
//remover banco
if (isset($_GET['id'])) {
	//banco
	$sql = "SELECT * FROM `payisp_config` WHERE id = " . (int)$_GET['id'] . " LIMIT 1";
	$result = $mysqli->query($sql);
	$banco = $result->fetch_array(MYSQLI_ASSOC);
	$sql = "DELETE FROM `payisp_config` WHERE id = '" . (int)$_GET['id'] . "' LIMIT 1";
	if ($mysqli->query($sql)) {
		//msg
		criar_log_mkauth_payisp('Banco #' . (int)$_GET['id'] . ' PAY ISP removido com sucesso [' . $banco['cod_banco'] . ']', 'admin');
		redir_com_aviso_payisp('Banco #' . (int)$_GET['id'] . ' removido com sucesso [' . $banco['cod_banco'] . ']!', 'bancos.index.php');
	}
}
?>
</file>

<file path="payisp/carnets.index.php">
<?php require_once 'init.php'; ?>
<?php
//registros por pagina 
$total_reg_por_pagina = $quantidade_registros_por_pagina;
//paginacao 
$pagina = isset($_GET['pagina']) ? (int)$_GET['pagina'] : 1;
$inicio = $pagina - 1;
$inicio = $inicio * $total_reg_por_pagina;
//filtros 
$tag = '';
$where = '';
$order = "ORDER BY titulo DESC";
//filtro por tag 
if (isset($_GET['tag']) && !empty($_GET['tag'])) {
	$tag .= '&tag=' . $_GET['tag'] . '';
	$where .= " AND (titulo LIKE '%" . escape_payisp($_GET['tag']) . "%' || nossonum LIKE '%" . escape_payisp($_GET['tag']) . "%' || fcartaonumero LIKE '%" . escape_payisp($_GET['tag']) . "%' || nome LIKE '%" . escape_payisp($_GET['tag']) . "%' || email LIKE '%" . escape_payisp($_GET['tag']) . "%' || endereco LIKE '%" . escape_payisp($_GET['tag']) . "%' || bairro LIKE '%" . escape_payisp($_GET['tag']) . "%' || cidade LIKE '%" . escape_payisp($_GET['tag']) . "%' || login LIKE '%" . escape_payisp($_GET['tag']) . "%' || cpf_cnpj LIKE '%" . escape_payisp($_GET['tag']) . "%')";
}
//filtros por status
$status_atual = 'todas';
if (isset($_GET['status']) && !empty($_GET['status'])) {
	$status_atual = trim($_GET['status']);
	$tag .= '&status=' . $status_atual . '';
	// A lgica original usa OR com o cdigo do carnet, mas aqui, o filtro est na consulta agrupada.
	// Manter o filtro WHERE para a vtab_titulos, conforme a lgica do MK-Auth.
	// Nota: O filtro "status" em uma listagem agrupada por carnet  complexo,
	// a consulta original filtra todas as faturas do carnet que atendem ao status.
	$where .= " AND status = '" . escape_payisp($status_atual) . "'";
}
//filtros por banco
$banco = '';
if (isset($_GET['banco']) && !empty($_GET['banco'])) {
	$banco = (int)($_GET['banco']);
	$tag .= '&banco=' . $banco . '';
	$where .= " AND numconta = '" . escape_payisp($banco) . "'";
}
//filtros por plano
$plano = '';
if (isset($_GET['plano']) && !empty($_GET['plano'])) {
	$plano = trim($_GET['plano']);
	$tag .= '&plano=' . $plano . '';
	$where .= " AND plano = '" . escape_payisp($plano) . "'";
}
//impresso
$impresso = '';
if (isset($_GET['impresso']) && !empty($_GET['impresso'])) {
	$impresso = trim($_GET['impresso']);
	$tag .= '&impresso=' . $impresso . '';
	$where .= " AND imp = '" . escape_payisp($impresso) . "'";
}
//ordem 
$ordem = 'desc';
if (isset($_GET['ordem']) && !empty($_GET['ordem'])) {
	$ordem = trim($_GET['ordem']);
	$tag .= '&ordem=' . $ordem . '';
	if ($_GET['ordem'] == 'asc') {
		$order = "ORDER BY titulo ASC";
	} else {
		$order = "ORDER BY titulo DESC";
	}
}
//tudo
$sql_tudo = "SELECT * FROM `vtab_titulos` WHERE tipocob = 'car' AND deltitulo = 0 $where GROUP BY codigo_carne $order";
$sql_tudo_result = $mysqli->query($sql_tudo);
$qtd_registros = $sql_tudo_result->num_rows;
$paginas = ceil($qtd_registros / $total_reg_por_pagina);
//lista os cliente bloqueados
$sql = "SELECT *,COUNT(*) AS parcelas FROM `vtab_titulos` WHERE tipocob = 'car' AND deltitulo = 0 $where GROUP BY codigo_carne $order LIMIT $inicio,$total_reg_por_pagina";
$result = $mysqli->query($sql);
//bancos 
$lista_bancos = dados_banco_mkauth_todos_payisp();
//planos 
$lista_planos = dados_planos_mkauth_todos_payisp();
?>
<?php $breadcrumbActual = 'Carnets'; ?>
<?php include 'lay.header.php'; ?>

<body>
	<script>
		// Mantido vazio, conforme original
	</script>
	<div style="height: 15px;"></div>
	<?php include('../../topo.php'); ?>

	<div class="container-fluid pt-3">

		<!-- Ttulo e Contagem -->
		<div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
			<h2 class="h4 mb-0"><i class="fa fa-book-open text-primary me-2"></i> Gesto de Carnets</h2>
			<span class="badge bg-primary fs-6"><?= str_pad($qtd_registros, 4, "0", STR_PAD_LEFT); ?> Carnets</span>
		</div>

		<?php exibir_aviso_payisp(); ?>

		<!-- Bloco Informativo Aprimorado -->
		<div class="alert alert-info d-flex align-items-center" role="alert">
			<i class="fa fa-info-circle me-2 fs-5"></i>
			<div>
				Lista de todos os carnets em seu MK-Auth. Clique sobre o cdigo do carnet ou use o boto de impresso para visualizar e imprimir.
			</div>
		</div>

		<!-- Botes de Ao -->
		<div class="d-flex justify-content-start flex-wrap gap-2 mb-4">
			<button onclick="location.href='/admin/clientes.hhvm?tipo=todos';" type="button" class="btn btn-primary"><i class="fa fa-plus"></i> Criar Faturas</button>
			<button onclick="imprimir_carnets();" type="button" class="btn btn-danger"><i class="fa fa-print"></i> Imprimir Carnets</button>
		</div>

		<!-- Formulrio de Filtros (Card Consolidado) -->
		<div class="card shadow-sm mb-4">
			<div class="card-header bg-light">
				<h6 class="mb-0"><i class="fa fa-filter me-2"></i> Filtros de Pesquisa</h6>
			</div>
			<div class="card-body p-3">
				<form method="GET" action="">
					<div class="row g-2">
						<!-- Busca Rpida -->
						<div class="col-md-3">
							<label for="tag" class="form-label small text-muted mb-0">Busca Rpida</label>
							<input value="<?php echo htmlspecialchars(isset($_GET['tag']) ? $_GET['tag'] : ''); ?>" name="tag" class="form-control form-control-sm" type="text" placeholder="Tags, Nome, CPF/CNPJ, etc.">
						</div>

						<!-- Status -->
						<div class="col-md-2">
							<label for="status" class="form-label small text-muted mb-0">Status Parcela</label>
							<select class="form-select form-select-sm" name="status" id="status">
								<option value="" <?php echo ($status_atual == 'todas') ? ' selected' : ''; ?>>Todos</option>
								<option value="aberto" <?php echo ($status_atual == 'aberto') ? ' selected' : ''; ?>>Com Faturas Abertas</option>
								<option value="pago" <?php echo ($status_atual == 'pago') ? ' selected' : ''; ?>>Com Faturas Pagas</option>
								<option value="vencido" <?php echo ($status_atual == 'vencido') ? ' selected' : ''; ?>>Com Faturas Vencidas</option>
							</select>
						</div>

						<!-- Banco -->
						<div class="col-md-2">
							<label for="banco" class="form-label small text-muted mb-0">Banco</label>
							<select class="form-select form-select-sm" name="banco" id="banco">
								<option value="" <?php echo ($banco == '') ? ' selected' : ''; ?>>Todos</option>
								<?php foreach ($lista_bancos as $v) { ?>
									<option value="<?php echo $v['id']; ?>" <?php echo ($banco == $v['id']) ? ' selected' : ''; ?>><?php echo $v['nome']; ?></option>
								<?php } ?>
							</select>
						</div>

						<!-- Plano -->
						<div class="col-md-2">
							<label for="plano" class="form-label small text-muted mb-0">Plano</label>
							<select class="form-select form-select-sm" name="plano" id="plano">
								<option value="" <?php echo ($plano == '') ? ' selected' : ''; ?>>Todos</option>
								<?php foreach ($lista_planos as $v) { ?>
									<option value="<?php echo $v['nome']; ?>" <?php echo ($plano == $v['nome']) ? ' selected' : ''; ?>><?php echo $v['nome']; ?></option>
								<?php } ?>
							</select>
						</div>

						<!-- Impresso -->
						<div class="col-md-1">
							<label for="impresso" class="form-label small text-muted mb-0">Impresso</label>
							<select class="form-select form-select-sm" name="impresso" id="impresso">
								<option value="" <?php echo ($impresso == '') ? ' selected' : ''; ?>>Todos</option>
								<option value="sim" <?php echo ($impresso == 'sim') ? ' selected' : ''; ?>>Sim</option>
								<option value="nao" <?php echo ($impresso == 'nao') ? ' selected' : ''; ?>>No</option>
							</select>
						</div>

						<!-- Ordem -->
						<div class="col-md-1">
							<label for="ordem" class="form-label small text-muted mb-0">Ordem</label>
							<select class="form-select form-select-sm" name="ordem" id="ordem">
								<option value="desc" <?php echo ($ordem == 'desc') ? ' selected' : ''; ?>>DESC</option>
								<option value="asc" <?php echo ($ordem == 'asc') ? ' selected' : ''; ?>>ASC</option>
							</select>
						</div>

						<!-- Botes de Ao do Filtro -->
						<div class="col-md-1 d-flex align-items-end justify-content-end gap-1">
							<button type="submit" class="btn btn-primary btn-sm" title="Filtrar"><i class="fa fa-search"></i></button>
							<button onclick="location.href='carnets.index.php';" type="button" class="btn btn-outline-danger btn-sm" title="Limpar Filtros"><i class="fa fa-times-circle"></i></button>
						</div>
					</div>
				</form>
			</div>
		</div>


		<!-- Tabela de Carnets -->
		<div class="table-responsive" style="min-height:600px;">
			<table class="table table-striped table-hover table-sm align-middle">
				<thead class="table-light">
					<tr>
						<th style="width:180px;">Carnet</th>
						<th>Cliente</th>
						<th>Banco</th>
						<th style="width:150px;">Descrio</th>
						<th class="text-center" style="width:100px;">Impresso</th>
						<th class="text-center" style="width:100px;">Qtd</th>
						<th class="text-end" style="width:120px;">Aberto (R$)</th>
						<th class="text-end" style="width:120px;">Pago (R$)</th>
						<th class="text-end" style="width:120px;">Atraso (R$)</th>
						<th style="width:100px;">Emisso</th>
						<th style="width:80px;">Aes</th>
					</tr>
				</thead>
				<tbody>
					<?php
					$i = 0;
					while ($row = $result->fetch_array()) {
						$aberto = total_parcelas_aberto_payisp($row['codigo_carne']);
						$pago = total_parcelas_pago_payisp($row['codigo_carne']);
						$vencido = total_parcelas_vencido_payisp($row['codigo_carne']);
						$banco_mk = dados_banco_mkauth_payisp($row['numconta']);
						$banco_payisp = dados_banco_uuid_payisp($banco_mk['uuid_boleto']);
						$whatsapp = preg_replace('/\D/', '', (!empty($row['celular']) ? $row['celular'] : $row['fone']));
						$frase = "Ol *" . ucwords($row['nome']) . "*, sou do financeiro *" . ucwords($dados_provedor['nome']) . "*, para pagar ou ver detalhes de suas faturas acesse o carnet digital *" . url_link_payisp() . "/admin/addons/payisp/cliente.carnet.php?uuid=" . $row['uuid_cliente'] . "&sec=" . sha1($row['uuid_cliente'] . $row['cpf_cnpj']) . "&carnet=" . $row['codigo_carne'] . "*, qualquer dvida entre em contato com nosso atendimento em *" . $dados_provedor['fone'] . "*!";
						$link_whats = "https://wa.me/55" . $whatsapp . "?text=" . urlencode($frase) . "";
					?>
						<tr>
							<th scope="row" class="align-middle">
								<!-- Checkbox e Link do Carnet -->
								<input class="lista_carnets"
									<?php echo isset($banco_payisp['id']) ? '' : 'disabled'; ?>
									data-id_banco="<?php echo isset($banco_payisp['id']) ? $banco_payisp['id'] : ''; ?>"
									type="checkbox" name="lista_carnets" value="<?php echo $row['codigo_carne']; ?>">
								<a onclick="window.open(this.href, this.target, 'width=800, height=500, scrollbars=yes'); return false;"
									href="/admin/addons/payisp/custom/prepara_carne.hhvm?carne=<?php echo $row['codigo_carne']; ?>"
									class="text-primary fw-bold">
									<?php echo $row['codigo_carne']; ?> <i class="fa fa-print"></i>
								</a>
							</th>
							<td>
								<!-- Detalhes do Cliente -->
								<u><a target="_blank" href="/admin/cliente_det.hhvm?uuid=<?php echo $row['uuid_cliente']; ?>"><?php echo ucwords($row['nome']); ?></a></u>
								<small class="text-muted">(<?php echo $row['cpf_cnpj']; ?>)</small><br>
								<div class="d-flex gap-1 mt-1">
									<?php if (!empty($whatsapp) && (strlen($whatsapp) == 10 || strlen($whatsapp) == 11)) { ?>
										<a title="Enviar carnet no whatsapp" target="_blank" href="<?php echo $link_whats; ?>"><span class="badge text-bg-success"><span class="fa-brands fa-whatsapp"></span></span></a>
									<?php } ?>
									<a title="Link do carnet" target="_blank" href="cliente.carnet.php?uuid=<?php echo $row['uuid_cliente']; ?>&sec=<?php echo sha1($row['uuid_cliente'] . $row['cpf_cnpj']); ?>&carnet=<?php echo $row['codigo_carne']; ?>"><span class="badge text-bg-primary"><span class="fa fa-share"></span></span></a>
								</div>
							</td>
							<td>
								<!-- Banco -->
								<strong><?php echo isset($banco_mk['nome']) ? $banco_mk['nome'] : 'n/a'; ?></strong>
								<?php if (isset($banco_payisp['id'])) { ?> <span class="badge text-bg-primary badge-sm" style="font-size:0.6rem;">
										API
									</span><?php } ?>
							</td>
							<td><?php echo $row['descricao']; ?></td>
							<td class="text-center">
								<!-- Status Impresso -->
								<?php
								$imp_class = $row['imp'] == 'sim' ? 'text-bg-primary' : 'text-bg-danger';
								$imp_text = $row['imp'] == 'sim' ? 'Sim' : 'No';
								?>
								<a onclick="window.open(this.href, this.target, 'width=800, height=500, scrollbars=yes'); return false;"
									href="/admin/addons/payisp/custom/prepara_carne.hhvm?carne=<?php echo $row['codigo_carne']; ?>">
									<span class="badge <?php echo $imp_class; ?>"><?php echo $imp_text; ?> <span class="fa fa-print"></span></span>
								</a>
							</td>
							<td class="text-center"><span class="badge text-bg-dark"><?php echo $row['parcelas']; ?></span></td>
							<td class="text-end"><span class="badge text-bg-primary">R$<?php echo isset($aberto['total']) ? number_format($aberto['total'], 2, ',', '.') : '0,00'; ?></span></td>
							<td class="text-end"><span class="badge text-bg-success">R$<?php echo isset($pago['total']) ? number_format($pago['total'], 2, ',', '.') : '0,00'; ?></span></td>
							<td class="text-end"><span class="badge text-bg-danger">R$<?php echo isset($vencido['total']) ? number_format($vencido['total'], 2, ',', '.') : '0,00'; ?></span></td>
							<td><?php echo date('d/m/Y', strtotime($row['processamento'])); ?></td>
							<td>
								<!-- Dropdown de Aes -->
								<div class="dropdown dropstart">
									<button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Mais Aes">
										Aes
									</button>
									<div class="dropdown-menu">
										<h6 class="dropdown-header">Carnet #<?php echo $row['codigo_carne']; ?></h6>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" onclick="window.open(this.href, this.target, 'width=800, height=500, scrollbars=yes'); return false;" href="/admin/addons/payisp/custom/prepara_carne.hhvm?carne=<?php echo $row['codigo_carne']; ?>"><span class="fa fa-print me-2"></span> Imprimir</a>
										<a class="dropdown-item" target="_blank" href="cliente.carnet.php?uuid=<?php echo $row['uuid_cliente']; ?>&sec=<?php echo sha1($row['uuid_cliente'] . $row['cpf_cnpj']); ?>&carnet=<?php echo $row['codigo_carne']; ?>"><span class="fa fa-share me-2"></span> Carnet digital</a>
									</div>
								</div>
							</td>
						</tr>
					<?php
						$i++;
					}
					?>
					<?php
					if ($qtd_registros == 0) {
					?>
						<tr>
							<td colspan="12" class="text-center py-4 text-muted">Nenhum registro de carnet encontrado com os filtros aplicados.</td>
						</tr>
					<?php
					}
					?>
				</tbody>
			</table>
		</div>

		<!-- Paginao -->
		<?php if ($paginas > 1) { ?>
			<nav class="mt-4" aria-label="Navegao de Pgina">
				<ul class="pagination justify-content-center">
					<!-- Boto Anterior -->
					<li class="page-item <?php echo ($pagina == 1) ? 'disabled' : ''; ?>">
						<a class="page-link" href="carnets.index.php?pagina=<?php echo max(1, $pagina - 1); ?><?php echo $tag; ?>" aria-label="Anterior">
							<span aria-hidden="true">&laquo;</span> Anterior
						</a>
					</li>

					<?php
					$max_links = 5;
					$start_page = max(1, $pagina - floor($max_links / 2));
					$end_page = min($paginas, $start_page + $max_links - 1);

					if ($end_page - $start_page < $max_links - 1) {
						$start_page = max(1, $end_page - $max_links + 1);
					}

					for ($i = $start_page; $i <= $end_page; $i++) {
						$active_class = ($i == $pagina) ? 'active' : '';
						echo '<li class="page-item ' . $active_class . '"><a class="page-link" href="carnets.index.php?pagina=' . $i . '' . $tag . '">' . $i . '</a></li>';
					}
					?>

					<!-- Boto Prxima -->
					<li class="page-item <?php echo ($pagina >= $paginas) ? 'disabled' : ''; ?>">
						<a class="page-link" href="carnets.index.php?pagina=<?php echo min($paginas, $pagina + 1); ?><?php echo $tag; ?>" aria-label="Prxima">
							Prxima <span aria-hidden="true">&raquo;</span>
						</a>
					</li>
				</ul>
			</nav>
		<?php } ?>

	</div>

	<?php include('lay.footer.php'); ?>
	<script>
		// FUNO DE IMPRESSO DE CARNETS
		function imprimir_carnets() {
			var selected = [];
			var bancos = [];
			jQuery('input[name="lista_carnets"]:checked').each(function() {
				var id_banco = jQuery(this).data("id_banco");
				// Condio original: id_banco != ''
				if (id_banco != '') {
					selected.push(jQuery(this).val());
					bancos.push(id_banco);
				}
			});
			console.log(selected);
			console.log(bancos.every((val, i, arr) => val === arr[0]));
			if (selected.length == 0) {
				bootbox.alert("Selecione no mnimo um carnet para impresso e que tenha sido emitido por o mesmo banco gerenciado via PAY ISP!");
				return false;
			} else if (bancos.every((val, i, arr) => val === arr[0]) == false) {
				bootbox.alert("Selecione apenas carnets emitidos por o mesmo banco. Filtre por bancos para o melhor resultado!");
				return false;
			} else {
				var carnets = '';
				jQuery.each(selected, function(key, value) {
					carnets += '&carne[]=' + value;
				});
				// Mantida a abertura de janela, conforme a funcionalidade original
				window.open('imprimir.carnet.php?origem=impressao_carnes' + carnets, 'carnets', 'width=800, height=500, scrollbars=yes');
				return false;
			}
		}
	</script>

</body>

</html>
</file>

<file path="payisp/cartao.mercadopago.pagar.php">
<?php 
include(dirname(__FILE__).'/init_cliente.php');
@header('Content-Type: application/json; charset=utf-8');
//fatura ao cliente 
$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND uuid_lanc = '".valor_antigo_payisp('uuid')."' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if(!isset($fatura['uuid_lanc'])){
	$alerta = 'O titulo selecionado no foi encontrado na base de dados, solicite um novo link de pagamento em nosso suporte.';
	echo json_encode(array('erro'=>true,'log'=>$alerta));
	exit;
}
if(sha1($fatura['uuid_lanc'].$fatura['titulo'].$fatura['titulo'])!=valor_antigo_payisp('sec')){
	$alerta = 'Voc no tem permisso de visualizar titulo selecionado.';
	echo json_encode(array('erro'=>true,'log'=>$alerta));
	exit;
}
//dados mp 
$request_body = file_get_contents('php://input');
$data = json_decode($request_body,true);
//soma o total 
$total_final = $fatura['valor'];
if($dados_configuracoes['taxa'] > 0){
	$total_final = $total_final+(($total_final/100)*$dados_configuracoes['taxa']);
}
$total_final = number_format($total_final,'2','.','');
$total_gateway = number_format($data['transaction_amount'],'2','.','');
if($total_final < $total_gateway){
	$alerta = 'O valor de pagamento ['.$total_gateway.'] esta diferente o total real ['.$total_final.'].';
	echo json_encode(array('erro'=>true,'log'=>$alerta));
	exit;
}
//dados customizados 
$custom = array();
$custom['notification_url'] = ($sandbox)?'https://www.loja5.com.br/ipn.php':url_link_payisp().'/admin/addons/payisp/cron.mercadopago.php';
$custom['description'] = 'Fatura #'.$fatura['titulo'].' em '.ucwords($dados_provedor['nome']).'';
$custom['external_reference'] = $fatura['titulo'];
//merge de dados 
$json = array_merge($data,$custom);
//request
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, 'https://api.mercadopago.com/v1/payments?access_token='.trim($dados_configuracoes['token']).'');
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($curl, CURLOPT_HTTPHEADER, array(
	"Accept: application/json",
	"Content-Type: application/json",
	"X-Idempotency-Key: mp-key-".time().""
));
curl_setopt($curl, CURLOPT_POST, true);
if(count($json) > 0){
	curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($json) );
}
curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 10);
curl_setopt($curl, CURLOPT_TIMEOUT, 40);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
$resultado = curl_exec($curl);
$httpcode  = curl_getinfo($curl, CURLINFO_HTTP_CODE);
$erro      = curl_error($curl);
curl_close($curl);
$payment = json_decode($resultado,true);
if($httpcode==201 && isset($payment['id'])){
	//salva os ids
	$mysqli->query("UPDATE sis_lanc SET formapag = 'mercadopago', chave_juno = '".$payment['id']."', processamento = NOW() WHERE id = '".$fatura['titulo']."';");
	$mysqli->query("UPDATE payisp_faturas SET gateway = 'mercadopago', gateway_id = '".$payment['id']."' WHERE fatura_mkauth = '".$fatura['titulo']."';");
	//se aprovado 
	if($payment['status']=='approved'){
		//atualiza a fatura mkauth
		$sql = "UPDATE sis_lanc SET formapag = 'mercadopago', `status` = 'pago', num_recibos = 1, datapag = '".date('Y-m-d H:i:s')."', coletor = 'mercadopago', valorpag = '".$payment['transaction_amount']."', tarifa_paga = '0', valordesc = '0', recibo = '".substr(md5((int)$fatura['titulo']),-8)."' WHERE id = '".(int)$fatura['titulo']."' LIMIT 1";
		$mysqli->query($sql);
		//atualiza a fatura addon
		$sql = "UPDATE payisp_faturas SET status = 'pago', valor_pago = '".$payment['transaction_amount']."', data_pagamento = '".date('Y-m-d H:i:s')."', desconto = '0' WHERE fatura_mkauth = '".(int)$fatura['titulo']."' LIMIT 1";
		$mysqli->query($sql);
		//cria o registro de entrada do caixa 
		$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,entrada,tipomov,planodecontas) VALUES ('".uniqid()."', 'mercadopago', '".date('Y-m-d H:i:s')."', 'Recebimento do titulo ".(int)$fatura['titulo']." / ".$fatura['login']." [mercadopago]', '".$payment['transaction_amount']."', 'aut', 'Outros')";
		$mysqli->query($sql);
		//log 
		criar_log_mkauth_payisp('[API] Titulo '.(int)$fatura['titulo'].' Recebido via PAY ISP [mercadopago].','admin');
	}
	echo json_encode(array('erro'=>false,'id'=>$payment['id'],'log'=>'Pagamento processado com sucesso!','raw'=>$payment,'original'=>$json));
	exit;
}else{
	$alerta = isset($payment['message'])?$payment['message']:'http '.$httpcode.'';
	echo json_encode(array('erro'=>true,'log'=>'Erro MercadoPago: '.$alerta,'raw'=>$payment,'original'=>$json));
	exit;
}
?>
</file>

<file path="payisp/cartao.mercadopago.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
//fatura ao cliente 
$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND uuid_lanc = '" . valor_antigo_payisp('uuid') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O ttulo do boleto selecionado no foi encontrado na base de dados. Verifique se o link acessado est correto ou solicite um novo link de pagamento em nosso suporte.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
if (sha1($fatura['uuid_lanc'] . $fatura['titulo'] . $fatura['titulo']) != valor_antigo_payisp('sec')) {
	$titulo = 'Acesso Negado';
	$alerta = 'Voc no tem permisso de visualizar o ttulo do boleto selecionado. Acesso negado por violao de segurana.';
	$tipo_alerta = 'danger';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//soma o total 
$total_final = $fatura['valor'];
if (isset($dados_configuracoes['taxa']) && $dados_configuracoes['taxa'] > 0) {
	$total_final = $total_final + (($total_final / 100) * $dados_configuracoes['taxa']);
}
$total_final_formatado = number_format($total_final, '2', '.', '');
?>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Pagar Fatura #<?php echo $fatura['titulo']; ?> via Carto - <?php echo ucwords($dados_provedor['nome']); ?></title>

	<!-- Metatags para compartilhamento -->
	<meta property="og:title" content="Pagar Fatura #<?php echo $fatura['titulo']; ?> via Carto - <?php echo ucwords($dados_provedor['nome']); ?>">
	<meta property="og:description" content="<?php echo ucwords($dados_provedor['nome']); ?>">
	<meta property="og:image" content="../../../mkfiles/logo.jpg">

	<!-- CSS e Scripts (Mantidos como no original) -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/admin/addons/payisp/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
	<link href="/admin/addons/payisp/css/bootstrap.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/toastr.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/styles.css" rel="stylesheet">

	<script src="/admin/scripts/jquery.js"></script>
	<script src="/admin/addons/payisp/js/bootstrap.bundle.min.js"></script>
	<script src="/admin/addons/payisp/js/toastr.min.js"></script>
	<script src="/admin/addons/payisp/js/jquery.blockUI.js"></script>
	<script src="/admin/addons/payisp/js/bootbox.all.js"></script>
	<script src="/admin/addons/payisp/js/scripts.js"></script>
	<script src="https://sdk.mercadopago.com/js/v2"></script>

	<style>
		body {
			background-color: #f8f9fa;
		}

		.container {
			max-width: 600px;
		}

		.mp-logo {
			max-height: 25px;
			margin-left: 8px;
		}
	</style>
</head>

<body>
	<div class="container py-4">

		<!-- Carto de Pagamento Principal -->
		<div class="card shadow-lg">

			<div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
				<h5 class="mb-0 text-primary">
					<i class="fa fa-credit-card me-2"></i> Pagamento da Fatura #<?php echo $fatura['titulo']; ?>
				</h5>
				<img src="https://imgmp.mlstatic.com/org-img/banners/br/responsive/mercado_pago_logo_simple.png" alt="Mercado Pago" class="mp-logo">
			</div>

			<div class="card-body">

				<!-- Aviso de Valor a Pagar -->
				<div class="alert alert-success text-center mb-4 py-3" role="alert">
					<h4 class="mb-1">Total a Pagar: R$<?php echo number_format($total_final, '2', ',', '.'); ?></h4>
					<?php if (isset($dados_configuracoes['taxa']) && $dados_configuracoes['taxa'] > 0) { ?>
						<small>(Inclui acrscimo de **<?php echo $dados_configuracoes['taxa']; ?>%**)</small>
					<?php } ?>
				</div>

				<!-- Mensagem Condicional -->
				<?php if ($fatura['status'] == 'pago') { ?>
					<div class="alert alert-success text-center" role="alert">
						<i class="fa fa-check-circle me-1"></i> Esta fatura j est **PAGA**!
					</div>
				<?php } else { ?>
					<div class="alert alert-info text-center" role="alert">
						<i class="fa fa-shield-alt me-1"></i> Informe os dados do carto em ambiente **seguro** do Mercado Pago para prosseguir.
					</div>
				<?php } ?>

				<!-- Contineres dos Bricks do Mercado Pago -->
				<?php if ($fatura['status'] == 'pago') { ?>
					<div id="statusScreenBrick_container"></div>
				<?php } else { ?>
					<div id="cardPaymentBrick_container"></div>
					<div id="statusScreenBrick_container" style="display:none;"></div>
				<?php } ?>

			</div>

			<div class="card-footer bg-light text-center">
				<button onclick="history.back();" type="button" class="btn btn-secondary"><i class="fa fa-rotate-left me-1"></i> Voltar</button>
			</div>
		</div>

		<!-- Script de Integrao com Mercado Pago -->
		<script>
			const mp = new MercadoPago('<?php echo trim($dados_configuracoes['public']); ?>', {
				locale: 'pt-BR'
			});
			const bricksBuilder = mp.bricks();

			// Tela de pagamento
			<?php if ($fatura['status'] <> 'pago') { ?>
				const renderCardPaymentBrick = async (bricksBuilder) => {
					const settings = {
						// Inicializao
						initialization: {
							amount: <?php echo $total_final_formatado; ?>, // valor total a ser pago
							payer: {
								email: "<?php echo $fatura['email']; ?>"
							},
						},
						// Customizao
						customization: {
							visual: {
								style: {
									theme: 'bootstrap', // Usa tema Bootstrap para melhor integrao visual
									customVariables: {}
								}
							},
							paymentMethods: {
								maxInstallments: 1, // Mantido o mximo de 1 parcela (condio original)
							}
						},
						// Callbacks
						callbacks: {
							onReady: () => {
								console.log('CardPaymentBrick pronto.');
							},
							onSubmit: (cardFormData) => {
								return new Promise((resolve, reject) => {
									// Faz a chamada  API de pagamento do backend
									fetch("cartao.<?php echo $dados_configuracoes['gateway']; ?>.pagar.php?uuid=<?php echo valor_antigo_payisp('uuid'); ?>&sec=<?php echo valor_antigo_payisp('sec'); ?>", {
										method: "POST",
										headers: {
											"Content-Type": "application/json",
										},
										body: JSON.stringify(cardFormData)
									}).then((response) => response.json()).then((data) => {
										// Receber o resultado do pagamento
										console.log('Resultado do pagamento:', data);
										if (data.erro) {
											// Substitudo alert() nativo por bootbox.alert()
											bootbox.alert({
												title: "Erro no Pagamento",
												message: data.log,
												centerVertical: true
											});
											reject();
										} else {
											// Sucesso, alterna para a tela de status
											jQuery('#cardPaymentBrick_container').hide();
											jQuery('#statusScreenBrick_container').show();
											resolve();
											renderStatusScreenBrick(bricksBuilder, data.id);
										}
									}).catch((error) => {
										// Lida com erro na comunicao (fetch)
										console.error('Erro na requisio de pagamento:', error);
										bootbox.alert({
											title: "Erro de Comunicao",
											message: "Ocorreu um erro ao processar sua requisio. Por favor, tente novamente.",
											centerVertical: true
										});
										reject();
									})
								});
							},
							onError: (error) => {
								// Callback chamado para todos os casos de erro do Brick
								console.error('Erro no Brick de Pagamento:', error);
								// Pode-se usar toastr para avisos no crticos
								toastr.error('Ocorreu um erro no formulrio de pagamento. Verifique os dados inseridos.', 'Ateno');
							},
						},
					};
					window.cardPaymentBrickController = await bricksBuilder.create('cardPayment', 'cardPaymentBrick_container', settings);
				};
				renderCardPaymentBrick(bricksBuilder);
			<?php } ?>

			// Status do pagamento 
			const renderStatusScreenBrick = async (bricksBuilder, idPagamento) => {
				const settings = {
					initialization: {
						paymentId: idPagamento, // Identificador do pagamento
					},
					customization: {
						visual: {
							hideStatusDetails: true,
							hideTransactionDate: true,
							style: {
								theme: 'bootstrap', // Usar o tema Bootstrap
							},
						},
						// URLs de retorno para erro e sucesso (mantidas conforme original)
						backUrls: {
							'error': '<?php echo (isset($sandbox) && $sandbox) ? 'https://www.loja5.com.br' : url_link_payisp(); ?>/cliente.fatura.php?uuid=<?php echo valor_antigo_payisp('uuid'); ?>&sec=<?php echo valor_antigo_payisp('sec'); ?>',
							'return': '<?php echo (isset($sandbox) && $sandbox) ? 'https://www.loja5.com.br' : url_link_payisp(); ?>/cliente.fatura.php?uuid=<?php echo valor_antigo_payisp('uuid'); ?>&sec=<?php echo valor_antigo_payisp('sec'); ?>'
						}
					},
					callbacks: {
						onReady: () => {
							console.log('StatusScreenBrick pronto.');
							// Recarrega a tela pai, se aplicvel (opcionalmente)
							// if(window.opener && typeof window.opener.location.reload === 'function') { window.opener.location.reload(false); }
						},
						onError: (error) => {
							console.error('Erro no StatusScreenBrick:', error);
						},
					},
				};
				window.statusScreenBrickController = await bricksBuilder.create('statusScreen', 'statusScreenBrick_container', settings);
			};

			<?php if ($fatura['status'] == 'pago') { ?>
				// Renderiza a tela de status se a fatura j estiver paga, usando a chave como ID de pagamento
				renderStatusScreenBrick(bricksBuilder, '<?php echo $fatura['chave_juno']; ?>');
			<?php } ?>
		</script>
	</div>
</body>

</html>
</file>

<file path="payisp/changelog.php">
<?php require_once 'init.php';?>
<!DOCTYPE html>
<?php
// A lgica original para o <html>  mantida
if (isset($_SESSION['MM_Usuario'])) {
    echo '<html lang="pt-BR">'; 
} else {
    echo '<html lang="pt-BR" class="has-navbar-fixed-top">';
}
?>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title>Histrico de Alteraes (Changelog)</title>
    <!-- Incluindo Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
    <style>
        body { background-color: #f8f9fa; }
        .card-changelog { max-width: 800px; margin: auto; }
        pre { 
            white-space: pre-wrap; /* Quebra de linha */
            word-wrap: break-word; /* Quebra de palavra */
            font-size: 0.9rem;
            background-color: #e9ecef; 
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<div class="container-fluid py-4">

    <!-- Card Principal para o Changelog -->
    <div class="card shadow-sm card-changelog">
        <div class="card-header bg-dark text-white">
            <h5 class="mb-0"><i class="fa fa-history me-2"></i> Histrico de Alteraes do Addon</h5>
        </div>
        <div class="card-body">
            <p class="text-muted">Abaixo est o log de todas as verses e alteraes realizadas no addon. ltima verificao em: <?php echo date('d/m/Y H:i:s'); ?></p>
            
            <pre>
<?php 
// Cdigo original de busca do changelog (mantido)
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://www.mkauth-addons.com.br/zip/payisp.txt');
curl_setopt($ch, CURLOPT_POST, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
$result = curl_exec($ch);
curl_close($ch);
// O nl2br  crucial para a legibilidade, e o <pre> envolve tudo.
echo ($result);
?>
            </pre>
        </div>
    </div>
</div>
</body>
</html>
</file>

<file path="payisp/class.bank.php">
<?php
//class banco
class BancoClassPayIsp
{

	public function converterLinhaDigitavel($linha)
	{
		$linha = preg_replace('/\D/', '', $linha);
		$campo1 = substr($linha, 0, 4) . substr($linha, 19, 1) . substr($linha, 20, 5);
		$campo2 = substr($linha, 24, 10);
		$campo3 = substr($linha, 34, 10);
		$campo4 = substr($linha, 4, 1);
		$campo5 = substr($linha, 5, 14);
		$cod_barras = $campo1 . $campo2 . $campo3 . $campo4 . $campo5;
		return $cod_barras;
	}

	public function geraCodigoBarra($numero)
	{
		$numero = preg_replace('/\D/', '', $numero);
		$fino = 2;
		$largo = 4;
		$altura = 60;
		$preta = 'data:image/gif;base64,R0lGODlhCgBQAIAAAAAAAP///yH5BAUUAAEALAAAAAAKAFAAAAIahI+py+0Po5y02ouz3rz7D4biSJbmiabqihUAOw==';
		$branca = 'data:image/gif;base64,R0lGODlhCgBQAIAAAP///////yH5BAUUAAEALAAAAAAKAFAAAAIahI+py+0Po5y02ouz3rz7D4biSJbmiabqihUAOw==';
		$barcodes[0] = '00110';
		$barcodes[1] = '10001';
		$barcodes[2] = '01001';
		$barcodes[3] = '11000';
		$barcodes[4] = '00101';
		$barcodes[5] = '10100';
		$barcodes[6] = '01100';
		$barcodes[7] = '00011';
		$barcodes[8] = '10010';
		$barcodes[9] = '01010';

		for ($f1 = 9; $f1 >= 0; $f1--) {
			for ($f2 = 9; $f2 >= 0; $f2--) {
				$f = ($f1 * 10) + $f2;
				$texto = '';
				for ($i = 1; $i < 6; $i++) {
					$texto .= substr($barcodes[$f1], ($i - 1), 1) . substr($barcodes[$f2], ($i - 1), 1);
				}
				$barcodes[$f] = $texto;
			}
		}

		$codBarImg = '';

		$codBarImg .= '<img src="' . $preta . '" width="' . $fino . '" height="' . $altura . '" border="0" />';
		$codBarImg .= '<img src="' . $branca . '" width="' . $fino . '" height="' . $altura . '" border="0" />';
		$codBarImg .= '<img src="' . $preta . '" width="' . $fino . '" height="' . $altura . '" border="0" />';
		$codBarImg .= '<img src="' . $branca . '" width="' . $fino . '" height="' . $altura . '" border="0" />';

		$codBarImg .= '<img ';

		$texto = $numero;

		if ((strlen($texto) % 2) <> 0) {
			$texto = '0' . $texto;
		}

		while (strlen($texto) > 0) {
			$i = round(substr($texto, 0, 2));
			$texto = substr($texto, strlen($texto) - (strlen($texto) - 2), (strlen($texto) - 2));

			if (isset($barcodes[$i])) {
				$f = $barcodes[$i];
			}

			for ($i = 1; $i < 11; $i += 2) {
				if (substr($f, ($i - 1), 1) == '0') {
					$f1 = $fino;
				} else {
					$f1 = $largo;
				}

				$codBarImg .= 'src="' . $preta . '" width="' . $f1 . '" height="' . $altura . '" border="0">';
				$codBarImg .= '<img ';

				if (substr($f, $i, 1) == '0') {
					$f2 = $fino;
				} else {
					$f2 = $largo;
				}

				$codBarImg .= 'src="' . $branca . '" width="' . $f2 . '" height="' . $altura . '" border="0">';
				$codBarImg .= '<img ';
			}
		}
		$codBarImg .= 'src="' . $preta . '" width="' . $largo . '" height="' . $altura . '" border="0" />';
		$codBarImg .= '<img src="' . $branca . '" width="' . $fino . '" height="' . $altura . '" border="0" />';
		$codBarImg .= '<img src="' . $preta . '" width="1" height="' . $altura . '" border="0" />';

		return $codBarImg;
	}

	public function geraCodigoBanco($cod)
	{
		$parte1 = substr($cod, 0, 3);
		$parte2 = $this->modulo_11($parte1);
		return $parte1 . "-" . $parte2;
	}

	public function modulo_11($num, $base = 9, $r = 0)
	{
		$soma = 0;
		$fator = 2;
		for ($i = strlen($num); $i > 0; $i--) {
			$numeros[$i] = substr($num, $i - 1, 1);
			$parcial[$i] = $numeros[$i] * $fator;
			$soma += $parcial[$i];
			if ($fator == $base) {
				$fator = 1;
			}
			$fator++;
		}
		if ($r == 0) {
			$soma *= 10;
			$digito = $soma % 11;
			//corrigido
			if ($digito == 10) {
				$digito = "X";
			}
			if (strlen($num) == "43") {
				//ento estamos checando a linha digitvel
				if ($digito == "0" or $digito == "X" or $digito > 9) {
					$digito = 1;
				}
			}
			return $digito;
		} elseif ($r == 1) {
			$resto = $soma % 11;
			return $resto;
		}
	}

	public function formatarLinha($cod_barras)
	{
		$cod_barras = preg_replace('/\D/', '', $cod_barras);
		$linha_digitavel = substr($cod_barras, 0, 5) . '.';
		$linha_digitavel .= substr($cod_barras, 5, 5) . ' ';
		$linha_digitavel .= substr($cod_barras, 10, 5) . '.';
		$linha_digitavel .= substr($cod_barras, 15, 6) . ' ';
		$linha_digitavel .= substr($cod_barras, 21, 5) . '.';
		$linha_digitavel .= substr($cod_barras, 26, 6) . ' ';
		$linha_digitavel .= substr($cod_barras, 32, 1) . ' ';
		$linha_digitavel .= substr($cod_barras, 33, 14);
		return $linha_digitavel;
	}
}
</file>

<file path="payisp/class.log.php">
<?php 
//log
class LoggerPayIsp {

    private
        $file,
        $timestamp;

    public function __construct($filename) {
        $this->file = $filename;
    }

    public function putLog($insert) {
		$this->timestamp = date('d-m-Y H:i:s').' > ';
        if (isset($this->timestamp)) {
            @file_put_contents($this->file, $this->timestamp.$insert."<br>", FILE_APPEND);
        } else {
            trigger_error("Timestamp not set", E_USER_ERROR);
        }
    }

    public function getLog() {
        $content = @file_get_contents($this->file);
        return $content;
    }

}
?>
</file>

<file path="payisp/class.qrcode.php">
<?php
/*
 * PHP QR Code encoder
 *
 * This file contains MERGED version of PHP QR Code library.
 * It was auto-generated from full version for your convenience.
 *
 * This merged version was configured to not requre any external files,
 * with disabled cache, error loging and weker but faster mask matching.
 * If you need tune it up please use non-merged version.
 *
 * For full version, documentation, examples of use please visit:
 *
 *    http://phpqrcode.sourceforge.net/
 *    https://sourceforge.net/projects/phpqrcode/
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */



/*
 * Version: 1.1.4
 * Build: 2010100721
 */



//---- qrconst.php -----------------------------





/*
 * PHP QR Code encoder
 *
 * Common constants
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

// Encoding modes

define('QR_MODE_NUL', -1);
define('QR_MODE_NUM', 0);
define('QR_MODE_AN', 1);
define('QR_MODE_8', 2);
define('QR_MODE_KANJI', 3);
define('QR_MODE_STRUCTURE', 4);

// Levels of error correction.

define('QR_ECLEVEL_L', 0);
define('QR_ECLEVEL_M', 1);
define('QR_ECLEVEL_Q', 2);
define('QR_ECLEVEL_H', 3);

// Supported output formats

define('QR_FORMAT_TEXT', 0);
define('QR_FORMAT_PNG',  1);

class qrstr
{
    public static function set(&$srctab, $x, $y, $repl, $replLen = false)
    {
        $srctab[$y] = substr_replace($srctab[$y], ($replLen !== false) ? substr($repl, 0, $replLen) : $repl, $x, ($replLen !== false) ? $replLen : strlen($repl));
    }
}



//---- merged_config.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Config file, tuned-up for merged verion
 */

define('QR_CACHEABLE', false);       // use cache - more disk reads but less CPU power, masks and format templates are stored there
define('QR_CACHE_DIR', false);       // used when QR_CACHEABLE === true
define('QR_LOG_DIR', false);         // default error logs dir   

define('QR_FIND_BEST_MASK', true);                                                          // if true, estimates best mask (spec. default, but extremally slow; set to false to significant performance boost but (propably) worst quality code
define('QR_FIND_FROM_RANDOM', 2);                                                       // if false, checks all masks available, otherwise value tells count of masks need to be checked, mask id are got randomly
define('QR_DEFAULT_MASK', 2);                                                               // when QR_FIND_BEST_MASK === false

define('QR_PNG_MAXIMUM_SIZE',  1024);                                                       // maximum allowed png image width (in pixels), tune to make sure GD and PHP can handle such big images




//---- qrtools.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Toolset, handy and debug utilites.
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

class QRtools
{

    //----------------------------------------------------------------------
    public static function binarize($frame)
    {
        $len = count($frame);
        foreach ($frame as &$frameLine) {

            for ($i = 0; $i < $len; $i++) {
                $frameLine[$i] = (ord($frameLine[$i]) & 1) ? '1' : '0';
            }
        }

        return $frame;
    }

    //----------------------------------------------------------------------
    public static function tcpdfBarcodeArray($code, $mode = 'QR,L', $tcPdfVersion = '4.5.037')
    {
        $barcode_array = array();

        if (!is_array($mode))
            $mode = explode(',', $mode);

        $eccLevel = 'L';

        if (count($mode) > 1) {
            $eccLevel = $mode[1];
        }

        $qrTab = QRcode::text($code, false, $eccLevel);
        $size = count($qrTab);

        $barcode_array['num_rows'] = $size;
        $barcode_array['num_cols'] = $size;
        $barcode_array['bcode'] = array();

        foreach ($qrTab as $line) {
            $arrAdd = array();
            foreach (str_split($line) as $char)
                $arrAdd[] = ($char == '1') ? 1 : 0;
            $barcode_array['bcode'][] = $arrAdd;
        }

        return $barcode_array;
    }

    //----------------------------------------------------------------------
    public static function clearCache()
    {
        self::$frames = array();
    }

    //----------------------------------------------------------------------
    public static function buildCache()
    {
        QRtools::markTime('before_build_cache');

        $mask = new QRmask();
        for ($a = 1; $a <= QRSPEC_VERSION_MAX; $a++) {
            $frame = QRspec::newFrame($a);
            if (QR_IMAGE) {
                $fileName = QR_CACHE_DIR . 'frame_' . $a . '.png';
                QRimage::png(self::binarize($frame), $fileName, 1, 0);
            }

            $width = count($frame);
            $bitMask = array_fill(0, $width, array_fill(0, $width, 0));
            for ($maskNo = 0; $maskNo < 8; $maskNo++)
                $mask->makeMaskNo($maskNo, $width, $frame, $bitMask, true);
        }

        QRtools::markTime('after_build_cache');
    }

    //----------------------------------------------------------------------
    public static function log($outfile, $err)
    {
        if (QR_LOG_DIR !== false) {
            if ($err != '') {
                if ($outfile !== false) {
                    file_put_contents(QR_LOG_DIR . basename($outfile) . '-errors.txt', date('Y-m-d H:i:s') . ': ' . $err, FILE_APPEND);
                } else {
                    file_put_contents(QR_LOG_DIR . 'errors.txt', date('Y-m-d H:i:s') . ': ' . $err, FILE_APPEND);
                }
            }
        }
    }

    //----------------------------------------------------------------------
    public static function dumpMask($frame)
    {
        $width = count($frame);
        for ($y = 0; $y < $width; $y++) {
            for ($x = 0; $x < $width; $x++) {
                echo ord($frame[$y][$x]) . ',';
            }
        }
    }

    //----------------------------------------------------------------------
    public static function markTime($markerId)
    {
        list($usec, $sec) = explode(" ", microtime());
        $time = ((float)$usec + (float)$sec);

        if (!isset($GLOBALS['qr_time_bench']))
            $GLOBALS['qr_time_bench'] = array();

        $GLOBALS['qr_time_bench'][$markerId] = $time;
    }

    //----------------------------------------------------------------------
    public static function timeBenchmark()
    {
        self::markTime('finish');

        $lastTime = 0;
        $startTime = 0;
        $p = 0;

        echo '<table cellpadding="3" cellspacing="1">
                    <thead><tr style="border-bottom:1px solid silver"><td colspan="2" style="text-align:center">BENCHMARK</td></tr></thead>
                    <tbody>';

        foreach ($GLOBALS['qr_time_bench'] as $markerId => $thisTime) {
            if ($p > 0) {
                echo '<tr><th style="text-align:right">till ' . $markerId . ': </th><td>' . number_format($thisTime - $lastTime, 6) . 's</td></tr>';
            } else {
                $startTime = $thisTime;
            }

            $p++;
            $lastTime = $thisTime;
        }

        echo '</tbody><tfoot>
                <tr style="border-top:2px solid black"><th style="text-align:right">TOTAL: </th><td>' . number_format($lastTime - $startTime, 6) . 's</td></tr>
            </tfoot>
            </table>';
    }
}

//##########################################################################

QRtools::markTime('start');




//---- qrspec.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * QR Code specifications
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * The following data / specifications are taken from
 * "Two dimensional symbol -- QR-code -- Basic Specification" (JIS X0510:2004)
 *  or
 * "Automatic identification and data capture techniques -- 
 *  QR Code 2005 bar code symbology specification" (ISO/IEC 18004:2006)
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

define('QRSPEC_VERSION_MAX', 40);
define('QRSPEC_WIDTH_MAX',   177);

define('QRCAP_WIDTH',        0);
define('QRCAP_WORDS',        1);
define('QRCAP_REMINDER',     2);
define('QRCAP_EC',           3);

class QRspec
{

    public static $capacity = array(
        array(0,    0, 0, array(0,    0,    0,    0)),
        array(21,   26, 0, array(7,   10,   13,   17)), // 1
        array(25,   44, 7, array(10,   16,   22,   28)),
        array(29,   70, 7, array(15,   26,   36,   44)),
        array(33,  100, 7, array(20,   36,   52,   64)),
        array(37,  134, 7, array(26,   48,   72,   88)), // 5
        array(41,  172, 7, array(36,   64,   96,  112)),
        array(45,  196, 0, array(40,   72,  108,  130)),
        array(49,  242, 0, array(48,   88,  132,  156)),
        array(53,  292, 0, array(60,  110,  160,  192)),
        array(57,  346, 0, array(72,  130,  192,  224)), //10
        array(61,  404, 0, array(80,  150,  224,  264)),
        array(65,  466, 0, array(96,  176,  260,  308)),
        array(69,  532, 0, array(104,  198,  288,  352)),
        array(73,  581, 3, array(120,  216,  320,  384)),
        array(77,  655, 3, array(132,  240,  360,  432)), //15
        array(81,  733, 3, array(144,  280,  408,  480)),
        array(85,  815, 3, array(168,  308,  448,  532)),
        array(89,  901, 3, array(180,  338,  504,  588)),
        array(93,  991, 3, array(196,  364,  546,  650)),
        array(97, 1085, 3, array(224,  416,  600,  700)), //20
        array(101, 1156, 4, array(224,  442,  644,  750)),
        array(105, 1258, 4, array(252,  476,  690,  816)),
        array(109, 1364, 4, array(270,  504,  750,  900)),
        array(113, 1474, 4, array(300,  560,  810,  960)),
        array(117, 1588, 4, array(312,  588,  870, 1050)), //25
        array(121, 1706, 4, array(336,  644,  952, 1110)),
        array(125, 1828, 4, array(360,  700, 1020, 1200)),
        array(129, 1921, 3, array(390,  728, 1050, 1260)),
        array(133, 2051, 3, array(420,  784, 1140, 1350)),
        array(137, 2185, 3, array(450,  812, 1200, 1440)), //30
        array(141, 2323, 3, array(480,  868, 1290, 1530)),
        array(145, 2465, 3, array(510,  924, 1350, 1620)),
        array(149, 2611, 3, array(540,  980, 1440, 1710)),
        array(153, 2761, 3, array(570, 1036, 1530, 1800)),
        array(157, 2876, 0, array(570, 1064, 1590, 1890)), //35
        array(161, 3034, 0, array(600, 1120, 1680, 1980)),
        array(165, 3196, 0, array(630, 1204, 1770, 2100)),
        array(169, 3362, 0, array(660, 1260, 1860, 2220)),
        array(173, 3532, 0, array(720, 1316, 1950, 2310)),
        array(177, 3706, 0, array(750, 1372, 2040, 2430)) //40
    );

    //----------------------------------------------------------------------
    public static function getDataLength($version, $level)
    {
        return self::$capacity[$version][QRCAP_WORDS] - self::$capacity[$version][QRCAP_EC][$level];
    }

    //----------------------------------------------------------------------
    public static function getECCLength($version, $level)
    {
        return self::$capacity[$version][QRCAP_EC][$level];
    }

    //----------------------------------------------------------------------
    public static function getWidth($version)
    {
        return self::$capacity[$version][QRCAP_WIDTH];
    }

    //----------------------------------------------------------------------
    public static function getRemainder($version)
    {
        return self::$capacity[$version][QRCAP_REMINDER];
    }

    //----------------------------------------------------------------------
    public static function getMinimumVersion($size, $level)
    {

        for ($i = 1; $i <= QRSPEC_VERSION_MAX; $i++) {
            $words  = self::$capacity[$i][QRCAP_WORDS] - self::$capacity[$i][QRCAP_EC][$level];
            if ($words >= $size)
                return $i;
        }

        return -1;
    }

    //######################################################################

    public static $lengthTableBits = array(
        array(10, 12, 14),
        array(9, 11, 13),
        array(8, 16, 16),
        array(8, 10, 12)
    );

    //----------------------------------------------------------------------
    public static function lengthIndicator($mode, $version)
    {
        if ($mode == QR_MODE_STRUCTURE)
            return 0;

        if ($version <= 9) {
            $l = 0;
        } else if ($version <= 26) {
            $l = 1;
        } else {
            $l = 2;
        }

        return self::$lengthTableBits[$mode][$l];
    }

    //----------------------------------------------------------------------
    public static function maximumWords($mode, $version)
    {
        if ($mode == QR_MODE_STRUCTURE)
            return 3;

        if ($version <= 9) {
            $l = 0;
        } else if ($version <= 26) {
            $l = 1;
        } else {
            $l = 2;
        }

        $bits = self::$lengthTableBits[$mode][$l];
        $words = (1 << $bits) - 1;

        if ($mode == QR_MODE_KANJI) {
            $words *= 2; // the number of bytes is required
        }

        return $words;
    }

    // Error correction code -----------------------------------------------
    // Table of the error correction code (Reed-Solomon block)
    // See Table 12-16 (pp.30-36), JIS X0510:2004.

    public static $eccTable = array(
        array(array(0,  0), array(0,  0), array(0,  0), array(0,  0)),
        array(array(1,  0), array(1,  0), array(1,  0), array(1,  0)), // 1
        array(array(1,  0), array(1,  0), array(1,  0), array(1,  0)),
        array(array(1,  0), array(1,  0), array(2,  0), array(2,  0)),
        array(array(1,  0), array(2,  0), array(2,  0), array(4,  0)),
        array(array(1,  0), array(2,  0), array(2,  2), array(2,  2)), // 5
        array(array(2,  0), array(4,  0), array(4,  0), array(4,  0)),
        array(array(2,  0), array(4,  0), array(2,  4), array(4,  1)),
        array(array(2,  0), array(2,  2), array(4,  2), array(4,  2)),
        array(array(2,  0), array(3,  2), array(4,  4), array(4,  4)),
        array(array(2,  2), array(4,  1), array(6,  2), array(6,  2)), //10
        array(array(4,  0), array(1,  4), array(4,  4), array(3,  8)),
        array(array(2,  2), array(6,  2), array(4,  6), array(7,  4)),
        array(array(4,  0), array(8,  1), array(8,  4), array(12,  4)),
        array(array(3,  1), array(4,  5), array(11,  5), array(11,  5)),
        array(array(5,  1), array(5,  5), array(5,  7), array(11,  7)), //15
        array(array(5,  1), array(7,  3), array(15,  2), array(3, 13)),
        array(array(1,  5), array(10,  1), array(1, 15), array(2, 17)),
        array(array(5,  1), array(9,  4), array(17,  1), array(2, 19)),
        array(array(3,  4), array(3, 11), array(17,  4), array(9, 16)),
        array(array(3,  5), array(3, 13), array(15,  5), array(15, 10)), //20
        array(array(4,  4), array(17,  0), array(17,  6), array(19,  6)),
        array(array(2,  7), array(17,  0), array(7, 16), array(34,  0)),
        array(array(4,  5), array(4, 14), array(11, 14), array(16, 14)),
        array(array(6,  4), array(6, 14), array(11, 16), array(30,  2)),
        array(array(8,  4), array(8, 13), array(7, 22), array(22, 13)), //25
        array(array(10,  2), array(19,  4), array(28,  6), array(33,  4)),
        array(array(8,  4), array(22,  3), array(8, 26), array(12, 28)),
        array(array(3, 10), array(3, 23), array(4, 31), array(11, 31)),
        array(array(7,  7), array(21,  7), array(1, 37), array(19, 26)),
        array(array(5, 10), array(19, 10), array(15, 25), array(23, 25)), //30
        array(array(13,  3), array(2, 29), array(42,  1), array(23, 28)),
        array(array(17,  0), array(10, 23), array(10, 35), array(19, 35)),
        array(array(17,  1), array(14, 21), array(29, 19), array(11, 46)),
        array(array(13,  6), array(14, 23), array(44,  7), array(59,  1)),
        array(array(12,  7), array(12, 26), array(39, 14), array(22, 41)), //35
        array(array(6, 14), array(6, 34), array(46, 10), array(2, 64)),
        array(array(17,  4), array(29, 14), array(49, 10), array(24, 46)),
        array(array(4, 18), array(13, 32), array(48, 14), array(42, 32)),
        array(array(20,  4), array(40,  7), array(43, 22), array(10, 67)),
        array(array(19,  6), array(18, 31), array(34, 34), array(20, 61)), //40
    );

    //----------------------------------------------------------------------
    // CACHEABLE!!!

    public static function getEccSpec($version, $level, array &$spec)
    {
        if (count($spec) < 5) {
            $spec = array(0, 0, 0, 0, 0);
        }

        $b1   = self::$eccTable[$version][$level][0];
        $b2   = self::$eccTable[$version][$level][1];
        $data = self::getDataLength($version, $level);
        $ecc  = self::getECCLength($version, $level);

        if ($b2 == 0) {
            $spec[0] = $b1;
            $spec[1] = (int)($data / $b1);
            $spec[2] = (int)($ecc / $b1);
            $spec[3] = 0;
            $spec[4] = 0;
        } else {
            $spec[0] = $b1;
            $spec[1] = (int)($data / ($b1 + $b2));
            $spec[2] = (int)($ecc  / ($b1 + $b2));
            $spec[3] = $b2;
            $spec[4] = $spec[1] + 1;
        }
    }

    // Alignment pattern ---------------------------------------------------

    // Positions of alignment patterns.
    // This array includes only the second and the third position of the 
    // alignment patterns. Rest of them can be calculated from the distance 
    // between them.

    // See Table 1 in Appendix E (pp.71) of JIS X0510:2004.

    public static $alignmentPattern = array(
        array(0,  0),
        array(0,  0),
        array(18,  0),
        array(22,  0),
        array(26,  0),
        array(30,  0), // 1- 5
        array(34,  0),
        array(22, 38),
        array(24, 42),
        array(26, 46),
        array(28, 50), // 6-10
        array(30, 54),
        array(32, 58),
        array(34, 62),
        array(26, 46),
        array(26, 48), //11-15
        array(26, 50),
        array(30, 54),
        array(30, 56),
        array(30, 58),
        array(34, 62), //16-20
        array(28, 50),
        array(26, 50),
        array(30, 54),
        array(28, 54),
        array(32, 58), //21-25
        array(30, 58),
        array(34, 62),
        array(26, 50),
        array(30, 54),
        array(26, 52), //26-30
        array(30, 56),
        array(34, 60),
        array(30, 58),
        array(34, 62),
        array(30, 54), //31-35
        array(24, 50),
        array(28, 54),
        array(32, 58),
        array(26, 54),
        array(30, 58), //35-40
    );


    /** --------------------------------------------------------------------
     * Put an alignment marker.
     * @param frame
     * @param width
     * @param ox,oy center coordinate of the pattern
     */
    public static function putAlignmentMarker(array &$frame, $ox, $oy)
    {
        $finder = array(
            "\xa1\xa1\xa1\xa1\xa1",
            "\xa1\xa0\xa0\xa0\xa1",
            "\xa1\xa0\xa1\xa0\xa1",
            "\xa1\xa0\xa0\xa0\xa1",
            "\xa1\xa1\xa1\xa1\xa1"
        );

        $yStart = $oy - 2;
        $xStart = $ox - 2;

        for ($y = 0; $y < 5; $y++) {
            QRstr::set($frame, $xStart, $yStart + $y, $finder[$y]);
        }
    }

    //----------------------------------------------------------------------
    public static function putAlignmentPattern($version, &$frame, $width)
    {
        if ($version < 2)
            return;

        $d = self::$alignmentPattern[$version][1] - self::$alignmentPattern[$version][0];
        if ($d < 0) {
            $w = 2;
        } else {
            $w = (int)(($width - self::$alignmentPattern[$version][0]) / $d + 2);
        }

        if ($w * $w - 3 == 1) {
            $x = self::$alignmentPattern[$version][0];
            $y = self::$alignmentPattern[$version][0];
            self::putAlignmentMarker($frame, $x, $y);
            return;
        }

        $cx = self::$alignmentPattern[$version][0];
        for ($x = 1; $x < $w - 1; $x++) {
            self::putAlignmentMarker($frame, 6, $cx);
            self::putAlignmentMarker($frame, $cx,  6);
            $cx += $d;
        }

        $cy = self::$alignmentPattern[$version][0];
        for ($y = 0; $y < $w - 1; $y++) {
            $cx = self::$alignmentPattern[$version][0];
            for ($x = 0; $x < $w - 1; $x++) {
                self::putAlignmentMarker($frame, $cx, $cy);
                $cx += $d;
            }
            $cy += $d;
        }
    }

    // Version information pattern -----------------------------------------

    // Version information pattern (BCH coded).
    // See Table 1 in Appendix D (pp.68) of JIS X0510:2004.

    // size: [QRSPEC_VERSION_MAX - 6]

    public static $versionPattern = array(
        0x07c94,
        0x085bc,
        0x09a99,
        0x0a4d3,
        0x0bbf6,
        0x0c762,
        0x0d847,
        0x0e60d,
        0x0f928,
        0x10b78,
        0x1145d,
        0x12a17,
        0x13532,
        0x149a6,
        0x15683,
        0x168c9,
        0x177ec,
        0x18ec4,
        0x191e1,
        0x1afab,
        0x1b08e,
        0x1cc1a,
        0x1d33f,
        0x1ed75,
        0x1f250,
        0x209d5,
        0x216f0,
        0x228ba,
        0x2379f,
        0x24b0b,
        0x2542e,
        0x26a64,
        0x27541,
        0x28c69
    );

    //----------------------------------------------------------------------
    public static function getVersionPattern($version)
    {
        if ($version < 7 || $version > QRSPEC_VERSION_MAX)
            return 0;

        return self::$versionPattern[$version - 7];
    }

    // Format information --------------------------------------------------
    // See calcFormatInfo in tests/test_qrspec.c (orginal qrencode c lib)

    public static $formatInfo = array(
        array(0x77c4, 0x72f3, 0x7daa, 0x789d, 0x662f, 0x6318, 0x6c41, 0x6976),
        array(0x5412, 0x5125, 0x5e7c, 0x5b4b, 0x45f9, 0x40ce, 0x4f97, 0x4aa0),
        array(0x355f, 0x3068, 0x3f31, 0x3a06, 0x24b4, 0x2183, 0x2eda, 0x2bed),
        array(0x1689, 0x13be, 0x1ce7, 0x19d0, 0x0762, 0x0255, 0x0d0c, 0x083b)
    );

    public static function getFormatInfo($mask, $level)
    {
        if ($mask < 0 || $mask > 7)
            return 0;

        if ($level < 0 || $level > 3)
            return 0;

        return self::$formatInfo[$level][$mask];
    }

    // Frame ---------------------------------------------------------------
    // Cache of initial frames.

    public static $frames = array();

    /** --------------------------------------------------------------------
     * Put a finder pattern.
     * @param frame
     * @param width
     * @param ox,oy upper-left coordinate of the pattern
     */
    public static function putFinderPattern(&$frame, $ox, $oy)
    {
        $finder = array(
            "\xc1\xc1\xc1\xc1\xc1\xc1\xc1",
            "\xc1\xc0\xc0\xc0\xc0\xc0\xc1",
            "\xc1\xc0\xc1\xc1\xc1\xc0\xc1",
            "\xc1\xc0\xc1\xc1\xc1\xc0\xc1",
            "\xc1\xc0\xc1\xc1\xc1\xc0\xc1",
            "\xc1\xc0\xc0\xc0\xc0\xc0\xc1",
            "\xc1\xc1\xc1\xc1\xc1\xc1\xc1"
        );

        for ($y = 0; $y < 7; $y++) {
            QRstr::set($frame, $ox, $oy + $y, $finder[$y]);
        }
    }

    //----------------------------------------------------------------------
    public static function createFrame($version)
    {
        $width = self::$capacity[$version][QRCAP_WIDTH];
        $frameLine = str_repeat("\0", $width);
        $frame = array_fill(0, $width, $frameLine);

        // Finder pattern
        self::putFinderPattern($frame, 0, 0);
        self::putFinderPattern($frame, $width - 7, 0);
        self::putFinderPattern($frame, 0, $width - 7);

        // Separator
        $yOffset = $width - 7;

        for ($y = 0; $y < 7; $y++) {
            $frame[$y][7] = "\xc0";
            $frame[$y][$width - 8] = "\xc0";
            $frame[$yOffset][7] = "\xc0";
            $yOffset++;
        }

        $setPattern = str_repeat("\xc0", 8);

        QRstr::set($frame, 0, 7, $setPattern);
        QRstr::set($frame, $width - 8, 7, $setPattern);
        QRstr::set($frame, 0, $width - 8, $setPattern);

        // Format info
        $setPattern = str_repeat("\x84", 9);
        QRstr::set($frame, 0, 8, $setPattern);
        QRstr::set($frame, $width - 8, 8, $setPattern, 8);

        $yOffset = $width - 8;

        for ($y = 0; $y < 8; $y++, $yOffset++) {
            $frame[$y][8] = "\x84";
            $frame[$yOffset][8] = "\x84";
        }

        // Timing pattern  

        for ($i = 1; $i < $width - 15; $i++) {
            $frame[6][7 + $i] = chr(0x90 | ($i & 1));
            $frame[7 + $i][6] = chr(0x90 | ($i & 1));
        }

        // Alignment pattern  
        self::putAlignmentPattern($version, $frame, $width);

        // Version information 
        if ($version >= 7) {
            $vinf = self::getVersionPattern($version);

            $v = $vinf;

            for ($x = 0; $x < 6; $x++) {
                for ($y = 0; $y < 3; $y++) {
                    $frame[($width - 11) + $y][$x] = chr(0x88 | ($v & 1));
                    $v = $v >> 1;
                }
            }

            $v = $vinf;
            for ($y = 0; $y < 6; $y++) {
                for ($x = 0; $x < 3; $x++) {
                    $frame[$y][$x + ($width - 11)] = chr(0x88 | ($v & 1));
                    $v = $v >> 1;
                }
            }
        }

        // and a little bit...  
        $frame[$width - 8][8] = "\x81";

        return $frame;
    }

    //----------------------------------------------------------------------
    public static function debug($frame, $binary_mode = false)
    {
        if ($binary_mode) {

            foreach ($frame as &$frameLine) {
                $frameLine = join('<span class="m">&nbsp;&nbsp;</span>', explode('0', $frameLine));
                $frameLine = join('&#9608;&#9608;', explode('1', $frameLine));
            }

?>
            <style>
                .m {
                    background-color: white;
                }
            </style>
        <?php
            echo '<pre><tt><br/ ><br/ ><br/ >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
            echo join("<br/ >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", $frame);
            echo '</tt></pre><br/ ><br/ ><br/ ><br/ ><br/ ><br/ >';
        } else {

            foreach ($frame as &$frameLine) {
                $frameLine = join('<span class="m">&nbsp;</span>',  explode("\xc0", $frameLine));
                $frameLine = join('<span class="m">&#9618;</span>', explode("\xc1", $frameLine));
                $frameLine = join('<span class="p">&nbsp;</span>',  explode("\xa0", $frameLine));
                $frameLine = join('<span class="p">&#9618;</span>', explode("\xa1", $frameLine));
                $frameLine = join('<span class="s">&#9671;</span>', explode("\x84", $frameLine)); //format 0
                $frameLine = join('<span class="s">&#9670;</span>', explode("\x85", $frameLine)); //format 1
                $frameLine = join('<span class="x">&#9762;</span>', explode("\x81", $frameLine)); //special bit
                $frameLine = join('<span class="c">&nbsp;</span>',  explode("\x90", $frameLine)); //clock 0
                $frameLine = join('<span class="c">&#9719;</span>', explode("\x91", $frameLine)); //clock 1
                $frameLine = join('<span class="f">&nbsp;</span>',  explode("\x88", $frameLine)); //version
                $frameLine = join('<span class="f">&#9618;</span>', explode("\x89", $frameLine)); //version
                $frameLine = join('&#9830;', explode("\x01", $frameLine));
                $frameLine = join('&#8901;', explode("\0", $frameLine));
            }

        ?>
            <style>
                .p {
                    background-color: yellow;
                }

                .m {
                    background-color: #00FF00;
                }

                .s {
                    background-color: #FF0000;
                }

                .c {
                    background-color: aqua;
                }

                .x {
                    background-color: pink;
                }

                .f {
                    background-color: gold;
                }
            </style>
<?php
            echo "<pre><tt>";
            echo join("<br/ >", $frame);
            echo "</tt></pre>";
        }
    }

    //----------------------------------------------------------------------
    public static function serial($frame)
    {
        return gzcompress(join("\n", $frame), 9);
    }

    //----------------------------------------------------------------------
    public static function unserial($code)
    {
        return explode("\n", gzuncompress($code));
    }

    //----------------------------------------------------------------------
    public static function newFrame($version)
    {
        if ($version < 1 || $version > QRSPEC_VERSION_MAX)
            return null;

        if (!isset(self::$frames[$version])) {

            $fileName = QR_CACHE_DIR . 'frame_' . $version . '.dat';

            if (QR_CACHEABLE) {
                if (file_exists($fileName)) {
                    self::$frames[$version] = self::unserial(file_get_contents($fileName));
                } else {
                    self::$frames[$version] = self::createFrame($version);
                    file_put_contents($fileName, self::serial(self::$frames[$version]));
                }
            } else {
                self::$frames[$version] = self::createFrame($version);
            }
        }

        if (is_null(self::$frames[$version]))
            return null;

        return self::$frames[$version];
    }

    //----------------------------------------------------------------------
    public static function rsBlockNum($spec)
    {
        return $spec[0] + $spec[3];
    }
    public static function rsBlockNum1($spec)
    {
        return $spec[0];
    }
    public static function rsDataCodes1($spec)
    {
        return $spec[1];
    }
    public static function rsEccCodes1($spec)
    {
        return $spec[2];
    }
    public static function rsBlockNum2($spec)
    {
        return $spec[3];
    }
    public static function rsDataCodes2($spec)
    {
        return $spec[4];
    }
    public static function rsEccCodes2($spec)
    {
        return $spec[2];
    }
    public static function rsDataLength($spec)
    {
        return ($spec[0] * $spec[1]) + ($spec[3] * $spec[4]);
    }
    public static function rsEccLength($spec)
    {
        return ($spec[0] + $spec[3]) * $spec[2];
    }
}



//---- qrimage.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Image output of code using GD2
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

define('QR_IMAGE', true);

class QRimage
{

    //----------------------------------------------------------------------
    public static function png($frame, $filename = false, $pixelPerPoint = 4, $outerFrame = 4, $saveandprint = FALSE)
    {
        $image = self::image($frame, $pixelPerPoint, $outerFrame);

        if ($filename === false) {
            Header("Content-type: image/png");
            ImagePng($image);
        } else {
            if ($saveandprint === TRUE) {
                ImagePng($image, $filename);
                header("Content-type: image/png");
                ImagePng($image);
            } else {
                ImagePng($image, $filename);
            }
        }

        ImageDestroy($image);
    }

    //----------------------------------------------------------------------
    public static function jpg($frame, $filename = false, $pixelPerPoint = 8, $outerFrame = 4, $q = 85)
    {
        $image = self::image($frame, $pixelPerPoint, $outerFrame);

        if ($filename === false) {
            Header("Content-type: image/jpeg");
            ImageJpeg($image, null, $q);
        } else {
            ImageJpeg($image, $filename, $q);
        }

        ImageDestroy($image);
    }

    //----------------------------------------------------------------------
    private static function image($frame, $pixelPerPoint = 4, $outerFrame = 4)
    {
        $h = count($frame);
        $w = strlen($frame[0]);

        $imgW = $w + 2 * $outerFrame;
        $imgH = $h + 2 * $outerFrame;

        $base_image = ImageCreate($imgW, $imgH);

        $col[0] = ImageColorAllocate($base_image, 255, 255, 255);
        $col[1] = ImageColorAllocate($base_image, 0, 0, 0);

        imagefill($base_image, 0, 0, $col[0]);

        for ($y = 0; $y < $h; $y++) {
            for ($x = 0; $x < $w; $x++) {
                if ($frame[$y][$x] == '1') {
                    ImageSetPixel($base_image, $x + $outerFrame, $y + $outerFrame, $col[1]);
                }
            }
        }

        $target_image = ImageCreate($imgW * $pixelPerPoint, $imgH * $pixelPerPoint);
        ImageCopyResized($target_image, $base_image, 0, 0, 0, 0, $imgW * $pixelPerPoint, $imgH * $pixelPerPoint, $imgW, $imgH);
        ImageDestroy($base_image);

        return $target_image;
    }
}



//---- qrinput.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Input encoding class
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

define('STRUCTURE_HEADER_BITS',  20);
define('MAX_STRUCTURED_SYMBOLS', 16);

class QRinputItem
{

    public $mode;
    public $size;
    public $data;
    public $bstream;

    public function __construct($mode, $size, $data, $bstream = null)
    {
        $setData = array_slice($data, 0, $size);

        if (count($setData) < $size) {
            $setData = array_merge($setData, array_fill(0, $size - count($setData), 0));
        }

        if (!QRinput::check($mode, $size, $setData)) {
            throw new Exception('Error m:' . $mode . ',s:' . $size . ',d:' . join(',', $setData));
            return null;
        }

        $this->mode = $mode;
        $this->size = $size;
        $this->data = $setData;
        $this->bstream = $bstream;
    }

    //----------------------------------------------------------------------
    public function encodeModeNum($version)
    {
        try {

            $words = (int)($this->size / 3);
            $bs = new QRbitstream();

            $val = 0x1;
            $bs->appendNum(4, $val);
            $bs->appendNum(QRspec::lengthIndicator(QR_MODE_NUM, $version), $this->size);

            for ($i = 0; $i < $words; $i++) {
                $val  = (ord($this->data[$i * 3]) - ord('0')) * 100;
                $val += (ord($this->data[$i * 3 + 1]) - ord('0')) * 10;
                $val += (ord($this->data[$i * 3 + 2]) - ord('0'));
                $bs->appendNum(10, $val);
            }

            if ($this->size - $words * 3 == 1) {
                $val = ord($this->data[$words * 3]) - ord('0');
                $bs->appendNum(4, $val);
            } else if ($this->size - $words * 3 == 2) {
                $val  = (ord($this->data[$words * 3]) - ord('0')) * 10;
                $val += (ord($this->data[$words * 3 + 1]) - ord('0'));
                $bs->appendNum(7, $val);
            }

            $this->bstream = $bs;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function encodeModeAn($version)
    {
        try {
            $words = (int)($this->size / 2);
            $bs = new QRbitstream();

            $bs->appendNum(4, 0x02);
            $bs->appendNum(QRspec::lengthIndicator(QR_MODE_AN, $version), $this->size);

            for ($i = 0; $i < $words; $i++) {
                $val  = (int)QRinput::lookAnTable(ord($this->data[$i * 2])) * 45;
                $val += (int)QRinput::lookAnTable(ord($this->data[$i * 2 + 1]));

                $bs->appendNum(11, $val);
            }

            if ($this->size & 1) {
                $val = QRinput::lookAnTable(ord($this->data[$words * 2]));
                $bs->appendNum(6, $val);
            }

            $this->bstream = $bs;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function encodeMode8($version)
    {
        try {
            $bs = new QRbitstream();

            $bs->appendNum(4, 0x4);
            $bs->appendNum(QRspec::lengthIndicator(QR_MODE_8, $version), $this->size);

            for ($i = 0; $i < $this->size; $i++) {
                $bs->appendNum(8, ord($this->data[$i]));
            }

            $this->bstream = $bs;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function encodeModeKanji($version)
    {
        try {

            $bs = new QRbitrtream();

            $bs->appendNum(4, 0x8);
            $bs->appendNum(QRspec::lengthIndicator(QR_MODE_KANJI, $version), (int)($this->size / 2));

            for ($i = 0; $i < $this->size; $i += 2) {
                $val = (ord($this->data[$i]) << 8) | ord($this->data[$i + 1]);
                if ($val <= 0x9ffc) {
                    $val -= 0x8140;
                } else {
                    $val -= 0xc140;
                }

                $h = ($val >> 8) * 0xc0;
                $val = ($val & 0xff) + $h;

                $bs->appendNum(13, $val);
            }

            $this->bstream = $bs;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function encodeModeStructure()
    {
        try {
            $bs =  new QRbitstream();

            $bs->appendNum(4, 0x03);
            $bs->appendNum(4, ord($this->data[1]) - 1);
            $bs->appendNum(4, ord($this->data[0]) - 1);
            $bs->appendNum(8, ord($this->data[2]));

            $this->bstream = $bs;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function estimateBitStreamSizeOfEntry($version)
    {
        $bits = 0;

        if ($version == 0)
            $version = 1;

        switch ($this->mode) {
            case QR_MODE_NUM:
                $bits = QRinput::estimateBitsModeNum($this->size);
                break;
            case QR_MODE_AN:
                $bits = QRinput::estimateBitsModeAn($this->size);
                break;
            case QR_MODE_8:
                $bits = QRinput::estimateBitsMode8($this->size);
                break;
            case QR_MODE_KANJI:
                $bits = QRinput::estimateBitsModeKanji($this->size);
                break;
            case QR_MODE_STRUCTURE:
                return STRUCTURE_HEADER_BITS;
            default:
                return 0;
        }

        $l = QRspec::lengthIndicator($this->mode, $version);
        $m = 1 << $l;
        $num = (int)(($this->size + $m - 1) / $m);

        $bits += $num * (4 + $l);

        return $bits;
    }

    //----------------------------------------------------------------------
    public function encodeBitStream($version)
    {
        try {

            unset($this->bstream);
            $words = QRspec::maximumWords($this->mode, $version);

            if ($this->size > $words) {

                $st1 = new QRinputItem($this->mode, $words, $this->data);
                $st2 = new QRinputItem($this->mode, $this->size - $words, array_slice($this->data, $words));

                $st1->encodeBitStream($version);
                $st2->encodeBitStream($version);

                $this->bstream = new QRbitstream();
                $this->bstream->append($st1->bstream);
                $this->bstream->append($st2->bstream);

                unset($st1);
                unset($st2);
            } else {

                $ret = 0;

                switch ($this->mode) {
                    case QR_MODE_NUM:
                        $ret = $this->encodeModeNum($version);
                        break;
                    case QR_MODE_AN:
                        $ret = $this->encodeModeAn($version);
                        break;
                    case QR_MODE_8:
                        $ret = $this->encodeMode8($version);
                        break;
                    case QR_MODE_KANJI:
                        $ret = $this->encodeModeKanji($version);
                        break;
                    case QR_MODE_STRUCTURE:
                        $ret = $this->encodeModeStructure();
                        break;

                    default:
                        break;
                }

                if ($ret < 0)
                    return -1;
            }

            return $this->bstream->size();
        } catch (Exception $e) {
            return -1;
        }
    }
};

//##########################################################################

class QRinput
{

    public $items;

    private $version;
    private $level;

    //----------------------------------------------------------------------
    public function __construct($version = 0, $level = QR_ECLEVEL_L)
    {
        if ($version < 0 || $version > QRSPEC_VERSION_MAX || $level > QR_ECLEVEL_H) {
            throw new Exception('Invalid version no');
            return NULL;
        }

        $this->version = $version;
        $this->level = $level;
    }

    //----------------------------------------------------------------------
    public function getVersion()
    {
        return $this->version;
    }

    //----------------------------------------------------------------------
    public function setVersion($version)
    {
        if ($version < 0 || $version > QRSPEC_VERSION_MAX) {
            throw new Exception('Invalid version no');
            return -1;
        }

        $this->version = $version;

        return 0;
    }

    //----------------------------------------------------------------------
    public function getErrorCorrectionLevel()
    {
        return $this->level;
    }

    //----------------------------------------------------------------------
    public function setErrorCorrectionLevel($level)
    {
        if ($level > QR_ECLEVEL_H) {
            throw new Exception('Invalid ECLEVEL');
            return -1;
        }

        $this->level = $level;

        return 0;
    }

    //----------------------------------------------------------------------
    public function appendEntry(QRinputItem $entry)
    {
        $this->items[] = $entry;
    }

    //----------------------------------------------------------------------
    public function append($mode, $size, $data)
    {
        try {
            $entry = new QRinputItem($mode, $size, $data);
            $this->items[] = $entry;
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------

    public function insertStructuredAppendHeader($size, $index, $parity)
    {
        if ($size > MAX_STRUCTURED_SYMBOLS) {
            throw new Exception('insertStructuredAppendHeader wrong size');
        }

        if ($index <= 0 || $index > MAX_STRUCTURED_SYMBOLS) {
            throw new Exception('insertStructuredAppendHeader wrong index');
        }

        $buf = array($size, $index, $parity);

        try {
            $entry = new QRinputItem(QR_MODE_STRUCTURE, 3, buf);
            array_unshift($this->items, $entry);
            return 0;
        } catch (Exception $e) {
            return -1;
        }
    }

    //----------------------------------------------------------------------
    public function calcParity()
    {
        $parity = 0;

        foreach ($this->items as $item) {
            if ($item->mode != QR_MODE_STRUCTURE) {
                for ($i = $item->size - 1; $i >= 0; $i--) {
                    $parity ^= $item->data[$i];
                }
            }
        }

        return $parity;
    }

    //----------------------------------------------------------------------
    public static function checkModeNum($size, $data)
    {
        for ($i = 0; $i < $size; $i++) {
            if ((ord($data[$i]) < ord('0')) || (ord($data[$i]) > ord('9'))) {
                return false;
            }
        }

        return true;
    }

    //----------------------------------------------------------------------
    public static function estimateBitsModeNum($size)
    {
        $w = (int)$size / 3;
        $bits = $w * 10;

        switch ($size - $w * 3) {
            case 1:
                $bits += 4;
                break;
            case 2:
                $bits += 7;
                break;
            default:
                break;
        }

        return $bits;
    }

    //----------------------------------------------------------------------
    public static $anTable = array(
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        36,
        -1,
        -1,
        -1,
        37,
        38,
        -1,
        -1,
        -1,
        -1,
        39,
        40,
        -1,
        41,
        42,
        43,
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        44,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1
    );

    //----------------------------------------------------------------------
    public static function lookAnTable($c)
    {
        return (($c > 127) ? -1 : self::$anTable[$c]);
    }

    //----------------------------------------------------------------------
    public static function checkModeAn($size, $data)
    {
        for ($i = 0; $i < $size; $i++) {
            if (self::lookAnTable(ord($data[$i])) == -1) {
                return false;
            }
        }

        return true;
    }

    //----------------------------------------------------------------------
    public static function estimateBitsModeAn($size)
    {
        $w = (int)($size / 2);
        $bits = $w * 11;

        if ($size & 1) {
            $bits += 6;
        }

        return $bits;
    }

    //----------------------------------------------------------------------
    public static function estimateBitsMode8($size)
    {
        return $size * 8;
    }

    //----------------------------------------------------------------------
    public function estimateBitsModeKanji($size)
    {
        return (int)(($size / 2) * 13);
    }

    //----------------------------------------------------------------------
    public static function checkModeKanji($size, $data)
    {
        if ($size & 1)
            return false;

        for ($i = 0; $i < $size; $i += 2) {
            $val = (ord($data[$i]) << 8) | ord($data[$i + 1]);
            if (
                $val < 0x8140
                || ($val > 0x9ffc && $val < 0xe040)
                || $val > 0xebbf
            ) {
                return false;
            }
        }

        return true;
    }

    /***********************************************************************
     * Validation
     **********************************************************************/

    public static function check($mode, $size, $data)
    {
        if ($size <= 0)
            return false;

        switch ($mode) {
            case QR_MODE_NUM:
                return self::checkModeNum($size, $data);
                break;
            case QR_MODE_AN:
                return self::checkModeAn($size, $data);
                break;
            case QR_MODE_KANJI:
                return self::checkModeKanji($size, $data);
                break;
            case QR_MODE_8:
                return true;
                break;
            case QR_MODE_STRUCTURE:
                return true;
                break;

            default:
                break;
        }

        return false;
    }


    //----------------------------------------------------------------------
    public function estimateBitStreamSize($version)
    {
        $bits = 0;

        foreach ($this->items as $item) {
            $bits += $item->estimateBitStreamSizeOfEntry($version);
        }

        return $bits;
    }

    //----------------------------------------------------------------------
    public function estimateVersion()
    {
        $version = 0;
        $prev = 0;
        do {
            $prev = $version;
            $bits = $this->estimateBitStreamSize($prev);
            $version = QRspec::getMinimumVersion((int)(($bits + 7) / 8), $this->level);
            if ($version < 0) {
                return -1;
            }
        } while ($version > $prev);

        return $version;
    }

    //----------------------------------------------------------------------
    public static function lengthOfCode($mode, $version, $bits)
    {
        $payload = $bits - 4 - QRspec::lengthIndicator($mode, $version);
        switch ($mode) {
            case QR_MODE_NUM:
                $chunks = (int)($payload / 10);
                $remain = $payload - $chunks * 10;
                $size = $chunks * 3;
                if ($remain >= 7) {
                    $size += 2;
                } else if ($remain >= 4) {
                    $size += 1;
                }
                break;
            case QR_MODE_AN:
                $chunks = (int)($payload / 11);
                $remain = $payload - $chunks * 11;
                $size = $chunks * 2;
                if ($remain >= 6)
                    $size++;
                break;
            case QR_MODE_8:
                $size = (int)($payload / 8);
                break;
            case QR_MODE_KANJI:
                $size = (int)(($payload / 13) * 2);
                break;
            case QR_MODE_STRUCTURE:
                $size = (int)($payload / 8);
                break;
            default:
                $size = 0;
                break;
        }

        $maxsize = QRspec::maximumWords($mode, $version);
        if ($size < 0) $size = 0;
        if ($size > $maxsize) $size = $maxsize;

        return $size;
    }

    //----------------------------------------------------------------------
    public function createBitStream()
    {
        $total = 0;

        foreach ($this->items as $item) {
            $bits = $item->encodeBitStream($this->version);

            if ($bits < 0)
                return -1;

            $total += $bits;
        }

        return $total;
    }

    //----------------------------------------------------------------------
    public function convertData()
    {
        $ver = $this->estimateVersion();
        if ($ver > $this->getVersion()) {
            $this->setVersion($ver);
        }

        for (;;) {
            $bits = $this->createBitStream();

            if ($bits < 0)
                return -1;

            $ver = QRspec::getMinimumVersion((int)(($bits + 7) / 8), $this->level);
            if ($ver < 0) {
                throw new Exception('WRONG VERSION');
                return -1;
            } else if ($ver > $this->getVersion()) {
                $this->setVersion($ver);
            } else {
                break;
            }
        }

        return 0;
    }

    //----------------------------------------------------------------------
    public function appendPaddingBit(&$bstream)
    {
        $bits = $bstream->size();
        $maxwords = QRspec::getDataLength($this->version, $this->level);
        $maxbits = $maxwords * 8;

        if ($maxbits == $bits) {
            return 0;
        }

        if ($maxbits - $bits < 5) {
            return $bstream->appendNum($maxbits - $bits, 0);
        }

        $bits += 4;
        $words = (int)(($bits + 7) / 8);

        $padding = new QRbitstream();
        $ret = $padding->appendNum($words * 8 - $bits + 4, 0);

        if ($ret < 0)
            return $ret;

        $padlen = $maxwords - $words;

        if ($padlen > 0) {

            $padbuf = array();
            for ($i = 0; $i < $padlen; $i++) {
                $padbuf[$i] = ($i & 1) ? 0x11 : 0xec;
            }

            $ret = $padding->appendBytes($padlen, $padbuf);

            if ($ret < 0)
                return $ret;
        }

        $ret = $bstream->append($padding);

        return $ret;
    }

    //----------------------------------------------------------------------
    public function mergeBitStream()
    {
        if ($this->convertData() < 0) {
            return null;
        }

        $bstream = new QRbitstream();

        foreach ($this->items as $item) {
            $ret = $bstream->append($item->bstream);
            if ($ret < 0) {
                return null;
            }
        }

        return $bstream;
    }

    //----------------------------------------------------------------------
    public function getBitStream()
    {

        $bstream = $this->mergeBitStream();

        if ($bstream == null) {
            return null;
        }

        $ret = $this->appendPaddingBit($bstream);
        if ($ret < 0) {
            return null;
        }

        return $bstream;
    }

    //----------------------------------------------------------------------
    public function getByteStream()
    {
        $bstream = $this->getBitStream();
        if ($bstream == null) {
            return null;
        }

        return $bstream->toByte();
    }
}






//---- qrbitstream.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Bitstream class
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

class QRbitstream
{

    public $data = array();

    //----------------------------------------------------------------------
    public function size()
    {
        return count($this->data);
    }

    //----------------------------------------------------------------------
    public function allocate($setLength)
    {
        $this->data = array_fill(0, $setLength, 0);
        return 0;
    }

    //----------------------------------------------------------------------
    public static function newFromNum($bits, $num)
    {
        $bstream = new QRbitstream();
        $bstream->allocate($bits);

        $mask = 1 << ($bits - 1);
        for ($i = 0; $i < $bits; $i++) {
            if ($num & $mask) {
                $bstream->data[$i] = 1;
            } else {
                $bstream->data[$i] = 0;
            }
            $mask = $mask >> 1;
        }

        return $bstream;
    }

    //----------------------------------------------------------------------
    public static function newFromBytes($size, $data)
    {
        $bstream = new QRbitstream();
        $bstream->allocate($size * 8);
        $p = 0;

        for ($i = 0; $i < $size; $i++) {
            $mask = 0x80;
            for ($j = 0; $j < 8; $j++) {
                if ($data[$i] & $mask) {
                    $bstream->data[$p] = 1;
                } else {
                    $bstream->data[$p] = 0;
                }
                $p++;
                $mask = $mask >> 1;
            }
        }

        return $bstream;
    }

    //----------------------------------------------------------------------
    public function append(QRbitstream $arg)
    {
        if (is_null($arg)) {
            return -1;
        }

        if ($arg->size() == 0) {
            return 0;
        }

        if ($this->size() == 0) {
            $this->data = $arg->data;
            return 0;
        }

        $this->data = array_values(array_merge($this->data, $arg->data));

        return 0;
    }

    //----------------------------------------------------------------------
    public function appendNum($bits, $num)
    {
        if ($bits == 0)
            return 0;

        $b = QRbitstream::newFromNum($bits, $num);

        if (is_null($b))
            return -1;

        $ret = $this->append($b);
        unset($b);

        return $ret;
    }

    //----------------------------------------------------------------------
    public function appendBytes($size, $data)
    {
        if ($size == 0)
            return 0;

        $b = QRbitstream::newFromBytes($size, $data);

        if (is_null($b))
            return -1;

        $ret = $this->append($b);
        unset($b);

        return $ret;
    }

    //----------------------------------------------------------------------
    public function toByte()
    {

        $size = $this->size();

        if ($size == 0) {
            return array();
        }

        $data = array_fill(0, (int)(($size + 7) / 8), 0);
        $bytes = (int)($size / 8);

        $p = 0;

        for ($i = 0; $i < $bytes; $i++) {
            $v = 0;
            for ($j = 0; $j < 8; $j++) {
                $v = $v << 1;
                $v |= $this->data[$p];
                $p++;
            }
            $data[$i] = $v;
        }

        if ($size & 7) {
            $v = 0;
            for ($j = 0; $j < ($size & 7); $j++) {
                $v = $v << 1;
                $v |= $this->data[$p];
                $p++;
            }
            $data[$bytes] = $v;
        }

        return $data;
    }
}




//---- qrsplit.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Input splitting classes
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * The following data / specifications are taken from
 * "Two dimensional symbol -- QR-code -- Basic Specification" (JIS X0510:2004)
 *  or
 * "Automatic identification and data capture techniques -- 
 *  QR Code 2005 bar code symbology specification" (ISO/IEC 18004:2006)
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */
class QRsplit
{

    public $dataStr = '';
    public $input;
    public $modeHint;

    //----------------------------------------------------------------------
    public function __construct($dataStr, $input, $modeHint)
    {
        $this->dataStr  = $dataStr;
        $this->input    = $input;
        $this->modeHint = $modeHint;
    }

    //----------------------------------------------------------------------
    public static function isdigitat($str, $pos)
    {
        if ($pos >= strlen($str))
            return false;

        return ((ord($str[$pos]) >= ord('0')) && (ord($str[$pos]) <= ord('9')));
    }

    //----------------------------------------------------------------------
    public static function isalnumat($str, $pos)
    {
        if ($pos >= strlen($str))
            return false;

        return (QRinput::lookAnTable(ord($str[$pos])) >= 0);
    }

    //----------------------------------------------------------------------
    public function identifyMode($pos)
    {
        if ($pos >= strlen($this->dataStr))
            return QR_MODE_NUL;

        $c = $this->dataStr[$pos];

        if (self::isdigitat($this->dataStr, $pos)) {
            return QR_MODE_NUM;
        } else if (self::isalnumat($this->dataStr, $pos)) {
            return QR_MODE_AN;
        } else if ($this->modeHint == QR_MODE_KANJI) {

            if ($pos + 1 < strlen($this->dataStr)) {
                $d = $this->dataStr[$pos + 1];
                $word = (ord($c) << 8) | ord($d);
                if (($word >= 0x8140 && $word <= 0x9ffc) || ($word >= 0xe040 && $word <= 0xebbf)) {
                    return QR_MODE_KANJI;
                }
            }
        }

        return QR_MODE_8;
    }

    //----------------------------------------------------------------------
    public function eatNum()
    {
        $ln = QRspec::lengthIndicator(QR_MODE_NUM, $this->input->getVersion());

        $p = 0;
        while (self::isdigitat($this->dataStr, $p)) {
            $p++;
        }

        $run = $p;
        $mode = $this->identifyMode($p);

        if ($mode == QR_MODE_8) {
            $dif = QRinput::estimateBitsModeNum($run) + 4 + $ln
                + QRinput::estimateBitsMode8(1)         // + 4 + l8
                - QRinput::estimateBitsMode8($run + 1); // - 4 - l8
            if ($dif > 0) {
                return $this->eat8();
            }
        }
        if ($mode == QR_MODE_AN) {
            $dif = QRinput::estimateBitsModeNum($run) + 4 + $ln
                + QRinput::estimateBitsModeAn(1)        // + 4 + la
                - QRinput::estimateBitsModeAn($run + 1); // - 4 - la
            if ($dif > 0) {
                return $this->eatAn();
            }
        }

        $ret = $this->input->append(QR_MODE_NUM, $run, str_split($this->dataStr));
        if ($ret < 0)
            return -1;

        return $run;
    }

    //----------------------------------------------------------------------
    public function eatAn()
    {
        $la = QRspec::lengthIndicator(QR_MODE_AN,  $this->input->getVersion());
        $ln = QRspec::lengthIndicator(QR_MODE_NUM, $this->input->getVersion());

        $p = 0;

        while (self::isalnumat($this->dataStr, $p)) {
            if (self::isdigitat($this->dataStr, $p)) {
                $q = $p;
                while (self::isdigitat($this->dataStr, $q)) {
                    $q++;
                }

                $dif = QRinput::estimateBitsModeAn($p) // + 4 + la
                    + QRinput::estimateBitsModeNum($q - $p) + 4 + $ln
                    - QRinput::estimateBitsModeAn($q); // - 4 - la

                if ($dif < 0) {
                    break;
                } else {
                    $p = $q;
                }
            } else {
                $p++;
            }
        }

        $run = $p;

        if (!self::isalnumat($this->dataStr, $p)) {
            $dif = QRinput::estimateBitsModeAn($run) + 4 + $la
                + QRinput::estimateBitsMode8(1) // + 4 + l8
                - QRinput::estimateBitsMode8($run + 1); // - 4 - l8
            if ($dif > 0) {
                return $this->eat8();
            }
        }

        $ret = $this->input->append(QR_MODE_AN, $run, str_split($this->dataStr));
        if ($ret < 0)
            return -1;

        return $run;
    }

    //----------------------------------------------------------------------
    public function eatKanji()
    {
        $p = 0;

        while ($this->identifyMode($p) == QR_MODE_KANJI) {
            $p += 2;
        }

        $ret = $this->input->append(QR_MODE_KANJI, $p, str_split($this->dataStr));
        if ($ret < 0)
            return -1;

        return $run;
    }

    //----------------------------------------------------------------------
    public function eat8()
    {
        $la = QRspec::lengthIndicator(QR_MODE_AN, $this->input->getVersion());
        $ln = QRspec::lengthIndicator(QR_MODE_NUM, $this->input->getVersion());

        $p = 1;
        $dataStrLen = strlen($this->dataStr);

        while ($p < $dataStrLen) {

            $mode = $this->identifyMode($p);
            if ($mode == QR_MODE_KANJI) {
                break;
            }
            if ($mode == QR_MODE_NUM) {
                $q = $p;
                while (self::isdigitat($this->dataStr, $q)) {
                    $q++;
                }
                $dif = QRinput::estimateBitsMode8($p) // + 4 + l8
                    + QRinput::estimateBitsModeNum($q - $p) + 4 + $ln
                    - QRinput::estimateBitsMode8($q); // - 4 - l8
                if ($dif < 0) {
                    break;
                } else {
                    $p = $q;
                }
            } else if ($mode == QR_MODE_AN) {
                $q = $p;
                while (self::isalnumat($this->dataStr, $q)) {
                    $q++;
                }
                $dif = QRinput::estimateBitsMode8($p)  // + 4 + l8
                    + QRinput::estimateBitsModeAn($q - $p) + 4 + $la
                    - QRinput::estimateBitsMode8($q); // - 4 - l8
                if ($dif < 0) {
                    break;
                } else {
                    $p = $q;
                }
            } else {
                $p++;
            }
        }

        $run = $p;
        $ret = $this->input->append(QR_MODE_8, $run, str_split($this->dataStr));

        if ($ret < 0)
            return -1;

        return $run;
    }

    //----------------------------------------------------------------------
    public function splitString()
    {
        while (strlen($this->dataStr) > 0) {
            if ($this->dataStr == '')
                return 0;

            $mode = $this->identifyMode(0);

            switch ($mode) {
                case QR_MODE_NUM:
                    $length = $this->eatNum();
                    break;
                case QR_MODE_AN:
                    $length = $this->eatAn();
                    break;
                case QR_MODE_KANJI:
                    if ($hint == QR_MODE_KANJI)
                        $length = $this->eatKanji();
                    else    $length = $this->eat8();
                    break;
                default:
                    $length = $this->eat8();
                    break;
            }

            if ($length == 0) return 0;
            if ($length < 0)  return -1;

            $this->dataStr = substr($this->dataStr, $length);
        }
    }

    //----------------------------------------------------------------------
    public function toUpper()
    {
        $stringLen = strlen($this->dataStr);
        $p = 0;

        while ($p < $stringLen) {
            $mode = self::identifyMode(substr($this->dataStr, $p), $this->modeHint);
            if ($mode == QR_MODE_KANJI) {
                $p += 2;
            } else {
                if (ord($this->dataStr[$p]) >= ord('a') && ord($this->dataStr[$p]) <= ord('z')) {
                    $this->dataStr[$p] = chr(ord($this->dataStr[$p]) - 32);
                }
                $p++;
            }
        }

        return $this->dataStr;
    }

    //----------------------------------------------------------------------
    public static function splitStringToQRinput($string, QRinput $input, $modeHint, $casesensitive = true)
    {
        if (is_null($string) || $string == '\0' || $string == '') {
            throw new Exception('empty string!!!');
        }

        $split = new QRsplit($string, $input, $modeHint);

        if (!$casesensitive)
            $split->toUpper();

        return $split->splitString();
    }
}



//---- qrrscode.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Reed-Solomon error correction support
 * 
 * Copyright (C) 2002, 2003, 2004, 2006 Phil Karn, KA9Q
 * (libfec is released under the GNU Lesser General Public License.)
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

class QRrsItem
{

    public $mm;                  // Bits per symbol 
    public $nn;                  // Symbols per block (= (1<<mm)-1) 
    public $alpha_to = array();  // log lookup table 
    public $index_of = array();  // Antilog lookup table 
    public $genpoly = array();   // Generator polynomial 
    public $nroots;              // Number of generator roots = number of parity symbols 
    public $fcr;                 // First consecutive root, index form 
    public $prim;                // Primitive element, index form 
    public $iprim;               // prim-th root of 1, index form 
    public $pad;                 // Padding bytes in shortened block 
    public $gfpoly;

    //----------------------------------------------------------------------
    public function modnn($x)
    {
        while ($x >= $this->nn) {
            $x -= $this->nn;
            $x = ($x >> $this->mm) + ($x & $this->nn);
        }

        return $x;
    }

    //----------------------------------------------------------------------
    public static function init_rs_char($symsize, $gfpoly, $fcr, $prim, $nroots, $pad)
    {
        // Common code for intializing a Reed-Solomon control block (char or int symbols)
        // Copyright 2004 Phil Karn, KA9Q
        // May be used under the terms of the GNU Lesser General Public License (LGPL)

        $rs = null;

        // Check parameter ranges
        if ($symsize < 0 || $symsize > 8)                     return $rs;
        if ($fcr < 0 || $fcr >= (1 << $symsize))                return $rs;
        if ($prim <= 0 || $prim >= (1 << $symsize))             return $rs;
        if ($nroots < 0 || $nroots >= (1 << $symsize))          return $rs; // Can't have more roots than symbol values!
        if ($pad < 0 || $pad >= ((1 << $symsize) - 1 - $nroots)) return $rs; // Too much padding

        $rs = new QRrsItem();
        $rs->mm = $symsize;
        $rs->nn = (1 << $symsize) - 1;
        $rs->pad = $pad;

        $rs->alpha_to = array_fill(0, $rs->nn + 1, 0);
        $rs->index_of = array_fill(0, $rs->nn + 1, 0);

        // PHP style macro replacement ;)
        $NN = &$rs->nn;
        $A0 = &$NN;

        // Generate Galois field lookup tables
        $rs->index_of[0] = $A0; // log(zero) = -inf
        $rs->alpha_to[$A0] = 0; // alpha**-inf = 0
        $sr = 1;

        for ($i = 0; $i < $rs->nn; $i++) {
            $rs->index_of[$sr] = $i;
            $rs->alpha_to[$i] = $sr;
            $sr <<= 1;
            if ($sr & (1 << $symsize)) {
                $sr ^= $gfpoly;
            }
            $sr &= $rs->nn;
        }

        if ($sr != 1) {
            // field generator polynomial is not primitive!
            $rs = NULL;
            return $rs;
        }

        /* Form RS code generator polynomial from its roots */
        $rs->genpoly = array_fill(0, $nroots + 1, 0);

        $rs->fcr = $fcr;
        $rs->prim = $prim;
        $rs->nroots = $nroots;
        $rs->gfpoly = $gfpoly;

        /* Find prim-th root of 1, used in decoding */
        for ($iprim = 1; ($iprim % $prim) != 0; $iprim += $rs->nn); // intentional empty-body loop!

        $rs->iprim = (int)($iprim / $prim);
        $rs->genpoly[0] = 1;

        for ($i = 0, $root = $fcr * $prim; $i < $nroots; $i++, $root += $prim) {
            $rs->genpoly[$i + 1] = 1;

            // Multiply rs->genpoly[] by  @**(root + x)
            for ($j = $i; $j > 0; $j--) {
                if ($rs->genpoly[$j] != 0) {
                    $rs->genpoly[$j] = $rs->genpoly[$j - 1] ^ $rs->alpha_to[$rs->modnn($rs->index_of[$rs->genpoly[$j]] + $root)];
                } else {
                    $rs->genpoly[$j] = $rs->genpoly[$j - 1];
                }
            }
            // rs->genpoly[0] can never be zero
            $rs->genpoly[0] = $rs->alpha_to[$rs->modnn($rs->index_of[$rs->genpoly[0]] + $root)];
        }

        // convert rs->genpoly[] to index form for quicker encoding
        for ($i = 0; $i <= $nroots; $i++)
            $rs->genpoly[$i] = $rs->index_of[$rs->genpoly[$i]];

        return $rs;
    }

    //----------------------------------------------------------------------
    public function encode_rs_char($data, &$parity)
    {
        $MM       = &$this->mm;
        $NN       = &$this->nn;
        $ALPHA_TO = &$this->alpha_to;
        $INDEX_OF = &$this->index_of;
        $GENPOLY  = &$this->genpoly;
        $NROOTS   = &$this->nroots;
        $FCR      = &$this->fcr;
        $PRIM     = &$this->prim;
        $IPRIM    = &$this->iprim;
        $PAD      = &$this->pad;
        $A0       = &$NN;

        $parity = array_fill(0, $NROOTS, 0);

        for ($i = 0; $i < ($NN - $NROOTS - $PAD); $i++) {

            $feedback = $INDEX_OF[$data[$i] ^ $parity[0]];
            if ($feedback != $A0) {
                // feedback term is non-zero

                // This line is unnecessary when GENPOLY[NROOTS] is unity, as it must
                // always be for the polynomials constructed by init_rs()
                $feedback = $this->modnn($NN - $GENPOLY[$NROOTS] + $feedback);

                for ($j = 1; $j < $NROOTS; $j++) {
                    $parity[$j] ^= $ALPHA_TO[$this->modnn($feedback + $GENPOLY[$NROOTS - $j])];
                }
            }

            // Shift 
            array_shift($parity);
            if ($feedback != $A0) {
                array_push($parity, $ALPHA_TO[$this->modnn($feedback + $GENPOLY[0])]);
            } else {
                array_push($parity, 0);
            }
        }
    }
}

//##########################################################################

class QRrs
{

    public static $items = array();

    //----------------------------------------------------------------------
    public static function init_rs($symsize, $gfpoly, $fcr, $prim, $nroots, $pad)
    {
        foreach (self::$items as $rs) {
            if ($rs->pad != $pad)       continue;
            if ($rs->nroots != $nroots) continue;
            if ($rs->mm != $symsize)    continue;
            if ($rs->gfpoly != $gfpoly) continue;
            if ($rs->fcr != $fcr)       continue;
            if ($rs->prim != $prim)     continue;

            return $rs;
        }

        $rs = QRrsItem::init_rs_char($symsize, $gfpoly, $fcr, $prim, $nroots, $pad);
        array_unshift(self::$items, $rs);

        return $rs;
    }
}



//---- qrmask.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Masking
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

define('N1', 3);
define('N2', 3);
define('N3', 40);
define('N4', 10);

class QRmask
{

    public $runLength = array();

    //----------------------------------------------------------------------
    public function __construct()
    {
        $this->runLength = array_fill(0, QRSPEC_WIDTH_MAX + 1, 0);
    }

    //----------------------------------------------------------------------
    public function writeFormatInformation($width, &$frame, $mask, $level)
    {
        $blacks = 0;
        $format =  QRspec::getFormatInfo($mask, $level);

        for ($i = 0; $i < 8; $i++) {
            if ($format & 1) {
                $blacks += 2;
                $v = 0x85;
            } else {
                $v = 0x84;
            }

            $frame[8][$width - 1 - $i] = chr($v);
            if ($i < 6) {
                $frame[$i][8] = chr($v);
            } else {
                $frame[$i + 1][8] = chr($v);
            }
            $format = $format >> 1;
        }

        for ($i = 0; $i < 7; $i++) {
            if ($format & 1) {
                $blacks += 2;
                $v = 0x85;
            } else {
                $v = 0x84;
            }

            $frame[$width - 7 + $i][8] = chr($v);
            if ($i == 0) {
                $frame[8][7] = chr($v);
            } else {
                $frame[8][6 - $i] = chr($v);
            }

            $format = $format >> 1;
        }

        return $blacks;
    }

    //----------------------------------------------------------------------
    public function mask0($x, $y)
    {
        return ($x + $y) & 1;
    }
    public function mask1($x, $y)
    {
        return ($y & 1);
    }
    public function mask2($x, $y)
    {
        return ($x % 3);
    }
    public function mask3($x, $y)
    {
        return ($x + $y) % 3;
    }
    public function mask4($x, $y)
    {
        return (((int)($y / 2)) + ((int)($x / 3))) & 1;
    }
    public function mask5($x, $y)
    {
        return (($x * $y) & 1) + ($x * $y) % 3;
    }
    public function mask6($x, $y)
    {
        return ((($x * $y) & 1) + ($x * $y) % 3) & 1;
    }
    public function mask7($x, $y)
    {
        return ((($x * $y) % 3) + (($x + $y) & 1)) & 1;
    }

    //----------------------------------------------------------------------
    private function generateMaskNo($maskNo, $width, $frame)
    {
        $bitMask = array_fill(0, $width, array_fill(0, $width, 0));

        for ($y = 0; $y < $width; $y++) {
            for ($x = 0; $x < $width; $x++) {
                if (ord($frame[$y][$x]) & 0x80) {
                    $bitMask[$y][$x] = 0;
                } else {
                    $maskFunc = call_user_func(array($this, 'mask' . $maskNo), $x, $y);
                    $bitMask[$y][$x] = ($maskFunc == 0) ? 1 : 0;
                }
            }
        }

        return $bitMask;
    }

    //----------------------------------------------------------------------
    public static function serial($bitFrame)
    {
        $codeArr = array();

        foreach ($bitFrame as $line)
            $codeArr[] = join('', $line);

        return gzcompress(join("\n", $codeArr), 9);
    }

    //----------------------------------------------------------------------
    public static function unserial($code)
    {
        $codeArr = array();

        $codeLines = explode("\n", gzuncompress($code));
        foreach ($codeLines as $line)
            $codeArr[] = str_split($line);

        return $codeArr;
    }

    //----------------------------------------------------------------------
    public function makeMaskNo($maskNo, $width, $s, &$d, $maskGenOnly = false)
    {
        $b = 0;
        $bitMask = array();

        $fileName = QR_CACHE_DIR . 'mask_' . $maskNo . DIRECTORY_SEPARATOR . 'mask_' . $width . '_' . $maskNo . '.dat';

        if (QR_CACHEABLE) {
            if (file_exists($fileName)) {
                $bitMask = self::unserial(file_get_contents($fileName));
            } else {
                $bitMask = $this->generateMaskNo($maskNo, $width, $s, $d);
                if (!file_exists(QR_CACHE_DIR . 'mask_' . $maskNo))
                    mkdir(QR_CACHE_DIR . 'mask_' . $maskNo);
                file_put_contents($fileName, self::serial($bitMask));
            }
        } else {
            $bitMask = $this->generateMaskNo($maskNo, $width, $s, $d);
        }

        if ($maskGenOnly)
            return;

        $d = $s;

        for ($y = 0; $y < $width; $y++) {
            for ($x = 0; $x < $width; $x++) {
                if ($bitMask[$y][$x] == 1) {
                    $d[$y][$x] = chr(ord($s[$y][$x]) ^ (int)$bitMask[$y][$x]);
                }
                $b += (int)(ord($d[$y][$x]) & 1);
            }
        }

        return $b;
    }

    //----------------------------------------------------------------------
    public function makeMask($width, $frame, $maskNo, $level)
    {
        $masked = array_fill(0, $width, str_repeat("\0", $width));
        $this->makeMaskNo($maskNo, $width, $frame, $masked);
        $this->writeFormatInformation($width, $masked, $maskNo, $level);

        return $masked;
    }

    //----------------------------------------------------------------------
    public function calcN1N3($length)
    {
        $demerit = 0;

        for ($i = 0; $i < $length; $i++) {

            if ($this->runLength[$i] >= 5) {
                $demerit += (N1 + ($this->runLength[$i] - 5));
            }
            if ($i & 1) {
                if (($i >= 3) && ($i < ($length - 2)) && ($this->runLength[$i] % 3 == 0)) {
                    $fact = (int)($this->runLength[$i] / 3);
                    if (($this->runLength[$i - 2] == $fact) &&
                        ($this->runLength[$i - 1] == $fact) &&
                        ($this->runLength[$i + 1] == $fact) &&
                        ($this->runLength[$i + 2] == $fact)
                    ) {
                        if (($this->runLength[$i - 3] < 0) || ($this->runLength[$i - 3] >= (4 * $fact))) {
                            $demerit += N3;
                        } else if ((($i + 3) >= $length) || ($this->runLength[$i + 3] >= (4 * $fact))) {
                            $demerit += N3;
                        }
                    }
                }
            }
        }
        return $demerit;
    }

    //----------------------------------------------------------------------
    public function evaluateSymbol($width, $frame)
    {
        $head = 0;
        $demerit = 0;

        for ($y = 0; $y < $width; $y++) {
            $head = 0;
            $this->runLength[0] = 1;

            $frameY = $frame[$y];

            if ($y > 0)
                $frameYM = $frame[$y - 1];

            for ($x = 0; $x < $width; $x++) {
                if (($x > 0) && ($y > 0)) {
                    $b22 = ord($frameY[$x]) & ord($frameY[$x - 1]) & ord($frameYM[$x]) & ord($frameYM[$x - 1]);
                    $w22 = ord($frameY[$x]) | ord($frameY[$x - 1]) | ord($frameYM[$x]) | ord($frameYM[$x - 1]);

                    if (($b22 | ($w22 ^ 1)) & 1) {
                        $demerit += N2;
                    }
                }
                if (($x == 0) && (ord($frameY[$x]) & 1)) {
                    $this->runLength[0] = -1;
                    $head = 1;
                    $this->runLength[$head] = 1;
                } else if ($x > 0) {
                    if ((ord($frameY[$x]) ^ ord($frameY[$x - 1])) & 1) {
                        $head++;
                        $this->runLength[$head] = 1;
                    } else {
                        $this->runLength[$head]++;
                    }
                }
            }

            $demerit += $this->calcN1N3($head + 1);
        }

        for ($x = 0; $x < $width; $x++) {
            $head = 0;
            $this->runLength[0] = 1;

            for ($y = 0; $y < $width; $y++) {
                if ($y == 0 && (ord($frame[$y][$x]) & 1)) {
                    $this->runLength[0] = -1;
                    $head = 1;
                    $this->runLength[$head] = 1;
                } else if ($y > 0) {
                    if ((ord($frame[$y][$x]) ^ ord($frame[$y - 1][$x])) & 1) {
                        $head++;
                        $this->runLength[$head] = 1;
                    } else {
                        $this->runLength[$head]++;
                    }
                }
            }

            $demerit += $this->calcN1N3($head + 1);
        }

        return $demerit;
    }


    //----------------------------------------------------------------------
    public function mask($width, $frame, $level)
    {
        $minDemerit = PHP_INT_MAX;
        $bestMaskNum = 0;
        $bestMask = array();

        $checked_masks = array(0, 1, 2, 3, 4, 5, 6, 7);

        if (QR_FIND_FROM_RANDOM !== false) {

            $howManuOut = 8 - (QR_FIND_FROM_RANDOM % 9);
            for ($i = 0; $i <  $howManuOut; $i++) {
                $remPos = rand(0, count($checked_masks) - 1);
                unset($checked_masks[$remPos]);
                $checked_masks = array_values($checked_masks);
            }
        }

        $bestMask = $frame;

        foreach ($checked_masks as $i) {
            $mask = array_fill(0, $width, str_repeat("\0", $width));

            $demerit = 0;
            $blacks = 0;
            $blacks  = $this->makeMaskNo($i, $width, $frame, $mask);
            $blacks += $this->writeFormatInformation($width, $mask, $i, $level);
            $blacks  = (int)(100 * $blacks / ($width * $width));
            $demerit = (int)((int)(abs($blacks - 50) / 5) * N4);
            $demerit += $this->evaluateSymbol($width, $mask);

            if ($demerit < $minDemerit) {
                $minDemerit = $demerit;
                $bestMask = $mask;
                $bestMaskNum = $i;
            }
        }

        return $bestMask;
    }

    //----------------------------------------------------------------------
}




//---- qrencode.php -----------------------------




/*
 * PHP QR Code encoder
 *
 * Main encoder classes.
 *
 * Based on libqrencode C library distributed under LGPL 2.1
 * Copyright (C) 2006, 2007, 2008, 2009 Kentaro Fukuchi <fukuchi@megaui.net>
 *
 * PHP QR Code is distributed under LGPL 3
 * Copyright (C) 2010 Dominik Dzienia <deltalab at poczta dot fm>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
 */

class QRrsblock
{
    public $dataLength;
    public $data = array();
    public $eccLength;
    public $ecc = array();

    public function __construct($dl, $data, $el, &$ecc, QRrsItem $rs)
    {
        $rs->encode_rs_char($data, $ecc);

        $this->dataLength = $dl;
        $this->data = $data;
        $this->eccLength = $el;
        $this->ecc = $ecc;
    }
};

//##########################################################################

class QRrawcode
{
    public $version;
    public $datacode = array();
    public $ecccode = array();
    public $blocks;
    public $rsblocks = array(); //of RSblock
    public $count;
    public $dataLength;
    public $eccLength;
    public $b1;

    //----------------------------------------------------------------------
    public function __construct(QRinput $input)
    {
        $spec = array(0, 0, 0, 0, 0);

        $this->datacode = $input->getByteStream();
        if (is_null($this->datacode)) {
            throw new Exception('null imput string');
        }

        QRspec::getEccSpec($input->getVersion(), $input->getErrorCorrectionLevel(), $spec);

        $this->version = $input->getVersion();
        $this->b1 = QRspec::rsBlockNum1($spec);
        $this->dataLength = QRspec::rsDataLength($spec);
        $this->eccLength = QRspec::rsEccLength($spec);
        $this->ecccode = array_fill(0, $this->eccLength, 0);
        $this->blocks = QRspec::rsBlockNum($spec);

        $ret = $this->init($spec);
        if ($ret < 0) {
            throw new Exception('block alloc error');
            return null;
        }

        $this->count = 0;
    }

    //----------------------------------------------------------------------
    public function init(array $spec)
    {
        $dl = QRspec::rsDataCodes1($spec);
        $el = QRspec::rsEccCodes1($spec);
        $rs = QRrs::init_rs(8, 0x11d, 0, 1, $el, 255 - $dl - $el);


        $blockNo = 0;
        $dataPos = 0;
        $eccPos = 0;
        for ($i = 0; $i < QRspec::rsBlockNum1($spec); $i++) {
            $ecc = array_slice($this->ecccode, $eccPos);
            $this->rsblocks[$blockNo] = new QRrsblock($dl, array_slice($this->datacode, $dataPos), $el,  $ecc, $rs);
            $this->ecccode = array_merge(array_slice($this->ecccode, 0, $eccPos), $ecc);

            $dataPos += $dl;
            $eccPos += $el;
            $blockNo++;
        }

        if (QRspec::rsBlockNum2($spec) == 0)
            return 0;

        $dl = QRspec::rsDataCodes2($spec);
        $el = QRspec::rsEccCodes2($spec);
        $rs = QRrs::init_rs(8, 0x11d, 0, 1, $el, 255 - $dl - $el);

        if ($rs == NULL) return -1;

        for ($i = 0; $i < QRspec::rsBlockNum2($spec); $i++) {
            $ecc = array_slice($this->ecccode, $eccPos);
            $this->rsblocks[$blockNo] = new QRrsblock($dl, array_slice($this->datacode, $dataPos), $el, $ecc, $rs);
            $this->ecccode = array_merge(array_slice($this->ecccode, 0, $eccPos), $ecc);

            $dataPos += $dl;
            $eccPos += $el;
            $blockNo++;
        }

        return 0;
    }

    //----------------------------------------------------------------------
    public function getCode()
    {
        $ret;

        if ($this->count < $this->dataLength) {
            $row = $this->count % $this->blocks;
            $col = $this->count / $this->blocks;
            if ($col >= $this->rsblocks[0]->dataLength) {
                $row += $this->b1;
            }
            $ret = $this->rsblocks[$row]->data[$col];
        } else if ($this->count < $this->dataLength + $this->eccLength) {
            $row = ($this->count - $this->dataLength) % $this->blocks;
            $col = ($this->count - $this->dataLength) / $this->blocks;
            $ret = $this->rsblocks[$row]->ecc[$col];
        } else {
            return 0;
        }
        $this->count++;

        return $ret;
    }
}

//##########################################################################

class QRcode
{

    public $version;
    public $width;
    public $data;

    //----------------------------------------------------------------------
    public function encodeMask(QRinput $input, $mask)
    {
        if ($input->getVersion() < 0 || $input->getVersion() > QRSPEC_VERSION_MAX) {
            throw new Exception('wrong version');
        }
        if ($input->getErrorCorrectionLevel() > QR_ECLEVEL_H) {
            throw new Exception('wrong level');
        }

        $raw = new QRrawcode($input);

        QRtools::markTime('after_raw');

        $version = $raw->version;
        $width = QRspec::getWidth($version);
        $frame = QRspec::newFrame($version);

        $filler = new FrameFiller($width, $frame);
        if (is_null($filler)) {
            return NULL;
        }

        // inteleaved data and ecc codes
        for ($i = 0; $i < $raw->dataLength + $raw->eccLength; $i++) {
            $code = $raw->getCode();
            $bit = 0x80;
            for ($j = 0; $j < 8; $j++) {
                $addr = $filler->next();
                $filler->setFrameAt($addr, 0x02 | (($bit & $code) != 0));
                $bit = $bit >> 1;
            }
        }

        QRtools::markTime('after_filler');

        unset($raw);

        // remainder bits
        $j = QRspec::getRemainder($version);
        for ($i = 0; $i < $j; $i++) {
            $addr = $filler->next();
            $filler->setFrameAt($addr, 0x02);
        }

        $frame = $filler->frame;
        unset($filler);


        // masking
        $maskObj = new QRmask();
        if ($mask < 0) {

            if (QR_FIND_BEST_MASK) {
                $masked = $maskObj->mask($width, $frame, $input->getErrorCorrectionLevel());
            } else {
                $masked = $maskObj->makeMask($width, $frame, (intval(QR_DEFAULT_MASK) % 8), $input->getErrorCorrectionLevel());
            }
        } else {
            $masked = $maskObj->makeMask($width, $frame, $mask, $input->getErrorCorrectionLevel());
        }

        if ($masked == NULL) {
            return NULL;
        }

        QRtools::markTime('after_mask');

        $this->version = $version;
        $this->width = $width;
        $this->data = $masked;

        return $this;
    }

    //----------------------------------------------------------------------
    public function encodeInput(QRinput $input)
    {
        return $this->encodeMask($input, -1);
    }

    //----------------------------------------------------------------------
    public function encodeString8bit($string, $version, $level)
    {
        if (string == NULL) {
            throw new Exception('empty string!');
            return NULL;
        }

        $input = new QRinput($version, $level);
        if ($input == NULL) return NULL;

        $ret = $input->append($input, QR_MODE_8, strlen($string), str_split($string));
        if ($ret < 0) {
            unset($input);
            return NULL;
        }
        return $this->encodeInput($input);
    }

    //----------------------------------------------------------------------
    public function encodeString($string, $version, $level, $hint, $casesensitive)
    {

        if ($hint != QR_MODE_8 && $hint != QR_MODE_KANJI) {
            throw new Exception('bad hint');
            return NULL;
        }

        $input = new QRinput($version, $level);
        if ($input == NULL) return NULL;

        $ret = QRsplit::splitStringToQRinput($string, $input, $hint, $casesensitive);
        if ($ret < 0) {
            return NULL;
        }

        return $this->encodeInput($input);
    }

    //----------------------------------------------------------------------
    public static function png($text, $outfile = false, $level = QR_ECLEVEL_L, $size = 3, $margin = 4, $saveandprint = false)
    {
        $enc = QRencode::factory($level, $size, $margin);
        return $enc->encodePNG($text, $outfile, $saveandprint = false);
    }

    //----------------------------------------------------------------------
    public static function text($text, $outfile = false, $level = QR_ECLEVEL_L, $size = 3, $margin = 4)
    {
        $enc = QRencode::factory($level, $size, $margin);
        return $enc->encode($text, $outfile);
    }

    //----------------------------------------------------------------------
    public static function raw($text, $outfile = false, $level = QR_ECLEVEL_L, $size = 3, $margin = 4)
    {
        $enc = QRencode::factory($level, $size, $margin);
        return $enc->encodeRAW($text, $outfile);
    }
}

//##########################################################################

class FrameFiller
{

    public $width;
    public $frame;
    public $x;
    public $y;
    public $dir;
    public $bit;

    //----------------------------------------------------------------------
    public function __construct($width, &$frame)
    {
        $this->width = $width;
        $this->frame = $frame;
        $this->x = $width - 1;
        $this->y = $width - 1;
        $this->dir = -1;
        $this->bit = -1;
    }

    //----------------------------------------------------------------------
    public function setFrameAt($at, $val)
    {
        $this->frame[$at['y']][$at['x']] = chr($val);
    }

    //----------------------------------------------------------------------
    public function getFrameAt($at)
    {
        return ord($this->frame[$at['y']][$at['x']]);
    }

    //----------------------------------------------------------------------
    public function next()
    {
        do {

            if ($this->bit == -1) {
                $this->bit = 0;
                return array('x' => $this->x, 'y' => $this->y);
            }

            $x = $this->x;
            $y = $this->y;
            $w = $this->width;

            if ($this->bit == 0) {
                $x--;
                $this->bit++;
            } else {
                $x++;
                $y += $this->dir;
                $this->bit--;
            }

            if ($this->dir < 0) {
                if ($y < 0) {
                    $y = 0;
                    $x -= 2;
                    $this->dir = 1;
                    if ($x == 6) {
                        $x--;
                        $y = 9;
                    }
                }
            } else {
                if ($y == $w) {
                    $y = $w - 1;
                    $x -= 2;
                    $this->dir = -1;
                    if ($x == 6) {
                        $x--;
                        $y -= 8;
                    }
                }
            }
            if ($x < 0 || $y < 0) return null;

            $this->x = $x;
            $this->y = $y;
        } while (ord($this->frame[$y][$x]) & 0x80);

        return array('x' => $x, 'y' => $y);
    }
};

//##########################################################################    

class QRencode
{

    public $casesensitive = true;
    public $eightbit = false;

    public $version = 0;
    public $size = 3;
    public $margin = 4;

    public $structured = 0; // not supported yet

    public $level = QR_ECLEVEL_L;
    public $hint = QR_MODE_8;

    //----------------------------------------------------------------------
    public static function factory($level = QR_ECLEVEL_L, $size = 3, $margin = 4)
    {
        $enc = new QRencode();
        $enc->size = $size;
        $enc->margin = $margin;

        switch ($level . '') {
            case '0':
            case '1':
            case '2':
            case '3':
                $enc->level = $level;
                break;
            case 'l':
            case 'L':
                $enc->level = QR_ECLEVEL_L;
                break;
            case 'm':
            case 'M':
                $enc->level = QR_ECLEVEL_M;
                break;
            case 'q':
            case 'Q':
                $enc->level = QR_ECLEVEL_Q;
                break;
            case 'h':
            case 'H':
                $enc->level = QR_ECLEVEL_H;
                break;
        }

        return $enc;
    }

    //----------------------------------------------------------------------
    public function encodeRAW($intext, $outfile = false)
    {
        $code = new QRcode();

        if ($this->eightbit) {
            $code->encodeString8bit($intext, $this->version, $this->level);
        } else {
            $code->encodeString($intext, $this->version, $this->level, $this->hint, $this->casesensitive);
        }

        return $code->data;
    }

    //----------------------------------------------------------------------
    public function encode($intext, $outfile = false)
    {
        $code = new QRcode();

        if ($this->eightbit) {
            $code->encodeString8bit($intext, $this->version, $this->level);
        } else {
            $code->encodeString($intext, $this->version, $this->level, $this->hint, $this->casesensitive);
        }

        QRtools::markTime('after_encode');

        if ($outfile !== false) {
            file_put_contents($outfile, join("\n", QRtools::binarize($code->data)));
        } else {
            return QRtools::binarize($code->data);
        }
    }

    //----------------------------------------------------------------------
    public function encodePNG($intext, $outfile = false, $saveandprint = false)
    {
        try {

            ob_start();
            $tab = $this->encode($intext);
            $err = ob_get_contents();
            ob_end_clean();

            if ($err != '')
                QRtools::log($outfile, $err);

            $maxSize = (int)(QR_PNG_MAXIMUM_SIZE / (count($tab) + 2 * $this->margin));

            QRimage::png($tab, $outfile, min(max(1, $this->size), $maxSize), $this->margin, $saveandprint);
        } catch (Exception $e) {

            QRtools::log($outfile, $e->getMessage());
        }
    }
}
</file>

<file path="payisp/cliente.carnet.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
require_once(dirname(__FILE__) . '/class.qrcode.php');
//class bank
$classBank = new BancoClassPayIsp();
//faturas ao cliente
$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND uuid_cliente = '" . valor_antigo_payisp('uuid') . "' AND codigo_carne = '" . valor_antigo_payisp('carnet') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_cliente'])) {
	$titulo = 'Faturas No Encontradas';
	$alerta = 'No encontramos nenhuma fatura em seu carnet. Caso j tenha pago todas, solicite um novo carnet em nossa central de atendimento.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
if (sha1($fatura['uuid_cliente'] . $fatura['cpf_cnpj']) != valor_antigo_payisp('sec')) {
	$titulo = 'Acesso Negado';
	$alerta = 'Voc no tem permisso de visualizar o carnet selecionado. Acesso negado por violao de segurana.';
	$tipo_alerta = 'danger';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
?>
<!doctype html>
<html lang="pt-BR">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Carnet: <?php echo ucwords($fatura['nome']); ?> - <?php echo ucwords($dados_provedor['nome']); ?></title>

	<meta property="og:title" content="Carnet: <?php echo ucwords($fatura['nome']); ?> - <?php echo ucwords($dados_provedor['nome']); ?>">
	<meta property="og:description" content="<?php echo ucwords($dados_provedor['nome']); ?>">
	<meta property="og:image" content="../../../mkfiles/logo.jpg">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/admin/addons/payisp/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
	<link href="/admin/addons/payisp/css/bootstrap.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/toastr.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/styles.css" rel="stylesheet">

	<script src="/admin/scripts/jquery.js"></script>
	<script src="/admin/addons/payisp/js/bootstrap.bundle.min.js"></script>
	<script src="/admin/addons/payisp/js/toastr.min.js"></script>
	<script src="/admin/addons/payisp/js/jquery.blockUI.js"></script>
	<script src="/admin/addons/payisp/js/bootbox.all.js"></script>
	<script src="/admin/addons/payisp/js/scripts.js"></script>
	<?php if ($dados_configuracoes['ativar_cartao'] == 1 && !empty($dados_configuracoes['gateway'])) { ?>
		<script>
			function pagarCartaoPayisp(id, uuid, sec) {
				// Substituindo o confirm() nativo por bootbox.confirm para melhor UX
				bootbox.confirm({
					title: "Pagar com Carto de Crdito",
					message: 'Confirma iniciar pagamento por Carto de Crdito para fatura #' + id + ' selecionada?',
					buttons: {
						cancel: {
							label: '<i class="fa fa-times"></i> No',
							className: 'btn-secondary'
						},
						confirm: {
							label: '<i class="fa fa-credit-card"></i> Sim, Pagar',
							className: 'btn-success'
						}
					},
					callback: function(result) {
						if (result) {
							location.href = 'cartao.<?php echo $dados_configuracoes['gateway']; ?>.php?uuid=' + uuid + '&sec=' + sec;
						}
					}
				});
				return false;
			}
		</script>
	<?php } ?>
	<style>
		/* Ajustando estilos de botes para serem responsivos e menores */
		.btn-xs {
			--bs-btn-padding-y: 0.15rem;
			--bs-btn-padding-x: 0.3rem;
			--bs-btn-font-size: 0.675rem;
			--bs-btn-border-radius: var(--bs-border-radius-sm);
		}

		.accordion-button {
			padding: 0.75rem 1.25rem;
		}

		.accordion-header .badge {
			font-size: 0.8rem;
			margin-left: 5px;
		}

		.accordion-body .row {
			padding: 0 10px;
			/* Adiciona padding interno */
		}

		.qr-img {
			max-width: 150px;
			/* Reduz o QR Code para melhor visualizao mvel */
			height: auto;
			border: 1px solid #ddd;
			padding: 5px;
			border-radius: 5px;
		}
	</style>
	<meta name="color-scheme" content="light only">
	<meta name="supported-color-schemes" content="light only">
</head>

<body>
	<div class="container py-4">
		<div class="card shadow">
			<div class="card-header bg-primary text-white d-flex align-items-center">
				<i class="fa fa-book-open me-2 fs-5"></i>
				<h5 class="mb-0">CARNET DIGITAL: <?php echo ucwords($fatura['nome']); ?></h5>
			</div>
			<div class="card-body p-0">

				<!-- ALERTA GERAL DE FATORA -->
				<div class="alert alert-info py-2 m-3 rounded" role="alert">
					<i class="fa fa-info-circle me-1"></i> Carnet #<?php echo $fatura['codigo_carne']; ?> - As faturas abertas so listadas abaixo.
				</div>

				<div class="accordion accordion-flush" id="lista-faturas">
					<?php
					// Busca apenas as faturas no pagas e no deletadas
					$sql = "SELECT * FROM `vtab_titulos` WHERE status <> 'pago' AND deltitulo = 0 AND uuid_cliente = '" . valor_antigo_payisp('uuid') . "' AND codigo_carne = '" . valor_antigo_payisp('carnet') . "' ORDER BY datavenc ASC LIMIT 12";
					$result = $mysqli->query($sql);
					$fatura_num = 1;
					while ($row = $result->fetch_array()) {
						// pix
						$sqlpix = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . $row['uuid_lanc'] . "' LIMIT 1";
						$resultpix = $mysqli->query($sqlpix);
						$pix = $resultpix->fetch_array(MYSQLI_ASSOC);

						// soma o total
						$total_final = $row['valor'];
						if (isset($dados_configuracoes['taxa']) && $dados_configuracoes['taxa'] > 0) {
							$total_final = $total_final + (($total_final / 100) * $dados_configuracoes['taxa']);
						}
						$total_final_formatado = number_format($total_final, '2', '.', '');

						// Status da Fatura
						$vencido = strtotime($row['datavenc']) < time() && $row['status'] != 'pago';
						$status_class = $vencido ? 'text-bg-danger' : 'text-bg-primary';
						$status_text = $vencido ? 'Vencido' : 'Aberto';
						$data_vencimento = date('d/m/Y', strtotime($row['datavenc']));
					?>
						<div class="accordion-item">
							<h2 class="accordion-header" id="heading-<?php echo $row['titulo']; ?>">
								<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fatura-<?php echo $row['titulo']; ?>" aria-expanded="false" aria-controls="fatura-<?php echo $row['titulo']; ?>">
									<span class="d-flex w-100 align-items-center">
										<!-- Ttulo e Valor -->
										<i class="fa fa-file-invoice me-2"></i>
										Fatura #<?php echo $row['titulo']; ?> <span class="fw-bold text-success mx-2">- R$<?php echo number_format($row['valor'], '2', ',', '.'); ?></span>

										<!-- Vencimento e Status -->
										<span class="ms-auto me-3">Venc.: <?php echo $data_vencimento; ?></span>
										<span class="badge <?php echo $status_class; ?>"><?php echo $status_text; ?></span>
									</span>
								</button>
							</h2>
							<div id="fatura-<?php echo $row['titulo']; ?>" class="accordion-collapse collapse" aria-labelledby="heading-<?php echo $row['titulo']; ?>" data-bs-parent="#lista-faturas">
								<div class="accordion-body p-3">
									<div class="row">

										<!-- Dados do Cliente/Fatura -->
										<div class="col-12 col-md-6 mb-3">
											<h6 class="border-bottom pb-2 mb-2"><i class="fa fa-user-circle me-1"></i> Detalhes da Fatura</h6>
											<address class="m-t-5 m-b-5 small">
												<span class="fw-bold">Cliente:</span> <?php echo ucwords($row['nome']); ?><br>
												<span class="fw-bold">CPF/CNPJ:</span> <?php echo $row['cpf_cnpj']; ?><br>
												<span class="fw-bold">Endereo:</span> <?php echo $row['endereco']; ?>, <?php echo $row['bairro']; ?>, <?php echo $row['cidade']; ?>/<?php echo $row['estado']; ?>, <?php echo $row['cep']; ?><br>
												<span class="fw-bold">Plano:</span> <?php echo $row['plano']; ?><br>
												<span class="fw-bold">Referncia:</span> <?php echo $row['referencia']; ?><br>
											</address>
										</div>

										<!-- Links e Cdigos de Pagamento -->
										<div class="col-12 col-md-6 mb-3">
											<h6 class="border-bottom pb-2 mb-2"><i class="fa fa-qrcode me-1"></i> Formas de Pagamento</h6>

											<!-- Link da Fatura -->
											<p class="mb-2 small">
												<span class="fw-bold">Transao:</span>
												<a target="_blank" href="cliente.fatura.php?uuid=<?php echo $row['uuid_lanc']; ?>&sec=<?php echo sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']); ?>"><?php echo $row['nossonum']; ?></a>
											</p>

											<!-- Linha Digitvel -->
											<?php if (!empty($row['linhadig'])) { ?>
												<p class="mb-1 fw-bold">Linha Digitvel (Boleto):</p>
												<div class="input-group mb-3">
													<input id="boleto-copiar-colar-<?php echo $row['titulo']; ?>" type="text" readonly value="<?php echo $classBank->formatarLinha($row['linhadig']); ?>" class="form-control form-control-sm">
													<button onclick="copiarCodigo('boleto-copiar-colar-<?php echo $row['titulo']; ?>', 'Linha Digitvel copiada com sucesso!');" class="btn btn-primary btn-sm" type="button"><i class="fa fa-copy"></i> Copiar</button>
												</div>
											<?php } ?>

											<!-- Cdigo de Barras (Oculto em Mobile, visvel para desktop) -->
											<?php
											$codigo_barra = $row['codigo_barras'] ?? $row['fchequeagcc'] ?? '';
											if (!empty($codigo_barra)) {
											?>
												<p class="mb-1 fw-bold d-none d-sm-block">Cdigo de Barras:</p>
												<code class="d-none d-sm-block small text-break"><?php echo $classBank->geraCodigoBarra($codigo_barra); ?></code>
											<?php } ?>

										</div>

										<!-- Pagamento Pix -->
										<?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
											<div class="col-12 col-md-6 mb-3">
												<h6 class="border-bottom pb-2 mb-2"><i class="fa fa-qrcode me-1"></i> Pagamento via Pix</h6>
												<div class="d-flex flex-column align-items-center">
													<div class="mb-2 text-center">
														<?php
														ob_start();
														QRCode::png(trim($pix['qrcode']), null, 'M', 4); // Reduzindo o tamanho do QR Code
														$imageString = base64_encode(ob_get_contents());
														ob_end_clean();
														?>
														<img class="qr-img" src="data:image/png;base64,<?php echo $imageString; ?>" alt="QR Code Pix" />
													</div>
													<p class="mb-1 fw-bold">Pix Copia e Cola:</p>
													<div class="input-group mb-3">
														<input id="pix-copiar-colar-<?php echo $row['titulo']; ?>" type="text" readonly value="<?php echo $pix['qrcode']; ?>" class="form-control form-control-sm">
														<button onclick="copiarCodigo('pix-copiar-colar-<?php echo $row['titulo']; ?>', 'Pix copiado com sucesso!');" class="btn btn-success btn-sm" type="button"><i class="fa fa-copy"></i> Copiar Pix</button>
													</div>
												</div>
											</div>
										<?php } ?>

										<!-- Pagamento Carto (Se Ativo) -->
										<?php if ($dados_configuracoes['ativar_cartao'] == 1 && !empty($dados_configuracoes['gateway'])) {
											// soma o total para o boto de carto (Recalculado aqui para garantir que o valor do boto  o correto)
											$total_final_cartao = $row['valor'];
											if (isset($dados_configuracoes['taxa']) && $dados_configuracoes['taxa'] > 0) {
												$total_final_cartao += (($total_final_cartao / 100) * $dados_configuracoes['taxa']);
											}
										?>
											<div class="col-12 col-md-6 mb-3">
												<h6 class="border-bottom pb-2 mb-2"><i class="fa fa-credit-card me-1"></i> Pagar com Carto</h6>
												<div class="text-center">
													<button onclick="pagarCartaoPayisp('<?php echo $row['titulo']; ?>','<?php echo $row['uuid_lanc']; ?>','<?php echo sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']); ?>');"
														type="button"
														class="btn btn-success w-100">
														<i class="fa fa-credit-card me-1"></i> Pagar R$<?php echo number_format($total_final_cartao, '2', ',', '.'); ?>
													</button>
													<?php if (isset($dados_configuracoes['taxa']) && $dados_configuracoes['taxa'] > 0) { ?>
														<small class="text-muted fst-italic"> (inclui acrscimo de <?php echo $dados_configuracoes['taxa']; ?>%)</small>
													<?php } ?>
												</div>
											</div>
										<?php } ?>

									</div>
								</div>
							</div>
						</div>
					<?php
						$fatura_num++;
					}
					?>
				</div>
			</div>
		</div>

		<?php if ($result->num_rows == 0) { ?>
			<!-- Mensagem se no houver faturas ativas no carnet -->
			<div class="alert alert-success mt-4 text-center" role="alert">
				<i class="fa fa-check-circle me-1"></i> Parabns! Todas as faturas do carnet #<?php echo $fatura['codigo_carne']; ?> j foram pagas.
			</div>
		<?php } ?>
	</div>

	<script>
		// Funo de copiar aprimorada com Toastr para feedback no obstrutivo
		function copiarCodigo(elementId, mensagem) {
			var elemento = document.getElementById(elementId);

			// Tenta usar a API moderna (Clipboard API)
			if (navigator.clipboard && navigator.clipboard.writeText) {
				// Remove a seleo atual para evitar problemas de foco
				window.getSelection().removeAllRanges();
				navigator.clipboard.writeText(elemento.value).then(function() {
					toastr.success(mensagem, 'Copiado!', {
						closeButton: true,
						progressBar: true
					});
				}, function(err) {
					console.error('Falha ao copiar usando Clipboard API: ', err);
					// Fallback para a API antiga
					fallbackCopy(elemento, mensagem);
				});
			} else {
				// Fallback para a API antiga
				fallbackCopy(elemento, mensagem);
			}
		}

		function fallbackCopy(elemento, mensagem) {
			elemento.select();
			// Para dispositivos mveis, tenta criar uma range
			var range = document.createRange();
			range.selectNode(elemento);
			window.getSelection().removeAllRanges();
			window.getSelection().addRange(range);

			try {
				var copiado = document.execCommand('copy');
				if (copiado) {
					toastr.success(mensagem, 'Copiado!', {
						closeButton: true,
						progressBar: true
					});
				} else {
					toastr.error('Falha ao copiar o cdigo. Tente selecionar manualmente.', 'Erro de Cpia');
				}
			} catch (err) {
				toastr.error('Erro ao copiar: ' + err, 'Erro de Cpia');
			}
			window.getSelection().removeAllRanges();
		}
	</script>
</body>

</html>
</file>

<file path="payisp/cliente.fatura.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
require_once(dirname(__FILE__) . '/class.qrcode.php');
//class bank
$classBank = new BancoClassPayIsp();
//fatura ao cliente 
$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND uuid_lanc = '" . valor_antigo_payisp('uuid') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
    $titulo = 'Fatura No Encontrada';
    $alerta = 'O titulo do boleto selecionado no foi encontrado na base de dados. Verifique se o link acessado est correto ou solicite um novo link de pagamento em nosso suporte.';
    $tipo_alerta = 'warning';
    require(dirname(__FILE__) . '/template_alerta.php');
    die('');
}
if (sha1($fatura['uuid_lanc'] . $fatura['titulo'] . $fatura['titulo']) != valor_antigo_payisp('sec')) {
    $titulo = 'Acesso Negado';
    $alerta = 'Voc no tem permisso de visualizar o ttulo do boleto selecionado. Acesso negado por violao de segurana.';
    $tipo_alerta = 'danger';
    require(dirname(__FILE__) . '/template_alerta.php');
    die('');
}
//pix 
$sql = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . valor_antigo_payisp('uuid') . "' LIMIT 1";
$result = $mysqli->query($sql);
$pix = $result->fetch_array(MYSQLI_ASSOC);
//soma o total 
$total_final = $fatura['valor'];
if ($dados_configuracoes['taxa'] > 0) {
    $total_final = $total_final + (($total_final / 100) * $dados_configuracoes['taxa']);
}
$total_final_formatado = number_format($total_final, '2', '.', '');

// Determina classes de status para o cabealho
$status_fatura = strtoupper(str_replace('_', ' ', $fatura['status']));
$status_cor = 'bg-secondary';
if ($fatura['status'] == 'pago') {
    $status_cor = 'bg-success';
} elseif ($fatura['status'] == 'aberto') {
    $status_cor = 'bg-primary';
} else { // vencido, etc.
    $status_cor = 'bg-danger';
}
?>
<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Ver Fatura #<?php echo $fatura['titulo']; ?> - <?php echo ucwords($dados_provedor['nome']); ?></title>

    <meta property="og:title" content="Ver Fatura #<?php echo $fatura['titulo']; ?> - <?php echo ucwords($dados_provedor['nome']); ?>">
    <meta property="og:description" content="<?php echo ucwords($dados_provedor['nome']); ?>">
    <meta property="og:image" content="../../../mkfiles/logo.jpg">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="/admin/addons/payisp/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/addons/payisp/css/bootstrap.min.css" rel="stylesheet">
    <link href="/admin/addons/payisp/css/toastr.min.css" rel="stylesheet">
    <link href="/admin/addons/payisp/css/styles.css" rel="stylesheet">

    <script src="/admin/scripts/jquery.js"></script>
    <script src="/admin/addons/payisp/js/bootstrap.bundle.min.js"></script>
    <script src="/admin/addons/payisp/js/toastr.min.js"></script>
    <script src="/admin/addons/payisp/js/jquery.blockUI.js"></script>
    <script src="/admin/addons/payisp/js/bootbox.all.js"></script>
    <script src="/admin/addons/payisp/js/scripts.js"></script>
    <?php if ($dados_configuracoes['ativar_cartao'] == 1 && !empty($dados_configuracoes['gateway'])) { ?>
        <script>
            function pagarCartaoPayisp() {
                // Substituindo o confirm() nativo por bootbox.confirm
                bootbox.confirm({
                    title: "Pagar com Carto de Crdito",
                    message: 'Confirma iniciar pagamento por Carto de Crdito para fatura #<?php echo $fatura['titulo']; ?>?',
                    buttons: {
                        cancel: {
                            label: '<i class="fa fa-times"></i> No',
                            className: 'btn-secondary'
                        },
                        confirm: {
                            label: '<i class="fa fa-credit-card"></i> Sim, Pagar',
                            className: 'btn-success'
                        }
                    },
                    callback: function(result) {
                        if (result) {
                            location.href = 'cartao.<?php echo $dados_configuracoes['gateway']; ?>.php?uuid=<?php echo valor_antigo_payisp('uuid'); ?>&sec=<?php echo valor_antigo_payisp('sec'); ?>';
                        }
                    }
                });
                return false;
            }
        </script>
    <?php } ?>

    <meta name="color-scheme" content="light only">
    <meta name="supported-color-schemes" content="light only">
    <style>
        /* Estilos base (simplificados e responsivos) */
        body {
            background-color: #f8f9fa;
        }

        .invoice-card {
            max-width: 800px;
            margin: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .header-section {
            padding: 20px;
        }

        .detail-section {
            padding: 15px;
            border-top: 1px solid #e9ecef;
        }

        .price-box {
            background: #f0f3f4;
            padding: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }

        .total-box {
            background: #2d353c;
            color: #fff;
            padding: 20px;
            font-size: 1.8rem;
            text-align: right;
        }

        .code-box {
            background-color: #f5f5f5;
            border-radius: 5px;
            padding: 10px;
            margin-top: 15px;
            text-align: center;
        }

        .code-box input {
            text-align: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .qr-code-img {
            max-width: 200px;
            height: auto;
            border: 1px solid #ddd;
            padding: 5px;
            border-radius: 5px;
        }

        /* Media query para a barra de cdigo de barras em dispositivos mveis (Ocultar) */
        @media (max-width: 767px) {
            .d-sm-block {
                display: none !important;
            }
        }
    </style>
</head>

<body>
    <div class="container py-4">

        <div class="invoice-card shadow-lg">

            <!-- CABEALHO DA FATURA (LOGO, STATUS, AES) -->
            <div class="row g-0 header-section bg-white border-bottom">
                <div class="col-12 col-md-2 text-center text-md-start mb-3 mb-md-0 align-self-center">
                    <img style="max-height: 80px;" src="../../../mkfiles/logo.jpg" alt="Logo Provedor" class="mb-2"><br>
                </div>
                <div class="col-12 col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <b><?php echo ucwords($dados_provedor['nome']); ?></b> - CNPJ: <?php echo $dados_provedor['cnpj']; ?><br>
                    <?php echo $dados_provedor['endereco']; ?>, <?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>, <?php echo $dados_provedor['cep']; ?><br>
                    <small>Contato: <?php echo $dados_provedor['fone']; ?></small>
                </div>
                <div class="col-12 col-md-4 text-center text-md-end">
                    <span class="badge <?php echo $status_cor; ?> fs-5 mb-2"><?php echo $status_fatura; ?></span>
                    <br>
                    <span class="fs-6 text-muted"><?php echo ucfirst($fatura['tipo']); ?>: <b>#<?php echo $fatura['titulo']; ?></b></span>
                    <br>
                    <?php if ($fatura['status'] == 'pago') { ?>
                        <span class="text-success fw-bold">Pago: R$<?php echo number_format($fatura['valorpag'], '2', ',', '.'); ?></span>
                    <?php } else { ?>
                        <span class="fw-bold">Valor Total: R$<?php echo number_format($fatura['valor'], '2', ',', '.'); ?></span>
                        <?php if ($dados_configuracoes['ativar_cartao'] == 1 && !empty($dados_configuracoes['gateway'])) { ?>
                            <div class="mt-2">
                                <button onclick="pagarCartaoPayisp();" type="button" class="btn btn-success btn-sm"><i class="fa fa-credit-card me-1"></i> Pagar Carto R$<?php echo number_format($total_final, '2', ',', '.'); ?></button>
                                <?php if ($dados_configuracoes['taxa'] > 0) { ?><br><small class="text-muted">(inclui acrscimo de <?php echo $dados_configuracoes['taxa']; ?>%)</small><?php } ?>
                            </div>
                        <?php } ?>
                    <?php } ?>
                </div>
            </div>

            <!-- DETALHES CLIENTE E BENEFICIRIO -->
            <div class="row g-0 detail-section bg-white">
                <div class="col-12 col-sm-6 p-3 border-end">
                    <h6 class="fw-bold text-primary border-bottom pb-1">CLIENTE</h6>
                    <small class="text-muted">
                        <span class="fw-bold">Nome:</span> <?php echo $fatura['nome']; ?><br>
                        <span class="fw-bold">CPF/CNPJ:</span> <?php echo $fatura['cpf_cnpj']; ?><br>
                        <span class="fw-bold">Endereo:</span> <?php echo $fatura['endereco']; ?>, <?php echo $fatura['bairro']; ?>, <?php echo $fatura['cidade']; ?>/<?php echo $fatura['estado']; ?>, <?php echo $fatura['cep']; ?><br>
                        <span class="fw-bold">Contato:</span> <?php echo !empty($fatura['fone']) ? $fatura['fone'] : $fatura['celular']; ?><br>
                        <span class="fw-bold">Plano:</span> <?php echo $fatura['plano']; ?><br>
                    </small>
                </div>
                <div class="col-12 col-sm-6 p-3">
                    <h6 class="fw-bold text-primary border-bottom pb-1">BENEFICIRIO</h6>
                    <small class="text-muted">
                        <span class="fw-bold">Nome:</span> <?php echo ucwords($dados_provedor['nome']); ?> (CNPJ: <?php echo $dados_provedor['cnpj']; ?>)<br>
                        <span class="fw-bold">Endereo:</span> <?php echo $dados_provedor['endereco']; ?>, <?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>, <?php echo $dados_provedor['cep']; ?><br>
                        <span class="fw-bold">Contato:</span> <?php echo $dados_provedor['fone']; ?> | E-mail: <?php echo $dados_provedor['email']; ?><br>
                        <span class="fw-bold">Transao:</span> <?php echo $fatura['nossonum']; ?><br>
                        <span class="fw-bold"><?php echo ($fatura['status'] == 'pago') ? 'Pagamento' : 'Vencimento'; ?>:</span>
                        <?php echo ($fatura['status'] == 'pago') ? date('d/m/Y', strtotime($fatura['datapag'])) : date('d/m/Y', strtotime($fatura['datavenc'])); ?>
                    </small>
                </div>
            </div>

            <!-- DETALHES DOS SERVIOS/ITENS -->
            <div class="row g-0 detail-section bg-light">
                <div class="col-12 p-3">
                    <h6 class="fw-bold text-dark border-bottom pb-1">DETALHES DA COBRANA</h6>
                    <p class="small mb-0">
                        <?php echo ucfirst($fatura['tipo']); ?> #<?php echo $fatura['titulo']; ?> / Plano de acesso: <?php echo $fatura['plano']; ?> / Login: <?php echo $fatura['login']; ?>.
                    </p>
                </div>
            </div>

            <!-- SEO DE PAGAMENTO (BOLETO E PIX) -->
            <?php if ($fatura['status'] != 'pago') { ?>
                <div class="row g-0 detail-section bg-white">
                    <div class="col-12 p-3">
                        <h5 class="fw-bold text-primary border-bottom pb-2 mb-3"><i class="fa fa-qrcode me-2"></i> Opes de Pagamento</h5>

                        <!-- LINHA DIGITVEL / BOLETO -->
                        <?php if (isset($fatura['linhadig']) && !empty($fatura['linhadig'])) { ?>
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-center fw-bold">LINHA DIGITVEL (Boleto)</h6>
                                    <div class="input-group">
                                        <input id="boleto-copiar-colar" type="text" readonly value="<?php echo $classBank->formatarLinha($fatura['linhadig']); ?>" class="form-control text-center form-control-lg">
                                        <button onclick="copiarCodigo('boleto-copiar-colar', 'Linha Digitvel do Boleto copiada com sucesso!');" class="btn btn-primary" type="button"><i class="fa fa-copy me-1"></i> Copiar</button>
                                    </div>
                                    <small class="form-text text-muted text-center d-block mt-1">Aps o pagamento, a baixa e confirmao so automticas.</small>
                                </div>
                            </div>
                        <?php } ?>

                        <!-- QR CODE PIX -->
                        <?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
                            <div class="row mb-4">
                                <div class="col-12 text-center">
                                    <h6 class="fw-bold">PAGUE COM PIX</h6>
                                    <?php
                                    ob_start();
                                    QRCode::png(trim($pix['qrcode']), null, 'M', 5);
                                    $imageString = base64_encode(ob_get_contents());
                                    ob_end_clean();
                                    ?>
                                    <img src="data:image/png;base64,<?php echo $imageString; ?>" class="qr-code-img mb-3" alt="QR Code Pix" />

                                    <div class="input-group mx-auto" style="max-width: 450px;">
                                        <textarea id="pix-copiar-colar" style="min-height:50px; resize: none;" readonly class="form-control text-center"><?php echo $pix['qrcode']; ?></textarea>
                                        <button onclick="copiarCodigo('pix-copiar-colar', 'Pix Copia e Cola copiado com sucesso!');" class="btn btn-success" type="button"><i class="fa fa-copy me-1"></i> Copiar Pix</button>
                                    </div>
                                    <small class="form-text text-muted mt-1">Use a funo Copia e Cola no seu aplicativo bancrio.</small>
                                </div>
                            </div>
                        <?php } ?>

                        <!-- CDIGO DE BARRAS (apenas para dispositivos maiores) -->
                        <?php
                        $codigo_barra = $fatura['codigo_barras'] ?? $fatura['fchequeagcc'] ?? null;
                        if (!empty($codigo_barra)) {
                        ?>
                            <div class="row d-sm-block" style="border-top: 1px solid #CCC; margin-top: 15px;">
                                <div class="col-12 code-box">
                                    <h6 class="fw-bold">CDIGO DE BARRAS DO BOLETO:</h6>
                                    <p class="mb-0"><?php echo $classBank->geraCodigoBarra($codigo_barra); ?></p>
                                </div>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            <?php } ?>
            <!-- FIM DA SEO DE PAGAMENTO -->

            <!-- FOOTER -->
            <div class="invoice-footer text-center bg-light p-3 border-top">
                <p class="text-center m-b-5 fw-bold mb-1">
                    <?php echo ucwords($dados_provedor['nome']); ?> - CNPJ: <?php echo $dados_provedor['cnpj']; ?>
                </p>
                <p class="text-center small text-muted mb-0">
                    <span class="m-r-10"><i class="fa fa-globe me-1"></i> <?php echo $dados_provedor['site']; ?></span> |
                    <span class="m-r-10"><i class="fa fa-phone me-1"></i> <?php echo $dados_provedor['fone']; ?></span> |
                    <span class="m-r-10"><i class="fa fa-envelope me-1"></i> <?php echo $dados_provedor['email']; ?></span>
                </p>
            </div>
        </div>

        <!-- Break de pgina para impresso (mantido) -->
        <div class="pagebreak"> </div>

        <script>
            // FUNO DE CPIA APRIMORADA COM TOASTR
            function copiarCodigo(elementId, mensagem) {
                var elemento = document.getElementById(elementId);

                // Tenta usar a API moderna (Clipboard API)
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    window.getSelection().removeAllRanges();
                    navigator.clipboard.writeText(elemento.value).then(function() {
                        toastr.success(mensagem, 'Copiado!', {
                            closeButton: true,
                            progressBar: true
                        });
                    }, function(err) {
                        console.error('Falha ao copiar usando Clipboard API: ', err);
                        // Fallback para a API antiga
                        fallbackCopy(elemento, mensagem);
                    });
                } else {
                    // Fallback para a API antiga
                    fallbackCopy(elemento, mensagem);
                }
            }

            function fallbackCopy(elemento, mensagem) {
                elemento.select();
                var range = document.createRange();
                range.selectNode(elemento);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);

                try {
                    var copiado = document.execCommand('copy');
                    if (copiado) {
                        toastr.success(mensagem, 'Copiado!', {
                            closeButton: true,
                            progressBar: true
                        });
                    } else {
                        toastr.error('Falha ao copiar o cdigo. Tente selecionar manualmente.', 'Erro de Cpia');
                    }
                } catch (err) {
                    toastr.error('Erro ao copiar: ' + err, 'Erro de Cpia');
                }
                window.getSelection().removeAllRanges();
            }
        </script>

    </div>
</body>

</html>
</file>

<file path="payisp/composer.json">
{
	"name": "dg/mysql-dump",
	"description": "MySQL database dump.",
	"keywords": ["mysql"],
	"homepage": "https://github.com/dg/MySQL-dump",
	"license": ["BSD-3-Clause"],
	"authors": [
		{
			"name": "David Grudl",
			"homepage": "http://davidgrudl.com"
		}
	],
	"require": {
		"php": ">=5.6",
		"robrichards/xmlseclibs": "^3.1"
	},
	"autoload": {
		"classmap": ["src/"]
	}
}
</file>

<file path="payisp/configuracoes.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php $erro_list = array(); ?>
<?php $breadcrumbActual = 'Configuraes PAY ISP'; ?>
<?php include 'lay.header.php'; ?>
<?php
//atualizar 
if (valor_antigo_payisp('acao') == 'atualizar') {
	//query 
	$sql = "UPDATE `payisp_configuracoes` SET registros_pagina = '" . valor_antigo_payisp('registros_pagina') . "', ativar_cartao = '" . valor_antigo_payisp('ativar_cartao') . "', gateway = '" . valor_antigo_payisp('gateway') . "', taxa = '" . valor_antigo_payisp('taxa') . "', public = '" . valor_antigo_payisp('public') . "', token = '" . valor_antigo_payisp('token') . "', tempo_cron = '" . valor_antigo_payisp('tempo_cron') . "', fatura_inicial = '" . valor_antigo_payisp('fatura_inicial') . "' WHERE id = 1;";
	$mysqli->query($sql);
	//reload 
	$dados_configuracoes = configuracoes_payisp();
}
//tem atualizaao 
$atualizado = addon_atualizado_payisp();
?>

<body>

	<div style="height: 15px;"></div>
	<?php include('../../topo.php'); ?>

	<div class="container-fluid pt-3">

		<!-- Ttulo e Verso -->
		<div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
			<h2 class="h4 mb-0"><i class="fa fa-cogs text-primary me-2"></i> Configuraes PAY ISP</h2>
			<span class="badge bg-secondary"><?php echo $nome_do_sistema; ?> (<?php echo $versao_publica_addon; ?>)</span>
		</div>

		<!-- ALERTA DE ATUALIZAO -->
		<?php if (isset($atualizado['atualizado']) && $atualizado['atualizado'] == 1) { ?>
			<div class="alert alert-danger d-flex align-items-center" role="alert">
				<i class="fa fa-exclamation-triangle me-2 fs-5"></i>
				<div>
					<strong>ALERTA DE ATUALIZAO:</strong> Existe uma nova verso (<?php echo $atualizado['nova']; ?>) do seu Addon. Verso atual: <?php echo $atualizado['atual']; ?>. Faa o backup e <a href="https://www.mkauth-addons.com.br/knowledgebase.php?article=19" target="_blank" class="alert-link">clique aqui</a> para seguir as instrues de atualizao.
				</div>
			</div>
		<?php } ?>

		<!-- Mensagens de Erro -->
		<?php if (count($erro_list) > 0) { ?>
			<div class="alert alert-danger alert-dismissible fade show" role="alert">
				<h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros de Validao:</h5>
				<ul class="mb-0">
					<?php foreach ($erro_list as $erro) { ?>
						<li><?php echo $erro; ?><br></li>
					<?php } ?>
				</ul>
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
		<?php } ?>

		<!-- Tabs de Navegao -->
		<ul id="tabs" class="nav nav-tabs nav-justified mt-4" role="tablist">
			<li class="nav-item" role="presentation">
				<button class="nav-link active" id="config-tab" data-bs-toggle="tab" data-bs-target="#config-tab-pane" type="button" role="tab" aria-controls="config-tab-pane" aria-selected="true"><i class="fa fa-sliders-h me-1"></i> Configuraes Gerais</button>
			</li>
			<?php if (file_exists('/opt/mk-auth/admin/conf_zap_msg.hhvm')) { ?>
				<li class="nav-item" role="presentation">
					<button class="nav-link" id="whatsapp-tab" data-bs-toggle="tab" data-bs-target="#whatsapp-tab-pane" type="button" role="tab" aria-controls="whatsapp-tab-pane" aria-selected="false"><i class="fab fa-whatsapp me-1"></i> Avisos Whatsapp</button>
				</li>
			<?php } ?>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="mysql-tab" data-bs-toggle="tab" data-bs-target="#mysql-tab-pane" type="button" role="tab" aria-controls="mysql-tab-pane" aria-selected="false"><i class="fa fa-database me-1"></i> Backups (Mysql)</button>
			</li>
		</ul>

		<!-- Contedo das Tabs -->
		<div class="card shadow-sm mb-5" style="border-radius: 0 0 8px 8px; border-top: none;">
			<div class="card-body">
				<div class="tab-content">

					<!-- TAB 1: Configuraes Gerais -->
					<div class="tab-pane fade show active" id="config-tab-pane" role="tabpanel" aria-labelledby="config-tab" tabindex="0">
						<div class="alert alert-info mt-3" role="alert"><i class="fa fa-info-circle me-1"></i> Ajustes globais do PAY ISP. Para ver o histrico de alteraes (changelog), <a onclick="abrirPopup_payisp('changelog.php',700,700);" class="alert-link">clique aqui</a>.</div>

						<form onsubmit="bloquear_tela_payisp();" id="configuracao" class="needs-validation" method="POST" action="configuracoes.php" novalidate>
							<input type="hidden" name="acao" value="atualizar">

							<h5 class="mt-4 border-bottom pb-2">Configuraes de Sistema e Fatura</h5>
							<div class="row">
								<div class="col-md-4 mb-3">
									<label for="registros_pagina" class="form-label">Qtd. Registros Pgina <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('registros_pagina', $dados_configuracoes['registros_pagina']); ?>" type="number" class="form-control" id="registros_pagina" name="registros_pagina" required>
									<div class="form-text text-muted">Quantidade de registros exibidos por pgina.</div>
								</div>
								<div class="col-md-4 mb-3">
									<label for="tempo_cron" class="form-label">Tempo entre Crons (horas) <span class="text-danger">*</span></label>
									<input min="1" max="12" value="<?php echo valor_antigo_payisp('tempo_cron', $dados_configuracoes['tempo_cron']); ?>" type="number" class="form-control" id="tempo_cron" name="tempo_cron" required>
									<div class="form-text text-muted">Tempo (em horas) entre uma checagem de processamento e outra.</div>
								</div>
								<div class="col-md-4 mb-3">
									<label for="fatura_inicial" class="form-label">Fatura Inicial para Registro <span class="text-danger">*</span></label>
									<input value="<?php echo valor_antigo_payisp('fatura_inicial', $dados_configuracoes['fatura_inicial']); ?>" type="number" class="form-control" id="fatura_inicial" name="fatura_inicial" required>
									<div class="form-text text-muted">A partir de qual nmero de fatura o registro deve ser iniciado.</div>
								</div>
							</div>

							<div class="row"> 
								<div class="col-12">
									<div class="alert alert-warning" role="alert">
										<i class="fa fa-exclamation-triangle me-1"></i> Aps alterar as configuraes de fatura inicial ou tempo entre crons, certifique-se de que o servio cron do seu servidor esteja devidamente configurado para executar o script de processamento de faturas do PAY ISP. Isso garantir que as faturas sejam geradas e processadas corretamente conforme as novas configuraes, caso queira consulta o crons configurados em seu sistema use o comando <code>crontab -l</code> no terminal do seu servidor.
									</div>
								</div>
							</div>

							<h5 class="mt-4 border-bottom pb-2">Configuraes de Carto de Crdito</h5>
							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="ativar_cartao" class="form-label">Ativar Carto (Requer HTTPS) <span class="text-danger">*</span></label>
									<select class="form-select" id="ativar_cartao" name="ativar_cartao" required>
										<option value="0" <?php echo valor_antigo_payisp('ativar_cartao', $dados_configuracoes['ativar_cartao']) == 0 ? ' selected' : ''; ?>>No</option>
										<option value="1" <?php echo valor_antigo_payisp('ativar_cartao', $dados_configuracoes['ativar_cartao']) == 1 ? ' selected' : ''; ?>>Sim</option>
									</select>
									<div class="form-text text-muted">Ativa a opo de pagamento por carto de crdito.</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="gateway" class="form-label">Gateway Carto Ativo</label>
									<select class="form-select" id="gateway" name="gateway">
										<option value="" <?php echo valor_antigo_payisp('gateway', $dados_configuracoes['gateway']) == '' ? ' selected' : ''; ?>>Nenhum</option>
										<option value="mercadopago" <?php echo valor_antigo_payisp('gateway', $dados_configuracoes['gateway']) == 'mercadopago' ? ' selected' : ''; ?>>MercadoPago</option>
									</select>
									<div class="form-text text-muted">Selecione o provedor de pagamento por carto.</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="taxa" class="form-label">Taxa Carto (%)</label>
									<input value="<?php echo valor_antigo_payisp('taxa', $dados_configuracoes['taxa']); ?>" type="number" step="any" class="form-control" id="taxa" name="taxa">
									<div class="form-text text-muted">Taxa de recebimento em porcentagem (ser adicionada ao valor da fatura).</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="public" class="form-label">Login/ID/PublicKey Gateway Carto</label>
									<input value="<?php echo valor_antigo_payisp('public', $dados_configuracoes['public']); ?>" type="text" class="form-control" id="public" name="public">
									<div class="form-text text-muted">Chave pblica de integrao (ex: PublicKey do MercadoPago).</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="token" class="form-label">Token/Secret Gateway Carto</label>
									<input value="<?php echo valor_antigo_payisp('token', $dados_configuracoes['token']); ?>" type="text" class="form-control" id="token" name="token">
									<div class="form-text text-muted">Token ou chave secreta de integrao.</div>
								</div>
							</div>

							<button type="submit" class="btn btn-primary mt-3"><i class="fa fa-save me-2"></i> Atualizar Configuraes</button>
						</form>
					</div>

					<!-- TAB 2: Avisos WhatsApp -->
					<?php if (file_exists('/opt/mk-auth/admin/conf_zap_msg.hhvm')) { ?>
						<div class="tab-pane fade" id="whatsapp-tab-pane" role="tabpanel" aria-labelledby="whatsapp-tab" tabindex="1">
							<div class="alert alert-info mt-3" role="alert">
								<i class="fa fa-info-circle me-1"></i> Para verses do MK-Auth com suporte nativo a WhatsApp (Menu Opes > Servidor de WhatsApp), utilize os layouts de mensagem abaixo.  crucial que as mensagens sejam do tipo TEXTO (sem PDF em anexo) para integrao correta com o PAY ISP.
							</div>

							<h5 class="mt-4 border-bottom pb-2">Layouts de Mensagem (Copiar e Colar)</h5>
							<div class="row">
								<div class="col-md-6 mb-3">
									<strong>Mensagem faturas  expirar (Prximo Vencimento)</strong>
									<br>
									<textarea style="min-height:450px;" onfocus="this.select();" onmouseup="return false;" readonly class="form-control" rows="15">Ol *%nomecliente%*, sua fatura *%provedornome%* expira em *%venctitulo%*, no valor de *R$%valortitulo%*, pague a mesma at o vencimento e evite o bloqueio de seu acesso, use o link ou dados abaixo para pagamento.

*Link de Pagamento:*
<?php echo url_link_payisp(); ?>/admin/addons/payisp/whatsapp.php?uuid=%id@titulo%&titulo=%numerotitulo%

*Linha Digitvel Boleto:*
`%linhadig%`

*Pix Copiar/Colar:*
`%copiaecola%`

_Caso j o tenha pago desconsiderar!_

*Atenciosamente %provedornome%*
%provedorfone%
</textarea>
								</div>
								<div class="col-md-6 mb-3">
									<strong>Mensagem faturas expiradas (Vencidas)</strong>
									<br>
									<textarea style="min-height:450px;" onfocus="this.select();" onmouseup="return false;" readonly class="form-control" rows="15">Ol *%nomecliente%*, sua fatura *%provedornome%* expirou em *%venctitulo%*, no valor de *R$%valortitulo%*, pague a mesma agora mesmo e volte a navegar se seu acesso estiver bloqueado, use o link ou dados abaixo para pagamento.

*Link de Pagamento:*
<?php echo url_link_payisp(); ?>/admin/addons/payisp/whatsapp.php?uuid=%id@titulo%&titulo=%numerotitulo%

*Linha Digitvel Boleto:*
`%linhadig%`

*Pix Copiar/Colar:*
`%copiaecola%`

_Caso j o tenha pago desconsiderar!_

*Atenciosamente %provedornome%*
%provedorfone%
</textarea>
								</div>
								<div class="col-12">
									<p class="text-danger small mt-2">
										Ateno: Voc pode customizar os textos, mas deve manter as tags de dados (%nomecliente%, %id@titulo%, etc.) e as tags de Linha Digitvel e Pix.
									</p>
								</div>
							</div>
						</div>
					<?php } ?>

					<!-- TAB 3: Backups -->
					<div class="tab-pane fade" id="mysql-tab-pane" role="tabpanel" aria-labelledby="mysql-tab" tabindex="1">
						<div class="alert alert-info mt-3" role="alert"><i class="fa fa-info-circle me-1"></i> Crie backups dos ttulos emitidos e de todas as configuraes do seu PayISP.</div>

						<h5 class="mt-4 border-bottom pb-2">Gerenciamento de Backup</h5>
						<div class="row">
							<div class="col-md-12">
								<strong>Criar Novo Backup</strong>
								<br>
								<a onclick="bloquear_tela_payisp(); setTimeout(function() { location.href='configuracoes.php?tab=mysql'; }, 5000);" target="_blank" href="backup.php" class="btn btn-success mt-2">
									<i class="fa fa-download me-2"></i> Criar e Baixar Backup
								</a>
								<?php if (!empty($dados_configuracoes['ultimo_backup'])) { ?>
									<br><small class="text-muted mt-2 d-block">O ltimo backup gerado foi em: <?php echo $dados_configuracoes['ultimo_backup']; ?></small>
								<?php } ?>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>

	</div>

	<?php include('lay.footer.php'); ?>

	<!-- Script para ativar a aba correta aps o redirecionamento -->
	<?php if (isset($_GET['tab']) && !empty($_GET['tab'])) { ?>
		<script>
			document.addEventListener("DOMContentLoaded", function() {
				var tabElement = document.getElementById('<?php echo valor_antigo_payisp('tab'); ?>-tab');
				if (tabElement) {
					new bootstrap.Tab(tabElement).show();
				}
			});
		</script>
	<?php } ?>

</body>

</html>
</file>

<file path="payisp/cron.baixa.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
$logs = array();
//lista de bancos ativos 
$data_vencimento = date('Y-m-d');
$bancos = bancos_ativos_payisp();
if (count($bancos) == 0) {
	$logs[] = 'Cron Baixa - Nenhum banco ativado em PAY ISP!';
}
//lista os titulos por bancos
$bipass = false;
foreach ($bancos as $id_banco_bd_mkauth => $banco) {
	//filtro banco 
	if (isset($_GET['banco']) && !empty($_GET['banco'])) {
		if ($_GET['banco'] != $banco['cod_banco']) {
			continue;
		} else {
			$bipass = true;
		}
	}
	//lista os titulos em abertos
	$limite_cron = isset($banco['qtd_check_cron']) ? $banco['qtd_check_cron'] : 30;
	$sql_boletos = "SELECT * FROM `sis_lanc` WHERE deltitulo = 1 AND datadel BETWEEN NOW() - INTERVAL 15 DAY AND NOW() AND (status = 'aberto' || status = 'vencido') AND fcartaonumero = '" . $banco['cod_banco'] . "' AND fchequenumero = 'registrado' ORDER BY RAND() LIMIT " . (($sandbox) ? '2' : $limite_cron) . "";
	$results = $mysqli->query($sql_boletos);
	if ($results->num_rows == 0) {
		$logs[] = 'Cron Baixa - Nenhum boleto removido pendente de baixa neste banco [' . $banco['cod_banco'] . '].';
	}
	$sucesso = array();
	while ($row = $results->fetch_array()) {
		//evita consultas em excesso
		if ((int)$row['url'] <= time() || $bipass == true) {
			//obj 
			$obj = class_banco_payisp($banco['cod_banco']);
			if (is_object($obj) && method_exists($obj, 'baixa')) {
				//consulta
				$boleto = $obj->baixa($row['fcartaobandeira'], $banco);
				//prazo espera
				$tempo_espera = time();
				$tempo_espera += $prazo_espera_cron * 60 * 60;
				//ok
				if (isset($boleto['erro']) && $boleto['erro'] == false) {
					//sucesso 
					$sucesso[] = (int)$row['id'];
					//atualiza a fatura mkauth
					$sql = "UPDATE sis_lanc SET fchequenumero = 'baixado' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//atualiza a fatura em si
					$sql = "UPDATE payisp_faturas SET status = 'baixado' WHERE fatura_mkauth = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//cria o log 
					$sql = "INSERT INTO payisp_baixas SET titulo = '" . (int)$row['id'] . "', transacao = '" . $row['fcartaobandeira'] . "', banco = '" . $banco['cod_banco'] . "', log = '" . print_r($boleto['resultado'], true) . "';";
					$mysqli->query($sql);
					//ok 
					$logs[] = 'Cron Baixa - Titulo ' . (int)$row['id'] . ' Baixado [' . $banco['cod_banco'] . '].';
				} else {
					//coloca em espera 
					$sql = "UPDATE sis_lanc SET url = '" . $tempo_espera . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//erro 
					$logs[] = 'Cron Baixa - Titulo ' . (int)$row['id'] . ' Erro ao Baixar [' . $banco['cod_banco'] . '].';
				}
			} else {
				//sem metodo
				$logs[] = 'Cron Baixa - Banco sem funcionalidade de baixa [' . $banco['cod_banco'] . '].';
			}
		} else {
			//em espera 
			$logs[] = 'Cron Baixa - Titulo ' . (int)$row['id'] . ' Em Espera (Prox. Check ' . date('d/m/Y H:i', (int)$row['url']) . ') [' . $banco['cod_banco'] . '].';
		}
	}
	//log
	if (count($sucesso) > 0) {
		criar_log_mkauth_payisp('[CRON] Titulo(s) ' . implode(',', $sucesso) . ' Baixados(s) via PAY ISP [' . $banco['cod_banco'] . '].', 'admin');
	}
}
//res
die(json_encode($logs));
</file>

<file path="payisp/cron.geral.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
$logs = array();
//lista de bancos ativos 
$bancos = bancos_ativos_payisp();
if (count($bancos) == 0) {
	$logs[] = 'Cron Geral - Nenhum banco ativado em PAY ISP!';
}
//lista os titulos por bancos
$bipass = false;
foreach ($bancos as $id_banco_bd_mkauth => $banco) {
	//filtro banco 
	if (isset($_GET['banco']) && !empty($_GET['banco'])) {
		if ($_GET['banco'] != $banco['cod_banco']) {
			continue;
		} else {
			$bipass = true;
		}
	}
	//lista os titulos em abertos
	$limite_cron = isset($banco['qtd_check_cron']) ? $banco['qtd_check_cron'] : 30;
	$sql_boletos = "SELECT * FROM `sis_lanc` WHERE deltitulo = 0 AND status = 'aberto' AND fcartaonumero = '" . $banco['cod_banco'] . "' AND fchequenumero = 'registrado' ORDER BY RAND() LIMIT " . (($sandbox) ? '1' : $limite_cron) . "";
	$results = $mysqli->query($sql_boletos);
	if ($results->num_rows == 0) {
		$logs[] = 'Cron Geral - Nenhum boleto aberto pendente de consulta neste banco [' . $banco['cod_banco'] . '].';
	}
	$sucesso = array();
	while ($row = $results->fetch_array()) {
		//evita consultas em excesso
		if ((int)$row['url'] <= time() || $bipass == true) {
			//obj 
			$obj = class_banco_payisp($banco['cod_banco']);
			if (is_object($obj) && method_exists($obj, 'cron')) {
				//consulta
				$boleto = $obj->cron($row['fcartaobandeira'], $banco);
				//prazo espera
				$tempo_espera = time();
				$tempo_espera += $prazo_espera_cron * 60 * 60;
				//se recebido
				if (isset($boleto['situacao']) && (strtoupper($boleto['situacao']) == 'RECEBIDO' || strtoupper($boleto['situacao']) == 'LIQUIDADO' || strtoupper($boleto['situacao']) == 'PAID')) {
					//dados
					$origem = isset($boleto['origem']) ? $boleto['origem'] : 'BOLETO';
					$valor_recebido = isset($boleto['valor']) ? $boleto['valor'] : $row['valor'];
					$data_hora = isset($boleto['data']) ? $boleto['data'] : date('Y-m-d H:i:s');
					if ($origem == 'PIX') {
						$tarifa = (float)$banco['tarifa_pix'];
					} else {
						$tarifa = (float)$banco['tarifa_boleto'];
					}
					if ($valor_recebido < $row['valor']) {
						$desconto = $row['valor'] - $valor_recebido;
					} else {
						$desconto = 0.00;
					}
					//atualiza a fatura mkauth
					$sql = "UPDATE sis_lanc SET formapag = 'dinheiro', `status` = 'pago', num_recibos = 1, datapag = '" . $data_hora . "', coletor = 'cron', valorpag = '" . $valor_recebido . "', tarifa_paga = '" . $tarifa . "', valordesc = '" . $desconto . "', recibo = '" . substr(md5((int)$row['id']), -8) . "', url = '" . $tempo_espera . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//atualiza a fatura addon
					$sql = "UPDATE payisp_faturas SET status = 'pago', valor_pago = '" . $valor_recebido . "', data_pagamento = '" . $data_hora . "', valor_desconto = '" . $desconto . "' WHERE cod_banco = '" . $banco['cod_banco'] . "' AND fatura_mkauth = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//cria o registro de entrada do caixa 
					$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,entrada,tipomov,planodecontas) VALUES ('" . uniqid() . "', '" . $banco['cod_banco'] . "', '" . $data_hora . "', 'Recebimento do titulo " . (int)$row['id'] . " / " . $row['login'] . " [" . $banco['cod_banco'] . "]', '" . ($valor_recebido - $tarifa) . "', 'aut', 'Outros')";
					$mysqli->query($sql);
					//tarifa do titulo se existir 
					if ($tarifa > 0) {
						$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,saida,tipomov,planodecontas) VALUES ('" . uniqid() . "', '" . $banco['cod_banco'] . "', '" . $data_hora . "', 'Tarifa titulo " . (int)$row['id'] . " / " . $row['login'] . " [" . $banco['cod_banco'] . "]', '" . $tarifa . "', 'aut', 'Outros')";
						$mysqli->query($sql);
					}
					//sucesso 
					$sucesso[] = (int)$row['id'];
					//ok
					$logs[] = 'Cron Geral - Titulo ' . (int)$row['id'] . ' Recebido [' . $banco['cod_banco'] . '].';
				} elseif (isset($boleto['situacao'])) {
					//coloca em espera 
					$sql = "UPDATE sis_lanc SET url = '" . $tempo_espera . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//aguardando
					$logs[] = 'Cron Geral - Titulo ' . (int)$row['id'] . ' -> ' . $boleto['situacao'] . ' -> [' . $banco['cod_banco'] . '].';
				} else {
					//erro
					$logs[] = 'Cron Geral - Titulo ' . (int)$row['id'] . ' Erro ' . $boleto['status'] . ' [' . $banco['cod_banco'] . '].';
				}
			} else {
				//sem metodo
				$logs[] = 'Cron Geral - Banco sem funcionalidade de consulta [' . $banco['cod_banco'] . '].';
			}
		} else {
			//em espera 
			$logs[] = 'Cron Geral - Titulo ' . (int)$row['id'] . ' Em Espera (Prox. Check ' . date('d/m/Y H:i', (int)$row['url']) . ') [' . $banco['cod_banco'] . '].';
		}
	}
	//log
	if (count($sucesso) > 0) {
		criar_log_mkauth_payisp('[CRON] Titulo(s) ' . implode(',', $sucesso) . ' Recebido(s) via PAY ISP [' . $banco['cod_banco'] . '].', 'admin');
	}
}
//res
die(json_encode($logs));
</file>

<file path="payisp/cron.mercadopago.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
$logs = array();
//dados mp 
$request_body = file_get_contents('php://input');
$data = @json_decode($request_body, true);
//processa as faturas mercadopago
if (isset($data['data']['id'])) {
	$sql = "SELECT * FROM `sis_lanc` WHERE deltitulo = 0 AND status = 'aberto' AND formapag = 'mercadopago' AND chave_juno = '" . escape_payisp($data['data']['id']) . "' LIMIT 1";
} else {
	$sql = "SELECT * FROM `sis_lanc` WHERE deltitulo = 0 AND status = 'aberto' AND formapag = 'mercadopago' AND chave_juno != '' AND processamento >= DATE(NOW() - INTERVAL 7 DAY) ORDER BY RAND() LIMIT 50";
}
$results = $mysqli->query($sql);
if ($results->num_rows == 0) {
	$logs[] = 'Cron MercadoPago - Nenhuma fatura a processar via MercadoPago.';
}
$sucesso = array();
while ($row = $results->fetch_array()) {
	//consulta 
	$curl = curl_init();
	curl_setopt($curl, CURLOPT_URL, 'https://api.mercadopago.com/v1/payments/' . trim($row['chave_juno']) . '?access_token=' . trim($dados_configuracoes['token']) . '');
	curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
	curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);
	curl_setopt($curl, CURLOPT_HTTPHEADER, array(
		"Accept: application/json",
		"Content-Type: application/json",
		"X-Idempotency-Key: mp-key-" . time() . ""
	));
	curl_setopt($curl, CURLOPT_POST, false);
	curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 10);
	curl_setopt($curl, CURLOPT_TIMEOUT, 40);
	curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
	$resultado = curl_exec($curl);
	$httpcode  = curl_getinfo($curl, CURLINFO_HTTP_CODE);
	$erro      = curl_error($curl);
	curl_close($curl);
	$payment = json_decode($resultado, true);
	if ($httpcode == 200 && isset($payment['id'])) {
		if ($payment['status'] == 'approved') {
			//atualiza a fatura mkauth
			$sql = "UPDATE sis_lanc SET formapag = 'mercadopago', `status` = 'pago', num_recibos = 1, datapag = '" . date('Y-m-d H:i:s') . "', coletor = 'mercadopago', valorpag = '" . $payment['transaction_amount'] . "', tarifa_paga = '0', valordesc = '0', recibo = '" . substr(md5((int)$row['id']), -8) . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
			$mysqli->query($sql);
			//atualiza a fatura addon
			$sql = "UPDATE payisp_faturas SET status = 'pago', valor_pago = '" . $payment['transaction_amount'] . "', data_pagamento = '" . date('Y-m-d H:i:s') . "', desconto = '0' WHERE fatura_mkauth = '" . (int)$row['id'] . "' LIMIT 1";
			$mysqli->query($sql);
			//cria o registro de entrada do caixa 
			$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,entrada,tipomov,planodecontas) VALUES ('" . uniqid() . "', 'mercadopago', '" . date('Y-m-d H:i:s') . "', 'Recebimento do titulo " . (int)$row['id'] . " / " . $row['login'] . " [mercadopago]', '" . $payment['transaction_amount'] . "', 'aut', 'Outros')";
			$mysqli->query($sql);
			//log 
			criar_log_mkauth_payisp('[API] Titulo ' . (int)$row['id'] . ' Recebido via PAY ISP [mercadopago].', 'admin');
			//ok
			$logs[] = 'Cron MercadoPago - Fatura ' . $row['id'] . ' paga.';
		} else {
			//erro
			$logs[] = 'Cron MercadoPago - Fatura ' . $row['id'] . ' em processamento - status ' . $payment['status'] . '.';
		}
	} else {
		//erro
		$logs[] = 'Cron MercadoPago - Erro ao consultar fatura ' . $row['id'] . ' - http ' . $httpcode . '.';
	}
}
die(json_encode($logs));
</file>

<file path="payisp/cron.registro.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
$logs = array();
//lista de bancos ativos 
$bancos = bancos_ativos_payisp();
if (count($bancos) == 0) {
	$logs[] = 'Cron Registro - Nenhum banco ativado em PAY ISP!';
}
//lista os titulos por bancos
foreach ($bancos as $id_banco_bd_mkauth => $banco) {
	//lista os titulos sem registro e tenta fazer o registro 
	$limite_cron = isset($banco['qtd_check_cron']) ? $banco['qtd_check_cron'] : 30;
	$sql = "SELECT * FROM `vtab_titulos` WHERE titulo >= " . (int)$id_fatura_inicial_cron . " AND deltitulo = 0 AND status = 'aberto' AND (fcartaobandeira = '' OR fcartaobandeira IS NULL) AND (conta = 0 || conta = " . $id_banco_bd_mkauth . ") LIMIT " . (($sandbox) ? '1' : $limite_cron) . "";
	$results = $mysqli->query($sql);
	if ($results->num_rows == 0) {
		$logs[] = 'Cron Registro >= ' . $id_fatura_inicial_cron . ' - Nenhum boleto pendente de registro neste banco [' . $banco['cod_banco'] . '].';
	} elseif ($banco['auto_registro'] == 0) {
		$logs[] = 'Cron Registro >= ' . $id_fatura_inicial_cron . ' - Registro automatico desativado neste banco [' . $banco['cod_banco'] . '].';
	} else {
		//lista os titulos e tenta fazer o registro
		$sucesso = array();
		while ($row = $results->fetch_array()) {
			//class de registro do boleto 
			$obj = class_banco_payisp($banco['cod_banco']);
			if (is_object($obj) && method_exists($obj, 'registrar')) {
				//tenta fazer o registro 
				$banco_mk = dados_banco_mkauth_payisp($id_banco_bd_mkauth);
				//inclui adicionais ao total de registro
				$total_inicial = $row['valor'];
				$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
				$results_adicionais = $mysqli->query($sql_adicionais);
				while ($rowad = $results_adicionais->fetch_array()) {
					if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
						$total_inicial -= $rowad['valor'];
					} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
						$total_inicial += $rowad['valor'];
					}
				}
				$row['valor'] = $total_inicial;
				//registro
				$resultado = $obj->registrar($row, $banco, $banco_mk);
				if (isset($resultado['erro']) && $resultado['erro'] == false) {
					//cria o pix 
					if (isset($resultado['qrcode']) && !empty($resultado['qrcode'])) {
						$sql = "INSERT INTO sis_qrpix SET titulo = '" . $row['uuid_lanc'] . "', qrcode = '" . $resultado['qrcode'] . "'";
						$mysqli->query($sql);
					}
					//atualiza o lancamento
					$sql = "UPDATE sis_lanc SET nossonum = '" . $resultado['nosso_numero'] . "', linhadig = '" . preg_replace('/\D/', '', $resultado['linha']) . "', num_recibos = 1, fcartaobandeira = '" . $resultado['tid'] . "', fcartaonumero = '" . $banco['cod_banco'] . "', id_empresa = '" . $resultado['nosso_numero'] . "', fchequenumero = 'registrado', fchequebanco = '" . preg_replace('/\D/', '', $resultado['linha']) . "', fchequeagcc = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
					$mysqli->query($sql);
					//codigo de barras 
					$sql = "UPDATE sis_lanc SET codigo_barras = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
					$mysqli->query($sql);
					//cria o registro individual
					$sql = "INSERT INTO payisp_faturas SET cod_banco = '" . $banco['cod_banco'] . "', nosso_numero = '" . $resultado['nosso_numero'] . "', linha = '" . preg_replace('/\D/', '', $resultado['linha']) . "', cod_barra = '" . preg_replace('/\D/', '', $resultado['barras']) . "', fatura_mkauth = '" . $row['titulo'] . "', valor_fatura = '" . number_format($row['valor'], 2, '.', '') . "', valor_desconto = '" . number_format($resultado['desconto'], 2, '.', '') . "', tipo_desconto = '" . $resultado['tipo_desconto'] . "', status = 'aberto', data_desconto = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_validade = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_emissao = '" . date('Y-m-d') . "', pix = '" . $resultado['qrcode'] . "', txid = '" . $resultado['txid'] . "', cod = '" . $resultado['tid'] . "'";
					$mysqli->query($sql);
					$sucesso[] = $row['titulo'];
					//ok
					$logs[] = $resultado['log'];
				} else {
					//erro
					$logs[] = $resultado['log'];
				}
			} else {
				//sem metodo
				$logs[] = 'Cron Registro >= ' . $id_fatura_inicial_cron . ' - Banco sem mtodo de registro [' . $banco['cod_banco'] . '].';
			}
		}
		//log
		if (count($sucesso) > 0) {
			criar_log_mkauth_payisp('Cron Registro >= ' . $id_fatura_inicial_cron . ' - Titulo(s) ' . implode(',', $sucesso) . ' Registados Cron via PAY ISP [' . $banco['cod_banco'] . '].', 'admin');
		}
	}
}
//log 
$logs_payisp->putLog(print_r($logs, true));
//res
die(json_encode($logs));
</file>

<file path="payisp/cron.vencidos.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
$logs = array();
//lista de bancos ativos 
$data_vencimento = date('Y-m-d');
$bancos = bancos_ativos_payisp();
if (count($bancos) == 0) {
	$logs[] = 'Cron Vencidos - Nenhum banco ativado em PAY ISP!';
}
//lista os titulos por bancos
$bipass = false;
foreach ($bancos as $id_banco_bd_mkauth => $banco) {
	//filtro banco 
	if (isset($_GET['banco']) && !empty($_GET['banco'])) {
		if ($_GET['banco'] != $banco['cod_banco']) {
			continue;
		} else {
			$bipass = true;
		}
	}
	//lista os titulos em abertos
	$limite_cron = isset($banco['qtd_check_cron']) ? $banco['qtd_check_cron'] : 30;
	$sql_boletos = "SELECT * FROM `sis_lanc` WHERE deltitulo = 0 AND (status = 'aberto' || status = 'vencido') AND fcartaonumero = '" . $banco['cod_banco'] . "' AND fchequenumero = 'registrado' AND datavenc <= '" . $data_vencimento . "' ORDER BY RAND() LIMIT " . (($sandbox) ? '1' : $limite_cron) . "";
	$results = $mysqli->query($sql_boletos);
	if ($results->num_rows == 0) {
		$logs[] = 'Cron Vencidos - Nenhum boleto vencido pendente de consulta neste banco [' . $banco['cod_banco'] . '].';
	}
	$sucesso = array();
	while ($row = $results->fetch_array()) {
		//evita consultas em excesso
		if ((int)$row['url'] <= time() || $bipass == true) {
			//obj 
			$obj = class_banco_payisp($banco['cod_banco']);
			if (is_object($obj) && method_exists($obj, 'cron')) {
				//consulta
				$boleto = $obj->cron($row['fcartaobandeira'], $banco);
				//prazo espera
				$tempo_espera = time();
				$tempo_espera += $prazo_espera_cron * 60 * 60;
				//se recebido
				if (isset($boleto['situacao']) && (strtoupper($boleto['situacao']) == 'RECEBIDO' || strtoupper($boleto['situacao']) == 'LIQUIDADO' || strtoupper($boleto['situacao']) == 'PAID')) {
					//dados
					$origem = isset($boleto['origem']) ? $boleto['origem'] : 'BOLETO';
					$valor_recebido = isset($boleto['valor']) ? $boleto['valor'] : $row['valor'];
					$data_hora = isset($boleto['data']) ? $boleto['data'] : date('Y-m-d H:i:s');
					if ($origem == 'PIX') {
						$tarifa = (float)$banco['tarifa_pix'];
					} else {
						$tarifa = (float)$banco['tarifa_boleto'];
					}
					if ($valor_recebido < $row['valor']) {
						$desconto = $row['valor'] - $valor_recebido;
					} else {
						$desconto = 0.00;
					}
					//atualiza a fatura mkauth
					$sql = "UPDATE sis_lanc SET formapag = 'dinheiro', `status` = 'pago', num_recibos = 1, datapag = '" . $data_hora . "', coletor = 'cron', valorpag = '" . $valor_recebido . "', tarifa_paga = '" . $tarifa . "', valordesc = '" . $desconto . "', recibo = '" . substr(md5((int)$row['id']), -8) . "', url = '" . $tempo_espera . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//atualiza a fatura addon
					$sql = "UPDATE payisp_faturas SET status = 'pago', valor_pago = '" . $valor_recebido . "', data_pagamento = '" . $data_hora . "', valor_desconto = '" . $desconto . "' WHERE cod_banco = '" . $banco['cod_banco'] . "' AND fatura_mkauth = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//cria o registro de entrada do caixa 
					$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,entrada,tipomov,planodecontas) VALUES ('" . uniqid() . "', '" . $banco['cod_banco'] . "', '" . $data_hora . "', 'Recebimento do titulo " . (int)$row['id'] . " / " . $row['login'] . " [" . $banco['cod_banco'] . "]', '" . ($valor_recebido - $tarifa) . "', 'aut', 'Outros')";
					$mysqli->query($sql);
					//tarifa do titulo se existir 
					if ($tarifa > 0) {
						$sql = "INSERT INTO sis_caixa (uuid_caixa,usuario,data ,historico,saida,tipomov,planodecontas) VALUES ('" . uniqid() . "', '" . $banco['cod_banco'] . "', '" . $data_hora . "', 'Tarifa titulo " . (int)$row['id'] . " / " . $row['login'] . " [" . $banco['cod_banco'] . "]', '" . $tarifa . "', 'aut', 'Outros')";
						$mysqli->query($sql);
					}
					//sucesso 
					$sucesso[] = (int)$row['id'];
					//ok
					$logs[] = 'Cron Vencidos - Titulo ' . (int)$row['id'] . ' Recebido [' . $banco['cod_banco'] . '].';
				} elseif (isset($boleto['situacao'])) {
					//coloca em espera 
					$sql = "UPDATE sis_lanc SET url = '" . $tempo_espera . "' WHERE id = '" . (int)$row['id'] . "' LIMIT 1";
					$mysqli->query($sql);
					//aguardando
					$logs[] = 'Cron Vencidos - Titulo ' . (int)$row['id'] . ' -> ' . $boleto['situacao'] . ' -> [' . $banco['cod_banco'] . '].';
				} else {
					//erro
					$logs[] = 'Cron Vencidos - Titulo ' . (int)$row['id'] . ' Erro ' . $boleto['status'] . ' [' . $banco['cod_banco'] . '].';
				}
			} else {
				//sem metodo
				$logs[] = 'Cron Vencidos - Banco sem funcionalidade de consulta [' . $banco['cod_banco'] . '].';
			}
		} else {
			//em espera 
			$logs[] = 'Cron Vencidos - Titulo ' . (int)$row['id'] . ' Em Espera (Prox. Check ' . date('d/m/Y H:i', (int)$row['url']) . ') [' . $banco['cod_banco'] . '].';
		}
	}
	//log
	if (count($sucesso) > 0) {
		criar_log_mkauth_payisp('[CRON] Titulo(s) ' . implode(',', $sucesso) . ' Recebido(s) via PAY ISP [' . $banco['cod_banco'] . '].', 'admin');
	}
}
//res
die(json_encode($logs));
</file>

<file path="payisp/faturas.index.php">
<?php require_once 'init.php'; ?>
<?php
//registros por pagina 
$total_reg_por_pagina = $quantidade_registros_por_pagina;
//paginacao 
$pagina = isset($_GET['pagina']) ? (int)$_GET['pagina'] : 1;
$inicio = $pagina - 1;
$inicio = $inicio * $total_reg_por_pagina;
//filtros 
$tag = '';
$where = '';
$order = "ORDER BY a.titulo DESC";
//filtro por tag 
if (isset($_GET['tag']) && !empty($_GET['tag'])) {
	$tag .= '&tag=' . $_GET['tag'] . '';
	$where .= " AND (a.titulo LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.nossonum LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.fcartaonumero LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.nome LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.email LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.endereco LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.bairro LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.cidade LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.login LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.cpf_cnpj LIKE '%" . escape_payisp($_GET['tag']) . "%')";
}
//filtros por status
$status_atual = 'todas';
if (isset($_GET['status']) && !empty($_GET['status'])) {
	$status_atual = trim($_GET['status']);
	$tag .= '&status=' . $status_atual . '';
	$where .= " AND a.status = '" . escape_payisp($status_atual) . "'";
}
//filtros por banco
$banco = '';
if (isset($_GET['banco']) && !empty($_GET['banco'])) {
	$banco = (int)($_GET['banco']);
	$tag .= '&banco=' . $banco . '';
	$where .= " AND a.numconta = '" . escape_payisp($banco) . "'";
}
//filtros por plano
$plano = '';
if (isset($_GET['plano']) && !empty($_GET['plano'])) {
	$plano = trim($_GET['plano']);
	$tag .= '&plano=' . $plano . '';
	$where .= " AND a.plano = '" . escape_payisp($plano) . "'";
}
//impresso
$impresso = '';
if (isset($_GET['impresso']) && !empty($_GET['impresso'])) {
	$impresso = trim($_GET['impresso']);
	$tag .= '&impresso=' . $impresso . '';
	$where .= " AND a.imp = '" . escape_payisp($impresso) . "'";
}
//nfcom
$nfcom = '';
if (isset($_GET['nfcom']) && !empty($_GET['nfcom'])) {
	$nfcom = trim($_GET['nfcom']);
	$tag .= '&nfcom=' . $nfcom . '';
	if ($nfcom == 'sim') {
		$where .= " AND EXISTS (SELECT 1 FROM `payisp_notas_nfcom` c WHERE c.titulo = a.titulo AND c.cancelada = 0 LIMIT 1)";
	} else if ($nfcom == 'cancelada') {
		$where .= " AND EXISTS (SELECT 1 FROM `payisp_notas_nfcom` c WHERE c.titulo = a.titulo AND c.cancelada = 1 LIMIT 1)";
	} else if ($nfcom == 'com_erros') {
		$where .= " AND EXISTS (SELECT 1 FROM `payisp_notas_nfcom_erros` c WHERE c.titulo_erro = a.titulo LIMIT 1)";
	} else {
		$where .= " AND NOT EXISTS (SELECT 1 FROM `payisp_notas_nfcom` c WHERE c.titulo = a.titulo LIMIT 1)";
	}
}
//base competencia em data
if($dados_configuracoes_nfcom['status']==1){
	if ($dados_configuracoes_nfcom['base_competencia'] == 'vencimento') {
		$campo_data_base = 'a.datavenc';
	} else {
		$campo_data_base = 'a.datapag';
	}
}else{
	$campo_data_base = 'a.processamento';
}
//filtros por data
$data_inicio = '';
$data_fim = '';
if (isset($_GET['data_inicio']) && !empty($_GET['data_inicio'])) {
	$data_inicio = trim($_GET['data_inicio']);
	$tag .= '&data_inicio=' . $data_inicio . '';
	$where .= " AND $campo_data_base >= '" . escape_payisp($data_inicio) . "'";
}
if (isset($_GET['data_fim']) && !empty($_GET['data_fim'])) {
	$data_fim = trim($_GET['data_fim']);
	$tag .= '&data_fim=' . $data_fim . '';
	$where .= " AND $campo_data_base <= '" . escape_payisp($data_fim) . "'";
}
//ordem 
$ordem = 'desc';
if (isset($_GET['ordem']) && !empty($_GET['ordem'])) {
	$ordem = trim($_GET['ordem']);
	$tag .= '&ordem=' . $ordem . '';
	if ($_GET['ordem'] == 'asc') {
		$order = "ORDER BY a.titulo ASC";
	} else {
		$order = "ORDER BY a.titulo DESC";
	}
}
//join 
//$join = " LEFT JOIN `payisp_faturas` b ON a.titulo = b.fatura_mkauth";
$join = "";
//tudo
$sql_tudo = "SELECT a.* FROM `vtab_titulos` a $join WHERE a.deltitulo = 0 $where $order";
$sql_tudo_result = $mysqli->query($sql_tudo);
$qtd_registros = $sql_tudo_result->num_rows;
$paginas = ceil($qtd_registros / $total_reg_por_pagina);
//lista os cliente bloqueados
$sql = "SELECT a.* FROM `vtab_titulos` a $join WHERE a.deltitulo = 0 $where $order LIMIT $inicio,$total_reg_por_pagina";
$result = $mysqli->query($sql);
//bancos 
$lista_bancos = dados_banco_mkauth_todos_payisp();
//planos 
$lista_planos = dados_planos_mkauth_todos_payisp();
?>
<?php $breadcrumbActual = 'Faturas'; ?>
<?php include 'lay.header.php'; ?>

<body>
	<script>
		// Mantido vazio, conforme original
	</script>
	<div style="height: 15px;"></div>
	<?php include('../../topo.php'); ?>

	<div class="container-fluid pt-3">

		<!-- Ttulo e Contagem -->
		<div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
			<h2 class="h4 mb-0"><i class="fa fa-receipt text-primary me-2"></i> Gesto de Faturas <small class="text-muted">(<?php echo ucwords($status_atual); ?>)</small></h2>
			<span class="badge bg-primary fs-6"><?= str_pad($qtd_registros, 4, "0", STR_PAD_LEFT); ?> Faturas</span>
		</div>

		<?php exibir_aviso_payisp(); ?>

		<!-- Bloco Informativo Aprimorado -->
		<div class="alert alert-info d-flex align-items-center" role="alert">
			<i class="fa fa-info-circle me-2 fs-5"></i>
			<div>
				Lista todas as faturas do seu MK-Auth. Utilize os filtros avanados abaixo para refinar sua busca por status, plano ou status de emisso da NFCom.
			</div>
		</div>

		<!-- Botes de Ao -->
		<div class="d-flex justify-content-start flex-wrap gap-2 mb-4">
			<button onclick="location.href='/admin/clientes.hhvm?tipo=todos';" type="button" class="btn btn-primary"><i class="fa fa-plus"></i> Criar Faturas</button>
			<button onclick="imprimir_faturas();" type="button" class="btn btn-warning text-dark"><i class="fa fa-print"></i> Imprimir Faturas</button>
			<?php if ($dados_configuracoes_nfcom['status'] == 1) { ?>
				<button onclick="emitir_nfcom_faturas();" <?php echo ($status_atual == 'vencido') ? 'disabled' : ''; ?> type="button" class="btn btn-success" title="<?php echo ($status_atual == 'vencido') ? 'Filtre por "Aguardando ou Pagos" para emitir NFCom' : 'Emitir NFCom para faturas pagas selecionadas'; ?>"><i class="fa fa-file-invoice"></i> Emitir NFCom</button>
				<button onclick="imprimir_notas_nfcom_faturas();" type="button" class="btn btn-secondary"><i class="fa fa-print"></i> Imprimir NFCom</button>
				<button onclick="abrirPopup_payisp('nfcom.consultar.php', 800, 800,true);" type="button" class="btn btn-info"><i class="fa fa-search"></i> Consultar NFCom</button>
			<?php } ?>
		</div>

		<!-- Formulrio de Filtros (Melhoria de UX: Card Expansivo) -->
		<div class="card shadow-sm mb-4">
			<div class="card-header bg-light d-flex justify-content-between align-items-center" data-bs-toggle="collapse" data-bs-target="#collapseFiltros" aria-expanded="false" aria-controls="collapseFiltros" style="cursor: pointer;">
				<h6 class="mb-0"><i class="fa fa-filter me-2"></i> Filtros Avanados</h6>
				<i class="fa fa-chevron-down"></i>
			</div>
			<div id="collapseFiltros" class="collapse show">
				<div class="card-body p-3">
					<form method="GET" action="">
						<div class="row g-2 mb-3">
							<!-- Linha 1: Filtro Rpido e Status -->
							<div class="col-md-6 col-lg-4">
								<label for="tag" class="form-label small text-muted mb-0">Busca Rpida (Ttulo, Cliente, Nosso Num.)</label>
								<input value="<?php echo htmlspecialchars(isset($_GET['tag']) ? $_GET['tag'] : ''); ?>" name="tag" class="form-control form-control-sm" type="text" placeholder="Tags a buscar...">
							</div>
							<div class="col-md-3 col-lg-3">
								<label for="status" class="form-label small text-muted mb-0">Status da Fatura</label>
								<select class="form-select form-select-sm" name="status" id="status">
									<option value="" <?php echo ($status_atual == 'todas') ? ' selected' : ''; ?>>Todos</option>
									<option value="aberto" <?php echo ($status_atual == 'aberto') ? ' selected' : ''; ?>>Abertos</option>
									<option value="pago" <?php echo ($status_atual == 'pago') ? ' selected' : ''; ?>>Pagos</option>
									<option value="vencido" <?php echo ($status_atual == 'vencido') ? ' selected' : ''; ?>>Vencidos</option>
								</select>
							</div>
							<div class="col-md-3 col-lg-3">
								<label for="ordem" class="form-label small text-muted mb-0">Ordenao</label>
								<select class="form-select form-select-sm" name="ordem" id="ordem">
									<option value="desc" <?php echo ($ordem == 'desc') ? ' selected' : ''; ?>>Mais Recente</option>
									<option value="asc" <?php echo ($ordem == 'asc') ? ' selected' : ''; ?>>Mais Antiga</option>
								</select>
							</div>
							<div class="col-md-3 col-lg-2">
								<label for="impresso" class="form-label small text-muted mb-0">Impresso</label>
								<select class="form-select form-select-sm" name="impresso" id="impresso">
									<option value="" <?php echo ($impresso == '') ? ' selected' : ''; ?>>Todos</option>
									<option value="sim" <?php echo ($impresso == 'sim') ? ' selected' : ''; ?>>Sim</option>
									<option value="nao" <?php echo ($impresso == 'nao') ? ' selected' : ''; ?>>No</option>
								</select>
							</div>
						</div>

						<div class="row g-2">
							<!-- Linha 2: Filtros Secundrios (Banco, Plano, NFCom, Datas) -->
							<div class="col-md-3 col-lg-2">
								<label for="banco" class="form-label small text-muted mb-0">Banco</label>
								<select class="form-select form-select-sm" name="banco" id="banco">
									<option value="" <?php echo ($banco == '') ? ' selected' : ''; ?>>Todos</option>
									<?php foreach ($lista_bancos as $v) { ?>
										<option value="<?php echo $v['id']; ?>" <?php echo ($banco == $v['id']) ? ' selected' : ''; ?>><?php echo $v['nome']; ?></option>
									<?php } ?>
								</select>
							</div>
							<div class="col-md-3 col-lg-2">
								<label for="plano" class="form-label small text-muted mb-0">Plano</label>
								<select class="form-select form-select-sm" name="plano" id="plano">
									<option value="" <?php echo ($plano == '') ? ' selected' : ''; ?>>Todos</option>
									<?php foreach ($lista_planos as $v) { ?>
										<option value="<?php echo $v['nome']; ?>" <?php echo ($plano == $v['nome']) ? ' selected' : ''; ?>><?php echo $v['nome']; ?></option>
									<?php } ?>
								</select>
							</div>

							<?php if ($dados_configuracoes_nfcom['status'] == 1) { ?>
								<div class="col-md-3 col-lg-2">
									<label for="nfcom" class="form-label small text-muted mb-0">Status NFCom</label>
									<select class="form-select form-select-sm" name="nfcom" id="nfcom">
										<option value="" <?php echo ($nfcom == '') ? ' selected' : ''; ?>>Todos</option>
										<option value="sim" <?php echo ($nfcom == 'sim') ? ' selected' : ''; ?>>Emitida</option>
										<option value="nao" <?php echo ($nfcom == 'nao') ? ' selected' : ''; ?>>No Emitida</option>
										<option value="cancelada" <?php echo ($nfcom == 'cancelada') ? ' selected' : ''; ?>>Cancelada</option>
										<option value="com_erros" <?php echo ($nfcom == 'com_erros') ? ' selected' : ''; ?>>Com Erros</option>
									</select>
								</div>
							<?php } ?>

							<div class="col-md-3 col-lg-2">
								<label for="data_inicio" class="form-label small text-muted mb-0">Data Incio</label>
								<input type="datetime-local" class="form-control form-control-sm" name="data_inicio" value="<?php echo htmlspecialchars($data_inicio); ?>">
							</div>
							<div class="col-md-3 col-lg-2">
								<label for="data_fim" class="form-label small text-muted mb-0">Data Fim</label>
								<input type="datetime-local" class="form-control form-control-sm" name="data_fim" value="<?php echo htmlspecialchars($data_fim); ?>">
							</div>

							<div class="col-md-12 col-lg-2 d-flex align-items-end gap-2">
								<button type="submit" class="btn btn-secondary btn-sm"><i class="fa fa-search"></i></button>
								<button onclick="location.href='faturas.index.php';" type="button" class="btn btn-outline-danger btn-sm"><i class="fa fa-times"></i></button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Tabela de Faturas -->
		<div class="table-responsive" style="min-height:600px;">
			<table class="table table-striped table-hover table-sm align-middle">
				<thead class="table-light">
					<tr>
						<th style="width:120px;">
							<input type="checkbox" id="selecionar_todos" onclick="jQuery('input.lista_faturas').prop('checked', this.checked);">
							&nbsp;Ttulo
						</th>
						<th>Cliente</th>
						<th style="width:150px;">Transao</th>
						<th style="width:150px;">Plano</th>
						<th style="width:150px;" class="text-end">Valor / Pago</th>
						<th style="width:150px;">Status</th>
						<th style="width:120px;">Vencimento</th>
						<?php if ($dados_configuracoes_nfcom['status'] == 1) { ?><th style="width:120px;">NFCom</th><?php } ?>
						<th style="width:120px;">Data Criao</th>
						<th style="width:80px;">Aes</th>
					</tr>
				</thead>
				<tbody>
					<?php
					$i = 0;
					while ($row = $result->fetch_array()) {
						// Lgica de clculo de valor total inicial
						$total_inicial = $row['valor'];
						//calcula adicionais e descontos
						$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
						$results_adicionais = $mysqli->query($sql_adicionais);
						while ($rowad = $results_adicionais->fetch_array()) {
							if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
								$total_inicial -= $rowad['valor'];
							}elseif(isset($rowad['valor']) && $rowad['valor'] > 0){
								$total_inicial += $rowad['valor'];
							}
						}
						$row['valor'] = $total_inicial;

						// Detalhes NFCom
						$nota = detalhes_nfcom_payisp($row['titulo']);
						$banco_mk = dados_banco_mkauth_payisp($row['numconta']);
						$banco_payisp = dados_banco_uuid_payisp($banco_mk['uuid_boleto']);
						$whatsapp = preg_replace('/\D/', '', (!empty($row['celular']) ? $row['celular'] : $row['fone']));
						$frase = "Ol *" . ucwords($row['nome']) . "*, sou do financeiro *" . ucwords($dados_provedor['nome']) . "*, para pagar ou ver detalhes de sua fatura acesse *" . url_link_payisp() . "/admin/addons/payisp/cliente.fatura.php?uuid=" . $row['uuid_lanc'] . "&sec=" . sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']) . "*, qualquer dvida entre em contato com nosso atendimento em *" . $dados_provedor['fone'] . "*!";
						$link_whats = "https://wa.me/55" . $whatsapp . "?text=" . urlencode($frase) . "";
					?>
						<tr>
							<th scope="row" class="align-middle">
								<!-- Checkbox de Seleo -->
								<input class="<?php echo $row['geranfe'] == 'nao' ? 'lista_faturas2' : 'lista_faturas'; ?>"
									title="<?php echo $row['geranfe'] == 'nao' ? 'Emisso da nota desativada no cadastro do cliente!' : 'Selecione'; ?>"
									<?php echo $row['geranfe'] == 'nao' ? 'disabled' : ''; ?>
									data-nfcom="<?php echo isset($nota['id_nota']) ? '1' : '0'; ?>"
									data-cancelado="<?php echo isset($nota['id_nota']) ? $nota['cancelada'] : 0; ?>"
									data-status="<?php echo $row['status']; ?>"
									data-id_banco="<?php echo isset($banco_payisp['id']) ? $banco_payisp['id'] : ''; ?>"
									type="checkbox" name="lista_faturas" value="<?php echo $row['titulo']; ?>">

								<!-- Link do Ttulo -->
								<?php if ($row['status'] == 'pago') { ?>
									<a onclick="void(0);" href="#" class="fw-bold text-dark"><?php echo $row['titulo']; ?></a>
								<?php } else { ?>
									<a onclick="window.open(this.href, this.target, 'width=860, height=440, scrollbars=yes'); return false;" href="/admin/addons/payisp/custom/prepara_boleto.hhvm?titulo=<?php echo $row['titulo']; ?>" class="text-primary"><?php echo $row['titulo']; ?> <i class="fa fa-print"></i></a>
								<?php } ?>
							</th>
							<td>
								<!-- Detalhes do Cliente -->
								<a target="_blank" href="/admin/cliente_det.hhvm?uuid=<?php echo $row['uuid_cliente']; ?>" class="text-decoration-none"><?php echo ucwords($row['nome']); ?></a> (<small class="text-muted"><?php echo $row['cpf_cnpj']; ?></small>)<br>
								<div class="d-flex gap-1 mt-1">
									<?php if (!empty($whatsapp) && (strlen($whatsapp) == 10 || strlen($whatsapp) == 11)) { ?>
										<a title="Enviar fatura no whatsapp" target="_blank" href="<?php echo $link_whats; ?>"><span class="badge text-bg-success"><span class="fa-brands fa-whatsapp"></span></span></a>
									<?php } ?>
									<a title="Link da fatura" target="_blank" href="cliente.fatura.php?uuid=<?php echo $row['uuid_lanc']; ?>&sec=<?php echo sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']); ?>"><span class="badge text-bg-primary"><span class="fa fa-share"></span></span></a>
								</div>
							</td>
							<td>
								<!-- Detalhes da Transao -->
								<span class="text-muted"><?php echo isset($banco_mk['nome']) ? $banco_mk['nome'] : 'n/a'; ?></span><?php if (isset($banco_payisp['id'])) { ?> <span class="badge text-bg-primary badge-sm" style="font-size:0.6rem;">
									API
								</span>
								<?php } ?>
								<?php if (isset($banco_payisp['id'])) { ?>
									<br><a onclick="window.open(this.href, this.target, 'width=800, height=800, scrollbars=yes'); return false;" href="faturas.logs.php?titulo=<?php echo $row['titulo']; ?>&banco=<?php echo $banco_payisp['id']; ?>&cod_banco=<?php echo $banco_payisp['cod_banco']; ?>&cod_banco_mk=<?php echo $banco_payisp['cod_banco_mkauth']; ?>"><span class="badge text-bg-secondary"><?php echo !empty($row['nossonum']) ? $row['nossonum'] : 'n/a'; ?></span></a>
								<?php } else { ?>
									<br><span class="badge text-bg-light text-dark border"><?php echo !empty($row['nossonum']) ? $row['nossonum'] : 'n/a'; ?></span>
								<?php } ?>
							</td>
							<td>
								<!-- Detalhes do Plano -->
								<strong><?php echo $row['plano']; ?></strong> (<?php echo strtoupper(substr($row['tipo'], 0, 1)); ?>)
								<?php if ($row['descricao'] != 'unico') { ?>
									<br><small class="text-muted"><?php echo $row['descricao']; ?></small>
								<?php } ?>
							</td>
							<td class="text-end">
								<!-- Valores -->
								R$<?php echo number_format($row['valor'], 2, ',', '.'); ?><br>
								<strong class="text-success">R$<?php echo number_format($row['valorpag'], 2, ',', '.'); ?></strong>
							</td>
							<td>
								<!-- Status da Fatura -->
								<?php
								$status_text = ucfirst(str_replace('_', ' ', $row['status']));
								$status_icon = 'fa-receipt';
								if ($row['status'] == 'aberto') {
									$status_class = 'text-bg-primary';
								} elseif ($row['status'] == 'pago') {
									$status_class = 'text-bg-success';
									$status_icon = 'fa-check';
								} else { // Vencido, Cancelado, etc.
									$status_class = 'text-bg-danger';
								}
								?>
								<a <?php if ($row['status'] == 'pago') { ?>
									onclick="window.open('/admin/titulo_info.hhvm?titulo=<?php echo $row['titulo']; ?>', '', 'width=800, height=600, scrollbars=yes'); return false;"
									<?php } else { ?>
									onclick="window.open(this.href, this.target, 'width=500, height=720, scrollbars=yes'); return false;" href="/admin/receber.hhvm?titulo=<?php echo $row['uuid_lanc']; ?>"
									<?php } ?>><span class="badge <?php echo $status_class; ?>"><?php echo $status_text; ?> <span class="fa <?php echo $status_icon; ?>"></span></span></a>
							</td>
							<td>
								<!-- Vencimento / Pagamento -->
								<?php
								$data_venc = strtotime($row['datavenc']);
								$data_hoje = time();
								$data_venc_formatada = date('d/m/Y', $data_venc);

								if ($row['status'] == 'pago') {
									$venc_class = 'text-bg-secondary';
									$venc_icon = 'fa-check-double';
									$venc_text = $data_venc_formatada;
								} elseif ($data_venc > $data_hoje) {
									$venc_class = 'text-bg-success';
									$venc_icon = 'fa-calendar-check';
									$venc_text = $data_venc_formatada;
								} else {
									$venc_class = 'text-bg-danger';
									$venc_icon = 'fa-calendar-times';
									$venc_text = $data_venc_formatada;
								}
								?>
								<span class="badge <?php echo $venc_class; ?>"><?php echo $venc_text; ?> <span class="fa <?php echo $venc_icon; ?>"></span></span>
							</td>
							<?php if ($dados_configuracoes_nfcom['status'] == 1) { ?>
								<td>
									<!-- Status NFCom -->
									<?php
									$has_nfcom = isset($nota['id_nota']);
									$nfcom_link = '';
									$nfcom_text = 'N. Emitida';
									$nfcom_class = 'text-bg-primary';

									if ($has_nfcom) {
										$params = "titulo=" . $row['titulo'] . "&chave=" . $nota['chave'] . "&tpAmb=" . ($nota['homologacao'] == 1 ? 2 : 1);
										$nfcom_link = "nfcom.detalhes.php?" . $params;

										if ($nota['cancelada'] == 0) {
											$nfcom_text = 'Emitida [' . $nota['numero'] . ']';
											$nfcom_class = 'text-bg-success';
										} else {
											$nfcom_text = 'Cancelada [' . $nota['numero'] . ']';
											$nfcom_class = 'text-bg-danger';
										}
									} elseif (fatura_nfcom_tem_erros_payisp($row['titulo'])) {
										$nfcom_link = "nfcom.erros.php?titulo=" . $row['titulo'];
										$nfcom_text = 'Com Erros';
										$nfcom_class = 'text-bg-warning text-dark';
									} else {
										$nfcom_link = "nfcom.emitir.php?titulo[]=" . $row['titulo'];
									}
									?>
									<a onclick="abrirPopup_payisp(this.href, 800, 800, true); return false;"
										href="<?php echo $nfcom_link; ?>">
										<span class="badge <?php echo $nfcom_class; ?>"><?php echo $nfcom_text; ?> <span class="fa fa-file-invoice"></span></span>
									</a>
								</td>
							<?php } ?>
							<td><?php echo date('d/m/Y', strtotime($row['processamento'])); ?></td>
							<td>
								<!-- Dropdown de Aes -->
								<div class="dropdown dropstart">
									<button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Mais Aes">
										Aes
									</button>
									<div class="dropdown-menu">
										<h6 class="dropdown-header">Fatura #<?php echo $row['titulo']; ?></h6>
										<div class="dropdown-divider"></div>

										<!-- Aes de Pagamento e Boleto -->
										<?php if ($row['status'] != 'pago') { ?>
											<a class="dropdown-item" target="_blank" href="cliente.fatura.php?uuid=<?php echo $row['uuid_lanc']; ?>&sec=<?php echo sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']); ?>"><span class="fa fa-share me-2"></span> Link da fatura</a>
											<a class="dropdown-item" onclick="window.open(this.href, this.target, 'width=860, height=440, scrollbars=yes'); return false;" href="/admin/addons/payisp/custom/prepara_boleto.hhvm?titulo=<?php echo $row['titulo']; ?>"><span class="fa fa-barcode me-2"></span> Boleto</a>
											<a class="dropdown-item" onclick="window.open(this.href, this.target, 'width=500, height=720, scrollbars=yes'); return false;" href="/admin/receber.hhvm?titulo=<?php echo $row['uuid_lanc']; ?>"><span class="fa fa-receipt me-2"></span> Receber Manual</a>
										<?php } else { ?>
											<a class="dropdown-item" target="_blank" href="cliente.fatura.php?uuid=<?php echo $row['uuid_lanc']; ?>&sec=<?php echo sha1($row['uuid_lanc'] . $row['titulo'] . $row['titulo']); ?>"><i class="fa fa-file-lines me-2"></i> Recibo</a>
										<?php } ?>
										<a class="dropdown-item" onclick="window.open('/admin/titulo_info.hhvm?titulo=<?php echo $row['titulo']; ?>', '', 'width=800, height=600, scrollbars=yes'); return false;"><span class="fa fa-info me-2"></span> Informaes</a>

										<!-- Aes NFCom -->
										<?php if ($dados_configuracoes_nfcom['status'] == 1) { ?>
											<div class="dropdown-divider"></div>
											<?php if (isset($nota['id_nota'])) { ?>
												<a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.detalhes.php?titulo=<?php echo $row['titulo']; ?>&chave=<?php echo $nota['chave']; ?>&tpAmb=<?php echo ($nota['homologacao'] == 1 ? 2 : 1); ?>',800,600, true); " href="javascript:void(0);"><span class="fa fa-file-invoice me-2"></span> Detalhes NFCom</a>
												<a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.consultar.php?chave=<?php echo $nota['chave']; ?>&titulo=<?php echo $row['titulo']; ?>&tpAmb=<?php echo ($nota['homologacao'] == 1 ? 2 : 1); ?>', 800, 600, true);" href="javascript:void(0);">
													<span class="fa fa-search me-2"></span> Consultar/Cancelar NFCom
												</a>
												<?php if ($nota['cancelada'] == 0) { ?>
													<a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.imprimir.php?titulo[]=<?php echo $row['titulo']; ?>&base=titulo',870,900);" href="javascript:void(0);"><span class="fa fa-print me-2"></span> Imprimir NFCom</a>
												<?php } ?>
											<?php } else { ?>
												<a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.emitir.php?origem=emitir_titulos&titulo[]=<?php echo $row['titulo']; ?>', 800, 600, true);" href="javascript:void(0);"><span class="fa fa-file-invoice me-2"></span> Emitir NFCom</a>
											<?php } ?>
										<?php } ?>
									</div>
								</div>
							</td>
						</tr>
					<?php
						$i++;
					}
					?>
					<?php
					if ($qtd_registros == 0) {
					?>
						<tr>
							<td colspan="<?php echo $dados_configuracoes_nfcom['status'] == 1 ? '10' : '9'; ?>" class="text-center py-4 text-muted">Nenhum registro cadastrado com os filtros aplicados.</td>
						</tr>
					<?php
					}
					?>
				</tbody>
			</table>
		</div>

		<!-- Paginao -->
		<?php if ($paginas > 1) { ?>
			<nav class="mt-4" aria-label="Navegao de Pgina">
				<ul class="pagination justify-content-center">
					<!-- Boto Anterior -->
					<li class="page-item <?php echo ($pagina == 1) ? 'disabled' : ''; ?>">
						<a class="page-link" href="faturas.index.php?pagina=<?php echo max(1, $pagina - 1); ?><?php echo $tag; ?>" aria-label="Anterior">
							<span aria-hidden="true">&laquo;</span> Anterior
						</a>
					</li>

					<?php
					$max_links = 5;
					$start_page = max(1, $pagina - floor($max_links / 2));
					$end_page = min($paginas, $start_page + $max_links - 1);

					if ($end_page - $start_page < $max_links - 1) {
						$start_page = max(1, $end_page - $max_links + 1);
					}

					for ($i = $start_page; $i <= $end_page; $i++) {
						$active_class = ($i == $pagina) ? 'active' : '';
						echo '<li class="page-item ' . $active_class . '"><a class="page-link" href="faturas.index.php?pagina=' . $i . '' . $tag . '">' . $i . '</a></li>';
					}
					?>

					<!-- Boto Prxima -->
					<li class="page-item <?php echo ($pagina >= $paginas) ? 'disabled' : ''; ?>">
						<a class="page-link" href="faturas.index.php?pagina=<?php echo min($paginas, $pagina + 1); ?><?php echo $tag; ?>" aria-label="Prxima">
							Prxima <span aria-hidden="true">&raquo;</span>
						</a>
					</li>
				</ul>
			</nav>
		<?php } ?>

	</div>

	<?php include('lay.footer.php'); ?>
	<script>
		// FUNO DE IMPRESSO DE FATURAS (BOLETO)
		function imprimir_faturas() {
			var selected = [];
			var bancos = [];
			jQuery('input[name="lista_faturas"]:checked').each(function() {
				var id_banco = jQuery(this).data("id_banco");
				var status = jQuery(this).data("status");
				// Condio original: id_banco != '' e status != 'pago'
				if (id_banco != '' && status != 'pago') {
					selected.push(jQuery(this).val());
					bancos.push(id_banco);
				}
			});
			console.log(selected);
			console.log(bancos.every((val, i, arr) => val === arr[0]));
			if (selected.length == 0) {
				bootbox.alert("Selecione no mnimo uma fatura que tenha sido emitida pelo PAY ISP, pelo mesmo banco, e que ainda no esteja paga.");
				return false;
			} else if (bancos.every((val, i, arr) => val === arr[0]) == false) {
				bootbox.alert("Selecione apenas faturas emitidas pelo mesmo banco e que no tenham sido pagas. Considere filtrar por banco para um melhor resultado.");
				return false;
			} else {
				var faturas = '';
				jQuery.each(selected, function(key, value) {
					faturas += '&titulo[]=' + value;
				});
				abrirPopup_payisp('imprimir.carnet.php?origem=impressao_titulos' + faturas, 800, 600);
				return false;
			}
		}

		// FUNO DE EMISSO DE NFCOM
		function emitir_nfcom_faturas() {
			var selected = [];
			jQuery('input[name="lista_faturas"]:checked').each(function() {
				var status = jQuery(this).data("status");
				var nfcom = jQuery(this).data("nfcom");
				// Condio original: status == 'pago' e nfcom == '0' (no emitida)
				if ((status == 'pago' || status == 'aberto') && nfcom == '0') {
					selected.push(jQuery(this).val());
				}
			});
			console.log(selected);
			if (selected.length == 0) {
				bootbox.alert("Selecione no mnimo uma fatura que j tenha sido paga ou aberta e que ainda no tenha uma NFCom emitida para continuar.");
				return false;
			} else {
				var faturas = '';
				jQuery.each(selected, function(key, value) {
					faturas += '&titulo[]=' + value;
				});
				abrirPopup_payisp('nfcom.emitir.php?origem=emitir_titulos' + faturas, 800, 600, true);
				return false;
			}
		}

		// FUNO DE IMPRESSO DE NFCOM
		function imprimir_notas_nfcom_faturas() {
			var selected = [];
			jQuery('input[name="lista_faturas"]:checked').each(function() {
				var status = jQuery(this).data("status");
				var nfcom = jQuery(this).data("nfcom");
				var cancelado = jQuery(this).data("cancelado");
				// Condio original: status == 'pago' e nfcom == '1' (emitida) e cancelado == '0'
				if (status == 'pago' && nfcom == '1' && cancelado == '0') {
					selected.push(jQuery(this).val());
				}
			});
			console.log(selected);
			if (selected.length == 0) {
				bootbox.alert("Selecione no mnimo uma fatura que j tenha sido paga, que tenha uma NFCom emitida e no cancelada para imprimir.");
				return false;
			} else {
				var faturas = '';
				jQuery.each(selected, function(key, value) {
					faturas += '&titulo[]=' + value;
				});
				abrirPopup_payisp('nfcom.imprimir.php?origem=imprimir_titulos&base=titulo' + faturas, 870, 900);
				return false;
			}
		}
	</script>

</body>

</html>
</file>

<file path="payisp/faturas.logs.php">
<?php
//log boleto individual
require(dirname(__FILE__) . '/init.php');
//dados do titulo
$sql = "SELECT * FROM `sis_lanc` WHERE id = '" . valor_antigo_payisp('titulo') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//se banco  atrado ao payisp
$modulo = trim($fatura['fcartaonumero']);
$banco = dados_banco_cod_payisp($modulo);
if (isset($banco['cod_banco'])) {
	$obj = class_banco_payisp($banco['cod_banco']);
	if (is_object($obj) && method_exists($obj, 'consulta')) {
		$log = $obj->consulta($fatura['fcartaobandeira'], $banco);
		$titulo = 'Logs';
		require(dirname(__FILE__) . '/template_log.php');
		die('');
	} else {
		$titulo = 'Ops';
		$alerta = 'Banco sem funcionalidade de consulta.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__) . '/template_alerta.php');
		die('');
	}
} else {
	$titulo = 'Ops';
	$alerta = 'No foi possivel encontrar os dados do banco emissor deste boleto ativo no PAY ISP, verificar se o mesmo encontra-se ativado!';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
</file>

<file path="payisp/imprimir.boleto.central.php">
<?php
require(dirname(__FILE__) . '/init_cliente.php');
//ini_set('display_errors', '1');
//ini_set('display_startup_errors', '1');
//error_reporting(E_ALL);
require_once(dirname(__FILE__) . '/class.qrcode.php');
//dados 
$boleto = isset($_GET['boleto']) ? $_GET['boleto'] : '';
$hash = isset($_GET['hash']) ? $_GET['hash'] : '';
//dados do titulo
$sql = "SELECT * FROM `vtab_titulos` WHERE titulo = '" . escape_payisp($boleto) . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//inclui adicionais ao total de registro
$total_inicial = $fatura['valor'];
$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$fatura['titulo'] . "";
$results_adicionais = $mysqli->query($sql_adicionais);
while ($rowad = $results_adicionais->fetch_array()) {
	if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
		$total_inicial -= $rowad['valor'];
	} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
		$total_inicial += $rowad['valor'];
	}
}
$fatura['valor'] = $total_inicial;
//se banco  atrado ao payisp
$modulo = trim($fatura['fcartaonumero']);
$banco = dados_banco_cod_payisp($modulo);
if (!isset($banco['cod_banco'])) {
	$titulo = 'Ops';
	$alerta = 'No foi possivel encontrar os dados do banco emissor deste boleto ativo no PAY ISP, verificar se o mesmo encontra-se ativado!';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//valida o acesso 
if (md5($boleto . '' . $banco['serial']) != $hash) {
	$titulo = 'Acesso Negado';
	$alerta = 'No foi possivel visualizar o carnet selecionado.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//class bank
$classBank = new BancoClassPayIsp();
$imprime_instrucoes_impressao = true;
$cod_banco_num = substr(trim($fatura['fchequebanco']), 0, 3);
//dados do pix 
$sql_pix = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . $fatura['uuid_lanc'] . "' LIMIT 1";
$result_pix = $mysqli->query($sql_pix);
$pix = $result_pix->fetch_array(MYSQLI_ASSOC);
//dados do fatura
$sql_f = "SELECT * FROM `payisp_faturas` WHERE fatura_mkauth = '" . $fatura['titulo'] . "' LIMIT 1";
$result_f = $mysqli->query($sql_f);
$f = $result_f->fetch_array(MYSQLI_ASSOC);
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>
		Fatura #<?php echo $fatura['titulo']; ?> <?php echo ucfirst($banco['cod_banco']); ?> - PAY ISP
	</title>
	<style type="text/css">
		@media print {
			.noprint {
				display: none;
			}
		}

		body {
			background-color: #ffffff;
			margin-right: 0;
		}

		.table-boleto {
			font: 9px Arial;
			width: 666px;
		}

		.table-boleto td {
			border-left: 1px solid #000;
			border-top: 1px solid #000;
		}

		.table-boleto td:last-child {
			border-right: 1px solid #000;
		}

		.table-boleto .titulo {
			color: #000033;
		}

		.linha-pontilhada {
			color: #000033;
			font: 9px Arial;
			width: 100%;
			border-bottom: 1px dashed #000;
			text-align: right;
			margin-bottom: 10px;
		}

		.table-boleto .conteudo {
			font: bold 10px Arial;
			height: 11.5px;
		}

		.table-boleto .sacador {
			display: inline;
			margin-left: 5px;
		}

		.table-boleto td {
			padding: 1px 4px;
		}

		.table-boleto .noleftborder {
			border-left: none !important;
		}

		.table-boleto .notopborder {
			border-top: none !important;
		}

		.table-boleto .norightborder {
			border-right: none !important;
		}

		.table-boleto .noborder {
			border: none !important;
		}

		.table-boleto .bottomborder {
			border-bottom: 1px solid #000 !important;
		}

		.table-boleto .rtl {
			text-align: right;
		}

		.table-boleto .logobanco {
			display: inline-block;
			max-width: 150px;
		}

		.table-boleto .logocontainer {
			width: 257px;
			display: inline-block;
		}

		.table-boleto .logobanco img {
			margin-bottom: -5px;
			height: 27px;
		}

		.table-boleto .codbanco {
			font: bold 20px Arial;
			padding: 1px 5px;
			display: inline;
			border-left: 2px solid #000;
			border-right: 2px solid #000;
			width: 51px;
			margin-left: 25px;
		}

		.table-boleto .linha-digitavel {
			font: bold 14px Arial;
			display: inline-block;
			width: 406px;
			text-align: right;
		}

		.table-boleto .nopadding {
			padding: 0px !important;
		}

		.table-boleto .caixa-gray-bg {
			font-weight: bold;
			background: #ccc;
		}

		.info {
			font: 11px Arial;
		}

		.info-empresa {
			font: 11px Arial;
		}

		.header {
			font: bold 13px Arial;
			display: block;
			margin: 4px;
		}

		.barcode {
			height: 50px;
		}

		.barcode div {
			display: inline-block;
			height: 100%;
		}

		.barcode .black {
			border-color: #000;
			border-left-style: solid;
			width: 0px;
		}

		.barcode .white {
			background: #fff;
		}

		.barcode .thin.black {
			border-left-width: 1px;
		}

		.barcode .large.black {
			border-left-width: 3px;
		}

		.barcode .thin.white {
			width: 1px;
		}

		.barcode .large.white {
			width: 3px;
		}

		.float_left {
			float: left;
		}

		.center {
			text-align: center;
		}

		.conteudo.cpf_cnpj {
			float: right;
			width: 24%;
		}

		.logotipo {
			max-height: 50px;
		}
	</style>
	<script>
		function quarter() {
			window.resizeTo(900, window.screen.availHeight);
		}
	</script>
</head>

<body onload="window.print();quarter();">

	<div style="width: 666px">
		<?php if ($imprime_instrucoes_impressao) { ?>
			<div class="noprint info">
				<h2>Instrues de Impresso</h2>
				<ul>
					<li>Imprima em impressora jato de tinta (ink jet) ou laser em qualidade normal ou alta (No use modo
						econmico).</li>
					<li>Utilize folha A4 (210 x 297 mm) ou Carta (216 x 279 mm) e margens mnimas  esquerda e  direita
						do
						formulrio.</li>
					<li>Corte na linha indicada. No rasure, risque, fure ou dobre a regio onde se encontra o cdigo de
						barras.</li>
					<li>Caso no aparea o cdigo de barras no final, pressione F5 para atualizar esta tela.</li>
					<li>Caso tenha problemas ao imprimir, copie a sequencia numrica abaixo e pague no caixa eletrnico
						ou no
						internet banking:</li>
				</ul>
				<span class="header">Linha Digitvel:
					<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
				</span>
				<span class="header">Valor: R$
					<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
				</span>
				<br>
				<div class="linha-pontilhada" style="margin-bottom: 20px;">Recibo do pagador</div>
			</div>
		<?php } ?>

		<table class="table-boleto" cellpadding="0" cellspacing="0" border="0">
			<tbody>
				<tr>
					<td valign="bottom" colspan="8" class="noborder nopadding">
						<div class="logocontainer">
							<div class="logobanco">
								<img src="images/<?php echo $cod_banco_num; ?>.png" alt="logotipo do banco">
							</div>
							<div class="codbanco">
								<?php echo $classBank->geraCodigoBanco($cod_banco_num); ?>
							</div>
						</div>
						<div class="linha-digitavel">
							<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3" width="250" rowspan="2" valign="top">
						<div class="titulo">Beneficirio</div>
						<div class="conteudo">
							<?php echo $banco['empresa']; ?><br />
							<?php echo $dados_provedor['endereco']; ?><br />
							<?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>
						</div>
					</td>
					<td colspan="2">
						<div class="titulo">CPF/CNPJ do Beneficirio</div>
						<div class="conteudo">
							<?php echo $banco['cnpj']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td width="120">
						<div class="titulo">Agncia/Cd. Beneficirio</div>
						<div class="conteudo rtl">
							<?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>
						</div>
					</td>
					<td width="110">
						<div class="titulo">Vencimento</div>
						<div class="conteudo rtl">
							<?php echo date('d/m/Y', strtotime($fatura['datavenc'])); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3">
						<div class="titulo">Pagador</div>
						<div class="conteudo float_left">
							<?php echo $fatura['nome']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $fatura['cpf_cnpj']; ?>
						</div>
					</td>
					<td>
						<div class="titulo">N documento</div>
						<div class="conteudo rtl">
							<?php echo $fatura['titulo']; ?>
						</div>
					</td>
					<td>
						<div class="titulo">Nosso nmero</div>
						<div class="conteudo rtl">
							<?php echo $fatura['nossonum']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="titulo">Espcie</div>
						<div class="conteudo">
							R$
						</div>
					</td>
					<td>
						<div class="titulo">Quantidade</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">Valor</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(-) Descontos / Abatimentos</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor Documento</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="2">
						<div class="titulo">Plano</div>
						<div class="conteudo"><?php echo $fatura['plano']; ?></div>
					</td>
					<td>
						<div class="titulo">(-) Outras dedues</div>
						<div class="conteudo">

						</div>
					</td>
					<td>
						<div class="titulo">(+) Outros acrscimos</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor cobrado</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="4">
					</td>
					<td class="noleftborder">
					</td>
				</tr>
				<tr>
					<td colspan="4" class="notopborder">
						<table style="width: 100%;" cellpadding="0" cellspacing="0" border="0"
							style="margin:0; padding:0;">
							<tbody style="margin:0; padding:0;">
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">
											<?php if (isset($f['valor_desconto']) && $f['valor_desconto'] > 0) { ?>
												<span class="cp">Pague at&eacute; o dia <b><?php echo date('d/m/Y', strtotime($f['data_desconto'])); ?></b> o valor <b><?php echo number_format(($f['valor_fatura'] - $f['valor_desconto']), 2, '.', ''); ?>R$</b> <u>(j&aacute; com <?php echo number_format($f['valor_desconto'], 2, '.', ''); ?><?php echo ($f['tipo_desconto'] == 'fixo') ? 'R$' : '%'; ?> de desconto)</u>.</span>
											<?php } ?>
										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">

										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">
											Fatura: #<?php echo $fatura['titulo']; ?> / Carn&ecirc;: <?php echo $fatura['codigo_carne']; ?> / Ref: <?php echo $fatura['referencia']; ?>
										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div style="margin-bottom: 10px;" class="conteudo">

										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</td>
					<td class="notopborder nobottomborder noleftborder" style="text-align:center">
						<?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
							<span class="ct2">Pagar no Pix (libera&ccedil;&atilde;o autom&aacute;tica)</span>
							<?php
							ob_start();
							QRCode::png($pix['qrcode'], null, 'M', 5);
							$imageString = base64_encode(ob_get_contents());
							ob_end_clean();
							?>
							<img style="height: 150px;width: 150px;" src="data:image/png;base64,<?php echo $imageString; ?>" />
						<?php } ?>
					</td>
				</tr>
				<tr>
					<td colspan="5" class="notopborder bottomborder"
						style="padding: 0px 20px 10px 0px; text-align: right">
						<div class="titulo">Recibo do pagador</div>
					</td>
				</tr>
			</tbody>
		</table>
		<br>
		<div class="linha-pontilhada">Corte na linha pontilhada</div>
		<br>

		<!-- Ficha de compensao -->
		<table class="table-boleto" cellpadding="0" cellspacing="0" border="0">
			<tbody>
				<tr>
					<td valign="bottom" colspan="8" class="noborder nopadding">
						<div class="logocontainer">
							<div class="logobanco">
								<img src="images/<?php echo $cod_banco_num; ?>.png" alt="logotipo do banco">
							</div>
							<div class="codbanco">
								<?php echo $classBank->geraCodigoBanco($cod_banco_num); ?>
							</div>
						</div>
						<div class="linha-digitavel">
							<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7">
						<div class="titulo">Local de pagamento</div>
						<div class="conteudo">
							Pag&aacute;vel em qualquer Banco, APP ou Loterica.
						</div>
					</td>
					<td width="180">
						<div class="titulo">Vencimento</div>
						<div class="conteudo rtl">
							<?php echo date('d/m/Y', strtotime($fatura['datavenc'])); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" rowspan="2" valign="top">
						<div class="titulo">Beneficirio</div>
						<div class="conteudo float_left">
							<?php echo $banco['empresa']; ?><br />
							<?php echo $dados_provedor['endereco']; ?><br />
							<?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $banco['cnpj']; ?>
						</div>


					</td>
					<td>
						<div class="titulo">Agncia/Cd. beneficirio</div>
						<div class="conteudo rtl">
							<?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="titulo">Nosso nmero</div>
						<div class="conteudo rtl">
							<?php echo $fatura['nossonum']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td width="110" colspan="2">
						<div class="titulo">Data do documento</div>
						<div class="conteudo">
							<?php echo date('d/m/Y', strtotime($fatura['processamento'])); ?>
						</div>
					</td>
					<td width="120" colspan="2">
						<div class="titulo">N documento</div>
						<div class="conteudo">
							<?php echo $fatura['titulo']; ?>
						</div>
					</td>
					<td width="60">
						<div class="titulo">Espcie doc.</div>
						<div class="conteudo">
							DM
						</div>
					</td>
					<td>
						<div class="titulo">Aceite</div>
						<div class="conteudo">
							N
						</div>
					</td>
					<td width="110">
						<div class="titulo">Data processamento</div>
						<div class="conteudo">
							<?php echo date('d/m/Y', strtotime($fatura['processamento'])); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor do Documento</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3">
						<div class="titulo">Carteira</div>
						<div class="conteudo">
							<?php echo $banco['carteira'] ?>
						</div>
					</td>
					<td width="35">
						<div class="titulo">Espcie</div>
						<div class="conteudo">
							R$
						</div>
					</td>
					<td colspan="2">
						<div class="titulo">Quantidade</div>
						<div class="conteudo">

						</div>
					</td>
					<td width="110">
						<div class="titulo">Valor</div>
						<div class="conteudo">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(-) Descontos / Abatimentos</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" valign="top">
						<div class="titulo">Instrues (Texto de responsabilidade do beneficirio)</div>
					</td>
					<td>
						<div class="titulo">(-) Outras dedues</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder" valign="top">
						<div class="conteudo">
							<?php echo $banco['in1'] ?>
						</div>
						<div class="conteudo">
						</div>
					</td>
					<td>
						<div class="titulo">(+) Mora / Multa</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder">
						<div class="conteudo">
							<?php echo $banco['in2'] ?>
						</div>
						<div class="conteudo">
						</div>
					</td>
					<td>
						<div class="titulo">(+) Outros acrscimos</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder">
						<div class="conteudo">
							<?php echo $banco['in3'] ?>
						</div>
						<div class="conteudo">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor cobrado</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" valign="top">
						<div class="titulo">Pagador</div>
						<div class="conteudo float_left">
							<?php echo $fatura['nome']; ?><br />
							<?php echo $fatura['endereco']; ?>, <?php echo $fatura['numero']; ?><br>
							<?php echo $fatura['cidade']; ?>/<?php echo $fatura['estado']; ?> - CEP: <?php echo $fatura['cep']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $fatura['cpf_cnpj']; ?>
						</div>
					</td>
					<td class="noleftborder">
						<div class="titulo" style="margin-top: 50px">Cd. Baixa</div>
					</td>
				</tr>

				<tr>
					<td colspan="6" class="noleftborder">
						<div class="titulo">Pagador / Avalista <div class="conteudo pagador">
								<?php echo $fatura['nome']; ?>
							</div>
						</div>
					</td>
					<td colspan="2" class="norightborder noleftborder">
						<div class="conteudo noborder rtl">Autenticao mecnica - Ficha de Compensao</div>
					</td>
				</tr>

				<tr>
					<td colspan="8" class="noborder">
						<?php echo $classBank->geraCodigoBarra($fatura['fchequeagcc']); ?>
					</td>
				</tr>

			</tbody>
		</table>
	</div>
</body>

</html>
</file>

<file path="payisp/imprimir.boleto.pdf.php">
<?php
//imprimir o boleto individual
require(dirname(__FILE__) . '/init.php');
//dados do titulo
$sql = "SELECT * FROM `sis_lanc` WHERE id = '" . valor_antigo_payisp('boleto') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//se banco  atrado ao payisp
$modulo = trim($fatura['fcartaonumero']);
$banco = dados_banco_cod_payisp($modulo);
if (isset($banco['cod_banco'])) {
	$obj = class_banco_payisp($banco['cod_banco']);
	if (is_object($obj) && method_exists($obj, 'imprimir')) {
		$boleto = $obj->imprimir($fatura['fcartaobandeira'], $banco);
		if (isset($boleto['erro']) && $boleto['erro'] == false) {
			if ($boleto['tipo'] == 'pdf') {
				$data = base64_decode($boleto['boleto']);
				@header('Content-Type: application/pdf');
				echo $data;
				exit;
			} elseif ($boleto['tipo'] == 'sempdf') {
				header('Location: imprimir.boleto.php?boleto=' . valor_antigo_payisp('boleto') . '&banco=' . $modulo . '');
				die();
			}
		} else {
			die('No foi possivel gerar o boleto: ' . $boleto['status'] . ' - ' . $boleto['log'] . ' (tente novamente)');
		}
	} else {
		$titulo = 'Ops';
		$alerta = 'Banco sem funcionalidade de impresso.';
		$tipo_alerta = 'warning';
		require(dirname(__FILE__) . '/template_alerta.php');
		die('');
	}
} else {
	$titulo = 'Ops';
	$alerta = 'No foi possivel encontrar os dados do banco emissor deste boleto ativo no PAY ISP, verificar se o mesmo encontra-se ativado!';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
</file>

<file path="payisp/imprimir.boleto.php">
<?php
require(dirname(__FILE__) . '/init.php');
//ini_set('display_errors', '1');
//ini_set('display_startup_errors', '1');
//error_reporting(E_ALL);
require_once(dirname(__FILE__) . '/class.qrcode.php');
//dados do titulo
$sql = "SELECT * FROM `vtab_titulos` WHERE titulo = '" . valor_antigo_payisp('boleto') . "' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//inclui adicionais ao total de registro
$total_inicial = $fatura['valor'];
$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$fatura['titulo'] . "";
$results_adicionais = $mysqli->query($sql_adicionais);
while ($rowad = $results_adicionais->fetch_array()) {
	if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
		$total_inicial -= $rowad['valor'];
	} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
		$total_inicial += $rowad['valor'];
	}
}
$fatura['valor'] = $total_inicial;
//se banco  atrado ao payisp
$modulo = trim($fatura['fcartaonumero']);
$banco = dados_banco_cod_payisp($modulo);
if (!isset($banco['cod_banco'])) {
	$titulo = 'Ops';
	$alerta = 'No foi possivel encontrar os dados do banco emissor deste boleto ativo no PAY ISP, verificar se o mesmo encontra-se ativado!';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//class bank
$classBank = new BancoClassPayIsp();
$imprime_instrucoes_impressao = true;
$cod_banco_num = substr(trim($fatura['fchequebanco']), 0, 3);
//dados do pix 
$sql_pix = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . $fatura['uuid_lanc'] . "' LIMIT 1";
$result_pix = $mysqli->query($sql_pix);
$pix = $result_pix->fetch_array(MYSQLI_ASSOC);
//dados do fatura
$sql_f = "SELECT * FROM `payisp_faturas` WHERE fatura_mkauth = '" . $fatura['titulo'] . "' LIMIT 1";
$result_f = $mysqli->query($sql_f);
$f = $result_f->fetch_array(MYSQLI_ASSOC);
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>
		Fatura #<?php echo $fatura['titulo']; ?> <?php echo ucfirst($banco['cod_banco']); ?> - PAY ISP
	</title>
	<style type="text/css">
		@media print {
			.noprint {
				display: none;
			}
		}

		body {
			background-color: #ffffff;
			margin-right: 0;
		}

		.table-boleto {
			font: 9px Arial;
			width: 666px;
		}

		.table-boleto td {
			border-left: 1px solid #000;
			border-top: 1px solid #000;
		}

		.table-boleto td:last-child {
			border-right: 1px solid #000;
		}

		.table-boleto .titulo {
			color: #000033;
		}

		.linha-pontilhada {
			color: #000033;
			font: 9px Arial;
			width: 100%;
			border-bottom: 1px dashed #000;
			text-align: right;
			margin-bottom: 10px;
		}

		.table-boleto .conteudo {
			font: bold 10px Arial;
			height: 11.5px;
		}

		.table-boleto .sacador {
			display: inline;
			margin-left: 5px;
		}

		.table-boleto td {
			padding: 1px 4px;
		}

		.table-boleto .noleftborder {
			border-left: none !important;
		}

		.table-boleto .notopborder {
			border-top: none !important;
		}

		.table-boleto .norightborder {
			border-right: none !important;
		}

		.table-boleto .noborder {
			border: none !important;
		}

		.table-boleto .bottomborder {
			border-bottom: 1px solid #000 !important;
		}

		.table-boleto .rtl {
			text-align: right;
		}

		.table-boleto .logobanco {
			display: inline-block;
			max-width: 150px;
		}

		.table-boleto .logocontainer {
			width: 257px;
			display: inline-block;
		}

		.table-boleto .logobanco img {
			margin-bottom: -5px;
			height: 27px;
		}

		.table-boleto .codbanco {
			font: bold 20px Arial;
			padding: 1px 5px;
			display: inline;
			border-left: 2px solid #000;
			border-right: 2px solid #000;
			width: 51px;
			margin-left: 25px;
		}

		.table-boleto .linha-digitavel {
			font: bold 14px Arial;
			display: inline-block;
			width: 406px;
			text-align: right;
		}

		.table-boleto .nopadding {
			padding: 0px !important;
		}

		.table-boleto .caixa-gray-bg {
			font-weight: bold;
			background: #ccc;
		}

		.info {
			font: 11px Arial;
		}

		.info-empresa {
			font: 11px Arial;
		}

		.header {
			font: bold 13px Arial;
			display: block;
			margin: 4px;
		}

		.barcode {
			height: 50px;
		}

		.barcode div {
			display: inline-block;
			height: 100%;
		}

		.barcode .black {
			border-color: #000;
			border-left-style: solid;
			width: 0px;
		}

		.barcode .white {
			background: #fff;
		}

		.barcode .thin.black {
			border-left-width: 1px;
		}

		.barcode .large.black {
			border-left-width: 3px;
		}

		.barcode .thin.white {
			width: 1px;
		}

		.barcode .large.white {
			width: 3px;
		}

		.float_left {
			float: left;
		}

		.center {
			text-align: center;
		}

		.conteudo.cpf_cnpj {
			float: right;
			width: 24%;
		}

		.logotipo {
			max-height: 50px;
		}
	</style>
	<script>
		function quarter() {
			window.resizeTo(900, window.screen.availHeight);
		}
	</script>
</head>

<body onload="window.print();quarter();">

	<div style="width: 666px">
		<?php if ($imprime_instrucoes_impressao) { ?>
			<div class="noprint info">
				<h2>Instrues de Impresso</h2>
				<ul>
					<li>Imprima em impressora jato de tinta (ink jet) ou laser em qualidade normal ou alta (No use modo
						econmico).</li>
					<li>Utilize folha A4 (210 x 297 mm) ou Carta (216 x 279 mm) e margens mnimas  esquerda e  direita
						do
						formulrio.</li>
					<li>Corte na linha indicada. No rasure, risque, fure ou dobre a regio onde se encontra o cdigo de
						barras.</li>
					<li>Caso no aparea o cdigo de barras no final, pressione F5 para atualizar esta tela.</li>
					<li>Caso tenha problemas ao imprimir, copie a sequencia numrica abaixo e pague no caixa eletrnico
						ou no
						internet banking:</li>
				</ul>
				<span class="header">Linha Digitvel:
					<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
				</span>
				<span class="header">Valor: R$
					<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
				</span>
				<br>
				<div class="linha-pontilhada" style="margin-bottom: 20px;">Recibo do pagador</div>
			</div>
		<?php } ?>

		<table class="table-boleto" cellpadding="0" cellspacing="0" border="0">
			<tbody>
				<tr>
					<td valign="bottom" colspan="8" class="noborder nopadding">
						<div class="logocontainer">
							<div class="logobanco">
								<img src="images/<?php echo $cod_banco_num; ?>.png" alt="logotipo do banco">
							</div>
							<div class="codbanco">
								<?php echo $classBank->geraCodigoBanco($cod_banco_num); ?>
							</div>
						</div>
						<div class="linha-digitavel">
							<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3" width="250" rowspan="2" valign="top">
						<div class="titulo">Beneficirio</div>
						<div class="conteudo">
							<?php echo $banco['empresa']; ?><br />
							<?php echo $dados_provedor['endereco']; ?><br />
							<?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>
						</div>
					</td>
					<td colspan="2">
						<div class="titulo">CPF/CNPJ do Beneficirio</div>
						<div class="conteudo">
							<?php echo $banco['cnpj']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td width="120">
						<div class="titulo">Agncia/Cd. Beneficirio</div>
						<div class="conteudo rtl">
							<?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>
						</div>
					</td>
					<td width="110">
						<div class="titulo">Vencimento</div>
						<div class="conteudo rtl">
							<?php echo date('d/m/Y', strtotime($fatura['datavenc'])); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3">
						<div class="titulo">Pagador</div>
						<div class="conteudo float_left">
							<?php echo $fatura['nome']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $fatura['cpf_cnpj']; ?>
						</div>
					</td>
					<td>
						<div class="titulo">N documento</div>
						<div class="conteudo rtl">
							<?php echo $fatura['titulo']; ?>
						</div>
					</td>
					<td>
						<div class="titulo">Nosso nmero</div>
						<div class="conteudo rtl">
							<?php echo $fatura['nossonum']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="titulo">Espcie</div>
						<div class="conteudo">
							R$
						</div>
					</td>
					<td>
						<div class="titulo">Quantidade</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">Valor</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(-) Descontos / Abatimentos</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor Documento</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="2">
						<div class="titulo">Plano</div>
						<div class="conteudo"><?php echo $fatura['plano']; ?></div>
					</td>
					<td>
						<div class="titulo">(-) Outras dedues</div>
						<div class="conteudo">

						</div>
					</td>
					<td>
						<div class="titulo">(+) Outros acrscimos</div>
						<div class="conteudo rtl">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor cobrado</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="4">
					</td>
					<td class="noleftborder">
					</td>
				</tr>
				<tr>
					<td colspan="4" class="notopborder">
						<table style="width: 100%;" cellpadding="0" cellspacing="0" border="0"
							style="margin:0; padding:0;">
							<tbody style="margin:0; padding:0;">
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">
											<?php if (isset($f['valor_desconto']) && $f['valor_desconto'] > 0) { ?>
												<span class="cp">Pague at&eacute; o dia <b><?php echo date('d/m/Y', strtotime($f['data_desconto'])); ?></b> o valor <b><?php echo number_format(($f['valor_fatura'] - $f['valor_desconto']), 2, '.', ''); ?>R$</b> <u>(j&aacute; com <?php echo number_format($f['valor_desconto'], 2, '.', ''); ?><?php echo ($f['tipo_desconto'] == 'fixo') ? 'R$' : '%'; ?> de desconto)</u>.</span>
											<?php } ?>
										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">

										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div class="conteudo">
											Fatura: #<?php echo $fatura['titulo']; ?> / Carn&ecirc;: <?php echo $fatura['codigo_carne']; ?> / Ref: <?php echo $fatura['referencia']; ?>
										</div>
									</td>
								</tr>
								<tr style="margin:0; padding:0;">
									<td style="margin:0; padding:0;" class="noborder">
										<div style="margin-bottom: 10px;" class="conteudo">

										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</td>
					<td class="notopborder nobottomborder noleftborder" style="text-align:center">
						<?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
							<span class="ct2">Pagar no Pix (libera&ccedil;&atilde;o autom&aacute;tica)</span>
							<?php
							ob_start();
							QRCode::png($pix['qrcode'], null, 'M', 5);
							$imageString = base64_encode(ob_get_contents());
							ob_end_clean();
							?>
							<img style="height: 150px;width: 150px;" src="data:image/png;base64,<?php echo $imageString; ?>" />
						<?php } ?>
					</td>
				</tr>
				<tr>
					<td colspan="5" class="notopborder bottomborder"
						style="padding: 0px 20px 10px 0px; text-align: right">
						<div class="titulo">Recibo do pagador</div>
					</td>
				</tr>
			</tbody>
		</table>
		<br>
		<div class="linha-pontilhada">Corte na linha pontilhada</div>
		<br>

		<!-- Ficha de compensao -->
		<table class="table-boleto" cellpadding="0" cellspacing="0" border="0">
			<tbody>
				<tr>
					<td valign="bottom" colspan="8" class="noborder nopadding">
						<div class="logocontainer">
							<div class="logobanco">
								<img src="images/<?php echo $cod_banco_num; ?>.png" alt="logotipo do banco">
							</div>
							<div class="codbanco">
								<?php echo $classBank->geraCodigoBanco($cod_banco_num); ?>
							</div>
						</div>
						<div class="linha-digitavel">
							<?php echo $classBank->formatarLinha($fatura['fchequebanco']); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7">
						<div class="titulo">Local de pagamento</div>
						<div class="conteudo">
							Pag&aacute;vel em qualquer Banco, APP ou Loterica.
						</div>
					</td>
					<td width="180">
						<div class="titulo">Vencimento</div>
						<div class="conteudo rtl">
							<?php echo date('d/m/Y', strtotime($fatura['datavenc'])); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" rowspan="2" valign="top">
						<div class="titulo">Beneficirio</div>
						<div class="conteudo float_left">
							<?php echo $banco['empresa']; ?><br />
							<?php echo $dados_provedor['endereco']; ?><br />
							<?php echo $dados_provedor['bairro']; ?>, <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $banco['cnpj']; ?>
						</div>


					</td>
					<td>
						<div class="titulo">Agncia/Cd. beneficirio</div>
						<div class="conteudo rtl">
							<?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<div class="titulo">Nosso nmero</div>
						<div class="conteudo rtl">
							<?php echo $fatura['nossonum']; ?>
						</div>
					</td>
				</tr>
				<tr>
					<td width="110" colspan="2">
						<div class="titulo">Data do documento</div>
						<div class="conteudo">
							<?php echo date('d/m/Y', strtotime($fatura['processamento'])); ?>
						</div>
					</td>
					<td width="120" colspan="2">
						<div class="titulo">N documento</div>
						<div class="conteudo">
							<?php echo $fatura['titulo']; ?>
						</div>
					</td>
					<td width="60">
						<div class="titulo">Espcie doc.</div>
						<div class="conteudo">
							DM
						</div>
					</td>
					<td>
						<div class="titulo">Aceite</div>
						<div class="conteudo">
							N
						</div>
					</td>
					<td width="110">
						<div class="titulo">Data processamento</div>
						<div class="conteudo">
							<?php echo date('d/m/Y', strtotime($fatura['processamento'])); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor do Documento</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="3">
						<div class="titulo">Carteira</div>
						<div class="conteudo">
							<?php echo $banco['carteira'] ?>
						</div>
					</td>
					<td width="35">
						<div class="titulo">Espcie</div>
						<div class="conteudo">
							R$
						</div>
					</td>
					<td colspan="2">
						<div class="titulo">Quantidade</div>
						<div class="conteudo">

						</div>
					</td>
					<td width="110">
						<div class="titulo">Valor</div>
						<div class="conteudo">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
					<td>
						<div class="titulo">(-) Descontos / Abatimentos</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" valign="top">
						<div class="titulo">Instrues (Texto de responsabilidade do beneficirio)</div>
					</td>
					<td>
						<div class="titulo">(-) Outras dedues</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder" valign="top">
						<div class="conteudo">
							<?php echo $banco['in1'] ?>
						</div>
						<div class="conteudo">
						</div>
					</td>
					<td>
						<div class="titulo">(+) Mora / Multa</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder">
						<div class="conteudo">
							<?php echo $banco['in2'] ?>
						</div>
						<div class="conteudo">
						</div>
					</td>
					<td>
						<div class="titulo">(+) Outros acrscimos</div>
						<div class="conteudo rtl">

						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" class="notopborder">
						<div class="conteudo">
							<?php echo $banco['in3'] ?>
						</div>
						<div class="conteudo">

						</div>
					</td>
					<td>
						<div class="titulo">(=) Valor cobrado</div>
						<div class="conteudo rtl">
							<?php echo number_format($fatura['valor'], 2, '.', ''); ?>
						</div>
					</td>
				</tr>
				<tr>
					<td colspan="7" valign="top">
						<div class="titulo">Pagador</div>
						<div class="conteudo float_left">
							<?php echo $fatura['nome']; ?><br />
							<?php echo $fatura['endereco']; ?>, <?php echo $fatura['numero']; ?><br>
							<?php echo $fatura['cidade']; ?>/<?php echo $fatura['estado']; ?> - CEP: <?php echo $fatura['cep']; ?>
						</div>
						<div class="conteudo cpf_cnpj">
							<?php echo $fatura['cpf_cnpj']; ?>
						</div>
					</td>
					<td class="noleftborder">
						<div class="titulo" style="margin-top: 50px">Cd. Baixa</div>
					</td>
				</tr>

				<tr>
					<td colspan="6" class="noleftborder">
						<div class="titulo">Pagador / Avalista <div class="conteudo pagador">
								<?php echo $fatura['nome']; ?>
							</div>
						</div>
					</td>
					<td colspan="2" class="norightborder noleftborder">
						<div class="conteudo noborder rtl">Autenticao mecnica - Ficha de Compensao</div>
					</td>
				</tr>

				<tr>
					<td colspan="8" class="noborder">
						<?php echo $classBank->geraCodigoBarra($fatura['fchequeagcc']); ?>
					</td>
				</tr>

			</tbody>
		</table>
	</div>
</body>

</html>
</file>

<file path="payisp/imprimir.carnet.central.php">
<?php
require(dirname(__FILE__) . '/init_cliente.php');
require_once(dirname(__FILE__) . '/class.qrcode.php');
//class bank
$classBank = new BancoClassPayIsp();
//dados 
$carne = isset($_GET['carne']) ? $_GET['carne'] : '';
$hash = isset($_GET['hash']) ? $_GET['hash'] : '';
//titulo unico
$sql_unico = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND codigo_carne = '" . escape_payisp($carne) . "' LIMIT 1";
$result = $mysqli->query($sql_unico);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if (!isset($fatura['uuid_lanc'])) {
	$titulo = 'Faturas No Encontrada';
	$alerta = 'No foi possivel encontrar nenhuma fatura a este carnet na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//se banco  atrado ao payisp
$modulo = trim($fatura['fcartaonumero']);
$banco = dados_banco_cod_payisp($modulo);
if (!isset($banco['cod_banco'])) {
	$titulo = 'Ops';
	$alerta = 'No foi possivel encontrar os dados do banco emissor para este carnet!';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//valida o acesso 
if (md5($carne . '' . $banco['serial']) != $hash) {
	$titulo = 'Acesso Negado';
	$alerta = 'No foi possivel visualizar o carnet selecionado.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__) . '/template_alerta.php');
	die('');
}
//vars 
$capa = false;
$capa_carnet_nova_pagina = false;
$titulo = 'Imprimir Carnet Cliente [' . escape_payisp($carne) . ']';
?>
<!DOCTYPE HTML>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title><?php echo $titulo; ?> - PAY ISP</title>
	<style>
		.alert {
			padding: 10px;
			margin: 5px;
			margin-bottom: 20px;
			border: 1px solid transparent;
			border-radius: 4px;
		}

		.alert h4 {
			margin-top: 0;
			color: inherit;
		}

		.alert .alert-link {
			font-weight: bold;
		}

		.alert>p,
		.alert>ul {
			margin-bottom: 0;
		}

		.alert>p+p {
			margin-top: 5px;
		}

		.alert-dismissable,
		.alert-dismissible {
			padding-right: 35px;
		}

		.alert-dismissable .close,
		.alert-dismissible .close {
			position: relative;
			top: -2px;
			right: -21px;
			color: inherit;
		}

		.alert-success {
			background-color: #dff0d8;
			border-color: #d6e9c6;
			color: #3c763d;
		}

		.alert-success hr {
			border-top-color: #c9e2b3;
		}

		.alert-success .alert-link {
			color: #2b542c;
		}

		.alert-info {
			background-color: #d9edf7;
			border-color: #bce8f1;
			color: #31708f;
		}

		.alert-info hr {
			border-top-color: #a6e1ec;
		}

		.alert-info .alert-link {
			color: #245269;
		}

		.alert-warning {
			background-color: #fcf8e3;
			border-color: #faebcc;
			color: #8a6d3b;
		}

		.alert-warning hr {
			border-top-color: #f7e1b5;
		}

		.alert-warning .alert-link {
			color: #66512c;
		}

		.alert-danger {
			background-color: #f2dede;
			border-color: #ebccd1;
			color: #a94442;
		}

		.alert-danger hr {
			border-top-color: #e4b9c0;
		}

		.alert-danger .alert-link {
			color: #843534;
		}

		.cp {
			font: 10px Arial;
			color: black;
			margin-top: -5px;
		}

		.ti {
			font: 9px Arial, Helvetica, sans-serif;
		}

		.ld {
			font: bold 15px Arial;
			color: #000000;
		}

		.ct {
			font: 9px "Arial Narrow";
			color: #000;
			margin-left: 2px;
			margin-top: -8px;
			padding: 0;
		}

		.cn {
			FONT: 9px Arial;
			COLOR: black;
		}

		.bc {
			font: bold 16px Arial;
			color: #000000;
		}

		.ld2 {
			font: bold 12px Arial;
			color: #000000;
		}

		body {
			margin: 0;
			font: Arial, Helvetica, sans-serif;
		}

		#carne {
			width: 870px;
			margin: 0 auto;
		}

		.master {
			margin: 0 auto;
		}

		.capa {
			margin: 0 auto;
		}

		.ti {
			font: 9px Arial, Helvetica, sans-serif;
		}

		.bordaRight {
			border-right: 1px solid #000;
		}

		.bordaLeft {
			border-left: 1px solid #000;
		}

		.claro {
			color: #999;
		}

		.master td {
			border-bottom: 1px solid #000;
			height: 25px;
			padding: 0;
			padding-left: 5px;
			font-size: 9px;
		}

		.campo {
			text-align: right;
			font: 9px Arial;
			color: #000;
			float: right;
			margin-left: 2px;
			margin-top: 3px;
		}

		.campo2 {
			text-align: right;
			font: bold 10px Arial;
			color: #000;
			margin-left: 2px;
		}

		.ct1 {
			FONT: 9px "Arial Narrow";
			COLOR: #000033;
			text-align: left;
		}

		.ct2 {
			FONT: 9px "Arial Narrow";
			COLOR: #000033
		}

		.cp1 {
			font: bold 10px Arial;
			color: black
		}

		hr {
			margin: 17px 0px;
		}

		.vertical-text {
			transform: rotate(90deg);
			transform-origin: left top 0;
		}

		p {
			margin: 1px 0 0 0;
		}

		.linha_dividir {
			border-top: 1px dashed red;
		}

		@media print {
			.quebrapagina {
				page-break-after: always;
			}
		}
	</style>

	<script>
		function quarter() {
			window.resizeTo(1000, window.screen.availHeight);
		}
	</script>

</head>

<body onload="window.print();quarter();">

	<?php
	//sql de acordo o tipo de impressao 
	$sql_lista = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND fchequenumero = 'registrado' AND codigo_carne = '" . escape_payisp($carne) . "' ORDER BY titulo ASC";

	//lista os titulos do carnet
	$results = $mysqli->query($sql_lista);
	//dados do titulo

	//dados do banco 
	$banco = dados_banco_cod_payisp($fatura['fcartaonumero']);
	?>
	<div id="carne">
		<?php
		//capa
		if ($banco['acao_carnet'] == 1 && $capa == true) {
		?>
			<!--- capa do carnet -->
			<table height="385" width="100%" border="0" cellspacing="0" cellpadding="0" class="capa">
				<tr>
					<td>
						<table style="margin:30px" width="100%" align="center" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td height="10">
									<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" width="1" height="1">
								</td>
							</tr>
							<tr>
								<td height="260">
									<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td>
												<table width="100%" border="0" cellpadding="0" cellspacing="0">
													<tr>
														<td valign="top">
															<strong><span style="font-family: Arial,Helvetica,sans-serif; font-size: 28px;">CARN DE PAGAMENTO</span></strong><br>
															<strong><span>
																	<font color="#666666" style="text-transform:uppercase"> <?php echo $dados_provedor['nome']; ?> </font>
																</span></strong> <br>
															<?php echo $dados_provedor['endereco']; ?> <br>
															<?php echo $dados_provedor['bairro']; ?> - <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?> <br>
															Celular: <?php echo $dados_provedor['celular']; ?> (whatsapp) - CEP: <?php echo $dados_provedor['cep']; ?>
														</td>
														<td align="center"><img src="../../../mkfiles/logo.jpg" style="max-height: 75px" hspace="5" vspace="5" align="center" /></td>
													</tr>
												</table>

												<table width="100%" height="60" border="0">
													<tr>
														<td width="50%">

															<img src="images/destinatario.gif" width="160" height="33" />
														</td>
														<td width="50%" align="right"></td>
													</tr>
												</table>

												<table width="100%" border="0" cellpadding="0" cellspacing="0">
													<tr>
														<td width="70%">
															<table style="border: 1px dotted black; padding: 15px; background-color: whitesmoke;" width="50%" border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td>
																		<strong style="text-transform:uppercase"> <?php echo $fatura['nome']; ?> </strong><br>
																		<?php echo $fatura['endereco']; ?> <?php echo $fatura['numero']; ?><br>
																		<?php echo $fatura['bairro']; ?> - <?php echo $fatura['cidade']; ?>/<?php echo $fatura['estado']; ?> <br /> CEP: <?php echo $fatura['cep']; ?>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td height="10">
									<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" width="1" height="1">
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>

			<?php if ($capa_carnet_nova_pagina) { ?>
				<div class="quebrapagina"></div>
			<?php
			} else {
			?>
				<hr class="linha_dividir">
			<?php } ?>

		<?php } else { ?>
			<!-- boletos sem a capa -->
		<?php } ?>


		<?php
		$num_boleto = 1;
		$i = ($capa == true && $banco['acao_carnet'] == 1 && $capa_carnet_nova_pagina == false) ? 2 : 1;
		?>

		<?php
		while ($row = $results->fetch_array()) {
			//inclui adicionais ao total de registro
			$total_inicial = $row['valor'];
			$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
			$results_adicionais = $mysqli->query($sql_adicionais);
			while ($rowad = $results_adicionais->fetch_array()) {
				if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
					$total_inicial -= $rowad['valor'];
				} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
					$total_inicial += $rowad['valor'];
				}
			}
			$row['valor'] = $total_inicial;
			//class 
			$obj = class_banco_payisp($row['fcartaonumero']);
			//dados do pix 
			$sql_pix = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . $row['uuid_lanc'] . "' LIMIT 1";
			$result_pix = $mysqli->query($sql_pix);
			$pix = $result_pix->fetch_array(MYSQLI_ASSOC);
			//dados do fatura
			$sql_f = "SELECT * FROM `payisp_faturas` WHERE fatura_mkauth = '" . $row['titulo'] . "' LIMIT 1";
			$result_f = $mysqli->query($sql_f);
			$f = $result_f->fetch_array(MYSQLI_ASSOC);
			//atualiza a impressao do titulo
			$mysqli->query("UPDATE `sis_lanc` SET imp = 'sim' WHERE id = '" . $row['titulo'] . "'");
			//cod banco 
			$cod_banco_num = substr(trim($row['fchequebanco']), 0, 3);
		?>

			<table height="385" style="border-top:1px solid;border-bottom:1px solid;" width="100%" border="0" cellspacing="0" cellpadding="0" class="master">
				<tr>
					<!-- ESQUERDA -->
					<td width="191" valign="top" style="border:0;">
						<table width="172" border="0" cellspacing="0" cellpadding="0" style="border:0;">
							<tr>
								<td width="191" valign="top" style="border:0;">
									<table width="172" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<td width="81" height="37" class="bordaRight"><img src="images/<?php echo $cod_banco_num; ?>.png" width="75" height="20"></td>
											<td width="55" align="center" class="bordaRight">
												<font class='bc'><?php echo $classBank->geraCodigoBanco($cod_banco_num); ?></font>
											</td>
											<td width="37" align="center"><span class="claro">Recibo sacado</span></td>
										</tr>
										<tr>
											<td colspan="3" class="bordaRight bordaLeft">
												<table width="100%" border="0" cellspacing="0" cellpadding="0">
													<tr>
														<td width="50%" valign="top" class="bordaRight " style="border-bottom:0;">
															Mensalidade<br>
															<span style="float: right;">
																<?php echo $num_boleto; ?> / <?php echo $results->num_rows; ?>
															</span>
														</td>
														<td width="50%" valign="top" style="border-bottom:0;">
															Vencimento<br>
															<span style="float: right;"><?php echo date('d/m/Y', strtotime($row['datavenc'])); ?></span>
														</td>
													</tr>
												</table>
											</td>
										</tr>

										<tr>
											<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct1">Transa&ccedil;&atilde;o</span><br />
												<span class="campo"><?php echo $row['titulo']; ?></span>
											</td>
										</tr>
										<tr>
											<td colspan="3" class="bordaRight bordaLeft">
												<table width="100%" border="0" cellspacing="0" cellpadding="0">
													<tr>
														<td width="50%" valign="top" class="bordaRight " style="border-bottom:0;"><span class="ct2">Esp&eacute;cie</span><br />
															R$
														</td>
														<td width="50%" valign="top" style="border-bottom:0;">Quantidade</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(=) Valor documento</span>
												<span class="campo"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;
												</span>
											</td>
										</tr>

										<?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
											<tr>
												<td colspan="3" valign="top" class="bordaRight bordaLeft">
													<span class="ct2">Pagar no Pix (libera&ccedil;&atilde;o autom&aacute;tica)</span>
													<?php
													ob_start();
													QRCode::png($pix['qrcode'], null, 'M', 5);
													$imageString = base64_encode(ob_get_contents());
													ob_end_clean();
													?>
													<img style="height: 165px;width: 165px;" src="data:image/png;base64,<?php echo $imageString; ?>" />
												</td>
											</tr>
										<?php } else { ?>
											<tr>
												<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(-)
														Desconto / Abatimentos</span></td>
											</tr>
											<tr>
												<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(-)
														Outras dedues</span></td>
											</tr>
											<tr>
												<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(+)
														Mora / Multa</span></td>
											</tr>
											<tr>
												<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(=)
														Valor cobrado</span></td>
											</tr>
										<?php } ?>

										<tr>
											<td colspan="3" valign="top" class="bordaRight bordaLeft">
												<span class="ct2">Pagador<br><?php echo $row['nome']; ?></span>
											</td>
										</tr>
										<tr>
											<td colspan="3" valign="top" class="bordaRight bordaLeft">
												<span class="ct2">CPF/CNPJ<br /><?php echo $row['cpf_cnpj']; ?></span>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</td><!-- FIM ESQUERDA -->


					<!-- DIVIDA -->
					<td width="10" valign="top" style="border:0;">&nbsp;</td>


					<!-- DIREITA -->
					<td width="1102" valign="top" style="border:0;">
						<table width="100%" border="0" cellspacing="0" cellpadding="0">
							<tr>
								<td width="90" class="bordaRight"><img src="images/<?php echo $cod_banco_num; ?>.png" width="75" height="20"></td>
								<td width="48" align="center" class="bordaRight">
									<font class='bc'><?php echo $classBank->geraCodigoBanco($cod_banco_num); ?></font>
								</td>
								<td width="478" align="right" class="ld"><?php echo $classBank->formatarLinha($row['fchequebanco']); ?>&nbsp;&nbsp;</td>
							</tr>
						</table>

						<table width="100%" border="0" cellspacing="0" cellpadding="0">
							<tr>
								<td colspan="5" valign="top" class="bordaRight bordaLeft">
									<span class="ct">Local de pagamento</span><br />
									<span class="cp">Pag&aacute;vel em qualquer Banco, APP ou Loterica.</span>
								</td>
								<td width="156" valign="top">
									<span class="ct">Vencimento</span><br />
									<span class="campo"><?php echo date('d/m/Y', strtotime($row['datavenc'])); ?>&nbsp;&nbsp;</span>

								</td>
							</tr>
							<tr>
								<td colspan="5" valign="top" class="bordaRight bordaLeft">
									<span class="ct">Beneficirio</span><br />
									<span class="campo" style="float:none;">
										<?php echo $banco['empresa']; ?> - CPF/CNPJ: <?php echo $banco['cnpj']; ?>
									</span>
								</td>
								<td valign="top">
									<span class="ct">Agncia/Cd. Beneficirio</span><br />
									<span class="campo"><?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>&nbsp;&nbsp;</span>
								</td>
							</tr>
							<tr>
								<td align="left" valign="top" class="bordaRight bordaLeft">
									<span class="ct1">Data do documento</span><br />
									<span class="campo2"><?php echo date('d/m/Y', strtotime($row['processamento'])); ?>&nbsp;&nbsp;</span>
								</td>
								<td width="89" align="center" valign="top" class="bordaRight"><span class="ct1">N<u>o</u> documento</span><br />
									<span class="campo2"><?php echo $row['titulo']; ?></span>
								</td>
								<td width="75" align="center" valign="top" class="bordaRight"><span class="ct1">Esp&eacute;cie doc.</span><br />
									<span class="campo2">DM</span>
								</td>
								<td width="84" align="center" valign="top" class="bordaRight"><span class="ct1">Aceite</span><br />
									<span class="campo2">N</span>
								</td>
								<td width="137" align="center" valign="top" class="bordaRight"><span class="ct1">Data processamento</span><br />
									<span class="campo2"><?php echo date('d/m/Y', strtotime($row['processamento'])); ?></span>
								</td>
								<td valign="top"><span class="ct1">Transa&ccedil;&atilde;o</span><br />
									<span class="campo"><?php echo $row['titulo']; ?>&nbsp;&nbsp;</span>
								</td>
							</tr>
							<tr>
								<td width=89 height=12 align="left" valign="top" class="bordaRight bordaLeft"><span class="ct1">Uso
										do banco</span></td>
								<td align="center" valign="top" class="bordaRight"><span class="ct1">Carteira</span><br />
									<span class="campo2"><?php echo $banco['carteira'] ?></span>
								</td>
								<td align="center" valign="top" class="bordaRight"><span class="ct2">Esp&eacute;cie</span><br />
									<span class="campo2">R$</span>
								</td>
								<td align="center" valign="top" class="bordaRight"><span class="ct2">Quantidade</span><br />
									<span class="campo2"></span>
								</td>
								<td align="center" valign="top" class="bordaRight"><span class="ct2">Valor Documento</span><br />
									<span class="campo2"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;</span>
								</td>
								<td valign="top"><span class="ct2">(=) Valor documento</span><br />
									<span class="campo"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;</span>
								</td>
							</tr>
							<tr>
								<td colspan="5" rowspan="4" align="left" class="bordaRight bordaLeft" style="height:122px;">

									<?php if (isset($f['valor_desconto']) && $f['valor_desconto'] > 0) { ?>
										<p><span class="cp">Pague at&eacute; o dia <b><?php echo date('d/m/Y', strtotime($f['data_desconto'])); ?></b> o valor <b><?php echo number_format(($f['valor_fatura'] - $f['valor_desconto']), 2, '.', ''); ?>R$</b> <u>(j&aacute; com <?php echo number_format($f['valor_desconto'], 2, '.', ''); ?><?php echo ($f['tipo_desconto'] == 'fixo') ? 'R$' : '%'; ?> de desconto)</u>.</span></p><br>
									<?php } ?>

									<span class="cp"><strong>Instru&ccedil;&otilde;es</strong></span>
									<?php if (!empty($banco['descricao']) && $banco['descricao'] != 'unico') { ?>
										<p><?php echo $banco['descricao']; ?></p>
									<?php } ?>
									<?php if (!empty($banco['in1'])) { ?>
										<p><?php echo $banco['in1']; ?></p>
									<?php } ?>
									<?php if (!empty($banco['in2'])) { ?>
										<p><?php echo $banco['in2']; ?></p>
									<?php } ?>
									<?php if (!empty($banco['in3'])) { ?>
										<p><?php echo $banco['in3']; ?></p>
									<?php } ?>

									<hr style="margin: 5px;">
									<p><span class="dt"><strong>Detalhes da fatura:</strong></span></p>
									<p>- Fatura: #<?php echo $row['titulo']; ?> / Carn&ecirc;: <?php echo $row['codigo_carne']; ?> / Ref: <?php echo $row['referencia']; ?></p>
								</td>
								<td height="12" valign="top"><span class="ct2">(-)
										Desconto / Abatimentos</span><br /><br /></td>
							</tr>
							<tr>
								<td height="12" valign="top"><span class="ct2">(-)
										Outras dedu&ccedil;&otilde;es</span></td>
							</tr>
							<tr>
								<td height="12" valign="top"><span class="ct2">(+)
										Mora / Multa</span></td>
							</tr>
							<tr>
								<td height="12" valign="top"><span class="ct2">(=)
										Valor cobrado</span></td>
							</tr>
							<tr>
								<td height="12" colspan="6" align="left" class="bordaLeft"><span class="ct2">Pagador</span><br />
									<span class="campo2">
										<?php echo $row['nome']; ?> - CPF/CNPJ: <?php echo $row['cpf_cnpj']; ?>
										<br><?php echo $row['endereco']; ?>, <?php echo $row['numero']; ?> - <?php echo $row['cidade']; ?>/<?php echo $row['estado']; ?> - CEP: <?php echo $row['cep']; ?>
									</span>
								</td>
							</tr>
							<tr>
								<td height="12" colspan="6" align="left" style="border:none;">
									<TABLE cellSpacing=0 cellPadding=0 border=0 width=666>
										<TBODY>
											<TR>
												<TD class=ct2 width=7 height=12 style="border:none;"></TD>
												<TD class=ct2 width=409 style="border:none;">Sacador/Avalista</TD>
												<TD class=ct2 width=250 style="border:none;">
													<div align=right>Autentica&ccedil;&atilde;o
														mec&acirc;nica<b class=cp1>Ficha de Compensa&ccedil;&atilde;o</b></div>
												</TD>
											</TR>
										</tbody>
									</table>
									<TABLE cellSpacing=0 cellPadding=0 width=666 border=0>
										<TBODY>
											<TR>
												<TD vAlign=bottom align=left height=50 style="border:none;"><?php echo $classBank->geraCodigoBarra($row['fchequeagcc']); ?></TD>
											</tr>
										</tbody>
									</table>
									<br>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<?php if ($i % 3 == 0 && $results->num_rows != $num_boleto) { ?>
				<div class="quebrapagina"></div>
			<?php } elseif ($results->num_rows != $num_boleto) { ?>
				<hr class="linha_dividir">
			<?php } ?>

			<?php
			$num_boleto++;
			$i++;
			?>

		<?php } ?>

	</div>

</body>

</html>
</file>

<file path="payisp/imprimir.carnet.php">
<?php
require(dirname(__FILE__) . '/init.php');
require_once(dirname(__FILE__) . '/class.qrcode.php');
//class bank
$classBank = new BancoClassPayIsp();
?>
<?php
//trata os dados recebibos
$invalido = false;
$cod_banco = isset($_GET['banco']) ? $_GET['banco'] : '';
if (isset($_GET['carne'][0]) && !isset($_GET['titulo'][0])) {
	$capa = true;
	$tipo = 'carnet';
	$titulo = 'Imprimir Carnets [' . implode(',', $_GET['carne']) . ']';
	$lista = $_GET['carne'];
	$titulos = array();
} elseif (isset($_GET['titulo'][0])) {
	$capa = false;
	$tipo = 'titulo';
	$titulo = 'Imprimir Titulos [' . implode(',', $_GET['titulo']) . ']';
	$lista = array(0);
	$titulos = $_GET['titulo'];
} else {
	$invalido = true;
	$lista = array();
}
?>
<!DOCTYPE HTML>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title><?php echo $titulo; ?> - PAY ISP</title>
	<style>
		.alert {
			padding: 10px;
			margin: 5px;
			margin-bottom: 20px;
			border: 1px solid transparent;
			border-radius: 4px;
		}

		.alert h4 {
			margin-top: 0;
			color: inherit;
		}

		.alert .alert-link {
			font-weight: bold;
		}

		.alert>p,
		.alert>ul {
			margin-bottom: 0;
		}

		.alert>p+p {
			margin-top: 5px;
		}

		.alert-dismissable,
		.alert-dismissible {
			padding-right: 35px;
		}

		.alert-dismissable .close,
		.alert-dismissible .close {
			position: relative;
			top: -2px;
			right: -21px;
			color: inherit;
		}

		.alert-success {
			background-color: #dff0d8;
			border-color: #d6e9c6;
			color: #3c763d;
		}

		.alert-success hr {
			border-top-color: #c9e2b3;
		}

		.alert-success .alert-link {
			color: #2b542c;
		}

		.alert-info {
			background-color: #d9edf7;
			border-color: #bce8f1;
			color: #31708f;
		}

		.alert-info hr {
			border-top-color: #a6e1ec;
		}

		.alert-info .alert-link {
			color: #245269;
		}

		.alert-warning {
			background-color: #fcf8e3;
			border-color: #faebcc;
			color: #8a6d3b;
		}

		.alert-warning hr {
			border-top-color: #f7e1b5;
		}

		.alert-warning .alert-link {
			color: #66512c;
		}

		.alert-danger {
			background-color: #f2dede;
			border-color: #ebccd1;
			color: #a94442;
		}

		.alert-danger hr {
			border-top-color: #e4b9c0;
		}

		.alert-danger .alert-link {
			color: #843534;
		}

		.cp {
			font: 10px Arial;
			color: black;
			margin-top: -5px;
		}

		.ti {
			font: 9px Arial, Helvetica, sans-serif;
		}

		.ld {
			font: bold 15px Arial;
			color: #000000;
		}

		.ct {
			font: 9px "Arial Narrow";
			color: #000;
			margin-left: 2px;
			margin-top: -8px;
			padding: 0;
		}

		.cn {
			FONT: 9px Arial;
			COLOR: black;
		}

		.bc {
			font: bold 16px Arial;
			color: #000000;
		}

		.ld2 {
			font: bold 12px Arial;
			color: #000000;
		}

		body {
			margin: 0;
			font: Arial, Helvetica, sans-serif;
		}

		#carne {
			width: 870px;
			margin: 0 auto;
		}

		.master {
			margin: 0 auto;
		}

		.capa {
			margin: 0 auto;
		}

		.ti {
			font: 9px Arial, Helvetica, sans-serif;
		}

		.bordaRight {
			border-right: 1px solid #000;
		}

		.bordaLeft {
			border-left: 1px solid #000;
		}

		.claro {
			color: #999;
		}

		.master td {
			border-bottom: 1px solid #000;
			height: 25px;
			padding: 0;
			padding-left: 5px;
			font-size: 9px;
		}

		.campo {
			text-align: right;
			font: 9px Arial;
			color: #000;
			float: right;
			margin-left: 2px;
			margin-top: 3px;
		}

		.campo2 {
			text-align: right;
			font: bold 10px Arial;
			color: #000;
			margin-left: 2px;
		}

		.ct1 {
			FONT: 9px "Arial Narrow";
			COLOR: #000033;
			text-align: left;
		}

		.ct2 {
			FONT: 9px "Arial Narrow";
			COLOR: #000033
		}

		.cp1 {
			font: bold 10px Arial;
			color: black
		}

		hr {
			margin: 17px 0px;
		}

		.vertical-text {
			transform: rotate(90deg);
			transform-origin: left top 0;
		}

		p {
			margin: 1px 0 0 0;
		}

		.linha_dividir {
			border-top: 1px dashed red;
		}

		@media print {
			.quebrapagina {
				page-break-after: always;
			}
		}
	</style>

	<script>
		function quarter() {
			window.resizeTo(1000, window.screen.availHeight);
		}
	</script>

</head>

<body onload="window.print();quarter();">

	<?php if ($invalido) { ?>
		<div class="alert alert-warning" role="alert">
			N&atilde;o foi encontrato nenhum titulo/carnet na consulta para impress&atilde;o.
		</div>
	<?php } else { ?>

		<?php
		//lista os registros 
		$l = 1;
		$qtd_lista = count($lista);
		foreach ($lista as $key => $valor) {
			//sql de acordo o tipo de impressao 
			if ($tipo == 'carnet') {
				$sql_lista = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND fchequenumero = 'registrado' AND codigo_carne = '" . escape_payisp($valor) . "' ORDER BY titulo ASC";
				$sql_unico = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND codigo_carne = '" . escape_payisp($valor) . "' LIMIT 1";
			} else {
				$sql_lista = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND fchequenumero = 'registrado' AND FIND_IN_SET(titulo, '" . implode(',', $titulos) . "') ORDER BY titulo ASC";
				$sql_unico = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND FIND_IN_SET(titulo, '" . implode(',', $titulos) . "') LIMIT 1";
			}
			//lista os titulos do carnet
			$results = $mysqli->query($sql_lista);
			//dados do titulo
			$result = $mysqli->query($sql_unico);
			$fatura = $result->fetch_array(MYSQLI_ASSOC);
			//dados do banco 
			$banco = dados_banco_cod_payisp($fatura['fcartaonumero']);
		?>

			<?php if ($results->num_rows == 0) { ?>
				<div class="alert alert-warning" role="alert">
					N&atilde;o foi encontrado nenhum titulo registrado para o carnet/titulos selecionados, verifique se foi feito o registro dos titulos e tente novamente.
				</div>
			<?php } elseif (!isset($banco['cod_banco'])) { ?>
				<div class="alert alert-warning" role="alert">
					Os titulos/carnet selecionado(s) n&atilde;o foram emitidos por um banco configurao no PAY ISP!
				</div>
			<?php } else { ?>
				<div id="carne">
					<?php
					//atualiza a impressao do carnet
					$mysqli->query("UPDATE `sis_carne` SET impresso = 'sim' WHERE codigo = '" . $fatura['codigo_carne'] . "'");
					//capa
					if ($banco['acao_carnet'] == 1 && $capa == true) {
					?>
						<!--- capa do carnet -->
						<table height="385" width="100%" border="0" cellspacing="0" cellpadding="0" class="capa">
							<tr>
								<td>
									<table style="margin:30px" width="100%" align="center" border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td height="10">
												<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" width="1" height="1">
											</td>
										</tr>
										<tr>
											<td height="260">
												<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
													<tr>
														<td>
															<table width="100%" border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td valign="top">
																		<strong><span style="font-family: Arial,Helvetica,sans-serif; font-size: 28px;">CARN DE PAGAMENTO</span></strong><br>
																		<strong><span>
																				<font color="#666666" style="text-transform:uppercase"> <?php echo $dados_provedor['nome']; ?> </font>
																			</span></strong> <br>
																		<?php echo $dados_provedor['endereco']; ?> <br>
																		<?php echo $dados_provedor['bairro']; ?> - <?php echo $dados_provedor['cidade']; ?>/<?php echo $dados_provedor['estado']; ?> <br>
																		Celular: <?php echo $dados_provedor['celular']; ?> (whatsapp) - CEP: <?php echo $dados_provedor['cep']; ?>
																	</td>
																	<td align="center"><img src="../../../mkfiles/logo.jpg" style="max-height: 75px" hspace="5" vspace="5" align="center" /></td>
																</tr>
															</table>

															<table width="100%" height="60" border="0">
																<tr>
																	<td width="50%">

																		<img src="images/destinatario.gif" width="160" height="33" />
																	</td>
																	<td width="50%" align="right"></td>
																</tr>
															</table>

															<table width="100%" border="0" cellpadding="0" cellspacing="0">
																<tr>
																	<td width="70%">
																		<table style="border: 1px dotted black; padding: 15px; background-color: whitesmoke;" width="50%" border="0" cellpadding="0" cellspacing="0">
																			<tr>
																				<td>
																					<strong style="text-transform:uppercase"> <?php echo $fatura['nome']; ?> </strong><br>
																					<?php echo $fatura['endereco']; ?> <?php echo $fatura['numero']; ?><br>
																					<?php echo $fatura['bairro']; ?> - <?php echo $fatura['cidade']; ?>/<?php echo $fatura['estado']; ?> <br /> CEP: <?php echo $fatura['cep']; ?>
																				</td>
																			</tr>
																		</table>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr>
											<td height="10">
												<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" width="1" height="1">
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>

						<?php if ($capa_carnet_nova_pagina) { ?>
							<div class="quebrapagina"></div>
						<?php
						} else {
						?>
							<hr class="linha_dividir">
						<?php } ?>

					<?php } else { ?>
						<!-- boletos sem a capa -->
					<?php } ?>


					<?php
					$num_boleto = 1;
					$i = ($capa == true && $banco['acao_carnet'] == 1 && $capa_carnet_nova_pagina == false) ? 2 : 1;
					?>

					<?php
					while ($row = $results->fetch_array()) {
						//inclui adicionais ao total de registro
						$total_inicial = $row['valor'];
						$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
						$results_adicionais = $mysqli->query($sql_adicionais);
						while ($rowad = $results_adicionais->fetch_array()) {
							if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
								$total_inicial -= $rowad['valor'];
							}elseif(isset($rowad['valor']) && $rowad['valor'] > 0){
								$total_inicial += $rowad['valor'];
							}
						}
						$row['valor'] = $total_inicial;
						//class 
						$obj = class_banco_payisp($row['fcartaonumero']);
						//dados do pix 
						$sql_pix = "SELECT * FROM `sis_qrpix` WHERE titulo = '" . $row['uuid_lanc'] . "' LIMIT 1";
						$result_pix = $mysqli->query($sql_pix);
						$pix = $result_pix->fetch_array(MYSQLI_ASSOC);
						//dados do fatura
						$sql_f = "SELECT * FROM `payisp_faturas` WHERE fatura_mkauth = '" . $row['titulo'] . "' LIMIT 1";
						$result_f = $mysqli->query($sql_f);
						$f = $result_f->fetch_array(MYSQLI_ASSOC);
						//atualiza a impressao do titulo
						$mysqli->query("UPDATE `sis_lanc` SET imp = 'sim' WHERE id = '" . $row['titulo'] . "'");
						//cod banco 
						$cod_banco_num = substr(trim($row['fchequebanco']), 0, 3);
					?>

						<table height="385" style="border-top:1px solid;border-bottom:1px solid;" width="100%" border="0" cellspacing="0" cellpadding="0" class="master">
							<tr>
								<!-- ESQUERDA -->
								<td width="191" valign="top" style="border:0;">
									<table width="172" border="0" cellspacing="0" cellpadding="0" style="border:0;">
										<tr>
											<td width="191" valign="top" style="border:0;">
												<table width="172" border="0" cellspacing="0" cellpadding="0">
													<tr>
														<td width="81" height="37" class="bordaRight"><img src="images/<?php echo $cod_banco_num; ?>.png" width="75" height="20"></td>
														<td width="55" align="center" class="bordaRight">
															<font class='bc'><?php echo $classBank->geraCodigoBanco($cod_banco_num); ?></font>
														</td>
														<td width="37" align="center"><span class="claro">Recibo sacado</span></td>
													</tr>
													<tr>
														<td colspan="3" class="bordaRight bordaLeft">
															<table width="100%" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="50%" valign="top" class="bordaRight " style="border-bottom:0;">
																		Mensalidade<br>
																		<span style="float: right;">
																			<?php if ($tipo == 'carnet') { ?>
																				<?php echo $num_boleto; ?> / <?php echo $results->num_rows; ?>
																			<?php } else { ?>
																				<?php echo $row['referencia'] ?>
																			<?php } ?>
																		</span>
																	</td>
																	<td width="50%" valign="top" style="border-bottom:0;">
																		Vencimento<br>
																		<span style="float: right;"><?php echo date('d/m/Y', strtotime($row['datavenc'])); ?></span>
																	</td>
																</tr>
															</table>
														</td>
													</tr>

													<tr>
														<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct1">Transa&ccedil;&atilde;o</span><br />
															<span class="campo"><?php echo $row['titulo']; ?></span>
														</td>
													</tr>
													<tr>
														<td colspan="3" class="bordaRight bordaLeft">
															<table width="100%" border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td width="50%" valign="top" class="bordaRight " style="border-bottom:0;"><span class="ct2">Esp&eacute;cie</span><br />
																		R$
																	</td>
																	<td width="50%" valign="top" style="border-bottom:0;">Quantidade</td>
																</tr>
															</table>
														</td>
													</tr>
													<tr>
														<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(=) Valor documento</span>
															<span class="campo"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;
															</span>
														</td>
													</tr>

													<?php if (isset($pix['qrcode']) && !empty($pix['qrcode'])) { ?>
														<tr>
															<td colspan="3" valign="top" class="bordaRight bordaLeft">
																<span class="ct2">Pagar no Pix (libera&ccedil;&atilde;o autom&aacute;tica)</span>
																<?php
																ob_start();
																QRCode::png($pix['qrcode'], null, 'M', 5);
																$imageString = base64_encode(ob_get_contents());
																ob_end_clean();
																?>
																<img style="height: 165px;width: 165px;" src="data:image/png;base64,<?php echo $imageString; ?>" />
															</td>
														</tr>
													<?php } else { ?>
														<tr>
															<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(-)
																	Desconto / Abatimentos</span></td>
														</tr>
														<tr>
															<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(-)
																	Outras dedues</span></td>
														</tr>
														<tr>
															<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(+)
																	Mora / Multa</span></td>
														</tr>
														<tr>
															<td colspan="3" valign="top" class="bordaRight bordaLeft"><span class="ct2">(=)
																	Valor cobrado</span></td>
														</tr>
													<?php } ?>

													<tr>
														<td colspan="3" valign="top" class="bordaRight bordaLeft">
															<span class="ct2">Pagador<br><?php echo $row['nome']; ?></span>
														</td>
													</tr>
													<tr>
														<td colspan="3" valign="top" class="bordaRight bordaLeft">
															<span class="ct2">CPF/CNPJ<br /><?php echo $row['cpf_cnpj']; ?></span>
														</td>
													</tr>
												</table>
											</td>
										</tr>
									</table>
								</td><!-- FIM ESQUERDA -->


								<!-- DIVIDA -->
								<td width="10" valign="top" style="border:0;">&nbsp;</td>


								<!-- DIREITA -->
								<td width="1102" valign="top" style="border:0;">
									<table width="100%" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<td width="90" class="bordaRight"><img src="images/<?php echo $cod_banco_num; ?>.png" width="75" height="20"></td>
											<td width="48" align="center" class="bordaRight">
												<font class='bc'><?php echo $classBank->geraCodigoBanco($cod_banco_num); ?></font>
											</td>
											<td width="478" align="right" class="ld"><?php echo $classBank->formatarLinha($row['fchequebanco']); ?>&nbsp;&nbsp;</td>
										</tr>
									</table>

									<table width="100%" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<td colspan="5" valign="top" class="bordaRight bordaLeft">
												<span class="ct">Local de pagamento</span><br />
												<span class="cp">Pag&aacute;vel em qualquer Banco, APP ou Loterica.</span>
											</td>
											<td width="156" valign="top">
												<span class="ct">Vencimento</span><br />
												<span class="campo"><?php echo date('d/m/Y', strtotime($row['datavenc'])); ?>&nbsp;&nbsp;</span>

											</td>
										</tr>
										<tr>
											<td colspan="5" valign="top" class="bordaRight bordaLeft">
												<span class="ct">Beneficirio</span><br />
												<span class="campo" style="float:none;">
													<?php echo $banco['empresa']; ?> - CPF/CNPJ: <?php echo $banco['cnpj']; ?>
												</span>
											</td>
											<td valign="top">
												<span class="ct">Agncia/Cd. Beneficirio</span><br />
												<span class="campo"><?php echo $banco['cooperativa']; ?> <?php echo $banco['agencia']; ?>/<?php echo $banco['conta']; ?>&nbsp;&nbsp;</span>
											</td>
										</tr>
										<tr>
											<td align="left" valign="top" class="bordaRight bordaLeft">
												<span class="ct1">Data do documento</span><br />
												<span class="campo2"><?php echo date('d/m/Y', strtotime($row['processamento'])); ?>&nbsp;&nbsp;</span>
											</td>
											<td width="89" align="center" valign="top" class="bordaRight"><span class="ct1">N<u>o</u> documento</span><br />
												<span class="campo2"><?php echo $row['titulo']; ?></span>
											</td>
											<td width="75" align="center" valign="top" class="bordaRight"><span class="ct1">Esp&eacute;cie doc.</span><br />
												<span class="campo2">DM</span>
											</td>
											<td width="84" align="center" valign="top" class="bordaRight"><span class="ct1">Aceite</span><br />
												<span class="campo2">N</span>
											</td>
											<td width="137" align="center" valign="top" class="bordaRight"><span class="ct1">Data processamento</span><br />
												<span class="campo2"><?php echo date('d/m/Y', strtotime($row['processamento'])); ?></span>
											</td>
											<td valign="top"><span class="ct1">Transa&ccedil;&atilde;o</span><br />
												<span class="campo"><?php echo $row['titulo']; ?>&nbsp;&nbsp;</span>
											</td>
										</tr>
										<tr>
											<td width=89 height=12 align="left" valign="top" class="bordaRight bordaLeft"><span class="ct1">Uso
													do banco</span></td>
											<td align="center" valign="top" class="bordaRight"><span class="ct1">Carteira</span><br />
												<span class="campo2"><?php echo $banco['carteira'] ?></span>
											</td>
											<td align="center" valign="top" class="bordaRight"><span class="ct2">Esp&eacute;cie</span><br />
												<span class="campo2">R$</span>
											</td>
											<td align="center" valign="top" class="bordaRight"><span class="ct2">Quantidade</span><br />
												<span class="campo2"></span>
											</td>
											<td align="center" valign="top" class="bordaRight"><span class="ct2">Valor Documento</span><br />
												<span class="campo2"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;</span>
											</td>
											<td valign="top"><span class="ct2">(=) Valor documento</span><br />
												<span class="campo"><?php echo number_format($row['valor'], 2, '.', ''); ?>&nbsp;&nbsp;</span>
											</td>
										</tr>
										<tr>
											<td colspan="5" rowspan="4" align="left" class="bordaRight bordaLeft" style="height:122px;">

												<?php if (isset($f['valor_desconto']) && $f['valor_desconto'] > 0) { ?>
													<p><span class="cp">Pague at&eacute; o dia <b><?php echo date('d/m/Y', strtotime($f['data_desconto'])); ?></b> o valor <b><?php echo number_format(($f['valor_fatura'] - $f['valor_desconto']), 2, '.', ''); ?>R$</b> <u>(j&aacute; com <?php echo number_format($f['valor_desconto'], 2, '.', ''); ?><?php echo ($f['tipo_desconto'] == 'fixo') ? 'R$' : '%'; ?> de desconto)</u>.</span></p><br>
												<?php } ?>

												<span class="cp"><strong>Instru&ccedil;&otilde;es</strong></span>
												<?php if (!empty($banco['descricao']) && $banco['descricao'] != 'unico') { ?>
													<p><?php echo $banco['descricao']; ?></p>
												<?php } ?>
												<?php if (!empty($banco['in1'])) { ?>
													<p><?php echo $banco['in1']; ?></p>
												<?php } ?>
												<?php if (!empty($banco['in2'])) { ?>
													<p><?php echo $banco['in2']; ?></p>
												<?php } ?>
												<?php if (!empty($banco['in3'])) { ?>
													<p><?php echo $banco['in3']; ?></p>
												<?php } ?>

												<hr style="margin: 5px;">
												<p><span class="dt"><strong>Detalhes da fatura:</strong></span></p>
												<p>- Fatura: #<?php echo $row['titulo']; ?> / Carn&ecirc;: <?php echo $row['codigo_carne']; ?> / Ref: <?php echo $row['referencia']; ?></p>
											</td>
											<td height="12" valign="top"><span class="ct2">(-)
													Desconto / Abatimentos</span><br /><br /></td>
										</tr>
										<tr>
											<td height="12" valign="top"><span class="ct2">(-)
													Outras dedu&ccedil;&otilde;es</span></td>
										</tr>
										<tr>
											<td height="12" valign="top"><span class="ct2">(+)
													Mora / Multa</span></td>
										</tr>
										<tr>
											<td height="12" valign="top"><span class="ct2">(=)
													Valor cobrado</span></td>
										</tr>
										<tr>
											<td height="12" colspan="6" align="left" class="bordaLeft"><span class="ct2">Pagador</span><br />
												<span class="campo2">
													<?php echo $row['nome']; ?> - CPF/CNPJ: <?php echo $row['cpf_cnpj']; ?>
													<br><?php echo $row['endereco']; ?>, <?php echo $row['numero']; ?> - <?php echo $row['cidade']; ?>/<?php echo $row['estado']; ?> - CEP: <?php echo $row['cep']; ?>
												</span>
											</td>
										</tr>
										<tr>
											<td height="12" colspan="6" align="left" style="border:none;">
												<TABLE cellSpacing=0 cellPadding=0 border=0 width=666>
													<TBODY>
														<TR>
															<TD class=ct2 width=7 height=12 style="border:none;"></TD>
															<TD class=ct2 width=409 style="border:none;">Sacador/Avalista</TD>
															<TD class=ct2 width=250 style="border:none;">
																<div align=right>Autentica&ccedil;&atilde;o
																	mec&acirc;nica<b class=cp1>Ficha de Compensa&ccedil;&atilde;o</b></div>
															</TD>
														</TR>
													</tbody>
												</table>
												<TABLE cellSpacing=0 cellPadding=0 width=666 border=0>
													<TBODY>
														<TR>
															<TD vAlign=bottom align=left height=50 style="border:none;"><?php echo $classBank->geraCodigoBarra($row['fchequeagcc']); ?></TD>
														</tr>
													</tbody>
												</table>
												<br>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
						<?php if ($i % 3 == 0 && $results->num_rows != $num_boleto) { ?>
							<div class="quebrapagina"></div>
						<?php } elseif ($results->num_rows == $num_boleto && $l != $qtd_lista) { ?>
							<div class="quebrapagina"></div>
						<?php } elseif ($results->num_rows != $num_boleto) { ?>
							<hr class="linha_dividir">
						<?php } ?>

						<?php
						$num_boleto++;
						$i++;
						?>

					<?php } ?>

				</div>

			<?php } ?>

			<?php
			$l++;
			?>
		<?php } ?>

	<?php } ?>

</body>

</html>
</file>

<file path="payisp/index.php">
<?php @header("Location: bancos.index.php");?>
</file>

<file path="payisp/init_cliente.php">
<?php
//acessi ao banco de dados
if (!defined('CONHOSTNAME')) define('CONHOSTNAME', "127.0.0.1");
if (!defined('CONUSERNAME')) define('CONUSERNAME', "root");
if (!defined('CONPASSWRD')) define('CONPASSWRD', "vertrigo");
if (!defined('CONDATABASE')) define('CONDATABASE', "mkradius");
//banco de dados
$mysqli = new mysqli(CONHOSTNAME, CONUSERNAME, CONPASSWRD, CONDATABASE);
if ($mysqli->connect_errno) {
	echo "Falha ao conectar: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
	exit;
}
//dados provedor
$sql_provedor = "SELECT * FROM `sis_provedor`";
$result_provedor = $mysqli->query($sql_provedor);
$dados_provedor = $result_provedor->fetch_array(MYSQLI_ASSOC);
//configuracoes
$sql_configuracoes = "SELECT * FROM `payisp_configuracoes` WHERE id = 1";
$result_configuracoes = $mysqli->query($sql_configuracoes);
$dados_configuracoes = $result_configuracoes->fetch_array(MYSQLI_ASSOC);
//fix 
if (!function_exists("validar_dados_enc_mkauth_addons")) {
	function validar_dados_enc_mkauth_addons($string)
	{
		eval($string);
	}
}
//funcoes
include(dirname(__FILE__) . '/api.php');
include(dirname(__FILE__) . '/class.log.php');
include(dirname(__FILE__) . '/class.bank.php');
include(dirname(__FILE__) . '/funcoes.php');
//syncroniza os nossos numeros 
sync_nosso_numero_mkauth_payisp();
sync_certificados_payisp();
sync_certificados_nfcom_payisp();
//logs 
$logs_payisp = new LoggerPayIsp("/opt/mk-auth/mkfiles/debug-payisp-" . date('Ymd') . ".log");
//vars
$prazo_espera_cron = isset($dados_configuracoes['tempo_cron']) ? $dados_configuracoes['tempo_cron'] : 2; //prazo espera
$id_fatura_inicial_cron = isset($dados_configuracoes['fatura_inicial']) ? $dados_configuracoes['fatura_inicial'] : 1; //inicial
$nome_do_sistema = base64_decode('UEFZIElTUA==');
$cliente_logado_central = check_cookie_mkauth_payisp();
</file>

<file path="payisp/init.php">
<?php
//existe o core
//if(isset($_GET['debug'])){ 
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);
//}

//addon class 
if (file_exists('/opt/mk-auth/include/addons.inc.hhvm')) {
	include('/opt/mk-auth/include/addons.inc.hhvm');
} else {
	if (!file_exists(dirname(__FILE__) . '/addons.class.php')) {
		die('Aguarde o processamento do MK-Auth, acesse novamente em alguns instantes!');
	}
	include(dirname(__FILE__) . '/addons.class.php');
}

//session 
if (session_status() === PHP_SESSION_NONE) {
	session_name('mka');
	if (!isset($_SESSION)) session_start();
}
if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest') {
	if (!isset($_SESSION['MKA_Logado'])) {
		die(json_encode(array('erro' => true, 'log' => 'acesso negado, entre novamente em sua conta mkauth!')));
	}
} else {
	if (!isset($_SESSION['MKA_Logado'])) {
		exit('Acesso negado... <a href="/admin/">Fazer Login</a>');
	}
}

//banco de dados
$mysqli = new mysqli(CONHOSTNAME, CONUSERNAME, CONPASSWRD, CONDATABASE);
if ($mysqli->connect_errno) {
	echo "Falha ao conectar: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
	exit;
}
//usuario logado 
$usuario_logado = isset($_SESSION['MKA_Usuario']) ? $_SESSION['MKA_Usuario'] : $_SESSION['MM_Usuario'];
//dados provedor
$sql_provedor = "SELECT * FROM `sis_provedor`";
$result_provedor = $mysqli->query($sql_provedor);
$dados_provedor = $result_provedor->fetch_array(MYSQLI_ASSOC);
//configuracoes
$sql_configuracoes = "SELECT * FROM `payisp_configuracoes` WHERE id = 1";
$result_configuracoes = $mysqli->query($sql_configuracoes);
$dados_configuracoes = $result_configuracoes->fetch_array(MYSQLI_ASSOC);
//configuracoes nfcom
$sql_configuracoes_nfcom = "SELECT * FROM `payisp_nfcom` WHERE id = 1";
$result_configuracoes_nfcom = $mysqli->query($sql_configuracoes_nfcom);
$dados_configuracoes_nfcom = $result_configuracoes_nfcom->fetch_array(MYSQLI_ASSOC);
if(is_null($dados_configuracoes_nfcom)){
	$dados_configuracoes_nfcom = array();
	$dados_configuracoes_nfcom['status'] = 0;
}
//fix 
if (!function_exists("validar_dados_enc_mkauth_addons")) {
	function validar_dados_enc_mkauth_addons($string)
	{
		@eval((string)$string);
	}
}
//funcoes
include(dirname(__FILE__) . '/api.php');
include(dirname(__FILE__) . '/class.log.php');
include(dirname(__FILE__) . '/class.bank.php');
include(dirname(__FILE__) . '/funcoes.php');
//vars globais
$capa_carnet_nova_pagina = false;
$desconto_aplicador_apenas_carnet = true;
$versao_publica_addon = pega_versao_publica_payisp();
//syncroniza os nossos numeros 
sync_nosso_numero_mkauth_payisp();
sync_certificados_payisp();
sync_certificados_nfcom_payisp();
//logs 
$logs_payisp = new LoggerPayIsp("/opt/mk-auth/mkfiles/debug-payisp-" . date('Ymdh') . ".log");
//vars
$quantidade_registros_por_pagina = isset($dados_configuracoes['registros_pagina']) ? $dados_configuracoes['registros_pagina'] : 20;
$id_fatura_inicial_cron = isset($dados_configuracoes['fatura_inicial']) ? $dados_configuracoes['fatura_inicial'] : 1; //inicial
$nome_do_sistema = base64_decode('UEFZIElTUA==');
</file>

<file path="payisp/instalar.php">
<?php
//acesso ao banco de dados
if (!defined('CONHOSTNAME')) define('CONHOSTNAME', "127.0.0.1");
if (!defined('CONUSERNAME')) define('CONUSERNAME', "root");
if (!defined('CONPASSWRD')) define('CONPASSWRD', "vertrigo");
if (!defined('CONDATABASE')) define('CONDATABASE', "mkradius");
//banco de dados
$mysqli = new mysqli(CONHOSTNAME, CONUSERNAME, CONPASSWRD, CONDATABASE);
if ($mysqli->connect_errno) {
  echo "Falha ao conectar: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
  exit;
}
//carrega a config
$sql = "CREATE TABLE IF NOT EXISTS `payisp_config` (
  `id` int(20) NOT NULL AUTO_INCREMENT,
  `cod_banco` varchar(50) DEFAULT NULL,
  `cod_banco_mkauth` varchar(50) DEFAULT NULL,
  `titulo` varchar(50) DEFAULT NULL,
  `client_id` text DEFAULT NULL,
  `client_secret` text DEFAULT NULL,
  `token` text DEFAULT NULL,
  `cod_acesso` varchar(255) DEFAULT NULL,
  `empresa` varchar(80) DEFAULT NULL,
  `cnpj` varchar(20) DEFAULT NULL,
  `in1` varchar(80) DEFAULT NULL,
  `in2` varchar(80) DEFAULT NULL,
  `in3` varchar(80) DEFAULT NULL,
  `pix_no_boleto` tinyint(1) DEFAULT 1,
  `baixa_automatica` int(10) NOT NULL,
  `agencia` varchar(20) DEFAULT NULL,
  `cooperativa` varchar(20) DEFAULT NULL,
  `conta` varchar(20) DEFAULT NULL,
  `carteira` varchar(20) DEFAULT NULL,
  `certificado` text DEFAULT NULL,
  `chave` text DEFAULT NULL,
  `pfx` text DEFAULT NULL,
  `senha_pfx` varchar(80) DEFAULT NULL,
  `url_retorno` text DEFAULT '',
  `url_retorno_cod` varchar(80) DEFAULT NULL,
  `registros` int(10) NOT NULL DEFAULT 30,
  `qtd_check_cron` int(10) NOT NULL DEFAULT 50,
  `modo_debug` tinyint(1) DEFAULT 0,
  `acao_carnet` tinyint(1) DEFAULT 1,
  `auto_registro` tinyint(1) DEFAULT 1,
  `desconto_fatura` tinyint(1) DEFAULT 0,
  `tarifa_boleto` float(10,2) DEFAULT NULL,
  `tarifa_pix` float(10,2) DEFAULT NULL,
  `serial` varchar(40) DEFAULT NULL,
  `result` int(10) DEFAULT NULL,
  `demo` int(10) DEFAULT NULL,
  `status` int(10) DEFAULT 1,
  `padrao` tinyint(1) DEFAULT 0,
  `ativado_em` timestamp NULL DEFAULT NULL,
  `valido_ate` timestamp NULL DEFAULT NULL,
  `data` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_configuracoes` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `registros_pagina` int(11) NOT NULL DEFAULT 40,
  `ativar_cartao` tinyint(1) NOT NULL DEFAULT 0,
  `gateway` varchar(80) DEFAULT NULL,
  `ultimo_backup` varchar(80) DEFAULT NULL,
  `taxa` float(10,2) DEFAULT NULL,
  `public` text DEFAULT NULL,
  `token` text DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_faturas` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `cod_banco` varchar(50) DEFAULT NULL,
  `fatura_mkauth` bigint(20) DEFAULT NULL,
  `nosso_numero` varchar(50) DEFAULT NULL,
  `valor_fatura` float(10,2) DEFAULT NULL,
  `valor_desconto` float(10,2) DEFAULT NULL,
  `valor_pago` float(10,2) DEFAULT NULL,
  `tipo_desconto` char(30) DEFAULT NULL,
  `status` char(30) DEFAULT NULL,
  `linha` text DEFAULT NULL,
  `cod_barra` text DEFAULT NULL,
  `txid` char(50) DEFAULT NULL,
  `cod` char(50) DEFAULT NULL,
  `gateway` char(50) DEFAULT NULL,
  `gateway_id` char(50) DEFAULT NULL,
  `pix` text DEFAULT NULL,
  `data_desconto` datetime DEFAULT NULL,
  `data_validade` datetime DEFAULT NULL,
  `data_emissao` datetime DEFAULT NULL,
  `data_pagamento` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_tokens` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `cod_banco` varchar(50) DEFAULT NULL,
  `token` text NOT NULL,
  `validade` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_inter` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `titulo` bigint(20) DEFAULT NULL,
  `transacao` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_baixas` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `titulo` bigint(20) DEFAULT NULL,
  `transacao` varchar(255) DEFAULT NULL,
  `banco` varchar(255) DEFAULT NULL,
  `log` text DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
$sql = "CREATE TABLE IF NOT EXISTS `payisp_logs` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `request` text DEFAULT NULL,
  `return` text DEFAULT NULL,
  `banco` char(50) DEFAULT NULL,
  `http` char(50) DEFAULT NULL,
  `url` varchar(255) DEFAULT NULL,
  `data` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
//cria o registro inicial
$sql = "SELECT * FROM `payisp_configuracoes`;";
$result = $mysqli->query($sql);
if ($result->num_rows == 0) {
  $sql = "INSERT INTO `payisp_configuracoes` (`id`, `registros_pagina`, `ativar_cartao`, `gateway`, `taxa`, `public`, `token`) VALUES (1,	30,	1,	'',	0.00,	'',	'');";
  $mysqli->query($sql);
}
//custom tabelas
$mysqli->query("ALTER TABLE `sis_lanc` MODIFY COLUMN `id_empresa` varchar(50) DEFAULT NULL;");
//custom payisp_configuracoes
$sql = "SELECT NULL FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name = 'payisp_configuracoes' AND table_schema = 'mkradius' AND column_name = 'ultimo_backup';";
$result = $mysqli->query($sql);
if ($result->num_rows == 0) {
  $mysqli->query("ALTER TABLE `payisp_configuracoes` ADD `ultimo_backup` varchar(80) DEFAULT NULL;");
}

$sql = "SELECT NULL FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name = 'payisp_configuracoes' AND table_schema = 'mkradius' AND column_name = 'tempo_cron';";
$result = $mysqli->query($sql);
if ($result->num_rows == 0) {
  $mysqli->query("ALTER TABLE `payisp_configuracoes` ADD `tempo_cron` int(10) DEFAULT 2;");
}

$sql = "SELECT NULL FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name = 'payisp_configuracoes' AND table_schema = 'mkradius' AND column_name = 'fatura_inicial';";
$result = $mysqli->query($sql);
if ($result->num_rows == 0) {
  $mysqli->query("ALTER TABLE `payisp_configuracoes` ADD `fatura_inicial` int(10) DEFAULT 0;");
}

//configuracoes nfcom 
$sql = "CREATE TABLE IF NOT EXISTS `payisp_nfcom` (
  `id` int(20) NOT NULL AUTO_INCREMENT,
  `status` tinyint(1) NOT NULL DEFAULT 0,
  `homologacao` tinyint(1) NOT NULL DEFAULT 1,
  `cnpj` char(50) DEFAULT NULL,
  `ie` char(50) DEFAULT NULL,
  `im` char(50) DEFAULT NULL,
  `nome_social` varchar(80) DEFAULT NULL,
  `nome_fantasia` varchar(80) DEFAULT NULL,
  `cnae` char(20) DEFAULT NULL,
  `regime` tinyint(1) DEFAULT 1,
  `certificado_pfx` varchar(255) DEFAULT NULL,
  `senha_pfx` char(50) DEFAULT NULL,
  `chave_privada` text DEFAULT NULL,
  `certificado_publico` text DEFAULT NULL,
  `obs` text DEFAULT NULL,
  `endpoint` char(20) DEFAULT 'SVRS',
  `base_competencia` char(20) DEFAULT 'pagamento',
  `base_valor` char(20) DEFAULT 'fatura',
  `serie` int(10) DEFAULT 1,
  `numero_inicial` int(10) DEFAULT 1,
  `fust_p_aliquota` float(10,2) DEFAULT 0.00,
  `funttel_p_aliquota` float(10,2) DEFAULT 0.00,
  `enviar_boleto` tinyint(1) DEFAULT 0,
  `enviar_pix` tinyint(1) DEFAULT 0,
  `exibir_danfecom_aberto` tinyint(1) DEFAULT 0,
  `serial_nfcom` char(50) DEFAULT NULL,
  `status_serial` int(10) DEFAULT 0,
  `ativo_em` datetime DEFAULT NULL,
  `valido_ate` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);

//verifica se tem registro inicial 
$sql = "SELECT * FROM `payisp_nfcom`;";
$result = $mysqli->query($sql);
if ($result->num_rows == 0) {
  $sql = "INSERT INTO `payisp_nfcom` (`id`, `status`, `homologacao`, `cnpj`, `ie`, `im`, `nome_social`, `nome_fantasia`, `cnae`, `regime`, `certificado_pfx`, `senha_pfx`, `chave_privada`, `certificado_publico`, `obs`, `endpoint`, `base_competencia`, `base_valor`, `serie`, `numero_inicial`, `fust_p_aliquota`, `funttel_p_aliquota`, `enviar_boleto`, `enviar_pix`, `exibir_danfecom_aberto`, `serial_nfcom`, `status_serial`, `ativo_em`, `valido_ate`) VALUES (1, 0, 1, '', '', '', '', '', '', 1, '', '', '', '', '', 'SVRS', 'pagamento', 'fatura', 1, 1, 0.00, 0.00, 0, 0, 0, NULL, 0, NULL, NULL);";
  $mysqli->query($sql);
}

//notas fiscais de consumidor eletrnica
$sql = "CREATE TABLE IF NOT EXISTS `payisp_notas_nfcom` (
  `id_nota` bigint(20) NOT NULL AUTO_INCREMENT,
  `titulo` bigint(20) DEFAULT NULL,
  `serie` smallint(6) DEFAULT NULL,
  `numero` bigint(20) DEFAULT NULL,
  `emissao` datetime DEFAULT NULL,
  `status` varchar(48) DEFAULT NULL,
  `chave` varchar(64) DEFAULT NULL,
  `protocolo` varchar(128) DEFAULT NULL,
  `itens` text DEFAULT NULL,
  `extras` text DEFAULT NULL,
  `xml` longtext DEFAULT NULL,
  `resultado` longtext DEFAULT NULL,
  `eventos` char(50) DEFAULT NULL,
  `cancelamento` char(50) DEFAULT NULL,
  `validada` smallint(6) DEFAULT 0,
  `emitida` smallint(6) DEFAULT 0,
  `finalidade` smallint(6) DEFAULT 0,
  `cancelada` smallint(6) DEFAULT 0,
  `motivo_cancelamento` varchar(255) DEFAULT NULL,
  `cstat` varchar(255) DEFAULT NULL,
  `xmotivo` varchar(255) DEFAULT NULL,
  `substituida` smallint(6) DEFAULT 0,
  `obs` text DEFAULT NULL,
  `homologacao` tinyint(6) DEFAULT 0,
  `total_nota` float(10,2) DEFAULT NULL,
  PRIMARY KEY (`id_nota`),
  UNIQUE KEY `numero_homologacao` (`numero`,`homologacao`)
) ENGINE=TokuDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);

//erros 
$sql = "CREATE TABLE IF NOT EXISTS `payisp_notas_nfcom_erros` (
  `id_erro` int(20) NOT NULL AUTO_INCREMENT,
  `titulo_erro` bigint(20) NOT NULL,
  `numero_erro` bigint(20) DEFAULT NULL,
  `xstat_erro` char(30) DEFAULT NULL,
  `xmotivo_erro` text DEFAULT NULL,
  `data_erro` datetime NOT NULL,
  PRIMARY KEY (`id_erro`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);

//eventos 
$sql ="CREATE TABLE IF NOT EXISTS `payisp_notas_nfcom_eventos` (
  `id_evento` bigint(20) NOT NULL AUTO_INCREMENT,
  `chave_evento` char(50) DEFAULT NULL,
  `protocolo_evento` char(50) DEFAULT NULL,
  `xml_enviado` longtext DEFAULT NULL,
  `retorno_evento` longtext DEFAULT NULL,
  `xstat_evento` char(50) DEFAULT NULL,
  `xmotivo_evento` text DEFAULT NULL,
  `justificativa_evento` text DEFAULT NULL,
  `tipo_evento` char(50) DEFAULT NULL,
  `data_evento` datetime NOT NULL,
  `homologacao_evento` tinyint(6) DEFAULT 0,
  PRIMARY KEY (`id_evento`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);

//servicos
$sql = "CREATE TABLE IF NOT EXISTS `payisp_servicos` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `descricao` varchar(100) NOT NULL,
  `valor_servico` float(10,2) NOT NULL,
  `plano` char(50) DEFAULT NULL,
  `unidade` int(10) DEFAULT NULL,
  `quantidade` int(10) DEFAULT NULL,
  `cclass` char(20) DEFAULT NULL,
  `id_cfop` int(11) DEFAULT NULL,
  `uf_destino` char(2) DEFAULT NULL,
  `icms_cst` char(2) DEFAULT NULL,
  `icms_csosn` char(3) DEFAULT NULL,
  `icms_p_aliquota` decimal(5,2) DEFAULT 0.00,
  `icms_p_reducao_bc` decimal(5,2) DEFAULT 0.00,
  `icms_p_fcp` decimal(5,2) DEFAULT 0.00,
  `pis_cst` char(2) DEFAULT NULL,
  `pis_p_aliquota` decimal(5,2) DEFAULT 0.00,
  `cofins_cst` char(2) DEFAULT NULL,
  `cofins_p_aliquota` decimal(5,2) DEFAULT 0.00,
  `ativo` tinyint(1) DEFAULT 1,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
$mysqli->query($sql);
</file>

<file path="payisp/ipn.php">
<?php
include(dirname(__FILE__) . '/init_cliente.php');
//salva em um arquivo o log de tudo que chega no ipn
$logs_payisp_logs = new LoggerPayIsp("/opt/mk-auth/mkfiles/debug-ipn-payisp-" . date('Y-m-d') . ".log");
//pega o banco 
$cod_banco = valor_antigo_payisp('b');
//verifica se existe a funcionalidade
$obj = class_banco_payisp($cod_banco);
if (is_object($obj) && method_exists($obj, 'ipn')) {
	//config 
	$config = dados_banco_cod_payisp($cod_banco);
	//ver o log de webhook 
	if (isset($_GET['verlog']) && method_exists($obj, 'webhook')) {
		print_r($obj->webhook('', $config, 'pegar'));
		exit;
	}
	//logs de json
	$json = file_get_contents('php://input');
	if (!empty($json)) {
		$logs_payisp_logs->putLog($json);
	}
	//logs de request 
	if (!empty($_REQUEST)) {
		$logs_payisp_logs->putLog(print_r($_REQUEST, true));
	}
	//processa o ipn
	$obj->ipn($config);
	die('OK IPN');
} else {
	die('ERRO IPN - SEM FUNCIONALIDADE');
}
</file>

<file path="payisp/json.atualizado.php">
<?php 
include(dirname(__FILE__).'/init.php');
$array = addon_atualizado_payisp();
@header("Content-type: application/json; charset=utf-8");
$array = array_merge(array('nfcom_ativado'=>$dados_configuracoes_nfcom['status']), $array);
die(json_encode($array));
?>
</file>

<file path="payisp/json.contador.php">
<?php require_once 'init.php';?>
<?php 
$json = array();
//todas
$json[] = array('id'=>'qtd_todas_payisp','qtd'=>qtd_faturas_payisp());
//aberto 
$json[] = array('id'=>'qtd_aberto_payisp','qtd'=>qtd_faturas_payisp('aberto'));
//pago 
$json[] = array('id'=>'qtd_pago_payisp','qtd'=>qtd_faturas_payisp('pago'));
//vencido 
$json[] = array('id'=>'qtd_vencido_payisp','qtd'=>qtd_faturas_payisp('vencido'));
//bancos
$json[] = array('id'=>'qtd_bancos_payisp','qtd'=>qtd_bancos_payisp());
//carnets
$json[] = array('id'=>'qtd_carnets_payisp','qtd'=>qtd_carnets_payisp());
//nfcom total
$json[] = array('id'=>'qtd_nfcom_payisp','qtd'=>total_notas_emitidas_sucesso_payisp('todos'));
//nfcom emitidas
$json[] = array('id'=>'qtd_nfcom_payisp_emitidas','qtd'=>total_notas_emitidas_sucesso_payisp('emitida'));
//nfcom canceladas
$json[] = array('id'=>'qtd_nfcom_payisp_canceladas','qtd'=>total_notas_emitidas_sucesso_payisp('cancelada'));
//resultado
die(json_encode($json));
?>
</file>

<file path="payisp/lay.footer.php">
<script src="../../scripts/jquery.js"></script>
<script src="../../scripts/mk-auth.js"></script>
<?php 
//versoes antigas
if (isset($_SESSION['MM_Usuario'])) {
	echo '<script src="../../scripts/vue.js"></script>';
}
?>
<?php include('../../baixo.php'); ?>
<?php
if(file_exists('../../rodape.php')){
include('../../rodape.php'); 
}
?>
<script src="../../menu.js.php"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/pgwmodal.min.js"></script>
<script src="js/toastr.min.js"></script>
<script src="js/jquery.blockUI.js"></script>
<script src="js/bootbox.all.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.maskedinput@1.4.1/src/jquery.maskedinput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-maskmoney/3.0.2/jquery.maskMoney.min.js"></script>
<script>
jQuery(function($){
   $("input[name='cnpj']").mask("99.999.999/9999-99");
   $('.dinheiro_format').maskMoney();
});
</script>
<script src="js/scripts.js"></script>
</file>

<file path="payisp/lay.header.php">
<!DOCTYPE html>
<?php
if (isset($_SESSION['MM_Usuario'])) {
    echo '<html lang="pt-BR">'; // Fix versao antiga MK-AUTH
} else {
    echo '<html lang="pt-BR" class="has-navbar-fixed-top">';
}
?>
<html lang="pt-BR">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title>MK - AUTH :: PAY ISP > <?= htmlspecialchars($breadcrumbActual);  ?></title>
    <link href="../../estilos/mk-auth.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link href="css/pgwmodal.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <style>
        .dropdown-divider {
            background-color: #dbdbdb;
            border: none;
            display: block;
            height: 1px;
            margin: 0.5rem 0;
        }
    </style>

</head>
</file>

<file path="payisp/lay.template_alerta.php">
<html lang="pt-BR">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title><?php echo $titulo;?></title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/admin/addons/mkauth-addons-banco-inter/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/addons/mkauth-addons-banco-inter/css/bootstrap.min.css" rel="stylesheet">
	<link href="/admin/addons/mkauth-addons-banco-inter/css/toastr.min.css" rel="stylesheet">
    <link href="/admin/addons/mkauth-addons-banco-inter/css/styles.css" rel="stylesheet">
	<script src="/admin/scripts/jquery.js"></script>
	<script src="/admin/scripts/mk-auth.js"></script>
	<script src="/admin/menu.js.php"></script>
	<script src="/admin/addons/mkauth-addons-banco-inter/js/bootstrap.bundle.min.js"></script>
	<script src="/admin/addons/mkauth-addons-banco-inter/js/toastr.min.js"></script>
	<script src="/admin/addons/mkauth-addons-banco-inter/js/jquery.blockUI.js"></script>
	<script src="/admin/addons/mkauth-addons-banco-inter/js/bootbox.all.js"></script>
	<script src="/admin/addons/mkauth-addons-banco-inter/js/scripts.js"></script>
</head>
<body>
<br>
<div class="container-fluid">
<div class="alert alert-<?php echo $tipo_alerta;?>" role="alert">
<i class="fa-solid fa-circle-info"></i> <?php echo $alerta;?>
</div>
</div>
</body>
</html>
</file>

<file path="payisp/login.hhvm">
<a href="/admin/login.hhvm">Fazer Login</a>
</file>

<file path="payisp/login.php">
<a href="/admin/login.php">Fazer Login</a>
</file>

<file path="payisp/logs.php">
<?php require_once 'init.php';?>
<?php 
//limpar logs 
if(isset($_GET['acao']) && $_GET['acao']=='limpar'){
    $sql = "DELETE FROM `payisp_logs`";
    $mysqli->query($sql);
    header("Location: /admin/addons/payisp/logs.php");
    exit;
}
//registros por pagina 
$total_reg_por_pagina = $quantidade_registros_por_pagina;
//paginacao 
$pagina = isset($_GET['pagina'])?(int)$_GET['pagina']:1;
$inicio = $pagina - 1;
$inicio = $inicio * $total_reg_por_pagina;
//filtros 
$tag = '';
$where = '';
//tudo
$sql_tudo = "SELECT * FROM `payisp_logs` WHERE 1=1 $where ORDER BY id DESC";
$sql_tudo_result = $mysqli->query($sql_tudo);
$qtd_registros = $sql_tudo_result->num_rows;
$paginas = ceil($qtd_registros/$total_reg_por_pagina);
//lista os logs
$sql = "SELECT * FROM `payisp_logs` WHERE 1=1 $where ORDER BY id DESC LIMIT $inicio,$total_reg_por_pagina";
$result = $mysqli->query($sql);
//tem atualizaao 
$atualizado = addon_atualizado_payisp();
?>
<?php $breadcrumbActual = 'Logs'; ?>
<?php include 'lay.header.php'; ?>
<body>
<!-- O script inicial  mantido vazio conforme o original, e o script de funo vai no final -->
<script>
</script>
    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <div class="container-fluid pt-3">
        
        <!-- Cabealho e Contagem -->
        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
            <h2 class="h4 mb-0"><i class="fa fa-clipboard-list text-primary me-2"></i> Logs de Comunicao (30 dias)</h2>
            <span class="badge bg-primary fs-6"><?= str_pad($qtd_registros, 4, "0", STR_PAD_LEFT); ?> Registros</span>
        </div>
        
        <?php exibir_aviso_payisp(); ?>
        
        <!-- Bloco Informativo -->
        <div class="alert alert-info d-flex align-items-center" role="alert">
            <i class="fa fa-info-circle me-2 fs-5"></i>
            Esta seo exibe os logs de requisies e retornos s APIs dos Bancos e servios em uso. Utilize para facilitar a resoluo de problemas e consultas.
        </div>
        
        <!-- Boto Limpar Logs (Usando bootbox.confirm) -->
        <div class="mb-4 text-center">
            <button onclick="confirmarLimpezaLogs();" type="button" class="btn btn-danger shadow-sm">
                <i class="fa fa-trash-alt me-2"></i> Limpar Todos os Logs
            </button>
        </div>
        
        <!-- Tabela de Logs -->
        <div class="table-responsive" style="min-height:600px;">
            <table class="table table-striped table-hover table-sm align-middle">
                <thead class="table-light">
                    <tr>
                        <th style="width:80px;">ID</th>
                        <th style="width:150px;">Banco / Servio</th>
                        <th>Request (Enviado)</th>
                        <th>Return (Resposta)</th>
                        <th style="width:100px;">HTTP Status</th>
                        <th>Endpoint (URL)</th>
                    </tr>
                </thead>
                <tbody>
                    <?php
                    $i=0; 
                    while ($row = $result->fetch_array()) { 
                    ?>
                        <tr>
                            <th scope="row">#<?php echo str_pad($row['id'], 4, "0", STR_PAD_LEFT);?></th>
                            <td>
                                <strong><?php echo $row['banco'];?></strong>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <code class="text-truncate me-2"><?php echo cortar_string_payisp($row['request'],40);?></code>
                                    <button class="btn btn-sm btn-outline-primary flex-shrink-0" 
                                            onclick="ver_completo_payisp('<?php echo htmlentities($row['request']);?>');" 
                                            title="Ver request completo">
                                        <i class="fa fa-eye"></i>
                                    </button>
                                </div>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <code class="text-truncate me-2"><?php echo cortar_string_payisp($row['return'],40);?></code>
                                    <button class="btn btn-sm btn-outline-primary flex-shrink-0" 
                                            onclick="ver_completo_payisp('<?php echo htmlentities($row['return']);?>');" 
                                            title="Ver return completo">
                                        <i class="fa fa-eye"></i>
                                    </button>
                                </div>
                            </td>
                            <td>
                                <?php 
                                    // Melhoria UX: Cores baseadas no status HTTP (pode ser ajustado)
                                    $http_status = $row['http'];
                                    $badge_class = 'bg-secondary';
                                    if ($http_status >= 200 && $http_status < 300) {
                                        $badge_class = 'bg-success';
                                    } elseif ($http_status >= 400) {
                                        $badge_class = 'bg-danger';
                                    } elseif ($http_status >= 300) {
                                        $badge_class = 'bg-warning text-dark';
                                    }
                                ?>
                                <span class="badge <?php echo $badge_class; ?>"><?php echo $http_status;?></span>
                            </td>
                            <td class="small text-truncate" style="max-width: 150px;">
                                <?php echo $row['url'];?>
                            </td>
                        </tr>
                    <?php 
                    $i++;
                    } 
                    ?>
                    <?php 
                    if($qtd_registros==0){
                    ?>
                        <tr>
                            <td colspan="6" class="text-center py-4 text-muted">Nenhum registro de log encontrado.</td>
                        </tr>
                    <?php 
                    }
                    ?>
                </tbody>
            </table>
        </div>
        
        <!-- Paginao -->
        <?php if($paginas > 1){ ?>
            <nav class="mt-4" aria-label="Navegao de Logs">
                <ul class="pagination justify-content-center">
                    <!-- Boto Anterior -->
                    <li class="page-item <?php echo ($pagina == 1) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="logs.php?pagina=<?php echo max(1, $pagina - 1); ?><?php echo $tag; ?>" aria-label="Anterior">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    
                    <?php
                    $max_links = 5;
                    $start_page = max(1, $pagina - floor($max_links / 2));
                    $end_page = min($paginas, $start_page + $max_links - 1);

                    if ($end_page - $start_page < $max_links - 1) {
                        $start_page = max(1, $end_page - $max_links + 1);
                    }
                    
                    for($i = $start_page; $i <= $end_page; $i++) {
                        $active_class = ($i == $pagina) ? 'active' : '';
                        echo '<li class="page-item '.$active_class.'"><a class="page-link" href="logs.php?pagina='.$i.''.$tag.'">'.$i.'</a></li>';
                    }
                    ?>

                    <!-- Boto Prxima -->
                    <li class="page-item <?php echo ($pagina >= $paginas) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="logs.php?pagina=<?php echo min($paginas, $pagina + 1); ?><?php echo $tag; ?>" aria-label="Prxima">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        <?php } ?>

    </div>

    <!-- MANTENDO TODO O CDIGO JAVASCRIPT ORIGINAL NO FINAL DO ARQUIVO -->
    <script> 
        // 1. Funo original de formatao (mantida)
        function formatar_texto_payisp(texto){
            //tenta formatar json
            try {
                var obj = JSON.parse(texto);
                return JSON.stringify(obj, null, 4);
            } catch (e) {
                //nao eh json, tenta formatar xml
                try {
                    var parser = new DOMParser();
                    var xmlDoc = parser.parseFromString(texto, "application/xml");
                    var xsltDoc = parser.parseFromString([
                        '<?xml version="1.0"?>',
                        '<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">',
                        '<xsl:output method="xml" indent="yes"/>',
                        '<xsl:template match="@*|node()">',
                        '<xsl:copy><xsl:apply-templates select="@*|node()"/></xsl:copy>',
                        '</xsl:template>',
                        '</xsl:stylesheet>'
                    ].join('\n'), "application/xml");
                    var xsltProcessor = new XSLTProcessor();
                    xsltProcessor.importStylesheet(xsltDoc);
                    var resultDoc = xsltProcessor.transformToDocument(xmlDoc);
                    var serializer = new XMLSerializer();
                    return serializer.serializeToString(resultDoc);
                } catch (e) {
                    //nao eh xml, retorna o texto puro
                    return texto;
                }
            }
        }
        
        // 2. Funo original de visualizao completa (mantida)
        function ver_completo_payisp(conteudo){
            //abre em nova janela de forma centralizada na tela
            var minhaJanela = window.open("", "Log Completo", "width=800,height=600,top=" + (screen.height/2 - 300) + ",left=" + (screen.width/2 - 400));
            // O contedo precisa ser decodificado se foi passado com htmlentities
            var decodedConteudo = document.createElement('textarea');
            decodedConteudo.innerHTML = conteudo;
            minhaJanela.document.write("<html><head><title>Log Completo</title></head><body><pre style='white-space: pre-wrap; word-wrap: break-word; padding: 10px;'>" + formatar_texto_payisp(decodedConteudo.value) + "</pre></body></html>");
        }
        
        // 3. Nova funo para confirmar limpeza de logs (melhor UX com bootbox)
        function confirmarLimpezaLogs() {
            bootbox.confirm({
                title: "Confirmao de Limpeza de Logs",
                message: "Tem certeza que deseja limpar TODOS os registros de logs? Esta ao  irreversvel.",
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> Cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-trash-alt"></i> Sim, Limpar Logs',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result) {
                        // Mantm a funcionalidade original de redirecionamento
                        location.href='logs.php?acao=limpar';
                    }
                }
            });
        }
    </script>

    <?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/manifest.json">
{
"name": "PAY ISP",
"version": "2.03",
"author": "Bruno Alencar - https://www.mkauth-addons.com.br/"
}
</file>

<file path="payisp/nfcom_editar_servico.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?PHP require(dirname(__FILE__) . '/src/certificado.php'); ?>
<?php $erro_list = array(); ?>
<?php $breadcrumbActual = 'Configuraes NFCom > Atualizar Servio'; ?>
<?php include 'lay.header.php'; ?>

<?php
//dados do servico
$sql = "
SELECT * FROM `payisp_servicos` WHERE id = '" . escape_payisp(valor_antigo_payisp('id')) . "' LIMIT 1";
$result = $mysqli->query($sql);
$dados_servico = $result->fetch_array(MYSQLI_ASSOC);

// Se no encontrou o servio e no est em ao de atualizao, redireciona
if (!$dados_servico && valor_antigo_payisp('acao') != 'atualizar') {
    $aviso = "Servio no encontrado.";
    $redir = "nfcom.php?tab=servicos";
    redir_com_aviso_payisp($aviso, $redir);
    exit;
}
// Se estiver na ao de atualizar, usa os dados do POST, seno usa os dados do banco
$servico_default = $dados_servico;


//se for atualizar
if (valor_antigo_payisp('acao') == 'atualizar') {
    // Para garantir que a funcionalidade de re-preenchimento funcione, usa o POST/GET como base
    // A lgica original de validao usa valor_antigo_payisp() que j faz essa checagem.

    //valida os dados
    $descricao = trim(valor_antigo_payisp('descricao'));
    if (empty($descricao)) {
        $erro_list[] = "A descrio do servio  obrigatria.";
    }
    $plano = trim(valor_antigo_payisp('plano'));
    $valor_servico = (float)trim(valor_antigo_payisp('valor_servico'));
    if (!is_float($valor_servico) || $valor_servico <= 0) {
        $erro_list[] = "O valor do servio deve ser um nmero vlido maior que zero.";
    }
    $quantidade = (int)trim(valor_antigo_payisp('quantidade', 1));
    if (!is_int($quantidade) || $quantidade <= 0) {
        $erro_list[] = "A quantidade de servios includos deve ser um nmero inteiro maior que zero.";
    }
    $unidade = trim(valor_antigo_payisp('unidade'));
    if (empty($unidade)) {
        $erro_list[] = "A unidade de servio  obrigatria.";
    }
    $cclass = trim(valor_antigo_payisp('cclass'));
    if (empty($cclass)) {
        $erro_list[] = "A classificao do servio (CCLASS)  obrigatria.";
    }
    $id_cfop = trim(valor_antigo_payisp('id_cfop'));
    if (empty($id_cfop)) {
        $erro_list[] = "O cdigo CFOP  obrigatrio.";
    }
    $uf_destino = trim(valor_antigo_payisp('uf_destino'));
    if (empty($uf_destino)) {
        $erro_list[] = "A UF de destino  obrigatria.";
    }
    $icms_cst = trim(valor_antigo_payisp('icms_cst'));
    if (empty($icms_cst)) {
        $erro_list[] = "O CST ICMS  obrigatrio.";
    }
    $icms_csosn = trim(valor_antigo_payisp('icms_csosn'));
    if (empty($icms_csosn)) {
        $erro_list[] = "O Tipo de Servio  obrigatrio.";
    }
    $icms_p_aliquota = (float)trim(valor_antigo_payisp('icms_p_aliquota', 0));
    if (!is_float($icms_p_aliquota) || $icms_p_aliquota < 0) {
        $erro_list[] = "A alquota do ICMS deve ser um nmero vlido maior ou igual a zero.";
    }
    $icms_p_reducao_bc = (float)trim(valor_antigo_payisp('icms_p_reducao_bc', 0));
    if (!is_float($icms_p_reducao_bc) || $icms_p_reducao_bc < 0) {
        $erro_list[] = "O percentual de reduo da base de clculo do ICMS deve ser um nmero vlido maior ou igual a zero.";
    }
    $icms_p_fcp = (float)trim(valor_antigo_payisp('icms_p_fcp', 0));
    if (!is_float($icms_p_fcp) || $icms_p_fcp < 0) {
        $erro_list[] = "A alquota do FCP deve ser um nmero vlido maior ou igual a zero.";
    }
    $pis_cst = trim(valor_antigo_payisp('pis_cst'));
    if (empty($pis_cst)) {
        $erro_list[] = "O CST PIS  obrigatrio.";
    }
    $pis_p_aliquota = (float)trim(valor_antigo_payisp('pis_p_aliquota', 0));
    if (!is_float($pis_p_aliquota) || $pis_p_aliquota < 0) {
        $erro_list[] = "A alquota do PIS deve ser um nmero vlido maior ou igual a zero.";
    }
    $cofins_cst = trim(valor_antigo_payisp('cofins_cst'));
    if (empty($cofins_cst)) {
        $erro_list[] = "O CST COFINS  obrigatrio.";
    }
    $cofins_p_aliquota = (float)trim(valor_antigo_payisp('cofins_p_aliquota', 0));
    if (!is_float($cofins_p_aliquota) || $cofins_p_aliquota < 0) {
        $erro_list[] = "A alquota do COFINS deve ser um nmero vlido maior ou igual a zero.";
    }
    //se nao tiver erros
    if (count($erro_list) == 0) {
        $sql = "UPDATE `payisp_servicos` 
        SET `descricao` = '" . escape_payisp($descricao) . "',
        `plano` = '" . escape_payisp($plano) . "',
        `valor_servico` = '" . escape_payisp($valor_servico) . "',
        `quantidade` = '" . escape_payisp($quantidade) . "',
        `unidade` = '" . escape_payisp($unidade) . "',
        `cclass` = '" . escape_payisp($cclass) . "',
        `id_cfop` = '" . escape_payisp($id_cfop) . "',
        `uf_destino` = '" . escape_payisp($uf_destino) . "',
        `icms_cst` = '" . escape_payisp($icms_cst) . "',
        `icms_csosn` = '" . escape_payisp($icms_csosn) . "',
        `icms_p_aliquota` = '" . escape_payisp($icms_p_aliquota) . "',
        `icms_p_reducao_bc` = '" . escape_payisp($icms_p_reducao_bc) . "',
        `icms_p_fcp` = '" . escape_payisp($icms_p_fcp) . "',
        `pis_cst` = '" . escape_payisp($pis_cst) . "',
        `pis_p_aliquota` = '" . escape_payisp($pis_p_aliquota) . "',
        `cofins_cst` = '" . escape_payisp($cofins_cst) . "',
        `cofins_p_aliquota` = '" . escape_payisp($cofins_p_aliquota) . "'
        WHERE `id` = '" . escape_payisp($dados_servico['id']) . "' LIMIT 1
        ";
        $mysqli->query($sql);
        //log
        criar_log_mkauth_payisp('O servio NFCom #' . $dados_servico['id'] . ' foi atualizado.', 'admin');
        //redireciona
        $aviso = "Servio NFCom atualizado com sucesso!";
        $redir = "nfcom.php?tab=servicos";
        redir_com_aviso_payisp($aviso, $redir);
        exit;
    }
}
?>

<script>
    function atualiza_valor_servico_por_plano_nfcom(selectElement) {
        var selectedOption = selectElement.options[selectElement.selectedIndex];
        var preco = selectedOption.getAttribute('data-preco');
        if (preco) {
            document.getElementById('valor_servico').value = parseFloat(preco).toFixed(2);
        } else {
            document.getElementById('valor_servico').value = '';
        }
    }
</script>

<body>

    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <!-- Novo Cabealho com Breadcrumb (Melhoria de UX) -->
    <div class="container-fluid pt-3">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="nfcom.php?tab=servicos"><i class="fa fa-cog me-1"></i> Configuraes NFCom</a></li>
                <li class="breadcrumb-item active" aria-current="page"><i class="fa fa-edit me-1"></i> Atualizar Servio #<?php echo htmlspecialchars($dados_servico['id']); ?></li>
            </ol>
        </nav>

        <h3 class="mb-4">Atualizar Servio NFCom: <?php echo htmlspecialchars($dados_servico['descricao']); ?></h3>

        <?php if (count($erro_list) > 0) { ?>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros de Validao:</h5>
                <ul class="mb-0">
                    <?php foreach ($erro_list as $erro) { ?>
                        <li><?php echo xss_input_protect_payisp($erro); ?></li>
                    <?php } ?>
                </ul>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <?php } ?>

        <!-- Bloco Informativo Principal -->
        <div class="alert alert-info d-flex align-items-center mb-4" role="alert">
            <i class="fa fa-info-circle me-2 fs-5"></i>
            Edite as regras fiscais para este plano de servio de NFCom. O ID do servio  #<?php echo htmlspecialchars($dados_servico['id']); ?>.
        </div>

        <!-- Formulrio (Organizado em Sees com Cards) -->
        <form onsubmit="return bloquear_tela_payisp();" method="post" action="nfcom_editar_servico.php?id=<?php echo $dados_servico['id']; ?>">
            <input type="hidden" name="acao" value="atualizar">
            <input type="hidden" name="id" value="<?php echo $dados_servico['id']; ?>">

            <!-- Card 1: Dados Bsicos e MK-Auth -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-tag me-2"></i> 1. Informaes Bsicas
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="descricao" class="form-label">Descrio do Servio <span class="text-danger">*</span></label>
                            <!-- Valor Antigo (POST) com fallback para o valor do banco -->
                            <input type="text" class="form-control" id="descricao" name="descricao" value="<?php echo valor_antigo_payisp('descricao', $dados_servico['descricao']); ?>" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="plano" class="form-label">Plano Associado</label>
                            <select class="form-select"
                                onchange="atualiza_valor_servico_por_plano_nfcom(this);"
                                id="plano" name="plano">
                                <option value="">Sem Plano</option>
                                <?php foreach (dados_planos_mkauth_todos_payisp() as $plano) { ?>
                                    <option data-preco="<?php echo $plano['valor']; ?>" value="<?php echo $plano['nome']; ?>" <?php echo valor_antigo_payisp('plano', $dados_servico['plano']) == $plano['nome'] ? 'selected' : ''; ?>><?php echo htmlspecialchars($plano['nome']); ?> (R$<?php echo $plano['valor']; ?>)</option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="valor_servico" class="form-label">Valor do Servio (R$) <span class="text-danger">*</span></label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="valor_servico" name="valor_servico" value="<?php echo valor_antigo_payisp('valor_servico', $dados_servico['valor_servico']); ?>" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="quantidade" class="form-label">Quantidade de Servios Includos <span class="text-danger">*</span></label>
                            <input type="number" class="form-control" id="quantidade" name="quantidade" value="<?php echo valor_antigo_payisp('quantidade', $dados_servico['quantidade']); ?>" min="1" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="unidade" class="form-label">Unidade de Servio <span class="text-danger">*</span></label>
                            <select class="form-select" id="unidade" name="unidade" required>
                                <option value="" disabled>Selecione a Unidade</option>
                                <?php foreach ($unidadesNfcomDeMedida as $unidade_id => $unidade_nome) { ?>
                                    <option value="<?php echo $unidade_id; ?>" <?php echo valor_antigo_payisp('unidade', $dados_servico['unidade']) == $unidade_id ? 'selected' : ''; ?>><?php echo htmlspecialchars($unidade_nome); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="ativo" class="form-label">Ativo <span class="text-danger">*</span></label>
                            <select class="form-select" id="ativo" name="ativo" required>
                                <option value="1" <?php echo valor_antigo_payisp('ativo', $dados_servico['ativo']) == '1' ? 'selected' : ''; ?>>Sim</option>
                                <option value="0" <?php echo valor_antigo_payisp('ativo', $dados_servico['ativo']) == '0' ? 'selected' : ''; ?>>No</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 2: Informaes Fiscais (Tributos) -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-file-invoice me-2"></i> 2. Classificao e CFOP
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="cclass" class="form-label">Classificao do Servio (CCLASS) <span class="text-danger">*</span></label>
                            <select class="form-select" id="cclass" name="cclass" required>
                                <option value="" disabled>Selecione a Classificao</option>
                                <?php foreach ($tabelaNfcomCClass as $cclass_codigo => $cclass_descricao) { ?>
                                    <option value="<?php echo $cclass_codigo; ?>" <?php echo valor_antigo_payisp('cclass', $dados_servico['cclass']) == $cclass_codigo ? 'selected' : ''; ?>><?php echo htmlspecialchars($cclass_codigo . ' - ' . $cclass_descricao); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="id_cfop" class="form-label">Cdigo CFOP <span class="text-danger">*</span></label>
                            <select class="form-select" id="id_cfop" name="id_cfop" required>
                                <option value="" disabled>Selecione o CFOP</option>
                                <?php foreach ($cfopsNfcomPublicos as $cfop => $descricao) { ?>
                                    <option value="<?php echo $cfop; ?>" <?php echo valor_antigo_payisp('id_cfop', $dados_servico['id_cfop']) == $cfop ? 'selected' : ''; ?>><?php echo htmlspecialchars($cfop . ' - ' . $descricao); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="uf_destino" class="form-label">UF de Destino <span class="text-danger">*</span></label>
                            <select class="form-select" id="uf_destino" name="uf_destino" required>
                                <option value="" disabled>Selecione a UF</option>
                                <?php
                                $ufs = array('AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA', 'MT', 'MS', 'MG', 'PA', 'PB', 'PR', 'PE', 'PI', 'RJ', 'RN', 'RS', 'RO', 'RR', 'SC', 'SP', 'SE', 'TO');
                                $uf_selecionada = valor_antigo_payisp('uf_destino', $dados_servico['uf_destino']);
                                foreach ($ufs as $uf) { ?>
                                    <option value="<?php echo $uf; ?>" <?php echo $uf_selecionada == $uf ? 'selected' : ''; ?>><?php echo $uf; ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="icms_csosn" class="form-label">Tipo de Servio (tpServUtil) <span class="text-danger">*</span></label>
                            <select class="form-select" id="icms_csosn" name="icms_csosn" required>
                                <option value="" disabled>Selecione o Tipo</option>
                                <?php
                                $icms_csosn_selecionado = valor_antigo_payisp('icms_csosn', $dados_servico['icms_csosn']);
                                foreach ($tpServUtilNfcom as $tpServUtil_id => $tpServUtil_nome) { ?>
                                    <option value="<?php echo $tpServUtil_id; ?>" <?php echo $icms_csosn_selecionado == $tpServUtil_id ? 'selected' : ''; ?>><?php echo htmlspecialchars($tpServUtil_id . ' - ' . $tpServUtil_nome); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 3: Dados de ICMS e FCP -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-percent me-2"></i> 3. Configuraes de ICMS e FCP
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="icms_cst" class="form-label">CST ICMS <span class="text-danger">*</span></label>
                            <select class="form-select" id="icms_cst" name="icms_cst" required>
                                <option value="" disabled>Selecione o CST ICMS</option>
                                <?php
                                $icms_cst_selecionado = valor_antigo_payisp('icms_cst', $dados_servico['icms_cst']);
                                ?>
                                <option value="90" <?php echo $icms_cst_selecionado == '90' ? 'selected' : ''; ?>>90 - Outras</option>
                                <!-- <option value="00" <?php echo $icms_cst_selecionado == '00' ? 'selected' : ''; ?>>00 - Tributada integralmente</option>
                                <option value="40" <?php echo $icms_cst_selecionado == '40' ? 'selected' : ''; ?>>40 - Isenta</option>
                                <option value="41" <?php echo $icms_cst_selecionado == '41' ? 'selected' : ''; ?>>41 - No tributada</option>
                                <option value="60" <?php echo $icms_cst_selecionado == '60' ? 'selected' : ''; ?>>60 - ICMS cobrado anteriormente por substituio tributria</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_aliquota" class="form-label">Alquota ICMS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_aliquota" name="icms_p_aliquota" value="<?php echo valor_antigo_payisp('icms_p_aliquota', $dados_servico['icms_p_aliquota']); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_reducao_bc" class="form-label">% Reduo da Base de Clculo</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_reducao_bc" name="icms_p_reducao_bc" value="<?php echo valor_antigo_payisp('icms_p_reducao_bc', $dados_servico['icms_p_reducao_bc']); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_fcp" class="form-label">Alquota FCP (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_fcp" name="icms_p_fcp" value="<?php echo valor_antigo_payisp('icms_p_fcp', $dados_servico['icms_p_fcp']); ?>">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 4: Dados de PIS e COFINS -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-calculator me-2"></i> 4. Configuraes de PIS e COFINS
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="pis_cst" class="form-label">CST PIS <span class="text-danger">*</span></label>
                            <select class="form-select" id="pis_cst" name="pis_cst" required>
                                <option value="" disabled>Selecione o CST PIS</option>
                                <?php
                                $pis_cst_selecionado = valor_antigo_payisp('pis_cst', $dados_servico['pis_cst']);
                                ?>
                                <option value="49" <?php echo $pis_cst_selecionado == '49' ? 'selected' : ''; ?>>49 - Outras Operaes</option>
                                <!-- <option value="01" <?php echo $pis_cst_selecionado == '01' ? 'selected' : ''; ?>>01 - Operao Tributvel com Alquota Bsica</option>
                                <option value="07" <?php echo $pis_cst_selecionado == '07' ? 'selected' : ''; ?>>07 - Operao Tributvel por Quantidade de Servio</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="pis_p_aliquota" class="form-label">Alquota PIS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="pis_p_aliquota" name="pis_p_aliquota" value="<?php echo valor_antigo_payisp('pis_p_aliquota', $dados_servico['pis_p_aliquota']); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="cofins_cst" class="form-label">CST COFINS <span class="text-danger">*</span></label>
                            <select class="form-select" id="cofins_cst" name="cofins_cst" required>
                                <option value="" disabled>Selecione o CST COFINS</option>
                                <?php
                                $cofins_cst_selecionado = valor_antigo_payisp('cofins_cst', $dados_servico['cofins_cst']);
                                ?>
                                <option value="49" <?php echo $cofins_cst_selecionado == '49' ? 'selected' : ''; ?>>49 - Outras Operaes</option>
                                <!-- <option value="01" <?php echo $cofins_cst_selecionado == '01' ? 'selected' : ''; ?>>01 - Operao Tributvel com Alquota Bsica</option>
                                <option value="07" <?php echo $cofins_cst_selecionado == '07' ? 'selected' : ''; ?>>07 - Operao Tributvel por Quantidade de Servio</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="cofins_p_aliquota" class="form-label">Alquota COFINS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="cofins_p_aliquota" name="cofins_p_aliquota" value="<?php echo valor_antigo_payisp('cofins_p_aliquota', $dados_servico['cofins_p_aliquota']); ?>">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Boto de Ao Final -->
            <button type="submit" class="btn btn-primary btn-lg w-100 mb-5">
                <i class="fa fa-save me-2"></i>
                Atualizar Servio NFCom
            </button>
        </form>
    </div>

    <?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/nfcom_excluir_servico.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php
$id = (int)valor_antigo_payisp('id');
if ($id > 0) {
    $sql = "DELETE FROM `payisp_servicos` WHERE id = '" . escape_payisp($id) . "'";
    $mysqli->query($sql);
    //log 
    criar_log_mkauth_payisp('Servio NFCom excludo. ID: ' . $id, 'admin');
    //redireciona
    $aviso = "Servio excludo com sucesso.";
    $redir = "nfcom.php?tab=servicos";
    redir_com_aviso_payisp($aviso, $redir);
    exit;
}
//redireciona
$aviso = "Servio no encontrado.";
$redir = "nfcom.php?tab=servicos";
redir_com_aviso_payisp($aviso, $redir, 'alert-info');
exit;
?>
</file>

<file path="payisp/nfcom_novo_servico.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?PHP require(dirname(__FILE__) . '/src/certificado.php'); ?>
<?php $erro_list = array(); ?>
<?php $breadcrumbActual = 'Configuraes NFCom > Novo Servio'; ?>
<?php include 'lay.header.php'; ?>

<?php
if (valor_antigo_payisp('acao') == 'criar') {
    //valida os dados
    $descricao = trim(valor_antigo_payisp('descricao'));
    if (empty($descricao)) {
        $erro_list[] = "A descrio do servio  obrigatria.";
    }
    $plano = trim(valor_antigo_payisp('plano'));
    $valor_servico = (float)trim(valor_antigo_payisp('valor_servico'));
    if (!is_float($valor_servico) || $valor_servico <= 0) {
        $erro_list[] = "O valor do servio deve ser um nmero vlido maior que zero.";
    }
    $quantidade = (int)trim(valor_antigo_payisp('quantidade',1));
    if (!is_int($quantidade) || $quantidade <= 0) {
        $erro_list[] = "A quantidade de servios deve ser um nmero inteiro maior que zero.";
    }
    $unidade = trim(valor_antigo_payisp('unidade'));
    if (empty($unidade)) {
        $erro_list[] = "A unidade de servio  obrigatria.";
    }
    $cclass = trim(valor_antigo_payisp('cclass'));
    if (empty($cclass)) {
        $erro_list[] = "A classificao do servio (CCLASS)  obrigatria.";
    }
    $id_cfop = trim(valor_antigo_payisp('id_cfop'));
    if (empty($id_cfop)) {
        $erro_list[] = "O cdigo CFOP  obrigatrio.";
    }
    $uf_destino = trim(valor_antigo_payisp('uf_destino'));
    if (empty($uf_destino)) {
        $erro_list[] = "A UF de destino  obrigatria.";
    }
    $icms_cst = trim(valor_antigo_payisp('icms_cst'));
    if (empty($icms_cst)) {
        $erro_list[] = "O CST ICMS  obrigatrio.";
    }
    $icms_csosn = trim(valor_antigo_payisp('icms_csosn'));
    if (empty($icms_csosn)) {
        $erro_list[] = "O Tipo de Servio  obrigatrio.";
    }
    $icms_p_aliquota = (float)trim(valor_antigo_payisp('icms_p_aliquota',0));
    if (!is_float($icms_p_aliquota) || $icms_p_aliquota < 0) {
        $erro_list[] = "A alquota do ICMS deve ser um nmero vlido maior ou igual a zero.";
    }
    $icms_p_reducao_bc = (float)trim(valor_antigo_payisp('icms_p_reducao_bc',0));
    if (!is_float($icms_p_reducao_bc) || $icms_p_reducao_bc < 0) {
        $erro_list[] = "O percentual de reduo da base de clculo do ICMS deve ser um nmero vlido maior ou igual a zero.";
    }
    $icms_p_fcp = (float)trim(valor_antigo_payisp('icms_p_fcp',0));
    if (!is_float($icms_p_fcp) || $icms_p_fcp < 0) {
        $erro_list[] = "A alquota do FCP deve ser um nmero vlido maior ou igual a zero.";
    }
    $pis_cst = trim(valor_antigo_payisp('pis_cst'));
    if (empty($pis_cst)) {
        $erro_list[] = "O CST PIS  obrigatrio.";
    }
    $pis_p_aliquota = (float)trim(valor_antigo_payisp('pis_p_aliquota',0));
    if (!is_float($pis_p_aliquota) || $pis_p_aliquota < 0) {
        $erro_list[] = "A alquota do PIS deve ser um nmero vlido maior ou igual a zero.";
    }
    $cofins_cst = trim(valor_antigo_payisp('cofins_cst'));
    if (empty($cofins_cst)) {
        $erro_list[] = "O CST COFINS  obrigatrio.";
    }
    $cofins_p_aliquota = (float)trim(valor_antigo_payisp('cofins_p_aliquota',0));
    if (!is_float($cofins_p_aliquota) || $cofins_p_aliquota < 0) {
        $erro_list[] = "A alquota do COFINS deve ser um nmero vlido maior ou igual a zero.";
    }
    //se nao tiver erros
    if (count($erro_list) == 0) {
        $sql = "INSERT INTO `payisp_servicos` 
        SET `descricao` = '" . escape_payisp($descricao) . "',
        `plano` = '" . escape_payisp($plano) . "',
        `valor_servico` = '" . escape_payisp($valor_servico) . "',
        `quantidade` = '" . escape_payisp($quantidade) . "',
        `unidade` = '" . escape_payisp($unidade) . "',
        `cclass` = '" . escape_payisp($cclass) . "',
        `id_cfop` = '" . escape_payisp($id_cfop) . "',
        `uf_destino` = '" . escape_payisp($uf_destino) . "',
        `icms_cst` = '" . escape_payisp($icms_cst) . "',
        `icms_csosn` = '" . escape_payisp($icms_csosn) . "',
        `icms_p_aliquota` = '" . escape_payisp($icms_p_aliquota) . "',
        `icms_p_reducao_bc` = '" . escape_payisp($icms_p_reducao_bc) . "',
        `icms_p_fcp` = '" . escape_payisp($icms_p_fcp) . "',
        `pis_cst` = '" . escape_payisp($pis_cst) . "',
        `pis_p_aliquota` = '" . escape_payisp($pis_p_aliquota) . "',
        `cofins_cst` = '" . escape_payisp($cofins_cst) . "',
        `cofins_p_aliquota` = '" . escape_payisp($cofins_p_aliquota) . "'
        ";
        $mysqli->query($sql);
        //log 
        criar_log_mkauth_payisp('Criao de novo servio NFCom: ' . $descricao, 'admin');
        //redireciona
        $aviso = "Servio NFCom criado com sucesso.";
        $redir = "nfcom.php?tab=servicos";
        redir_com_aviso_payisp($aviso,$redir);
        exit;
    }
}
?>

<!-- Mantendo a funo JS original para a funcionalidade -->
<script>
    function atualiza_valor_servico_por_plano_nfcom(selectElement) {
        var selectedOption = selectElement.options[selectElement.selectedIndex];
        var preco = selectedOption.getAttribute('data-preco');
        if (preco) {
            // Mantendo a lgica de formatao original
            document.getElementById('valor_servico').value = parseFloat(preco).toFixed(2);
        } else {
            document.getElementById('valor_servico').value = '';
        }
    }
</script>

<body>

    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <!-- Novo Cabealho com Breadcrumb (Melhoria de UX) -->
    <div class="container-fluid pt-3">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="nfcom.php?tab=servicos"><i class="fa fa-cog me-1"></i> Configuraes NFCom</a></li>
                <li class="breadcrumb-item active" aria-current="page"><i class="fa fa-plus-circle me-1"></i> Novo Servio</li>
            </ol>
        </nav>

        <h3 class="mb-4">Cadastro de Novo Servio NFCom</h3>

        <?php if (count($erro_list) > 0) { ?>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros de Validao:</h5>
                <ul class="mb-0">
                    <?php foreach ($erro_list as $erro) { ?>
                        <li><?php echo xss_input_protect_payisp($erro); ?></li>
                    <?php } ?>
                </ul>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <?php } ?>

        <!-- Bloco Informativo Principal -->
        <div class="alert alert-info d-flex align-items-center mb-4" role="alert">
            <i class="fa fa-info-circle me-2 fs-5"></i>
            Adicione um novo plano de servio para emisso de NFCom, preenchendo todos os dados cadastrais e tributrios corretamente.
        </div>

        <!-- Formulrio (Organizado em Sees com Cards) -->
        <form onsubmit="return bloquear_tela_payisp();" method="post" action="nfcom_novo_servico.php">
            <input type="hidden" name="acao" value="criar">

            <!-- Card 1: Dados Bsicos e MK-Auth -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-tag me-2"></i> 1. Informaes Bsicas
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="descricao" class="form-label">Descrio do Servio <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="descricao" name="descricao" value="<?php echo valor_antigo_payisp('descricao'); ?>" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="plano" class="form-label">Plano Associado (MK-Auth) <span class="text-danger">*</span></label>
                            <select class="form-select" 
                            onchange="atualiza_valor_servico_por_plano_nfcom(this);"
                            id="plano" name="plano">
                                <option value="" disabled>Selecione</option>
                                <?php foreach (dados_planos_mkauth_todos_payisp() as $plano) { ?>
                                    <option data-preco="<?php echo $plano['valor']; ?>" value="<?php echo $plano['nome']; ?>" <?php echo valor_antigo_payisp('plano') == $plano['nome'] ? 'selected' : ''; ?>><?php echo htmlspecialchars($plano['nome']); ?> (R$<?php echo $plano['valor']; ?>)</option>
                                <?php } ?>
                            </select>
                            <div class="form-text text-muted">A seleo de um plano pode preencher o campo 'Valor do Servio'.</div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="valor_servico" class="form-label">Valor do Servio (R$) <span class="text-danger">*</span></label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="valor_servico" name="valor_servico" value="<?php echo valor_antigo_payisp('valor_servico'); ?>" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="quantidade" class="form-label">Quantidade <span class="text-danger">*</span></label>
                            <input type="number" class="form-control" id="quantidade" name="quantidade" value="<?php echo valor_antigo_payisp('quantidade',1); ?>" min="1" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="unidade" class="form-label">Unidade de Servio <span class="text-danger">*</span></label>
                            <select class="form-select" id="unidade" name="unidade" required>
                                <option value="" disabled>Selecione a Unidade</option>
                                <?php foreach ($unidadesNfcomDeMedida as $unidade_id => $unidade_nome) { ?>
                                    <option value="<?php echo $unidade_id; ?>" <?php echo valor_antigo_payisp('unidade',4) == $unidade_id ? 'selected' : ''; ?>><?php echo htmlspecialchars($unidade_nome); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="ativo" class="form-label">Ativo <span class="text-danger">*</span></label>
                            <select class="form-select" id="ativo" name="ativo" required>
                                <option value="1" <?php echo valor_antigo_payisp('ativo') == '1' ? 'selected' : ''; ?>>Sim (Ativo)</option>
                                <option value="0" <?php echo valor_antigo_payisp('ativo') == '0' ? 'selected' : ''; ?>>No (Inativo)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 2: Informaes Fiscais (Tributos) -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-file-invoice me-2"></i> 2. Classificao e CFOP
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="cclass" class="form-label">Classificao do Servio (CCLASS) <span class="text-danger">*</span></label>
                            <select class="form-select" id="cclass" name="cclass" required>
                                <option value="" disabled>Selecione a Classificao</option>
                                <?php foreach ($tabelaNfcomCClass as $cclass_codigo => $cclass_descricao) { ?>
                                    <option value="<?php echo $cclass_codigo; ?>" <?php echo valor_antigo_payisp('cclass','0400501') == $cclass_codigo ? 'selected' : ''; ?>><?php echo htmlspecialchars($cclass_codigo . ' - ' . $cclass_descricao); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="id_cfop" class="form-label">Cdigo CFOP <span class="text-danger">*</span></label>
                            <select class="form-select" id="id_cfop" name="id_cfop" required>
                                <option value="" disabled>Selecione o CFOP</option>
                                <?php foreach ($cfopsNfcomPublicos as $cfop => $descricao) { ?>
                                    <option value="<?php echo $cfop; ?>" <?php echo valor_antigo_payisp('id_cfop',5307) == $cfop ? 'selected' : ''; ?>><?php echo htmlspecialchars($cfop . ' - ' . $descricao); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="uf_destino" class="form-label">UF de Destino <span class="text-danger">*</span></label>
                            <select class="form-select" id="uf_destino" name="uf_destino" required>
                                <option value="" disabled>Selecione a UF</option>
                                <?php
                                $ufs = array('AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA', 'MT', 'MS', 'MG', 'PA', 'PB', 'PR', 'PE', 'PI', 'RJ', 'RN', 'RS', 'RO', 'RR', 'SC', 'SP', 'SE', 'TO');
                                $uf_selecionada = valor_antigo_payisp('uf_destino',$dados_provedor['estado']);
                                foreach ($ufs as $uf) { ?>
                                    <option value="<?php echo $uf; ?>" <?php echo $uf_selecionada == $uf ? 'selected' : ''; ?>><?php echo $uf; ?></option>
                                <?php } ?>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="icms_csosn" class="form-label">Tipo de Servio (tpServUtil) <span class="text-danger">*</span></label>
                            <select class="form-select" id="icms_csosn" name="icms_csosn" required>
                                <option value="" disabled>Selecione o Tipo</option>
                                <?php 
                                $icms_csosn_selecionado = valor_antigo_payisp('icms_csosn',900);
                                foreach($tpServUtilNfcom as $tpServUtil_id => $tpServUtil_nome) { ?>
                                    <option value="<?php echo $tpServUtil_id; ?>" <?php echo $icms_csosn_selecionado == $tpServUtil_id ? 'selected' : ''; ?>><?php echo htmlspecialchars($tpServUtil_id . ' - ' . $tpServUtil_nome); ?></option>
                                <?php } ?>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Card 3: Dados de ICMS e FCP -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-percent me-2"></i> 3. Configuraes de ICMS e FCP
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="icms_cst" class="form-label">CST ICMS <span class="text-danger">*</span></label>
                            <select class="form-select" id="icms_cst" name="icms_cst" required>
                                <option value="" disabled>Selecione o CST ICMS</option>
                                <?php 
                                // Mantendo apenas a opo 90 conforme o cdigo original, mas o cdigo original tinha 
                                // opes comentadas, vou focar no que estava ativo. Se precisar das outras, me avise.
                                $icms_cst_selecionado = valor_antigo_payisp('icms_cst',90);
                                ?>
                                <option value="90" <?php echo $icms_cst_selecionado == '90' ? 'selected' : ''; ?>>90 - Outras</option>
                                <!-- Adicionando os comentados como referncia opcional -->
                                <!-- <option value="00" <?php echo $icms_cst_selecionado == '00' ? 'selected' : ''; ?>>00 - Tributada integralmente</option>
                                <option value="40" <?php echo $icms_cst_selecionado == '40' ? 'selected' : ''; ?>>40 - Isenta</option>
                                <option value="41" <?php echo $icms_cst_selecionado == '41' ? 'selected' : ''; ?>>41 - No tributada</option>
                                <option value="60" <?php echo $icms_cst_selecionado == '60' ? 'selected' : ''; ?>>60 - ICMS cobrado anteriormente por substituio tributria</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_aliquota" class="form-label">Alquota ICMS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_aliquota" name="icms_p_aliquota" value="<?php echo valor_antigo_payisp('icms_p_aliquota'); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_reducao_bc" class="form-label">% Reduo da Base de Clculo</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_reducao_bc" name="icms_p_reducao_bc" value="<?php echo valor_antigo_payisp('icms_p_reducao_bc'); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="icms_p_fcp" class="form-label">Alquota FCP (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="icms_p_fcp" name="icms_p_fcp" value="<?php echo valor_antigo_payisp('icms_p_fcp'); ?>">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Card 4: Dados de PIS e COFINS -->
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <i class="fa fa-calculator me-2"></i> 4. Configuraes de PIS e COFINS
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="pis_cst" class="form-label">CST PIS <span class="text-danger">*</span></label>
                            <select class="form-select" id="pis_cst" name="pis_cst" required>
                                <option value="" disabled>Selecione o CST PIS</option>
                                <?php
                                $pis_cst_selecionado = valor_antigo_payisp('pis_cst',49);
                                ?>
                                <option value="49" <?php echo $pis_cst_selecionado == '49' ? 'selected' : ''; ?>>49 - Outras Operaes</option>
                                <!-- Adicionando os comentados como referncia opcional -->
                                <!-- <option value="01" <?php echo $pis_cst_selecionado == '01' ? 'selected' : ''; ?>>01 - Operao Tributvel com Alquota Bsica</option>
                                <option value="07" <?php echo $pis_cst_selecionado == '07' ? 'selected' : ''; ?>>07 - Operao Tributvel por Quantidade de Servio</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="pis_p_aliquota" class="form-label">Alquota PIS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="pis_p_aliquota" name="pis_p_aliquota" value="<?php echo valor_antigo_payisp('pis_p_aliquota'); ?>">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="cofins_cst" class="form-label">CST COFINS <span class="text-danger">*</span></label>
                            <select class="form-select" id="cofins_cst" name="cofins_cst" required>
                                <option value="" disabled>Selecione o CST COFINS</option>
                                <?php 
                                $cofins_cst_selecionado = valor_antigo_payisp('cofins_cst',49);
                                ?>
                                <option value="49" <?php echo $cofins_cst_selecionado == '49' ? 'selected' : ''; ?>>49 - Outras Operaes</option>
                                <!-- Adicionando os comentados como referncia opcional -->
                                <!-- <option value="01" <?php echo $cofins_cst_selecionado == '01' ? 'selected' : ''; ?>>01 - Operao Tributvel com Alquota Bsica</option>
                                <option value="07" <?php echo $cofins_cst_selecionado == '07' ? 'selected' : ''; ?>>07 - Operao Tributvel por Quantidade de Servio</option> -->
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="cofins_p_aliquota" class="form-label">Alquota COFINS (%)</label>
                            <input type="text"
                                placeholder="0.00"
                                class="form-control dinheiro_format" id="cofins_p_aliquota" name="cofins_p_aliquota" value="<?php echo valor_antigo_payisp('cofins_p_aliquota'); ?>">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Boto de Ao Final -->
            <button type="submit" class="btn btn-primary btn-lg w-100 mb-5">
                <i class="fa fa-save me-2"></i>
                Salvar Novo Servio NFCom
            </button>
        </form>
    </div>

    <?php include('lay.footer.php'); ?>

</body>

</html>
</file>

<file path="payisp/nfcom.ativar.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php $erro_list = array(); ?>
<?php $breadcrumbActual = 'Ativar uso da NFCom'; ?>

<?php 
//ativar nfcom
$acao = valor_antigo_payisp('acao', '');
if($acao == 'ativar_nfcom'){
    //verifica se ja esta ativo
    $dados_configuracoes = configuracoes_nfcom_payisp();
    if(isset($dados_configuracoes['serial_nfcom']) && !empty($dados_configuracoes['serial_nfcom'])){
        $erro_list[] = 'O mdulo NFCom j est ativo em seu sistema, acesse o menu acima NFCOM ISP > Configuraes.';
    } else {
        //ativa o nfcom
        $erro_list = ativar_nfcom_payisp();
    }
}
?>

<?php include 'lay.header.php'; ?>

<body>

    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <!-- Novo Cabealho e Ttulo -->
    <div class="container-fluid pt-3">

        <?php if(count($erro_list) > 0): ?>
            <div class="alert alert-danger" role="alert">
                <h5 class="alert-heading"><i class="fas fa-exclamation-triangle"></i> Erros Encontrados:</h5>
                <ul>
                    <?php foreach($erro_list as $erro): ?>
                        <li><?php echo htmlspecialchars($erro); ?></li>
                    <?php endforeach; ?>
                </ul>
            </div>
        <?php endif; ?>

        <div class="row mb-3">
            <div class="col">
                <h4><i class="fas fa-file-invoice"></i> Ativar uso da NFCom</h4>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="alert alert-info" role="alert">
                    <h5 class="alert-heading"><i class="fas fa-info-circle"></i> Informaes</h5>
                    <p>
                        Voc est prestes a ativar o uso do mdulo de emisso de Notas Fiscais Eletrnicas (NFCom) em seu sistema MK-Auth, ao ativar este mdulo, voc ter acesso a funcionalidades avanadas para a emisso e gerenciamento de notas fiscais eletrnicas diretamente pelo sistema por um periodo de <b>365 dias grtis</b> sem nenhuma limitao de uso. <u>Aps o perodo gratuito, ser necessrio adquirir uma licena para continuar utilizando o mdulo NFCom.</u>
                    </p>
                </div>
                <form method="post" action="nfcom.ativar.php">
                    <input type="hidden" name="acao" value="ativar_nfcom">
                    <button onclick="confirmar_ativacao_nfcom()" type="button" class="btn btn-primary">
                        <i class="fas fa-check-circle"></i>
                        Ativar NFCom - 365 dias grtis
                    </button>
                </form>
            </div>
        </div>

    </div>

    <?php include('lay.footer.php'); ?>

    <script>
        function confirmar_ativacao_nfcom() {
            bootbox.confirm({
                title: "Confirmao de Ativao NFCom",
                message: "Tem certeza que deseja ativar o uso do mdulo NFCom? Esta ao iniciar o perodo gratuito de 365 dias.",
                buttons: {
                    confirm: {
                        label: 'Sim, ativar NFCom',
                        className: 'btn-success'
                    },
                    cancel: {
                        label: 'Cancelar',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        document.querySelector('form').submit();
                    }
                }
            });
        }
    </script>
</body>

</html>
</file>

<file path="payisp/nfcom.cancelar.php">
<?php
require_once 'init.php';
include(dirname(__FILE__) . '/vendor/autoload.php');
include(dirname(__FILE__) . '/src/nfcom_engine.php');
include(dirname(__FILE__) . '/src/nfcom_xml.php');
include(dirname(__FILE__) . '/src/nfcom_cert.php');
include(dirname(__FILE__) . '/src/nfcom_tools.php');
include(dirname(__FILE__) . '/src/nfcom_xsd.php');
include(dirname(__FILE__) . '/src/nfcom_eventos.php');
//pega a chave
$chave = isset($_GET['chave']) ? preg_replace('/[^0-9]/', '', $_GET['chave']) : '';
//pega o protocolo
$protocolo = isset($_GET['protocolo']) ? preg_replace('/[^0-9]/', '', $_GET['protocolo']) : '';
//pega o tpAmb
$tpAmb = isset($_GET['tpAmb']) ? intval($_GET['tpAmb']) : ($dados_configuracoes_nfcom['homologacao'] == 1 ? 2 : 1);
//pega a justificativa
$justificativa_cancelamento = isset($_GET['justificativa']) ? substr(strip_tags($_GET['justificativa']), 0, 255) : 'Cancelamento solicitado pelo emitente.';
//init
try {
    //valida a chave
    if ($chave == '' || strlen($chave) != 44) {
        throw new Exception("Chave de acesso invlida. A chave deve conter 44 dgitos.");
    }
    //valida o protocolo
    if ($protocolo == '') {
        throw new Exception("Protocolo de autorizao invlido para cancelamento, consulte a nota fiscal primeiro.");
    }
    //valida a justificativa
    if (strlen($justificativa_cancelamento) < 15) {
        throw new Exception("A justificativa de cancelamento deve conter no mnimo 15 caracteres.");
    }
    //pega o endpoint nfcom
    $endpoint = $dados_configuracoes_nfcom['endpoint'] == '' ? 'SVRS' : $dados_configuracoes_nfcom['endpoint'];
    if (!isset($nfcomEndpoints[$endpoint])) {
        throw new Exception("Endpoint NFCom invlido configurado: " . htmlspecialchars($endpoint));
    }
    //caminho do certificado e chave privada
    $caminho_crt = "/tmp/certificado-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".crt";
    $caminho_key = "/tmp/chave-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".key";
    if (!file_exists($caminho_crt) || !file_exists($caminho_key)) {
        throw new Exception("Certificado ou chave privada NFCom no encontrados. Certifique-se de que os arquivos existam em: " . htmlspecialchars($caminho_crt) . " e " . htmlspecialchars($caminho_key));
    }
    //dados da chave nfcom 
    $dados_chave = extrair_dados_chave_nfcom_payisp($chave);
    //inicializa o cliente NFCom
    $nfcom = new NFComClient($nfcomEndpoints[$endpoint]);
    //carrega o certificado e chave privada
    $nfcom->setCertificados($caminho_crt, $caminho_key, '');
    //monta o xml de cancelamento
    $builder = new EventoBuilder();
    $infEvento = new InfEvento();
    $infEvento->tpEvento = '110111'; // Cdigo do evento de cancelamento
    $infEvento->chNFCom = $chave;
    $infEvento->CNPJ = preg_replace('/[^0-9]/', '', $dados_configuracoes_nfcom['cnpj']);
    $infEvento->cOrgao = $estadosNfcom[$dados_provedor['estado']]; // UF do emitente (exemplo simplificado)
    $infEvento->tpAmb = $tpAmb; // 1=Produo, 2=Homologao
    $infEvento->dhEvento = date('Y-m-d\TH:i:sP'); // Data e hora do evento no formato ISO 8601
    $infEvento->nSeqEvento = 1; // Sequencial do evento
    //detalhes do cancelamento
    $detEvento = new DetEvento();
    $detEvento->versaoEvento = '1.00';
    $evCanc = new EvCancNFCom();
    $evCanc->nProt = $protocolo; // Deveria ser preenchido com o protocolo da NFCom a ser cancelada
    $evCanc->xJust = $justificativa_cancelamento; // Justificativa (mnimo 15 caracteres)
    $detEvento->eventoEspecifico = $evCanc;
    $infEvento->detEvento = $detEvento;
    //gerar o xml do evento
    $xmlEvento = $builder->gerarXml($infEvento);
    // Assina o XML da NFCom
    $assinador = new AssinadorNFCom();
    $senha_da_chave = '';
    $assinador->carregarChaves($caminho_crt, $caminho_key, $senha_da_chave);
    $xmlAssinado = $assinador->assinar($xmlEvento, 'infEvento');
    // Valida o XML da NFCom
    $validador = new NFComValidator($caminhoXsdNfcomEventos);
    $validador->validate($xmlAssinado);
    // Salva o XML em um arquivo temporrio
    $caminho_arquivo_xml = '/opt/mk-auth/mkfiles/payisp.nfcom.cancelamento.' . trim($chave) . '.xml';
    $fp = fopen($caminho_arquivo_xml, 'w+');
    if ($fp === false) {
        throw new Exception("No foi possvel criar o arquivo XML temporrio em: " . htmlspecialchars($caminho_arquivo_xml));
    }
    fwrite($fp, $xmlAssinado);
    fclose($fp);
    //inicializa o cliente NFCom
    $nfcomClient = new NFComClient($nfcomEndpoints[$endpoint]);
    //carrega o certificado e chave privada
    $nfcomClient->setCertificados($caminho_crt, $caminho_key, '');
    $resposta = $nfcomClient->enviarEvento($xmlAssinado, $infEvento->tpAmb);
    //valida a resposta
    if (!isset($resposta->infEvento)) {
        $msg_erro = 'Erro ao cancelar NFCom: Resposta invlida do servidor.';
        @header("Location: nfcom.consultar.php?msg_erro=" . urlencode($msg_erro) . "&chave=" . urlencode($chave));
        exit;
    }
    //cria o registro de evento no banco de dados
    $sql_evento = "INSERT INTO `payisp_notas_nfcom_eventos` SET 
        chave_evento = '" . escape_payisp($chave) . "',
        protocolo_evento = '" . escape_payisp($resposta->infEvento->nProt) . "',
        xml_enviado = '" . escape_payisp($xmlAssinado) . "',
        retorno_evento = '" . escape_payisp(json_encode($resposta)) . "',
        xstat_evento = '" . escape_payisp($resposta->infEvento->cStat) . "',
        xmotivo_evento = '" . escape_payisp($resposta->infEvento->xMotivo) . "',
        justificativa_evento = '" . escape_payisp($justificativa_cancelamento) . "',
        tipo_evento = 'cancelamento',
        homologacao_evento = " . ($infEvento->tpAmb == 2 ? 1 : 0) . ",
        data_evento = NOW();";
    $mysqli->query($sql_evento);
    //trata a resposta e salva no banco de dados
    if ($resposta->infEvento->cStat != 135) {
        //log 
        criar_log_mkauth_payisp('NFcom [' . $infEvento->chNFCom . '] Erro na resposta do cancelamento: ' . $resposta->infEvento->xMotivo, 'admin');
        //erro no cancelamento
        $msg_erro = 'Erro ao cancelar NFCom: ' . $resposta->infEvento->xMotivo;
        @header("Location: nfcom.consultar.php?msg_erro=" . urlencode($msg_erro) . "&chave=" . urlencode($chave));
        exit;
    }
    //caso tenha alguma nota fiscal vinculada, marca como cancelada
    $sql_update_nfcom = "UPDATE `payisp_notas_nfcom` SET 
        cancelamento = '" . escape_payisp($resposta->infEvento->nProt) . "',
        cancelada = 1,
        motivo_cancelamento = '" . escape_payisp($justificativa_cancelamento) . "',
        status = 'cancelada'
        WHERE chave = '" . escape_payisp($chave) . "' AND homologacao = " . ($infEvento->tpAmb == 2 ? 1 : 0) . " LIMIT 1;";
    $mysqli->query($sql_update_nfcom);
    //log 
    criar_log_mkauth_payisp('NFcom [' . $infEvento->chNFCom . '] Cancelamento realizado com sucesso: ' . $resposta->infEvento->xMotivo, 'admin');
    //log bd geral 
    criar_log_api_payisp('nfcom', escape_payisp(json_encode($infEvento)), escape_payisp(json_encode($resposta)), 200, 'cancelamento');
    //sucesso no cancelamento
    @header("Location: nfcom.consultar.php?msg_sucesso=" . urlencode("NFCom cancelada com sucesso.") . "&chave=" . urlencode($chave));
    exit;
} catch (Exception $e) {
    //log bd geral 
    criar_log_api_payisp('nfcom', escape_payisp(json_encode($infEvento)), escape_payisp($e->getMessage()), 500, 'cancelamento');
    //erro no cancelamento
    $msg_erro = $e->getMessage();
    @header("Location: nfcom.consultar.php?msg_erro=" . urlencode($msg_erro) . "&chave=" . urlencode($chave));
    exit;
}
</file>

<file path="payisp/nfcom.consultar.php">
<?php
require_once 'init.php';
include(dirname(__FILE__) . '/vendor/autoload.php');
include(dirname(__FILE__) . '/src/nfcom_engine.php');
include(dirname(__FILE__) . '/src/nfcom_xml.php');
include(dirname(__FILE__) . '/src/nfcom_cert.php');
include(dirname(__FILE__) . '/src/nfcom_tools.php');
//pega a chave 
$protocolo = '';
if (isset($_GET['tpAmb']) && in_array(intval($_GET['tpAmb']), [1, 2])) {
    $tpAmb = intval($_GET['tpAmb']);
} else {
    $tpAmb = $dados_configuracoes_nfcom['homologacao'] == 1 ? 2 : 1;
}
$chave = isset($_GET['chave']) ? preg_replace('/[^0-9]/', '', $_GET['chave']) : '';
//mensagem de erro
$msg_erro = isset($_GET['msg_erro']) ? strip_tags($_GET['msg_erro']) : '';
//mensagem de sucesso
$msg_sucesso = isset($_GET['msg_sucesso']) ? strip_tags($_GET['msg_sucesso']) : '';
//titulo
$titulo = isset($_GET['titulo']) ? intval($_GET['titulo']) : 0;
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultar NFCom - MK-Auth Pay ISP</title>
    <!-- Incluindo Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
</head>

<body>
    <div class="container py-4">
        
        <h3 class="mb-4 text-center">
            <i class="fa fa-search text-primary me-2"></i> Consultar NFCom 
            <span class="badge bg-secondary"><?php echo $tpAmb == 2 ? 'Homologao' : 'Produo'; ?></span>
        </h3>

        <!-- Mensagens de Erro/Sucesso (Estilizao Bootstrap 5) -->
        <?php if ($msg_erro != '') { ?>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="fa fa-exclamation-triangle me-2"></i> <strong>Erro:</strong> <?php echo xss_input_protect_payisp($msg_erro); ?>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <?php } ?>
        <?php if ($msg_sucesso != '') { ?>
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="fa fa-check-circle me-2"></i> <strong>Sucesso:</strong> <?php echo xss_input_protect_payisp($msg_sucesso); ?>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <script>
                // Mantm a funo original de JS
                self.opener.reloadAqui();
            </script>
        <?php } ?>

        <!-- Card para o Formulrio de Consulta (Melhor UX) -->
        <div class="card shadow mb-4">
            <div class="card-header bg-light">
                <h5 class="card-title mb-0">Localizar NFCom pela Chave</h5>
            </div>
            <div class="card-body">
                <form method="get" action="nfcom.consultar.php" onsubmit="return bloquear_tela_payisp();">
                    
                    <!-- Seleo de Ambiente -->
                    <div class="mb-3">
                        <label class="form-label">Ambiente de Consulta:</label><br>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="tpAmb" id="tpAmbProd" value="1" <?php echo ($tpAmb == 1 ? 'checked' : ''); ?>>
                            <label class="form-check-label" for="tpAmbProd">Produo</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="tpAmb" id="tpAmbHomolog" value="2" <?php echo ($tpAmb == 2 ? 'checked' : ''); ?>>
                            <label class="form-check-label" for="tpAmbHomolog">Homologao</label>
                        </div>
                    </div>

                    <!-- Campo da Chave de Acesso -->
                    <div class="mb-4">
                        <label for="chaveAcesso" class="form-label">Chave de Acesso (44 dgitos):</label>
                        <input type="text" name="chave" id="chaveAcesso" class="form-control form-control-lg" placeholder="Insira a chave de acesso da NFCom aqui"
                            onkeydown="this.value=this.value.replace(/[^0-9]/g,'');"
                            onkeyup="this.value=this.value.replace(/[^0-9]/g,'');"
                            value="<?php echo htmlspecialchars($chave); ?>"
                            maxlength="44" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg w-100"><i class="fa fa-search me-2"></i> Consultar NFCom</button>
                </form>
            </div>
        </div>

        <!-- Resultados da Consulta -->
        <div class="mt-5">
        <?php
        if ($chave == '' || strlen($chave) != 44) {
            // Se a chave no for vlida, exibe a instruo
            echo '<div class="alert alert-info py-3" role="alert"><i class="fa fa-info-circle me-2"></i> Por favor, insira uma chave de acesso vlida com 44 dgitos para iniciar a consulta.</div>';
        } else {
            try {
                //pega o endpoint nfcom
                $endpoint = $dados_configuracoes_nfcom['endpoint'] == '' ? 'SVRS' : $dados_configuracoes_nfcom['endpoint'];
                if (!isset($nfcomEndpoints[$endpoint])) {
                    throw new Exception("Endpoint NFCom invlido configurado: " . htmlspecialchars($endpoint));
                }
                //caminho do certificado e chave privada
                $caminho_crt = "/tmp/certificado-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".crt";
                $caminho_key = "/tmp/chave-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".key";
                if (!file_exists($caminho_crt) || !file_exists($caminho_key)) {
                    throw new Exception("Certificado ou chave privada NFCom no encontrados. Certifique-se de que os arquivos existam em: " . htmlspecialchars($caminho_crt) . " e " . htmlspecialchars($caminho_key));
                }
                //inicializa o cliente NFCom
                $nfcom = new NFComClient($nfcomEndpoints[$endpoint]);
                //carrega o certificado e chave privada
                $nfcom->setCertificados($caminho_crt, $caminho_key, '');
                $resposta = $nfcom->consultarNFCom($chave, $tpAmb);
        ?>
                
                <!-- Resultados da Consulta -->
                <h4 class="mb-3">Resultado da Consulta</h4>

                <?php
                if ($resposta->cStat == 100) {
                    $protocolo = $resposta->protNFCom->infProt->nProt;
                ?>
                    <div class="card bg-light border-success shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-success"><i class="fa fa-check-circle me-2"></i> NFCom Autorizada!</h5>
                            <p class="card-text">A NFCom foi consultada e est Emitida e Vlida.</p>
                            <hr>
                            <div class="row">
                                <div class="col-md-6 mb-2"><strong>Cdigo/Status:</strong> <?php echo htmlspecialchars($resposta->cStat); ?></div>
                                <div class="col-md-6 mb-2"><strong>Motivo:</strong> <?php echo htmlspecialchars($resposta->xMotivo); ?></div>
                                <div class="col-12 mb-2"><strong>Chave de Acesso:</strong> <code class="bg-white p-1 rounded"><?php echo htmlspecialchars($resposta->protNFCom->infProt->chNFCom); ?></code></div>
                                <div class="col-md-6 mb-2"><strong>Protocolo:</strong> <?php echo htmlspecialchars($resposta->protNFCom->infProt->nProt); ?></div>
                                <div class="col-md-6 mb-2"><strong>Data de Autorizao:</strong> <?php echo htmlspecialchars($resposta->protNFCom->infProt->dhRecbto); ?></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                    <?php 
                    // verificca se a data  maior que 5 dias (limite de cancelamento)
                    $dataEvento = new DateTime($resposta->protNFCom->infProt->dhRecbto);
                    $dataAtual = new DateTime();
                    $intervalo = $dataAtual->diff($dataEvento);
                    
                    if ($intervalo->days > 5) {
                    ?>
                        <div class="alert alert-warning" role="alert">
                            <i class="fa fa-exclamation-triangle me-2"></i>
                            Cancelamento No Permitido! O prazo mximo de 5 dias para cancelamento foi excedido (<?php echo htmlspecialchars($intervalo->days); ?> dias decorridos).
                        </div>
                    <?php
                    } else {
                    ?>
                        <div class="alert alert-info" role="alert">
                            <i class="fa fa-calendar-check me-2"></i>
                            Cancelamento Permitido! A NFCom pode ser cancelada dentro do prazo legal de 5 dias (<?php echo htmlspecialchars($intervalo->days); ?> dias decorridos).
                        </div>
                        <button class="btn btn-danger btn-sm"
                            onclick="confirmar_cancelamento_nfcom('<?php echo htmlspecialchars($resposta->protNFCom->infProt->chNFCom); ?>');"
                            href="javascript:void(0);"><i class="fa fa-times-circle me-2"></i> Cancelar NFCom</button>
                    <?php } ?>
                    </div>
                
                <?php } elseif ($resposta->cStat == 101) { ?>
                    
                    <div class="card bg-light border-info shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-info"><i class="fa fa-ban me-2"></i> NFCom J Cancelada</h5>
                            <p class="card-text">O status retornado indica que esta NFCom foi cancelada na SEFAZ.</p>
                            <hr>
                            <div class="row">
                                <div class="col-md-6 mb-2"><strong>Cdigo/Status:</strong> <?php echo htmlspecialchars($resposta->cStat); ?></div>
                                <div class="col-md-6 mb-2"><strong>Motivo:</strong> <?php echo htmlspecialchars($resposta->xMotivo); ?></div>
                                <div class="col-12 mb-2"><strong>Chave de Acesso:</strong> <code class="bg-white p-1 rounded"><?php echo htmlspecialchars($resposta->protNFCom->infProt->chNFCom); ?></code></div>
                                <div class="col-md-6 mb-2"><strong>Protocolo Cancelamento:</strong> <?php echo htmlspecialchars($resposta->protNFCom->infProt->nProt); ?></div>
                                <div class="col-md-6 mb-2"><strong>Data do Cancelamento:</strong> <?php echo htmlspecialchars($resposta->protNFCom->infProt->dhRecbto); ?></div>
                            </div>
                        </div>
                    </div>
                    
                    <?php if ($titulo > 0) { ?>
                        <div class="mt-4">
                            <button class="btn btn-success btn-sm"
                                onclick="confirmar_nova_nfcom('<?php echo htmlspecialchars($titulo); ?>');"
                                href="javascript:void(0);">
                                <i class="fa fa-plus-circle me-2"></i>
                                Emitir Nova NFCom para a Fatura #<?php echo htmlspecialchars($titulo); ?>
                            </button>
                        </div>
                    <?php } ?>
                    
                <?php } else { ?>
                    
                    <div class="card bg-light border-danger shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-danger"><i class="fa fa-exclamation-circle me-2"></i> Erro na Consulta</h5>
                            <p class="card-text">Ocorreu um erro ao tentar consultar a NFCom na SEFAZ.</p>
                            <hr>
                            <div class="row">
                                <div class="col-md-6"><strong>Cdigo de Retorno:</strong> <?php echo htmlspecialchars($resposta->cStat); ?></div>
                                <div class="col-md-6"><strong>Motivo:</strong> <?php echo htmlspecialchars($resposta->xMotivo); ?></div>
                            </div>
                        </div>
                    </div>
                    
                <?php } ?>
            <?php
            } catch (Exception $e) {
            ?>
                <div class="alert alert-danger" role="alert">
                    <i class="fa fa-server me-2"></i> 
                    <strong>Erro de Conexo/Configurao:</strong> <?php echo $e->getMessage(); ?>
                </div>
        <?php
            }
        }
        ?>
        </div>
    </div>
    
    <!-- MANTENDO TODOS OS SCRIPTS ORIGINAIS NO FINAL DO ARQUIVO -->
    <script>
        function confirmar_cancelamento_nfcom(chave) {
            bootbox.prompt({
                title: "Confirmao de Cancelamento NFCom",
                message: "Por favor, insira a justificativa para o cancelamento da NFCom com chave de acesso " + chave + " (mnimo 15 caracteres):",
                inputType: 'textarea',
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> No, cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-check"></i> Sim, confirmar',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result !== null) {
                        if (result.length < 15) {
                            // Usando bootbox.alert, conforme o original
                            bootbox.alert("A justificativa deve ter no mnimo 15 caracteres.");
                        } else {
                            bloquear_tela_payisp();
                            location.href = 'nfcom.cancelar.php?chave=' + chave + '&protocolo=<?php echo $protocolo; ?>&tpAmb=<?php echo $tpAmb; ?>&justificativa=' + encodeURIComponent(result);
                        }
                    }
                }
            });
        }
        
        function confirmar_nova_nfcom(titulo) {
            bootbox.confirm({
                title: "Emitir Nova NFCom",
                message: "Deseja emitir uma nova NFCom para a fatura #" + titulo + "?",
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> No, cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-check"></i> Sim, confirmar',
                        className: 'btn-success'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        location.href = 'nfcom.emitir.php?titulo[]=' + titulo + '';
                    }
                }
            });
        }
    </script>
</body>

</html>
</file>

<file path="payisp/nfcom.detalhes.php">
<?php
//init
include("init.php");
$titulo = valor_antigo_payisp('titulo');
$chave = valor_antigo_payisp('chave');
$notaArray = detalhes_nfcom_chave_payisp($titulo, $chave);

// Decodifica os JSONs internos
$infNFCom = json_decode($notaArray['itens'])->infNFCom;
$resultado = json_decode($notaArray['resultado']);
$infProt = $resultado->protNFCom->infProt ?? null; // Pega o n 'infProt'

/**
 * Funo helper 'h' para exibir dados com segurana.
 * Verifica se a propriedade existe e no  nula/vazia.
 */
function h($obj, $prop, $default = '---', $formatter = null, ...$params)
{
    if (isset($obj) && is_array($obj)) {
        $value = $obj[$prop] ?? null;
    } else {
        $value = $obj->{$prop} ?? null;
    }

    if (isset($value) && !is_null($value) && $value !== '') {
        $formattedValue = $value;
        if (is_callable($formatter)) {
            try {
                $formattedValue = call_user_func_array($formatter, array_merge([$value], $params));
            } catch (Exception $e) { /* falha silenciosa */
            }
        }
        return htmlspecialchars($formattedValue);
    }
    return $default;
}

// Funes de formatao
function formatarDataHora($dateTimeStr)
{
    return date('d/m/Y H:i:s', strtotime($dateTimeStr));
}
function formatarData($dateStr)
{
    return date('d/m/Y', strtotime($dateStr));
}
function formatarMoeda($valor)
{
    return 'R$ ' . number_format((float)$valor, 2, ',', '.');
}
function formatarCnpjCpf($val)
{
    if (strlen($val) == 11) return preg_replace("/(\d{3})(\d{3})(\d{3})(\d{2})/", "\$1.\$2.\$3-\$4", $val);
    if (strlen($val) == 14) return preg_replace("/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/", "\$1.\$2.\$3/\$4-\$5", $val);
    return $val;
}
function formatarUnidade($uMed)
{
    $map = ['1' => 'MIN', '2' => 'MB', '3' => 'GB', '4' => 'UN'];
    return $map[$uMed] ?? (string)$uMed;
}
function formatarCompetencia($compet)
{
    $ano = substr($compet, 0, 4);
    $mesNum = (int)substr($compet, 4, 2);
    $meses = [1 => 'JAN', 2 => 'FEV', 3 => 'MAR', 4 => 'ABR', 5 => 'MAI', 6 => 'JUN', 7 => 'JUL', 8 => 'AGO', 9 => 'SET', 10 => 'OUT', 11 => 'NOV', 12 => 'DEZ'];
    return ($meses[$mesNum] ?? '') . '/' . $ano;
}
function formatarChave($chave)
{
    return implode(' ', str_split($chave, 4));
}

// Determinar a classe do Alerta de Status
$statusClass = 'alert-secondary';
if ($notaArray['cstat'] == 100) $statusClass = 'alert-success';
if ($notaArray['cancelada'] == 1) $statusClass = 'alert-danger';
$protocolo =  h($notaArray, 'protocolo');
$tpAmb =  $notaArray['homologacao'] == 1 ? '2' : '1';
$lista_eventos = todos_eventos_nfcom_chave_payisp($notaArray['chave']);
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes da NFCom - <?php echo $notaArray['numero']; ?> | PAY ISP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
    <style>
        .card-header h5,
        .card-header h6 {
            margin-bottom: 0;
        }

        .list-group-item {
            padding: 0.75rem 1rem;
        }

        .label {
            font-size: 0.8rem;
            color: #6c757d;
            display: block;
            margin-bottom: -2px;
        }

        .value {
            font-size: 1rem;
            color: #212529;
        }

        .table-sm th,
        .table-sm td {
            padding: 0.4rem;
        }

        .chave-acesso {
            font-family: monospace;
            font-size: 1.1rem;
        }
    </style>
</head>

<body class="bg-light">

    <div class="container-fluid">

        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <h1 class="h4">Detalhes da NFCom</h1>
                <h2 class="h5 text-muted">N <?php echo h($infNFCom->ide, 'nNF'); ?> / Srie <?php echo h($infNFCom->ide, 'serie'); ?></h2>
            </div>
            <div class="text-end">
                <?php if ($notaArray['status'] == 'emitida') { ?>
                    <a href="javascript:void(0);" onclick="imprimir_danfe_nfcom('<?php echo h($notaArray, 'titulo'); ?>');" class="btn btn-primary"><i class="bi bi-printer"></i> Imprimir DANFE</a>
                    <a href="javascript:void(0);" onclick="confirmar_cancelamento_nfcom('<?php echo h($notaArray, 'chave'); ?>');" class="btn btn-danger"><i class="bi bi-x-circle"></i> Cancelar Nota</a>
                    <a href="nfcom.xml.php?titulo=<?php echo h($notaArray, 'titulo'); ?>&chave=<?php echo h($notaArray, 'chave'); ?>" target="_blank" class="btn btn-success">
                        <i class="bi bi-file-earmark-code"></i>
                        XML NFCom #<?php echo h($notaArray, 'titulo'); ?>
                    </a>
                <?php } else if ($notaArray['status'] == 'cancelada') { ?>
                    <a href="javascript:void(0);" onclick="confirmar_nova_nfcom('<?php echo h($notaArray, 'titulo'); ?>');" class="btn btn-success"><i class="bi bi-plus-circle"></i> Emitir Nova NFCom #<?php echo h($notaArray, 'titulo'); ?></a>
                <?php } ?>
            </div>
        </div>

        <div class="alert <?php echo $statusClass; ?> d-flex justify-content-between align-items-center" role="alert">
            <div>
                <h5 class="alert-heading">
                    <?php if ($notaArray['cancelada'] == 1): ?>
                        Nota Cancelada
                    <?php elseif ($notaArray['cstat'] == 100): ?>
                        Autorizado o uso da NFCom
                    <?php else: ?>
                        <?php echo h($notaArray, 'xmotivo'); ?>
                    <?php endif; ?>
                    <?php if ($notaArray['homologacao'] == 1): ?>
                        <span class="badge bg-secondary">HOMOLOGAO</span>
                    <?php else : ?>
                        <span class="badge bg-success">PRODUO</span>
                    <?php endif; ?>
                </h5>
            </div>
            <i class="bi <?php echo ($notaArray['cstat'] == 100) ? 'bi-check-circle-fill' : 'bi-exclamation-triangle-fill'; ?>" style="font-size: 1rem;"></i>
        </div>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="resumo-tab" data-bs-toggle="tab" data-bs-target="#resumo" type="button" role="tab">Resumo</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="detalhes-tab" data-bs-toggle="tab" data-bs-target="#detalhes" type="button" role="tab">Dados Completos da NFCom</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="eventos-tab" data-bs-toggle="tab" data-bs-target="#eventos" type="button" role="tab">Eventos</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="debug-tab" data-bs-toggle="tab" data-bs-target="#debug" type="button" role="tab">JSON (Debug)</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">

            <div class="tab-pane fade show active p-3 border border-top-0 bg-white" id="resumo" role="tabpanel">
                <div class="row">
                    <div class="col-md-7">
                        <div class="mb-3">
                            <label for="chave" class="form-label label">Chave de Acesso</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-sm chave-acesso" id="chave" value="<?php echo h($notaArray, 'chave'); ?>" readonly>
                                <button class="btn btn-outline-secondary btn-sm" type="button" onclick="copiarTexto('chave')"><i class="bi bi-clipboard"></i></button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="protocolo" class="form-label label">Protocolo de Autorizao</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-sm" id="protocolo" value="<?php echo h($notaArray, 'protocolo'); ?>" readonly>
                                <button class="btn btn-outline-secondary btn-sm" type="button" onclick="copiarTexto('protocolo')"><i class="bi bi-clipboard"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between">
                                <span class="text-muted">Valor Total</span>
                                <strong class="h5 text-success"><?php echo h($notaArray, 'total_nota', '---', 'formatarMoeda'); ?></strong>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <span class="text-muted">Data de Emisso</span>
                                <strong><?php echo h($notaArray, 'emissao', '---', 'formatarDataHora'); ?></strong>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <span class="text-muted">Data Autorizao</span>
                                <strong><?php echo h($infProt, 'dhRecbto', '---', 'formatarDataHora'); ?></strong>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade p-3 border border-top-0 bg-white" id="detalhes" role="tabpanel">
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header h6">Emitente</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><span class="label">Nome/Razo Social</span><span class="value"><?php echo h($infNFCom->emit, 'xNome'); ?></span></li>
                                <li class="list-group-item"><span class="label">CNPJ</span><span class="value"><?php echo h($infNFCom->emit, 'CNPJ', '---', 'formatarCnpjCpf'); ?></span></li>
                                <li class="list-group-item"><span class="label">Inscrio Estadual</span><span class="value"><?php echo h($infNFCom->emit, 'IE'); ?></span></li>
                                <li class="list-group-item"><span class="label">Endereo</span><span class="value"><?php echo h($infNFCom->emit->enderEmit, 'xLgr'); ?>, <?php echo h($infNFCom->emit->enderEmit, 'nro'); ?> - <?php echo h($infNFCom->emit->enderEmit, 'xBairro'); ?>, <?php echo h($infNFCom->emit->enderEmit, 'xMun'); ?>/<?php echo h($infNFCom->emit->enderEmit, 'UF'); ?></span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header h6">Destinatrio</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><span class="label">Nome/Razo Social</span><span class="value"><?php echo h($infNFCom->dest, 'xNome'); ?></span></li>
                                <li class="list-group-item"><span class="label">CPF</span><span class="value"><?php echo h($infNFCom->dest, 'CPF', '---', 'formatarCnpjCpf'); ?></span></li>
                                <li class="list-group-item"><span class="label">Ind. IE</span><span class="value"><?php echo h($infNFCom->dest, 'indIEDest'); ?> (9 = No Contribuinte)</span></li>
                                <li class="list-group-item"><span class="label">Endereo</span><span class="value"><?php echo h($infNFCom->dest->enderDest, 'xLgr'); ?>, <?php echo h($infNFCom->dest->enderDest, 'nro'); ?> - <?php echo h($infNFCom->dest->enderDest, 'xBairro'); ?>, <?php echo h($infNFCom->dest->enderDest, 'xMun'); ?>/<?php echo h($infNFCom->dest->enderDest, 'UF'); ?></span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header h6">Assinante / Fatura</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><span class="label">Cd. Assinante</span><span class="value"><?php echo h($infNFCom->assinante, 'iCodAssinante'); ?></span></li>
                                <li class="list-group-item"><span class="label">N Contrato</span><span class="value"><?php echo h($infNFCom->assinante, 'nContrato'); ?></span></li>
                                <li class="list-group-item"><span class="label">Competncia</span><span class="value"><?php echo h($infNFCom->faturamento, 'CompetFat', '---', 'formatarCompetencia'); ?></span></li>
                                <li class="list-group-item"><span class="label">Vencimento</span><span class="value"><?php echo h($infNFCom->faturamento, 'dVencFat', '---', 'formatarData'); ?></span></li>
                                <li class="list-group-item"><span class="label">URL PIX</span><span class="value" style="font-size: 0.8rem; word-break: break-all;"><?php echo h($infNFCom->faturamento, 'gPIX'); ?></span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header h6">Totais</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between"><span class="text-muted">Total Produtos/Servios</span> <strong><?php echo h($infNFCom->total, 'vProd', '---', 'formatarMoeda'); ?></strong></li>
                                <li class="list-group-item d-flex justify-content-between"><span class="text-muted">Descontos</span> <strong><?php echo h($infNFCom->total, 'vDesc', '---', 'formatarMoeda'); ?></strong></li>
                                <li class="list-group-item d-flex justify-content-between"><span class="text-muted">Outras Despesas</span> <strong><?php echo h($infNFCom->total, 'vOutro', '---', 'formatarMoeda'); ?></strong></li>
                                <li class="list-group-item d-flex justify-content-between"><span class="text-muted">FUST</span> <strong><?php echo h($infNFCom->total, 'vFUST', '---', 'formatarMoeda'); ?></strong></li>
                                <li class="list-group-item d-flex justify-content-between"><span class="text-muted">FUNTTEL</span> <strong><?php echo h($infNFCom->total, 'vFUNTTEL', '---', 'formatarMoeda'); ?></strong></li>
                                <li class="list-group-item d-flex justify-content-between bg-light">
                                    <strong class="h6 mb-0">VALOR TOTAL DA NFCom</strong>
                                    <strong class="h5 mb-0 text-success"><?php echo h($infNFCom->total, 'vNF', '---', 'formatarMoeda'); ?></strong>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header h6">Itens da NFCom</div>
                            <div class="table-responsive">
                                <table class="table table-sm table-striped mb-0">
                                    <thead>
                                        <tr>
                                            <th>Item</th>
                                            <th>Descrio</th>
                                            <th class="text-end">UN</th>
                                            <th class="text-end">Qtd.</th>
                                            <th class="text-end">Vlr. Unit.</th>
                                            <th class="text-end">Vlr. Total</th>
                                            <th class="text-end">ICMS CST</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <?php foreach ($infNFCom->det as $item): ?>
                                            <tr>
                                                <td><?php echo h($item, 'nItem'); ?></td>
                                                <td><?php echo h($item->prod, 'xProd'); ?> (CFOP: <?php echo h($item->prod, 'CFOP'); ?>)</td>
                                                <td class="text-end"><?php echo h($item->prod, 'uMed', '---', 'formatarUnidade'); ?></td>
                                                <td class="text-end"><?php echo h($item->prod, 'qFaturada', '---', 'formatarNumero', 2); ?></td>
                                                <td class="text-end"><?php echo h($item->prod, 'vItem', '---', 'formatarMoeda'); ?></td>
                                                <td class="text-end"><?php echo h($item->prod, 'vProd', '---', 'formatarMoeda'); ?></td>
                                                <td class="text-end"><?php echo h($item->imposto->icms, 'CST'); ?> (SN)</td>
                                            </tr>
                                        <?php endforeach; ?>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade p-3 border border-top-0 bg-white" id="eventos" role="tabpanel">
                <?php if (count($lista_eventos) > 0) { ?>
                    <div class="list-group">
                        <?php foreach ($lista_eventos as $evento) { ?>
                            <div class="list-group-item">
                                <h6 class="mb-1">Evento: <?php echo ucfirst(h($evento, 'tipo_evento')); ?> (<?php echo h($evento, 'xstat_evento'); ?>)</h6>
                                <p class="mb-1"><strong>Data/Hora:</strong> <?php echo h($evento, 'data_evento', '---', 'formatarDataHora'); ?></p>
                                <p class="mb-1"><strong>Protocolo:</strong> <?php echo h($evento, 'protocolo_evento'); ?></p>
                                <p class="mb-1"><strong>Motivo:</strong> <?php echo h($evento, 'xmotivo_evento'); ?></p>
                                <p class="mb-0"><strong>Justificativa:</strong> <?php echo h($evento, 'justificativa_evento', 'n/a'); ?></p>
                            </div>
                        <?php } ?>
                    </div>
                <?php } else { ?>
                    <p class="text-muted">Nenhum evento registrado para esta nota.</p>
                <?php } ?>
            </div>

            <div class="tab-pane fade p-3 border border-top-0 bg-white" id="debug" role="tabpanel">
                <h6>JSON [itens]</h6>
                <pre class="bg-dark text-white p-3 rounded" style="max-height: 400px; overflow-y: auto;"><?php echo json_encode(json_decode($notaArray['itens']), JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES); ?></pre>

                <h6>JSON [resultado]</h6>
                <pre class="bg-dark text-white p-3 rounded" style="max-height: 400px; overflow-y: auto;"><?php echo json_encode(json_decode($notaArray['resultado']), JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES); ?></pre>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        function copiarTexto(elementId) {
            var input = document.getElementById(elementId);
            input.select();
            input.setSelectionRange(0, 99999); // Para mobile
            try {
                document.execCommand('copy');
                // (Opcional) Feedback visual
                var originalBtn = document.querySelector('button[onclick="copiarTexto(\'' + elementId + '\')"]');
                var originalIcon = originalBtn.innerHTML;
                originalBtn.innerHTML = '<i class="bi bi-check-lg text-success"></i>';
                setTimeout(function() {
                    originalBtn.innerHTML = originalIcon;
                }, 1500);
            } catch (err) {
                alert('No foi possvel copiar.');
            }
        }

        function imprimir_danfe_nfcom(titulo) {
            abrirPopup_payisp('nfcom.imprimir.php?titulo[]=' + titulo + '&base=titulo', 870, 900);
            return false;
        }

        function confirmar_cancelamento_nfcom(chave) {
            bootbox.prompt({
                title: "Confirmao de Cancelamento NFCom",
                message: "Por favor, insira a justificativa para o cancelamento da NFCom com chave de acesso " + chave + " (mnimo 15 caracteres):",
                inputType: 'textarea',
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> No, cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-check"></i> Sim, confirmar',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result !== null) {
                        if (result.length < 15) {
                            bootbox.alert("A justificativa deve ter no mnimo 15 caracteres.");
                        } else {
                            bloquear_tela_payisp();
                            location.href = 'nfcom.cancelar.php?chave=' + chave + '&protocolo=<?php echo $protocolo; ?>&tpAmb=<?php echo $tpAmb; ?>&justificativa=' + encodeURIComponent(result);
                        }
                    }
                }
            });
        }

        function confirmar_nova_nfcom(titulo) {
            bootbox.confirm({
                title: "Emitir Nova NFCom",
                message: "Deseja emitir uma nova NFCom para a fatura #" + titulo + "?",
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> No, cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-check"></i> Sim, confirmar',
                        className: 'btn-success'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        location.href = 'nfcom.emitir.php?titulo[]=' + titulo + '';
                    }
                }
            });
        }
    </script>
</body>

</html>
</file>

<file path="payisp/nfcom.emitir.php">
<?php
require_once 'init.php';
include(dirname(__FILE__) . '/vendor/autoload.php');
include(dirname(__FILE__) . '/src/nfcom_engine.php');
include(dirname(__FILE__) . '/src/nfcom_xml.php');
include(dirname(__FILE__) . '/src/nfcom_cert.php');
include(dirname(__FILE__) . '/src/nfcom_tools.php');
include(dirname(__FILE__) . '/src/nfcom_xsd.php');
?>
<!DOCTYPE html>
<html lang="pt-BR">

<?php
$total_notas_processadas = 0;
$registros_validos = 0;
$notas_sucesso = 0;
$notas_erro = 0;
?>

<?php
//processa as faturas selecionadas
$resultado_processamento = array();
if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['acao']) && $_POST['acao'] === 'criar_nfcom_payisp') {
    //lista de faturas para processar
    if (isset($_POST['lista_faturas']) && is_array($_POST['lista_faturas'])) {
        $faturas_para_processar = $_POST['lista_faturas'];
        foreach ($faturas_para_processar as $fatura_id) {
            $total_notas_processadas++;
            //pega o endpoint nfcom
            $endpoint = $dados_configuracoes_nfcom['endpoint'] == '' ? 'SVRS' : $dados_configuracoes_nfcom['endpoint'];
            if (!isset($nfcomEndpoints[$endpoint])) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Endpoint NFCom inv&aacute;lido configurado: ' . htmlspecialchars($endpoint)
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //pega dados da fatura
            $dados_fatura = dados_fatura_mkauth_payisp($fatura_id);
            if (!$dados_fatura) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Fatura n&atilde;o encontrada.'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //adicionais ao total da fatura
            $total_inicial = $dados_fatura['valor'];
            $sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$dados_fatura['titulo'] . "";
            $results_adicionais = $mysqli->query($sql_adicionais);
            while ($rowad = $results_adicionais->fetch_array()) {
                if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
                    $total_inicial -= $rowad['valor'];
                } elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
                    $total_inicial += $rowad['valor'];
                }
            }
            $dados_fatura['valor'] = $total_inicial;

            //pega dados do cliente
            $cliente = dados_cliente_mkauth_payisp($dados_fatura['uuid_cliente']);
            if (!$cliente) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Cliente n&atilde;o encontrado para a fatura.'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //verifica se o plano de servico foi encontrado
            $plano = servico_plano_mkauth_payisp($dados_fatura['plano'], $cliente['estado']);
            if (!$plano) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Plano de servi&ccedil;o n&atilde;o encontrado para a fatura.'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //valor base do item
            if ($dados_configuracoes_nfcom['base_valor'] == 'fatura') {
                //pega o valor da fatura com adicionais
                $valor_base_item = reduzir_base_calculo_payisp($dados_fatura['valor'], $plano['icms_p_reducao_bc']);
            } else {
                //pega o valor do servico do plano
                $valor_base_item = reduzir_base_calculo_payisp($plano['valor_servico'], $plano['icms_p_reducao_bc']);
            }
            if ($valor_base_item <= 0) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'O valor do servio para a fatura  invlido.'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //verifica regime tributario
            if ($dados_configuracoes_nfcom['regime'] != 1) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'No momento o Regime tribut&aacute;rio n&atilde;o suportado na vers&atilde;o atual (apenas Simples Nacional).'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //verifica se o arquivo xsd existe
            if (!file_exists($caminhoXsdNfcom)) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'O arquivo XSD para valida&ccedil;&atilde;o da NFCom n&atilde;o foi encontrado no caminho: ' . $caminhoXsdNfcom
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //caminhos dos certificados
            $caminho_crt = "/tmp/certificado-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".crt";
            $caminho_key = "/tmp/chave-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".key";
            if (!file_exists($caminho_crt) || !file_exists($caminho_key)) {
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Os arquivos do certificado digital para emiss&atilde;o da NFCom n&atilde;o foram encontrados. Verifique se o certificado foi exportado corretamente.'
                );
                $notas_erro++;
                continue; // pula para a prxima fatura
            }

            //vars
            $numero_nota = proximo_numero_nfcom_payisp($dados_configuracoes_nfcom['homologacao']);
            $cod_unico = $dados_fatura['titulo']; //usamos o id do titulo como codigo unico

            //nfcom
            $nfcom = new NFCom();

            //ide nfcom
            $nfcom->infNFCom->ide->cUF = $estadosNfcom[$dados_provedor['estado']];
            $nfcom->infNFCom->ide->tpAmb = $dados_configuracoes_nfcom['homologacao'] == 1 ? 2 : 1;
            $nfcom->infNFCom->ide->mod = '62';
            $nfcom->infNFCom->ide->serie = $dados_configuracoes_nfcom['homologacao'] == 1 ? 999 : $dados_configuracoes_nfcom['serie'];
            $nfcom->infNFCom->ide->nNF = $numero_nota;
            $nfcom->infNFCom->ide->cNF = str_pad($cod_unico, 7, '0', STR_PAD_LEFT);
            $nfcom->infNFCom->ide->dhEmi = date('Y-m-d\TH:i:sP');
            $nfcom->infNFCom->ide->tpEmis = 1;
            $nfcom->infNFCom->ide->nSiteAutoriz = '0';
            $nfcom->infNFCom->ide->cMunFG = $dados_provedor['cidade_ibge'];
            $nfcom->infNFCom->ide->finNFCom = 0;
            $nfcom->infNFCom->ide->tpFat = 0;
            $nfcom->infNFCom->ide->verProc = "PayispLib v1.0";

            //emit nfcom
            $nfcom->infNFCom->emit->CNPJ = somente_numero_payisp($dados_configuracoes_nfcom['cnpj']);
            $nfcom->infNFCom->emit->IE = somente_numero_payisp($dados_configuracoes_nfcom['ie']);
            $nfcom->infNFCom->emit->CRT = $dados_configuracoes_nfcom['regime'];
            $nfcom->infNFCom->emit->xNome = limpar_acentos_payisp($dados_configuracoes_nfcom['nome_social']);
            $nfcom->infNFCom->emit->xFant = limpar_acentos_payisp($dados_configuracoes_nfcom['nome_fantasia']);
            $nfcom->infNFCom->emit->enderEmit->xLgr = limpar_acentos_payisp($dados_provedor['endereco']);
            $nfcom->infNFCom->emit->enderEmit->nro = $dados_provedor['numero'];
            $nfcom->infNFCom->emit->enderEmit->xBairro = limpar_acentos_payisp($dados_provedor['bairro']);
            $nfcom->infNFCom->emit->enderEmit->cMun = $dados_provedor['cidade_ibge'];
            $nfcom->infNFCom->emit->enderEmit->xMun = limpar_acentos_payisp($dados_provedor['cidade']);
            $nfcom->infNFCom->emit->enderEmit->CEP = preg_replace('/\D/', '', $dados_provedor['cep']);
            $nfcom->infNFCom->emit->enderEmit->UF = $dados_provedor['estado'];
            $nfcom->infNFCom->emit->enderEmit->fone = preg_replace('/\D/', '', $dados_provedor['fone']);
            $nfcom->infNFCom->emit->enderEmit->email = $dados_provedor['email'];

            //dest nfcom
            $nfcom->infNFCom->dest->xNome = limpar_acentos_payisp($cliente['nome']);
            if (strlen(preg_replace('/\D/', '', $cliente['cpf_cnpj'])) == 14) {
                $nfcom->infNFCom->dest->CNPJ = preg_replace('/\D/', '', $cliente['cpf_cnpj']);
                $nfcom->infNFCom->dest->indIEDest = empty($cliente['ie']) ? 9 : 1; // 1=Contribuinte ICMS, 9=No Contribuinte
            } else {
                $nfcom->infNFCom->dest->CPF = preg_replace('/\D/', '', $cliente['cpf_cnpj']);
                $nfcom->infNFCom->dest->indIEDest = 9; // 9=No Contribuinte
            }
            $nfcom->infNFCom->dest->enderDest->xLgr = limpar_acentos_payisp($cliente['endereco']);
            $nfcom->infNFCom->dest->enderDest->nro = $cliente['numero'];
            $nfcom->infNFCom->dest->enderDest->xBairro = limpar_acentos_payisp($cliente['bairro']);
            $nfcom->infNFCom->dest->enderDest->cMun = $cliente['cidade_ibge'];
            $nfcom->infNFCom->dest->enderDest->xMun = limpar_acentos_payisp($cliente['cidade']);
            $nfcom->infNFCom->dest->enderDest->CEP = preg_replace('/\D/', '', $cliente['cep']);
            $nfcom->infNFCom->dest->enderDest->UF = $cliente['estado'];

            //assinante nfcom
            $nfcom->infNFCom->assinante->iCodAssinante = preg_replace('/\D/', '', $cliente['cpf_cnpj']);
            $nfcom->infNFCom->assinante->tpAssinante = $cliente['tipo_pessoa'];
            $nfcom->infNFCom->assinante->tpServUtil = $plano['icms_csosn'];
            $nfcom->infNFCom->assinante->nContrato = preg_replace('/\D/', '', $cliente['cpf_cnpj']);
            $nfcom->infNFCom->assinante->dContratoIni = transformar_data_ddmmyyyy_payisp($cliente['cadastro']);

            //item nfcom
            $item1 = new Det(1); // nItem = 1
            // 6a. <prod>
            $item1->prod->cProd = $plano['id'];
            $item1->prod->xProd = limpar_acentos_payisp($plano['descricao']);
            $item1->prod->cClass = $plano['cclass'];
            $item1->prod->CFOP = $plano['id_cfop'];
            $item1->prod->uMed = $plano['unidade'];
            $item1->prod->qFaturada = (int)$plano['quantidade'];
            $item1->prod->vItem = number_format(($valor_base_item / (int)$plano['quantidade']), 8, '.', '');
            $item1->prod->vProd = number_format((($valor_base_item / (int)$plano['quantidade']) * (int)$plano['quantidade']), 8, '.', '');
            // 6b. <imposto>
            // 6b.1. ICMS (Neste caso, Simples Nacional)
            $icms = new IcmsSN();
            $icms->CST = $plano['icms_cst'];
            $icms->indSN = $dados_configuracoes_nfcom['regime'] == 1 ? 1 : 2; //1=Simples Nacional, 2=Excesso de sublimite
            $item1->imposto->icms = $icms; // Atribui o objeto ICMS especfico
            // 6b.2. PIS
            $item1->imposto->PIS->CST = $plano['pis_cst'];
            $item1->imposto->PIS->vBC = number_format($valor_base_item, 8, '.', '');
            $item1->imposto->PIS->pPIS = 0.00;
            $item1->imposto->PIS->vPIS = 0.00;
            // 6b.3. COFINS
            $item1->imposto->COFINS->CST = $plano['cofins_cst'];
            $item1->imposto->COFINS->vBC = number_format($valor_base_item, 8, '.', '');
            $item1->imposto->COFINS->pCOFINS = 0.00;
            $item1->imposto->COFINS->vCOFINS = 0.00;
            // 6b.4. FUST
            $item1->imposto->FUST->vBC = number_format($valor_base_item, 8, '.', '');
            $item1->imposto->FUST->pFUST = $dados_configuracoes_nfcom['fust_p_aliquota'];
            $item1->imposto->FUST->vFUST = number_format(($valor_base_item * ($dados_configuracoes_nfcom['fust_p_aliquota'] / 100)), 8, '.', '');
            // 6b.5. FUNTTEL
            $item1->imposto->FUNTTEL->vBC = number_format($valor_base_item, 8, '.', '');
            $item1->imposto->FUNTTEL->pFUNTTEL = $dados_configuracoes_nfcom['funttel_p_aliquota'];
            $item1->imposto->FUNTTEL->vFUNTTEL = number_format(($valor_base_item * ($dados_configuracoes_nfcom['funttel_p_aliquota'] / 100)), 8, '.', '');
            // 6b.6. retTrib
            $item1->imposto->retTrib->vRetPIS = 0.00;
            $item1->imposto->retTrib->vRetCofins = 0.00;
            $item1->imposto->retTrib->vRetCSLL = 0.00;
            $item1->imposto->retTrib->vBCIRRF = 0.00;
            $item1->imposto->retTrib->vIRRF = 0.00;
            // 6c. Adicione o item  nota
            $nfcom->infNFCom->addDet($item1);

            // 7. Preencha o Bloco <total>
            $nfcom->infNFCom->total->vProd = number_format($valor_base_item, 8, '.', '');
            $nfcom->infNFCom->total->ICMSTot->vBC = 0.00;
            $nfcom->infNFCom->total->ICMSTot->vICMS = 0.00;
            $nfcom->infNFCom->total->ICMSTot->vICMSDeson = 0.00;
            $nfcom->infNFCom->total->ICMSTot->vFCP = 0.00;
            $nfcom->infNFCom->total->vCOFINS = 0.00;
            $nfcom->infNFCom->total->vPIS = 0.00;
            $nfcom->infNFCom->total->vFUNTTEL = number_format(($valor_base_item * ($dados_configuracoes_nfcom['funttel_p_aliquota'] / 100)), 8, '.', '');
            $nfcom->infNFCom->total->vFUST = number_format(($valor_base_item * ($dados_configuracoes_nfcom['fust_p_aliquota'] / 100)), 8, '.', '');
            $nfcom->infNFCom->total->vRetTribTot->vRetPIS = 0.00;
            $nfcom->infNFCom->total->vRetTribTot->vRetCofins = 0.00;
            $nfcom->infNFCom->total->vRetTribTot->vRetCSLL = 0.00;
            $nfcom->infNFCom->total->vRetTribTot->vIRRF = 0.00;
            $nfcom->infNFCom->total->vDesc = 0.00;
            $nfcom->infNFCom->total->vOutro = 0.00;
            $nfcom->infNFCom->total->vNF = number_format($valor_base_item, 8, '.', '');

            // 8. Preencha o Bloco de Faturamento (GFat)
            $nfcom->infNFCom->faturamento = new GFat();
            $nfcom->infNFCom->faturamento->nFat = 'FAT' . str_pad($dados_fatura['titulo'], 6, '0', STR_PAD_LEFT);
            if ($dados_configuracoes_nfcom['base_competencia'] == 'pagamento') {
                $nfcom->infNFCom->faturamento->CompetFat = date('Ym', strtotime($dados_fatura['datapag']));
                $nfcom->infNFCom->faturamento->dVencFat = date('Y-m-d', strtotime($dados_fatura['datavenc']));
                $nfcom->infNFCom->faturamento->dPerUsoIni = primeira_data_mes_payisp($dados_fatura['datavenc']);
                $nfcom->infNFCom->faturamento->dPerUsoFim = ultima_data_mes_payisp($dados_fatura['datavenc']);
            } else {
                $nfcom->infNFCom->faturamento->CompetFat = date('Ym', strtotime($dados_fatura['datavenc']));
                $nfcom->infNFCom->faturamento->dVencFat = date('Y-m-d', strtotime($dados_fatura['datavenc']));
                $nfcom->infNFCom->faturamento->dPerUsoIni = primeira_data_mes_payisp($dados_fatura['datavenc']);
                $nfcom->infNFCom->faturamento->dPerUsoFim = ultima_data_mes_payisp($dados_fatura['datavenc']);
            }

            if (strlen(somente_numero_payisp($dados_fatura['linhadig'])) >= 44 && $dados_configuracoes_nfcom['enviar_boleto'] == 1) {
                $nfcom->infNFCom->faturamento->codBarras = somente_numero_payisp($dados_fatura['linhadig']);
            } else {
                $nfcom->infNFCom->faturamento->codBarras = '00000000000000000000000000000000000000000000000';
            }

            //8.1 Preenche os dados de Pix
            $pix = dados_pix_mkauth_payis($dados_fatura['uuid_lanc']);
            if ($dados_configuracoes_nfcom['enviar_pix'] == 1 && isset($pix['qrcode']) && !empty($pix['qrcode'])) {
                $pixOb = new GPIX();
                $pixOb->urlQRCodePIX = $pix['qrcode'];
                $nfcom->infNFCom->faturamento->gPIX = 'https://www.mkauth-addons.com.br/api/text.to.qrcode.php?cod=' . urlencode($pix['qrcode']);
            }

            // 9. Preencha o Bloco <infAdic>
            $nfcom->infNFCom->infAdic->infCpl = limpar_acentos_payisp($dados_configuracoes_nfcom['obs']);

            // 9. (opcional) Gere o JSON da NFCom
            $nfcomJson = json_encode($nfcom);

            // 10. Gere o XML
            try {
                // Gera o XML da NFCom
                $nfcom->setUrlBaseQrCode('https://dfe-portal.svrs.rs.gov.br/NFCom/qrcode');
                // Assina o XML da NFCom
                $assinador = new AssinadorNFCom();
                $senha_da_chave = '';
                $assinador->carregarChaves($caminho_crt, $caminho_key, $senha_da_chave);
                $docxml = $nfcom->gerarXml();
                $xmlAssinado = $assinador->assinar($docxml, 'infNFCom');
                // Gera a chave da NFCom
                if ($nfcom->chave == '') {
                    throw new Exception("Erro ao gerar a chave da NFCom.");
                }
                if (strlen($nfcom->chave) != 44) {
                    throw new Exception("Chave da NFCom gerada  invlida: " . htmlspecialchars($nfcom->chave));
                }
                // Valida o XML da NFCom
                $validador = new NFComValidator($caminhoXsdNfcom);
                $validador->validate($xmlAssinado);
                // Salva o XML em um arquivo temporrio
                $caminho_arquivo_xml = '/opt/mk-auth/mkfiles/payisp.nfcom.emissao.' . $nfcom->chave . '.xml';
                $fp = fopen($caminho_arquivo_xml, 'w+');
                if ($fp === false) {
                    throw new Exception("No foi possvel criar o arquivo XML temporrio em: " . htmlspecialchars($caminho_arquivo_xml));
                }
                fwrite($fp, $xmlAssinado);
                fclose($fp);
                //inicializa o cliente NFCom
                $nfcomClient = new NFComClient($nfcomEndpoints[$endpoint]);
                //carrega o certificado e chave privada
                $nfcomClient->setCertificados($caminho_crt, $caminho_key, '');
                $resposta = $nfcomClient->enviarNFCom($xmlAssinado, $dados_configuracoes_nfcom['homologacao'] == 1 ? 2 : 1);
                $cStat = (int)$resposta->cStat;
                $xMotivo = (string)$resposta->xMotivo;
                $chNFCom = (isset($resposta->protNFCom->infProt->chNFCom) ? (string)$resposta->protNFCom->infProt->chNFCom : '');
                $nProt = (isset($resposta->protNFCom->infProt->nProt) ? (string)$resposta->protNFCom->infProt->nProt : '');
                //se emitida com sucesso
                if ($cStat == 100) {
                    //registra a nota nfcom
                    $sql_nota = "INSERT INTO payisp_notas_nfcom (titulo, serie, numero, emissao,  `status`, chave, protocolo, itens, extras, xml, resultado, eventos, cancelamento, validada, emitida, finalidade, cancelada, motivo_cancelamento, cstat, xmotivo, substituida, obs, homologacao, total_nota) VALUES (
                        " . (int)$dados_fatura['titulo'] . ",
                        " . (int)$nfcom->infNFCom->ide->serie . ",
                        " . (int)$nfcom->infNFCom->ide->nNF . ",
                        NOW(),
                        'emitida',
                        '" . escape_payisp($chNFCom) . "',
                        '" . escape_payisp($nProt) . "',
                        '" . escape_payisp($nfcomJson) . "',
                        '',
                        '" . escape_payisp($xmlAssinado) . "',
                        '" . escape_payisp(json_encode($resposta)) . "',
                        '',
                        '',
                        1,
                        1,
                        1,
                        0,
                        '',
                        " . (int)$cStat . ",
                        '" . escape_payisp($xMotivo) . "',
                        0,
                        '" . escape_payisp($nfcom->infNFCom->infAdic->infCpl) . "',
                        " . (int)$dados_configuracoes_nfcom['homologacao'] . ",
                        '" . number_format($nfcom->infNFCom->total->vNF, 2, '.', '') . "'
                    )";
                    $mysqli->query($sql_nota);
                    //remove os registros de erro anteriores
                    $sql_limpa_erro = "DELETE FROM payisp_notas_nfcom_erros WHERE titulo_erro = " . (int)$dados_fatura['titulo'] . ";";
                    $mysqli->query($sql_limpa_erro);
                    //log bd geral 
                    criar_log_api_payisp('nfcom', escape_payisp($nfcomJson), escape_payisp(json_encode($resposta)), 200, 'emitir');
                    //log sistema
                    criar_log_mkauth_payisp('NFCom emitida com sucesso para a fatura ID ' . (int)$fatura_id . '. Chave: ' . htmlspecialchars($chNFCom), 'admin');
                } else {
                    //registra o erro
                    $sql_erro = "INSERT INTO payisp_notas_nfcom_erros SET titulo_erro = " . (int)$dados_fatura['titulo'] . ", data_erro = NOW(), xstat_erro = " . (int)$cStat . ", xmotivo_erro = '" . escape_payisp($xMotivo) . "';";
                    $mysqli->query($sql_erro);
                    //log bd geral 
                    criar_log_api_payisp('nfcom', escape_payisp($nfcomJson), escape_payisp(json_encode($resposta)), 400, 'emitir');
                }
                //resultado
                if ($cStat == 100) {
                    $resultado_processamento[] = array(
                        'fatura_id' => $fatura_id,
                        'status' => 'sucesso',
                        'mensagem' => 'NFCom emitida com sucesso. Chave: ' . htmlspecialchars($chNFCom)
                    );
                    $notas_sucesso++;
                } else {
                    $resultado_processamento[] = array(
                        'fatura_id' => $fatura_id,
                        'status' => 'erro',
                        'mensagem' => 'Erro ao emitir a NFCom. C&oacute;digo: ' . htmlspecialchars($cStat) . ' - ' . htmlspecialchars($xMotivo)
                    );
                    $notas_erro++;
                }
                //log sistema
                criar_log_mkauth_payisp('Processamento da NFCom concludo para a fatura ID ' . (int)$fatura_id . '. Status: ' . htmlspecialchars($cStat), 'admin');
            } catch (\Exception $e) {
                //captura erro generico
                $resultado_processamento[] = array(
                    'fatura_id' => $fatura_id,
                    'status' => 'erro',
                    'mensagem' => 'Erro ao processar a NFCom para a fatura: ' . $e->getMessage()
                );
                $notas_erro++;
                //log bd geral 
                criar_log_api_payisp('nfcom', escape_payisp($nfcomJson), escape_payisp($e->getMessage()), 500, 'emitir');
                //registra o erro
                $sql_erro = "INSERT INTO payisp_notas_nfcom_erros SET titulo_erro = " . (int)$dados_fatura['titulo'] . ", data_erro = NOW(), xstat_erro = 0, xmotivo_erro = '" . escape_payisp($e->getMessage()) . "';";
                $mysqli->query($sql_erro);
            }
        }
    }
}
?>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title>Criar NFCom - PAY ISP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
    <script>
        function confirmar_enviar_nfcom_payisp() {
            var bootbox_confirm = bootbox.confirm({
                title: "Confirma o envio para emiss&atilde;o das notas NFCom as faturas selecionadas?",
                message: "Voc&ecirc; est&aacute; prestes a enviar as faturas selecionadas para emiss&atilde;o de NFCom. Deseja continuar?",
                buttons: {
                    cancel: {
                        label: '<i class="bi bi-x-circle"></i> Cancelar',
                        className: 'btn-danger'
                    },
                    confirm: {
                        label: '<i class="bi bi-check-circle"></i> Confirmar',
                        className: 'btn-success'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        $('#form_criar_nfcom_payisp').submit();
                    }
                }
            });
        }
    </script>
</head>

<body>
    <?php if (isset($resultado_processamento) && count($resultado_processamento) > 0) { ?>
        <br>
        <div class="container-fluid mt-3">
            <h4>Resultado do Processamento das Faturas</h4>
            <?php if ($notas_erro > 0) { ?>
                <div class="alert alert-danger" role="alert">
                    Existem <b><?php echo $notas_erro; ?></b> nota(s) com erro(s) durante o processamento. Por favor, verifique a lista abaixo para mais detalhes e corrija os problemas antes de tentar emitir novamente.
                </div>
            <?php } ?>
            <?php if ($notas_sucesso > 0 && $notas_sucesso == $total_notas_processadas) { ?>
                <div class="alert alert-success" role="alert">
                    Todas as <b><?php echo $notas_sucesso; ?></b> nota(s) foram emitidas com sucesso.
                </div>
            <?php } ?>
            <table class="table table-bordered table-striped">
                <thead>
                    <tr>
                        <th>ID da Fatura</th>
                        <th>Status</th>
                        <th>Mensagem</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($resultado_processamento as $resultado) { ?>
                        <tr>
                            <td><?php echo htmlspecialchars_decode($resultado['fatura_id']); ?></td>
                            <td><?php echo htmlspecialchars_decode(ucfirst($resultado['status'])); ?></td>
                            <td><?php echo htmlspecialchars_decode($resultado['mensagem']); ?></td>
                        </tr>
                    <?php } ?>
                </tbody>
            </table>
            <button class="btn btn-danger" onclick="window.close();">
                <i class="bi bi-x-circle"></i>
                Fechar
            </button>
        </div>
        <script>
            self.opener.reloadAqui();
        </script>
    <?php } else { ?>
        <br>
        <div class="container-fluid">
            <form action="" method="post" id="form_criar_nfcom_payisp">
                <input type="hidden" name="acao" value="criar_nfcom_payisp">
                <!-- verifica se nfcom esta ativa -->
                <?php if ($dados_configuracoes_nfcom['status'] == 0) { ?>
                    <div class="alert alert-danger" role="alert">
                        <strong>ATENO!</strong> A emisso de NFCom est desativada nas configuraes do PAY ISP > NFCom. Por favor, ative-a para prosseguir.
                    </div>
                <?php exit;
                } ?>
                <!-- verifica se nfcom esta em homologacao -->
                <?php if ($dados_configuracoes_nfcom['homologacao'] == 1) { ?>
                    <div class="alert alert-warning" role="alert">
                        <strong>AVISO!</strong> A emisso de NFCom est em modo de homologao nas configuraes do PAY ISP, todas as noto vo ser emitidas em ambiente de testes e na serie 999.
                    </div>
                <?php } ?>
                <!-- valida certificado digital -->
                <?php if (validade_certificado_nfcom_payisp($dados_configuracoes_nfcom['cnpj']) === false) { ?>
                    <div class="alert alert-danger" role="alert">
                        <strong>ATENO!</strong> O certificado digital configurado para emisso de NFCom est invlido ou expirado. Por favor, verifique o certificado nas configuraes do PAY ISP > NFCom.
                    </div>
                <?php exit;
                } ?>
                <!-- valida dados do emitente -->
                <?php
                $dados_invalidos_emitente = dados_emitente_nfcom_invalidos_payisp($dados_configuracoes_nfcom);
                if (count($dados_invalidos_emitente) > 0) {
                ?>
                    <div class="alert alert-danger" role="alert">
                        <strong>ATENO!</strong> Os dados do emitente da NFCom esto incompletos ou invlidos <b><?php echo implode(',', $dados_invalidos_emitente); ?>]</b>. Por favor, verifique os dados nas configuraes do PAY ISP > NFCom.
                    </div>
                <?php exit;
                } ?>
                <!-- valida endereco do emitente -->
                <?php
                $dados_invalidos_end_prov = endereco_emitente_nfcom_invalidos_payisp($dados_provedor);
                if (count($dados_invalidos_end_prov) > 0) {
                ?>
                    <div class="alert alert-danger" role="alert">
                        <strong>ATENO!</strong> O endereo do emitente da NFCom est incompleto ou invlido <b><?php echo implode(',', $dados_invalidos_end_prov); ?>]</b>. Por favor, verifique o endereo nas configuraes do Provedor > Dados Provedor.
                    </div>
                <?php exit;
                } ?>
                <?php if (total_servicos_nfcom_payisp() == 0) { ?>
                    <div class="alert alert-danger" role="alert">
                        <strong>ATENO!</strong> No h servios configurados para emisso de NFCom. Por favor, verifique os servios nas configuraes do PAY ISP > NFCom > Servios.
                    </div>
                <?php exit;
                } ?>

                <?php
                //pega
                $titulos = isset($_GET['titulo']) ? $_GET['titulo'] : array();
                //lista e valida os titulos um a um antes de criar a nfcom
                foreach ($titulos as $titulo) {
                    //dados da fatura
                    $dados_fatura = dados_fatura_mkauth_payisp($titulo);
                    if (!$dados_fatura) {
                        echo '<div class="alert alert-danger" role="alert">
                    <strong>ATENO!</strong> A fatura com o ID ' . $titulo . ' no foi encontrada no sistema MK-Auth.
                </div>';
                        continue;
                    }
                    //dados do destinatario so validos
                    $dados_destinatario_validos = dados_destinatario_nfcom_invalidos_payisp($dados_fatura);
                    if (count($dados_destinatario_validos) > 0) {
                        echo '<div class="alert alert-danger" role="alert">
                    <strong>ATENO!</strong> Os dados do destinatrio <b>[' . $dados_fatura['nome'] . ']</b> da fatura com o ID <b>#' . $titulo . '</b> esto incompletos ou invlidos <b>[' . implode(',', $dados_destinatario_validos) . ']</b>. Por favor, verifique os dados do cliente e atualize.
                </div>';
                        continue;
                    }
                    //pega o servico nfcom do plano
                    $plano = servico_plano_mkauth_payisp($dados_fatura['plano']);
                    if (!$plano) {
                        echo '<div class="alert alert-danger" role="alert">
                    <strong>ATENO!</strong> No h servio configurado para o plano <b>[' . $dados_fatura['plano'] . ']</b> da fatura com o ID <b>#' . $titulo . '</b>. Por favor, verifique os servios nas configuraes do PAY ISP > NFCom > Servios.
                </div>';
                        continue;
                    }
                    //adicionais ao total da fatura
                    $total_inicial = $dados_fatura['valor'];
                    $sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$dados_fatura['titulo'] . "";
                    $results_adicionais = $mysqli->query($sql_adicionais);
                    while ($rowad = $results_adicionais->fetch_array()) {
                        if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
                            $total_inicial -= $rowad['valor'];
                        } elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
                            $total_inicial += $rowad['valor'];
                        }
                    }
                    $dados_fatura['valor'] = $total_inicial;
                    //valor base do item
                    if ($dados_configuracoes_nfcom['base_valor'] == 'fatura') {
                        //pega o valor da fatura com adicionais
                        $valor_base_item = reduzir_base_calculo_payisp($dados_fatura['valor'], $plano['icms_p_reducao_bc']);
                    } else {
                        //pega o valor do servico do plano
                        $valor_base_item = reduzir_base_calculo_payisp($plano['valor_servico'], $plano['icms_p_reducao_bc']);
                    }
                    //tudo ok
                    $registros_validos++;
                    echo '<input type="hidden" name="lista_faturas[]" value="' . $titulo . '">';
                    if ($dados_fatura['status'] != 'pago') {
                        echo '<div class="alert alert-primary" role="alert">
                    <strong>AVISO!</strong> A fatura com o ID <b>#' . $titulo . '</b> para o cliente <b>' . $dados_fatura['nome'] . '</b> est com o status <b>' . ucfirst($dados_fatura['status']) . '</b>. A NFCom ser emitida normalmente, caso venha a confirmar a emisso da mesma.
                </div>';
                    } else {
                        echo '<div class="alert alert-success" role="alert">
                    <strong>OK!</strong> A fatura com o ID <b>#' . $titulo . '</b> para o cliente <b>' . $dados_fatura['nome'] . '</b> foi validada inicialmente com sucesso, emisso da NFCom no valor de <b>R$' . number_format($valor_base_item, 2, ',', '.') . ' [' . $dados_configuracoes_nfcom['base_valor'] . ']</b>.
                </div>';
                    }
                }
                ?>
                <div class="mb-3">
                    <button type="button" onclick="confirmar_enviar_nfcom_payisp()"
                        <?php echo $registros_validos == 0 ? 'disabled' : ''; ?>
                        class="btn btn-primary" id="btn_criar_nfcom_payisp"><i class="fa fa-file-invoice"></i> Criar NFCom para <?php echo $registros_validos; ?> faturas selecionadas</button>
                </div>
            </form>
        </div>
    <?php } ?>
</body>

</html>
</file>

<file path="payisp/nfcom.erros.php">
<?php
require_once 'init.php';
$id_titulo = (int)valor_antigo_payisp('titulo');
$sql = "SELECT * FROM payisp_notas_nfcom_erros WHERE titulo_erro = $id_titulo";
$dados_erro = $mysqli->query($sql);
$total_erro = $dados_erro->num_rows;
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status API NFCom - MK-Auth Pay ISP</title>
    <!-- Incluindo Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
</head>

<body>
    <?php if ($total_erro > 0) { ?>
        <div class="container mt-4">
            <h3 class="mb-4">Erros de Emisso NFCom - Ttulo #<?php echo $id_titulo; ?></h3>
            <table class="table table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Data do Erro</th>
                        <th>Cdigo do Erro</th>
                        <th>Mensagem do Erro</th>
                    </tr>
                </thead>
                <tbody>
                    <?php while ($row = $dados_erro->fetch_assoc()) { ?>
                        <tr>
                            <td><?php echo date('d/m/Y H:i:s', strtotime($row['data_erro'])); ?></td>
                            <td><?php echo htmlspecialchars($row['xstat_erro']); ?></td>
                            <td><?php echo htmlspecialchars($row['xmotivo_erro']); ?></td>
                        </tr>
                    <?php } ?>
                </tbody>
            </table>
        </div>
    <?php } else { ?>
        <div class="container mt-4">
            <div class="alert alert-info" role="alert">
                Nenhum erro encontrado para o ttulo #<?php echo $id_titulo; ?>.
            </div>
        </div>
    <?php } ?>

</body>

</html>
</file>

<file path="payisp/nfcom.imprimir.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?php require_once(dirname(__FILE__) . '/class.qrcode.php'); ?>
<?php
//class bank
$classBank = new BancoClassPayIsp();
//base da impressao das notas 
$base = isset($_GET['base']) ? xss_input_protect_payisp($_GET['base']) : 'titulo';
//pega os titulos a imprimir
$titulos = [];
if (isset($_GET['titulo'])) {
    if (is_array($_GET['titulo'])) {
        $titulos = $_GET['titulo'];
    } else {
        $titulos[] = $_GET['titulo'];
    }
}

//funcoes de formatacao
function h($value, $default = '---', $formatter = null, ...$params)
{
    $resolvedValue = $value;
    if (is_array($value) && count($value) == 2) {
        list($obj, $prop) = $value;
        if (isset($obj) && !is_null($obj) && isset($obj->{$prop}) && !is_null($obj->{$prop}) && $obj->{$prop} !== '') {
            $resolvedValue = $obj->{$prop};
        } else {
            $resolvedValue = null;
        }
    }
    if (isset($resolvedValue) && !is_null($resolvedValue) && $resolvedValue !== '') {
        $formattedValue = $resolvedValue;
        if (is_callable($formatter)) {
            try {
                $formattedValue = call_user_func($formatter, $resolvedValue, ...$params);
            } catch (Exception $e) {
                $formattedValue = $resolvedValue;
            }
        }
        return htmlspecialchars($formattedValue);
    }
    return $default;
}

function formatarData($dateStr)
{
    return date('d/m/Y', strtotime($dateStr));
}

function formatarDataHora($dateTimeStr)
{
    return date('d/m/Y H:i:s', strtotime($dateTimeStr));
}

function formatarMoeda($valor)
{
    return 'R$ ' . number_format((float)$valor, 2, ',', '.');
}

function formatarNumero($valor, $decimais = 2)
{
    return number_format((float)$valor, $decimais, ',', '.');
}

function formatarCnpjCpf($cnpj, $cpf)
{
    $val = !empty($cpf) ? $cpf : $cnpj;
    if (empty($val)) return '';
    if (strlen($val) == 11) return preg_replace("/(\d{3})(\d{3})(\d{3})(\d{2})/", "\$1.\$2.\$3-\$4", $val);
    return preg_replace("/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/", "\$1.\$2.\$3/\$4-\$5", $val);
}

function formatarUnidade($uMed)
{
    $map = ['1' => 'MIN', '2' => 'MB', '3' => 'GB', '4' => 'UN'];
    return $map[$uMed] ?? (string)$uMed;
}

function formatarCompetencia($compet)
{
    $ano = substr($compet, 0, 4);
    $mesNum = (int)substr($compet, 4, 2);
    $meses = [1 => 'JAN', 2 => 'FEV', 3 => 'MAR', 4 => 'ABR', 5 => 'MAI', 6 => 'JUN', 7 => 'JUL', 8 => 'AGO', 9 => 'SET', 10 => 'OUT', 11 => 'NOV', 12 => 'DEZ'];
    return ($meses[$mesNum] ?? '') . '/' . $ano;
}

function calcularDV($chave)
{
    $soma = 0;
    $multiplicadores = [2, 3, 4, 5, 6, 7, 8, 9];
    $i = strlen($chave) - 1;
    $j = 0;
    while ($i >= 0) {
        $soma += (int)$chave[$i] * $multiplicadores[$j];
        $j = ($j == 7) ? 0 : $j + 1;
        $i--;
    }
    $resto = $soma % 11;
    return ($resto == 0 || $resto == 1) ? 0 : (11 - $resto);
}
?>

<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imprimir DANFE-COM Titulo(s): <?php echo implode(',', $titulos); ?></title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 9pt;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        .danfe-a4 {
            width: 790px;
            /* Aprox. 210mm */
            /* REMOVIDO: min-height: 1120px; (Causador do problema) */
            margin: 10px auto;
            padding: 15px;
            /* Margem interna para visualizao */
            background-color: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
            /* Espaamento entre tabelas */
        }

        td,
        th {
            border: 1px solid #000;
            padding: 4px;
            /* Padding reduzido */
            vertical-align: top;
            font-size: 9pt;
        }

        th {
            background-color: #f0f0f0;
            font-size: 8pt;
            text-transform: uppercase;
            text-align: left;
        }

        .header-label {
            font-size: 8pt;
            text-transform: uppercase;
            color: #333;
            margin: 0;
        }

        .header-value {
            font-size: 10pt;
            font-weight: bold;
            margin: 0;
        }

        .logo-placeholder {
            max-height: 60px;
            /* Logo menor */
            width: auto;
            content: url('../../../mkfiles/logo.jpg');
        }

        .chave-numero {
            font-family: 'Courier New', Courier, monospace;
            font-size: 11pt;
            /* Fonte da chave menor */
            font-weight: bold;
            word-break: break-all;
        }

        .qr-code {
            width: 100px;
            /* QR Code menor */
            height: 100px;
            margin: auto;
        }

        .total-pagar {
            font-size: 14pt;
            font-weight: bold;
            text-align: right;
        }

        .text-right {
            text-align: right;
        }

        .text-center {
            text-align: center;
        }

        .no-border {
            border: none;
        }

        .full-height {
            height: 100%;
        }

        @media print {

            /* Define o tamanho da pgina e zera as margens do navegador */
            @page {
                size: A4;
                margin: 10mm;
                /* Define uma margem de impresso de 1cm */
            }

            /* Reseta o body para impresso */
            body {
                background-color: #fff;
                font-size: 9pt;
                margin: 0;
                padding: 0;
            }

            /* Remove estilos de tela do container */
            .danfe-a4 {
                width: 100%;
                margin: 0;
                padding: 0;
                border: none;
                box-shadow: none;
                min-height: 0;
                /* Reseta a altura mnima */
            }

            /* Esconde o boto de imprimir */
            .btn-print {
                display: none;
            }

            /* (Opcional) Evita quebra de tabelas no meio */
            table {
                page-break-inside: auto;
            }

            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }

            .hiden-print {
                display: none;
            }

            .new-page {
                page-break-before: always;
            }
        }
    </style>
</head>

<body onload="self.print();"

    <div class="danfe-a4">

    <?php if (count($titulos) == 0): ?>
        <div class="alert alert-warning" role="alert">
            Nenhum ttulo selecionado para impresso da NFCom.
        </div>
    <?php else: ?>

        <div style="text-align: center; margin-bottom: 10px;" class="hiden-print">
            <button onclick="window.print()" class="btn-print">Imprimir DANFE-COM</button>
        </div>

        <?php foreach ($titulos as $titulo): ?>
            <?php
            // Carrega os detalhes da NFCom para o ttulo atual
            $nfcom  = detalhes_nfcom_payisp($titulo);
            // Verifica se a NFCom foi carregada corretamente
            if (!$nfcom || empty($nfcom['itens'])) {
                echo '<div class="alert alert-danger hiden-print" role="alert">
                        No foi possvel carregar a NFCom para o ttulo: ' . h($titulo) . '.
                    </div>';
                continue;
            }
            // Gerar chave de acesso formatada
            $jsonData = @json_decode($nfcom['itens']);
            if (!$jsonData || !isset($jsonData->infNFCom)) {
                echo '<div class="alert alert-danger hiden-print" role="alert">
                        Dados invlidos na NFCom para o ttulo: ' . h($titulo) . '.
                    </div>';
                continue;
            }
            $data = $jsonData->infNFCom;
            //print_r($data);
            $dataSupl = isset($jsonData->infNFComSupl) ? $jsonData->infNFComSupl : null;
            $chaveGerada = $nfcom['chave'];
            $urlBaseQrCode = ($data->ide->tpAmb == 1) ? 'https://dfe-portal.svrs.rs.gov.br/NFCom/qrcode' : 'https://dfe-portal.svrs.rs.gov.br/NFCom/qrcode';
            $params = http_build_query(['chNFCom' => $chaveGerada, 'tpAmb' => $data->ide->tpAmb]);
            $urlQrCode = $urlBaseQrCode . '?' . $params;
            $chaveFormatada = implode(' ', str_split($chaveGerada, 4));
            ?>

            <table style="margin-bottom: 5px;">
                <tr>
                    <td style="width: 150px; text-align: center; border: 1px solid #000;">
                        <img src="" class="logo-placeholder" alt="Logo da Empresa">
                    </td>
                    <td style="padding: 5px; border: 1px solid #000; vertical-align: middle;">
                        <p class="header-value" style="font-size: 12pt;"><?php echo h([$data->emit, 'xNome']); ?></p>
                        <p style="margin: 2px 0; font-size: 9pt;">
                            <?php echo h([$data->emit->enderEmit, 'xLgr']); ?>, <?php echo h([$data->emit->enderEmit, 'nro']); ?> -
                            <?php echo h([$data->emit->enderEmit, 'xBairro']); ?>, <?php echo h([$data->emit->enderEmit, 'xMun']); ?> - <?php echo h([$data->emit->enderEmit, 'UF']); ?>
                        </p>
                        <p style="margin: 2px 0; font-size: 9pt;">
                            <strong>CNPJ:</strong> <?php echo h([$data->emit, 'CNPJ'], '---', 'formatarCnpjCpf', $data->emit->CNPJ, null); ?>
                            <strong style="margin-left: 20px;">IE:</strong> <?php echo h([$data->emit, 'IE']); ?>
                            <?php if (isset($data->emit->enderEmit->fone) && !empty($data->emit->enderEmit->fone)): ?>
                                <strong style="margin-left: 20px;">Fone:</strong> <?php echo h([$data->emit->enderEmit, 'fone']); ?>
                            <?php endif; ?>
                        </p>
                    </td>
                </tr>
            </table>

            <table style="margin-bottom: 5px;">
                <tr>
                    <td class="text-center" style="padding: 10px;">
                        <p class="header-value" style="font-size: 10pt;">DOCUMENTO AUXILIAR DA NOTA FISCAL FATURA DE SERVIOS DE COMUNICAO ELETRNICA</p>
                        <p class="header-label" style="margin-top: 10px; font-size: 14px;">
                            <span style="margin-left: 0px; font-weight: bold;">NFCom N:</span> <?php echo h([$data->ide, 'nNF'], '---', 'str_pad', 9, '0', STR_PAD_LEFT); ?>
                            <span style="margin-left: 20px; font-weight: bold;">Srie:</span> <?php echo h([$data->ide, 'serie']); ?>
                            <span style="margin-left: 20px; font-weight: bold;">Emisso:</span> <?php echo h([$data->ide, 'dhEmi'], '---', 'formatarDataHora'); ?>
                        </p>
                    </td>
                </tr>
            </table>

            <table style="margin-bottom: 5px;">
                <tr>
                    <td style="width: 75%; padding: 5px;">
                        <p class="header-label">CONSULTE PELA CHAVE DE ACESSO EM:</p>
                        <p style="font-size: 9pt; margin: 2px 0;">https://dfe-portal.svrs.rs.gov.br/NFCom/Consulta</p>
                        <p class="header-label" style="margin-top: 10px;">CHAVE DE ACESSO:</p>
                        <p class="header-value"><?php echo h($chaveFormatada); ?></p>
                        <p class="header-label" style="margin-top: 10px;">PROTOCOLO DE AUTORIZAO:</p>
                        <p class="header-value"><?php echo $nfcom['protocolo']; ?></p>
                    </td>
                    <td style="width: 25%; text-align: center; padding: 5px;">
                        <?php
                        ob_start();
                        QRCode::png($urlQrCode, null, 'M', 6, 2);
                        $imageString = base64_encode(ob_get_contents());
                        ob_end_clean();
                        ?>
                        <?php if ($imageString): ?>
                            <img src="data:image/png;base64,<?php echo $imageString; ?>" class="qr-code" alt="QR Code">
                        <?php else: ?>
                            <img src="https://www.mkauth-addons.com.br/api/text.to.qrcode.php?cod=<?php echo urlencode($urlQrCode); ?>" class="qr-code" alt="QR Code">
                        <?php endif; ?>
                    </td>
                </tr>
            </table>

            <table style="margin-bottom: 5px;">
                <thead>
                    <tr>
                        <th style="width: 50%;">DESTINATRIO / ASSINANTE</th>
                        <th style="width: 50%;">INFORMAES DA FATURA</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="font-size: 9pt;">
                            <p class="header-label" style="margin:0;">NOME / RAZO SOCIAL</p>
                            <p class="header-value" style="margin:0; font-size: 10pt;"><?php echo h([$data->dest, 'xNome']); ?></p>

                            <p class="header-label" style="margin:5px 0 0 0;">ENDEREO</p>
                            <p style="margin:0;"><?php echo h([$data->dest->enderDest, 'xLgr']); ?>, <?php echo h([$data->dest->enderDest, 'nro']); ?> - <?php echo h([$data->dest->enderDest, 'xBairro']); ?> - <?php echo h([$data->dest->enderDest, 'xMun']); ?> / <?php echo h([$data->dest->enderDest, 'UF']); ?></p>

                            <table class="no-border" style="width: 100%; margin-top: 5px;">
                                <tr>
                                    <td class="no-border" style="padding: 0;">
                                        <p class="header-label" style="margin:0;">CPF/CNPJ</p>
                                        <p class="header-value" style="margin:0;"><?php echo h(formatarCnpjCpf(h([$data->dest, 'CNPJ'], ''), h([$data->dest, 'CPF'], ''))); ?></p>
                                    </td>
                                    <td class="no-border" style="padding: 0;">
                                        <p class="header-label" style="margin:0;">INSCRIO ESTADUAL</p>
                                        <p class="header-value" style="margin:0;"><?php echo h([$data->dest, 'IE'], 'ISENTO'); ?></p>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="font-size: 9pt;">
                            <table class="no-border" style="width: 100%;">
                                <tr>
                                    <td class="no-border" style="padding: 0 5px 0 0; width: 50%;">
                                        <p class="header-label" style="margin:0;">REFERNCIA</p>
                                        <p class="header-value" style="margin:0;"><?php echo h([$data->faturamento, 'CompetFat'], '---', 'formatarCompetencia'); ?></p>
                                    </td>
                                    <td class="no-border" style="padding: 0 0 0 5px; width: 50%;">
                                        <p class="header-label" style="margin:0;">CDIGO CLIENTE</p>
                                        <p class="header-value" style="margin:0;"><?php echo h([$data->assinante, 'iCodAssinante']); ?></p>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="no-border" style="padding: 5px 5px 0 0;" colspan="2">
                                        <p class="header-label" style="margin:0;">VENCIMENTO</p>
                                        <p class="header-value" style="margin:0; font-size: 11pt;"><?php echo h([$data->faturamento, 'dVencFat'], '---', 'formatarData'); ?></p>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="no-border" style="padding: 10px 0 0 0;" colspan="2">
                                        <p class="header-label" style="margin:0; text-align: right;">TOTAL A PAGAR</p>
                                        <p class="total-pagar" style="margin:0;"><?php echo h([$data->total, 'vNF'], '---', 'formatarMoeda'); ?></p>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table style="margin-bottom: 5px;">
                <thead>
                    <tr>
                        <th>DESCRIO DO PRODUTO/SERVIO</th>
                        <th style="width: 50px;" class="text-right">UN</th>
                        <th style="width: 80px;" class="text-right">QUANT.</th>
                        <th style="width: 100px;" class="text-right">VALOR UNIT.</th>
                        <th style="width: 100px;" class="text-right">VALOR TOTAL</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($data->det as $item): ?>
                        <tr>
                            <td><?php echo h([$item->prod, 'xProd']); ?></td>
                            <td class="text-right"><?php echo h([$item->prod, 'uMed'], '---', 'formatarUnidade'); ?></td>
                            <td class="text-right"><?php echo h([$item->prod, 'qFaturada'], '---', 'formatarNumero', 2); ?></td>
                            <td class="text-right"><?php echo h([$item->prod, 'vItem'], '---', 'formatarMoeda'); ?></td>
                            <td class="text-right"><?php echo h([$item->prod, 'vProd'], '---', 'formatarMoeda'); ?></td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>

            <table style="margin-bottom: 5px;">
                <tr>
                    <td class="no-border" style="width: 50%; padding: 0 5px 0 0; vertical-align: top;">
                        <table>
                            <thead>
                                <tr>
                                    <th>TOTAIS DA NOTA</th>
                                    <th class="text-right">VALOR</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Total Produtos/Servios</td>
                                    <td class="text-right"><?php echo h([$data->total, 'vProd'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>Base de Clculo ICMS</td>
                                    <td class="text-right"><?php echo h([$data->total->ICMSTot, 'vBC'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>Valor ICMS</td>
                                    <td class="text-right"><?php echo h([$data->total->ICMSTot, 'vICMS'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>Valor Total da Nota</td>
                                    <td class="text-right header-value"><?php echo h([$data->total, 'vNF'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td class="no-border" style="width: 50%; padding: 0 0 0 5px; vertical-align: top;">
                        <table>
                            <thead>
                                <tr>
                                    <th>TRIBUTOS</th>
                                    <th class="text-right">VALOR</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>PIS</td>
                                    <td class="text-right"><?php echo h([$data->total, 'vPIS'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>COFINS</td>
                                    <td class="text-right"><?php echo h([$data->total, 'vCOFINS'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>FUST</td>
                                    <td class="text-right"><?php echo h([$data->total, 'vFUST'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                                <tr>
                                    <td>FUNTTEL</td>
                                    <td class="text-right"><?php echo h([$data->total, 'vFUNTTEL'], '---', 'formatarMoeda'); ?></td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </table>

            <table style="margin-bottom: 5px;">
                <tr>
                    <td style="width: 65%;">
                        <p class="header-label" style="margin:0 0 5px 0;">INFORMAES COMPLEMENTARES (Diviso VII)</p>
                        <p style="font-size: 8pt; margin: 0; min-height: 40px;">
                            <?php echo h(nl2br(h([$data->infAdic, 'infCpl'])), 'Nenhuma informao complementar.'); ?>
                        </p>
                    </td>
                    <td style="width: 35%;">
                        <p class="header-label" style="margin:0 0 5px 0;">RESERVADO AO FISCO (Diviso VI)</p>
                        <div style="min-height: 40px;">
                            <?php if (h([$data->ide, 'tpEmis'], '1') != '1'): ?>
                                <p style="font-weight: bold; text-align: center; margin: 5px 0;">EMITIDO EM CONTINGNCIA</p>
                            <?php endif; ?>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- rea do Contribuinte e Determinaes da Anatel, vai ter 2 colunas, 1 para a linha do boleto, essa mais larga e outra para o qrcode do pix -->
            <?php if ($dados_configuracoes_nfcom['enviar_boleto'] || $dados_configuracoes_nfcom['enviar_pix']) { ?>
                <table>
                    <tr>
                        <td colspan="2" style="padding: 5px; text-align: center; border-top: 1px solid #000;">
                            <p class="header-label" style="margin:0 0 5px 0;">
                                DIVISO VIII - DADOS DO CONTRIBUINTE E DETERMINAES DA ANATEL
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 70%; vertical-align: top; padding: 5px; text-align: center;">
                            <?php if ($dados_configuracoes_nfcom['enviar_boleto']) { ?>
                                <p class="header-label" style="margin:0 0 5px 0;">LINHA DO BOLETO:</p>
                                <?php if (isset($data->faturamento->codBarras) && $data->faturamento->codBarras != '00000000000000000000000000000000000000000000000' && strlen($data->faturamento->codBarras) >= 44) { ?>
                                    <p style="font-size: 9pt; margin: 0;">
                                    <?php echo $classBank->formatarLinha($data->faturamento->codBarras);?>
                                    <br>
                                    <img src="https://www.mkauth-addons.com.br/api/linha.to.barra.image.php?cod=<?php echo preg_replace('/\D/', '', $data->faturamento->codBarras);?>">
                                    </p>
                                <?php } else { ?>
                                    <p style="font-size: 9pt; margin: 0;">n/a</p>
                                <?php } ?>
                            <?php } ?>
                        </td>
                        <td style="width: 30%; vertical-align: top; padding: 5px; text-align: center;">
                            <p class="header-label" style="margin:0 0 5px 0;">PIX PARA PAGAMENTO:</p>
                            <?php if ($dados_configuracoes_nfcom['enviar_pix'] && isset($data->faturamento->gPIX) && !empty($data->faturamento->gPIX)) { ?>
                                <img src="<?php echo ($data->faturamento->gPIX); ?>" style="width: 100px; height: 100px;" alt="QR Code PIX">
                            <?php } else { ?>
                                <p style="font-size: 9pt; margin: 0;">n/a</p>
                            <?php } ?>
                        </td>
                    </tr>
                </table>
            <?php } ?>

            <!-- se ambiente de homologacao -->
            <?php if ($data->ide->tpAmb != 1): ?>
                <p style="text-align: center; font-size: 10pt; font-weight: bold; color: red; margin-top: 10px;">
                    AMBIENTE DE HOMOLOGAO - NO TEM VALOR FISCAL
                    <br><br>
                </p>
            <?php endif; ?>

            <?php if (next($titulos)): ?>
                <div class="new-page"></div>
            <?php endif; ?>

        <?php endforeach; ?>

    <?php endif; ?>

    </div>

</body>

</html>
</file>

<file path="payisp/nfcom.index.php">
<?php
//init
require_once 'init.php';
//config 
$dados_configuracoes = configuracoes_nfcom_payisp();
if (!isset($dados_configuracoes['id']) || empty($dados_configuracoes['serial_nfcom'])) {
    @header("Location: nfcom.ativar.php");
    exit;
}
?>
<?php
// Registros por pagina 
$total_reg_por_pagina = $quantidade_registros_por_pagina;
// Paginacao 
$pagina = isset($_GET['pagina']) ? (int)$_GET['pagina'] : 1;
$inicio = $pagina - 1;
$inicio = $inicio * $total_reg_por_pagina;
// Filtros 
$tag = '';
$where = '';
$order = "ORDER BY a.id_nota DESC";
// Filtro por tag 
if (isset($_GET['tag']) && !empty($_GET['tag'])) {
    $tag .= '&tag=' . $_GET['tag'] . '';
    $where .= " AND (a.numero LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.chave LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.protocolo LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.cancelamento LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.cstat LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.xmotivo LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.total_nota LIKE '%" . escape_payisp($_GET['tag']) . "%' || a.itens LIKE '%" . escape_payisp($_GET['tag']) . "%')";
}
// Filtros por status
$status_atual = 'todas';
if (isset($_GET['status']) && !empty($_GET['status'])) {
    $status_atual = trim($_GET['status']);
    $tag .= '&status=' . $status_atual . '';
    $where .= " AND a.status = '" . escape_payisp($status_atual) . "'";
}
// Filtros por data
$data_inicio = '';
$data_fim = '';
if (isset($_GET['data_inicio']) && !empty($_GET['data_inicio'])) {
    $data_inicio = trim($_GET['data_inicio']);
    $tag .= '&data_inicio=' . $data_inicio . '';
    $where .= " AND a.emissao >= '" . escape_payisp($data_inicio) . "'";
}
if (isset($_GET['data_fim']) && !empty($_GET['data_fim'])) {
    $data_fim = trim($_GET['data_fim']);
    $tag .= '&data_fim=' . $data_fim . '';
    $where .= " AND a.emissao <= '" . escape_payisp($data_fim) . "'";
}
// Ordem 
$ordem = 'desc';
if (isset($_GET['ordem']) && !empty($_GET['ordem'])) {
    $ordem = trim($_GET['ordem']);
    $tag .= '&ordem=' . $ordem . '';
    if ($_GET['ordem'] == 'asc') {
        $order = "ORDER BY a.id_nota ASC";
    } else {
        $order = "ORDER BY a.id_nota DESC";
    }
}
// Join
$join = "";
// Tudo
$sql_tudo = "SELECT a.* FROM `payisp_notas_nfcom` a $join WHERE a.homologacao = " . $dados_configuracoes_nfcom['homologacao'] . " $where $order";
$sql_tudo_result = $mysqli->query($sql_tudo);
$qtd_registros = $sql_tudo_result->num_rows;
$paginas = ceil($qtd_registros / $total_reg_por_pagina);
// List
$sql = "SELECT a.* FROM `payisp_notas_nfcom` a $join WHERE a.homologacao = " . $dados_configuracoes_nfcom['homologacao'] . " $where $order LIMIT $inicio,$total_reg_por_pagina";
$result = $mysqli->query($sql);
?>
<?php $breadcrumbActual = 'Notas NFCom'; ?>
<?php include 'lay.header.php'; ?>

<body>
    <script>
        // Mantenho este script vazio (como no original), mas a funo essencial de JS est no final do <body>
    </script>
    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <div class="container-fluid pt-3">

        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
            <h2 class="h4 mb-0"><i class="fa fa-file-invoice-dollar text-primary me-2"></i> Notas NFCom <small class="text-muted">(<?php echo ucwords($status_atual); ?>)</small></h2>
            <span class="badge bg-primary fs-6"><?= str_pad($qtd_registros, 4, "0", STR_PAD_LEFT); ?> Notas</span>
        </div>

        <!-- Alerta de Modo de Operao (Homologao/Produo) -->
        <?php if ($dados_configuracoes_nfcom['homologacao'] == '1') {
            $ambiente = $dados_configuracoes_nfcom['endpoint'] == '' ? 'SVRS' : $dados_configuracoes_nfcom['endpoint'];
        ?>
            <div class="alert alert-warning d-flex align-items-center" role="alert">
                <i class="fa fa-exclamation-triangle fa-2x me-3"></i>
                <div>
                    <strong>Modo de Homologao Ativo!</strong> As notas fiscais emitidas NO so vlidas para fins fiscais. Ambiente: <?php echo $ambiente; ?>.
                    <br>
                    <a href="javascript:abrirPopup_payisp('nfcom.status.php',600,600);" class="alert-link text-decoration-underline">Consulte o Status da API NFCom</a>.
                </div>
            </div>
        <?php } ?>

        <?php exibir_aviso_payisp(); ?>

        <div class="alert alert-info d-flex align-items-center" role="alert">
            <i class="fa fa-info-circle me-2 fs-5"></i>
            Esta seo exibe todas as Notas Fiscais de Consumidor Eletrnicas (NFCom) emitidas. Utilize a barra de filtros abaixo para refinar sua busca por status, data ou tags especficas. Voc pode criar novas NFCom no menu PAY ISP, imprimir notas existentes ou consultar o status das mesmas diretamente nesta interface.
        </div>

        <div class="d-flex justify-content-start gap-2 mb-4">
            <button onclick="imprimir_notas_nfcom_faturas();" type="button" class="btn btn-success"><i class="fa fa-print"></i> Imprimir NFCom</button>
            <button onclick="abrirPopup_payisp('nfcom.consultar.php', 800, 800, true);" type="button" class="btn btn-outline-secondary"><i class="fa fa-search"></i> Consultar NFCom</button>
        </div>

        <div class="card shadow-sm mb-4">
            <div class="card-header bg-light d-flex align-items-center">
                <i class="fa fa-filter me-2"></i> Filtros de Pesquisa
            </div>
            <div class="card-body p-3">
                <form method="GET" action="" class="row g-2 align-items-end">

                    <div class="col-md-3">
                        <label for="tag" class="form-label small text-muted mb-0">Busca por Tags/Nmero</label>
                        <input value="<?php echo htmlspecialchars(isset($_GET['tag']) ? $_GET['tag'] : ''); ?>" name="tag" id="tag" class="form-control form-control-sm" type="text" placeholder="Tags a buscar...">
                    </div>

                    <div class="col-md-2">
                        <label for="status" class="form-label small text-muted mb-0">Status</label>
                        <select class="form-select form-select-sm" name="status" id="status">
                            <option value="" <?php echo ($status_atual == 'todas') ? ' selected' : ''; ?>>Todos</option>
                            <option value="emitida" <?php echo ($status_atual == 'emitida') ? ' selected' : ''; ?>>Emitidas</option>
                            <option value="cancelada" <?php echo ($status_atual == 'cancelada') ? ' selected' : ''; ?>>Canceladas</option>
                        </select>
                    </div>

                    <div class="col-md-2">
                        <label for="ordem" class="form-label small text-muted mb-0">Ordenao</label>
                        <select class="form-select form-select-sm" name="ordem" id="ordem">
                            <option value="desc" <?php echo ($ordem == 'desc') ? ' selected' : ''; ?>>DESC (Mais Recente)</option>
                            <option value="asc" <?php echo ($ordem == 'asc') ? ' selected' : ''; ?>>ASC (Mais Antiga)</option>
                        </select>
                    </div>

                    <div class="col-md-2">
                        <label for="data_inicio" class="form-label small text-muted mb-0">Data Incio</label>
                        <input type="datetime-local" class="form-control form-control-sm" id="data_inicio" name="data_inicio" value="<?php echo htmlspecialchars($data_inicio); ?>">
                    </div>

                    <div class="col-md-2">
                        <label for="data_fim" class="form-label small text-muted mb-0">Data Fim</label>
                        <input type="datetime-local" class="form-control form-control-sm" id="data_fim" name="data_fim" value="<?php echo htmlspecialchars($data_fim); ?>">
                    </div>

                    <div class="col-md-1 d-flex justify-content-end gap-1">
                        <button type="submit" class="btn btn-primary btn-sm"><i class="fa fa-search"></i></button>
                        <button onclick="location.href='nfcom.index.php';" type="button" class="btn btn-outline-danger btn-sm"><i class="fa fa-times-circle"></i></button>
                    </div>
                </form>
            </div>
        </div>


        <div class="table-responsive" style="min-height:600px;">
            <table class="table table-striped table-hover table-sm align-middle">
                <thead class="table-light">
                    <tr>
                        <th style="width:180px;">
                            <input type="checkbox" id="selecionar_todos" onclick="jQuery('input.lista_faturas').prop('checked', this.checked);">
                            &nbsp;Nota
                        </th>
                        <th style="width:120px;">Status</th>
                        <th>Cliente</th>
                        <th style="width:100px;">REF (cNF)</th>
                        <th style="width:150px;">Valor</th>
                        <th style="width:120px;">Data</th>
                        <th style="width:100px;">Aes</th>
                    </tr>
                </thead>
                <tbody>
                    <?php
                    $i = 0;
                    while ($row = $result->fetch_array()) {
                        // Decodifica o json da nota 
                        $nota1 = @json_decode($row['itens'], true);
                        if (!isset($nota1['infNFCom'])) {
                            continue;
                        }
                        $nota = $nota1['infNFCom'];
                        $suplementar = isset($nota1['infNFComSupl']) ? $nota1['infNFComSupl'] : null;

                        $status_cor = $row['status'] == 'emitida' ? 'success' : 'danger';
                        $status_icone = $row['status'] == 'emitida' ? 'fa-check-circle' : 'fa-times-circle';
                        $checkbox_class = $row['status'] == 'emitida' ? 'lista_faturas' : 'lista_faturas2';
                    ?>
                        <tr>
                            <th scope="row" class="align-middle">
                                <input class="<?php echo $checkbox_class; ?>" data-nfcom="<?php echo $nota['ide']['nNF']; ?>" data-status="<?php echo $row['status']; ?>" <?php echo $row['status'] == 'cancelada' ? 'disabled' : ''; ?> type="checkbox" name="lista_faturas" value="<?php echo $row['titulo']; ?>">
                                <?php echo $nota['ide']['nNF']; ?>/<?php echo $nota['ide']['serie']; ?>
                            </th>
                            <td>
                                <span style="cursor:pointer;" class="badge text-bg-<?php echo $status_cor; ?>" onclick="abrirPopup_payisp('nfcom.detalhes.php?titulo=<?php echo $row['titulo']; ?>&chave=<?php echo $row['chave']; ?>&tpAmb=<?php echo $row['homologacao'] == 1 ? 2 : 1; ?>', 800, 600, true);">
                                    <?php echo ucwords($row['status']); ?> <i class="fa <?php echo $status_icone; ?>"></i>
                                </span>
                            </td>
                            <td>
                                <u><?php echo ucwords($nota['dest']['xNome']); ?></u><br>
                                <small class="text-muted"><?php echo !empty($nota['dest']['CPF']) ? $nota['dest']['CPF'] : $nota['dest']['CNPJ']; ?></small>
                            </td>
                            <td>
                                <?php echo $nota['ide']['cNF']; ?>
                            </td>
                            <td>R$<?php echo number_format($row['total_nota'], 2, ',', '.'); ?></td>
                            <td><?php echo date('d/m/Y', strtotime($row['emissao'])); ?></td>
                            <td>
                                <div class="dropdown">
                                    <button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        Aes
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <h6 class="dropdown-header">NFCom #<?php echo $row['titulo']; ?></h6>
                                        <li><a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.detalhes.php?titulo=<?php echo $row['titulo']; ?>&chave=<?php echo $row['chave']; ?>&tpAmb=<?php echo $row['homologacao'] == 1 ? 2 : 1; ?>', 800, 600, true);" href="javascript:void(0);"><span class="fa fa-file-invoice me-2"></span> Detalhes NFCom</a></li>
                                        <li><a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.consultar.php?chave=<?php echo $row['chave']; ?>&titulo=<?php echo $row['titulo']; ?>&tpAmb=<?php echo $row['homologacao'] == 1 ? 2 : 1; ?>', 800, 600, true);" href="javascript:void(0);">
                                                <span class="fa fa-search me-2"></span>
                                                Consultar/Cancelar NFCom
                                            </a></li>
                                        <?php if ($row['cancelada'] == 0) { ?>
                                            <li>
                                                <hr class="dropdown-divider">
                                            </li>
                                            <li><a class="dropdown-item" onclick="abrirPopup_payisp('nfcom.imprimir.php?titulo[]=<?php echo $row['titulo']; ?>&base=titulo',870,900);" href="javascript:void(0);"><span class="fa fa-print me-2"></span> Imprimir NFCom</a></li>
                                        <?php } ?>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    <?php
                        $i++;
                    }
                    ?>
                    <?php
                    if ($qtd_registros == 0) {
                    ?>
                        <tr>
                            <td colspan="7" class="text-center py-4">Nenhum registro cadastrado!</td>
                        </tr>
                    <?php
                    }
                    ?>
                </tbody>
            </table>
        </div>

        <?php if ($paginas > 1) { ?>
            <nav class="mt-4" aria-label="Navegao de Pgina">
                <ul class="pagination justify-content-center">
                    <li class="page-item <?php echo ($pagina == 1) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="nfcom.index.php?pagina=<?php echo max(1, $pagina - 1); ?><?php echo $tag; ?>" aria-label="Anterior">
                            <span aria-hidden="true">&laquo;</span> Anterior
                        </a>
                    </li>

                    <?php
                    // Lgica de paginao de links (5 links centrais)
                    $max_links = 5;
                    $start_page = max(1, $pagina - floor($max_links / 2));
                    $end_page = min($paginas, $start_page + $max_links - 1);

                    if ($end_page - $start_page < $max_links - 1) {
                        $start_page = max(1, $end_page - $max_links + 1);
                    }

                    for ($i = $start_page; $i <= $end_page; $i++) {
                        $active_class = ($i == $pagina) ? 'active' : '';
                        echo '<li class="page-item ' . $active_class . '"><a class="page-link" href="nfcom.index.php?pagina=' . $i . '' . $tag . '">' . $i . '</a></li>';
                    }
                    ?>

                    <li class="page-item <?php echo ($pagina >= $paginas) ? 'disabled' : ''; ?>">
                        <a class="page-link" href="nfcom.index.php?pagina=<?php echo min($paginas, $pagina + 1); ?><?php echo $tag; ?>" aria-label="Prxima">
                            Prxima <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        <?php } ?>

    </div>

    <?php include('lay.footer.php'); ?>
    <script>
        function imprimir_notas_nfcom_faturas() {
            var selected = [];
            jQuery('input[name="lista_faturas"]:checked').each(function() {
                var status = jQuery(this).data("status");
                if (status == 'emitida') {
                    selected.push(jQuery(this).val());
                }
            });
            console.log(selected);
            if (selected.length == 0) {
                // Preservando a funo de alerta do bootbox, se estiver em uso
                if (typeof bootbox !== 'undefined' && bootbox.alert) {
                    bootbox.alert("Selecione no minimo uma NFCom j emitida para imprimir!");
                } else {
                    alert("Selecione no minimo uma NFCom j emitida para imprimir!");
                }
                return false;
            } else {
                var faturas = '';
                jQuery.each(selected, function(key, value) {
                    faturas += '&titulo[]=' + value;
                });
                abrirPopup_payisp('nfcom.imprimir.php?origem=imprimir_titulos&base=titulo' + faturas, 870, 900);
                return false;
            }
        }
    </script>

</body>

</html>
</file>

<file path="payisp/nfcom.licenca.php">
<?php require_once 'init.php'; ?>
<?php
//dados nfcom
$dados_nfcom = configuracoes_nfcom_payisp();

//atualizar dados da licensa
if (isset($_REQUEST['atualizar_licensa'])) {
  //atualiza
  atualizar_dados_da_licenca_nfcom_payisp($dados_nfcom);
  sleep(2);
  //recarrega
  $dados_nfcom = configuracoes_nfcom_payisp();
}

//dados da licensa
$dados_da_licensa = dados_da_licenca_nfcom_payisp($dados_nfcom);

// Calcula dias restantes para determinar o alerta
$dias_restantes = diff_date_php_days_payisp($dados_nfcom['valido_ate']);
$alerta_class = 'alert-info';
$alerta_icon = 'fa-info-circle';
if ($dias_restantes <= 0) {
  $alerta_class = 'alert-danger';
  $alerta_icon = 'fa-times-circle';
} elseif ($dias_restantes <= 30) {
  $alerta_class = 'alert-warning';
  $alerta_icon = 'fa-exclamation-triangle';
}
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="iso-8859-1">
  <title>Licena Complemento NFCom</title>
  <!-- Incluindo Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/toastr.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <script src="../../scripts/jquery.js"></script>
  <script src="../../scripts/mk-auth.js"></script>
  <script src="../../menu.js.php"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/toastr.min.js"></script>
  <script src="js/jquery.blockUI.js"></script>
  <script src="js/bootbox.all.js"></script>
  <script src="js/scripts.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
    }

    .container-fluid {
      max-width: 600px;
    }

    .card-header {
      background-color: #0d6efd !important;
      color: white;
    }
  </style>
  <script>
    // atualizar host da licenca 
    function atualizar() {
      bootbox.confirm({
        title: "Atualizar Host/IP da Licena",
        message: "Esta ao solicitar a atualizao do host/IP licenciado. Confirma que o IP atual do seu MK-Auth  o novo endereo de host?",
        buttons: {
          confirm: {
            label: '<i class="fa fa-sync-alt"></i> Sim, Atualizar',
            className: 'btn-warning'
          },
          cancel: {
            label: '<i class="fa fa-times"></i> Cancelar',
            className: 'btn-secondary'
          }
        },
        callback: function(result) {
          if (result) {
            bloquear_tela_payisp();
            $.ajax({
              url: 'nfcom.licensa.reset.php',
              type: 'POST',
              data: {
                serial_resetar: '<?php echo $dados_nfcom['serial_nfcom']; ?>',
                'atualizar_licensa': true
              },
              dataType: 'JSON',
              cache: false,
              success: function(data) {
                console.log(data);
                // Notifica o sucesso e recarrega
                toastr.success('Host/IP da Licena atualizado com sucesso!', 'Sucesso');
                if (window.opener && typeof window.opener.location.reload === 'function') {
                  window.opener.location.reload(false);
                }
                location.reload(true);
              },
              error: function(xhr, status, error) {
                // Em caso de erro na requisio AJAX
                console.error("Erro ao atualizar a licena:", error);
                toastr.error('Falha ao atualizar o host/IP. Verifique o console ou tente novamente mais tarde.', 'Erro');
                desbloquear_tela_payisp();
              }
            });
          }
        }
      });
    }
  </script>
</head>

<body>
  <div class="container-fluid py-4">

    <!-- Card Principal -->
    <div class="card shadow">
      <div class="card-header">
        <h5 class="mb-0 d-flex align-items-center">
          <i class="fa fa-key me-2"></i>
          Licena Complemento NFCom
        </h5>
      </div>
      <div class="card-body">

        <!-- Alerta Informativo -->
        <div class="alert alert-primary" role="alert">
          <i class="fa-solid fa-circle-info me-2"></i>
          Compre ou atualize sua licena do complemento NFCom para PAY ISP usando o boto abaixo. Os dados do seu provedor sero utilizados no faturamento.
        </div>

        <form onsubmit="bloquear_tela_payisp();" action="https://locasistemas.com/clientes/nfcomisp/buy.lic.php?serial=<?php echo $dados_nfcom['serial_nfcom']; ?>" method="post">
          <input type="hidden" name="licensa" value="<?php echo $dados_nfcom['serial_nfcom']; ?>">
          <input type="hidden" name="retorno" value="<?php echo base64_encode(url_full_payisp()); ?>">
          <?php foreach (dados_do_provedor_payisp() as $k => $v) { ?>
            <input type="hidden" name="<?php echo $k; ?>" value="<?php echo $v; ?>">
          <?php } ?>

          <!-- Detalhes da Licena (Lista de Definio para clareza) -->
          <dl class="row mb-4">
            <dt class="col-sm-4">Status:</dt>
            <dd class="col-sm-8 fw-bold">
              <?php echo exibir_detalhes_geral_nfcom_payisp($dados_nfcom); ?>
            </dd>

            <dt class="col-sm-4">Licena Serial:</dt>
            <dd class="col-sm-8"><code class="bg-light p-1 rounded"><?php echo $dados_nfcom['serial_nfcom']; ?></code></dd>
            <dd class="col-sm-12 text-muted small">A Licena  nica por banco e intransfervel.</dd>

            <dt class="col-sm-4">Host/IP Licenciado:</dt>
            <dd class="col-sm-8">
              <strong><?php echo isset($dados_da_licensa->key_data['hostname']) ? $dados_da_licensa->key_data['hostname'] : 'n/a'; ?></strong>
            </dd>
            <dd class="col-sm-12 text-muted small">
              Trocou de host/ip e est sem acesso? <a href="javascript:void(0);" onclick="atualizar()" class="text-decoration-underline">Clique aqui para atualizar</a>.
            </dd>

            <dt class="col-sm-4 mt-2">Expira Em:</dt>
            <dd class="col-sm-8 mt-2 fw-bold">
              <?php echo date('d/m/Y H:i:s', strtotime($dados_nfcom['valido_ate'])); ?>
              [<?php echo $dias_restantes; ?> dia(s)]
            </dd>
          </dl>

          <div class="mt-4">
            <?php if ($dias_restantes <= 30) { ?>
              <button type="submit" class="btn btn-primary btn-lg w-100 shadow-sm"><span class="fa fa-qrcode me-2"></span> Comprar/Renovar Licena (1 ano de uso)</button>
            <?php } else { ?>
              <div class="alert alert-success" role="alert">
                <i class="fa-solid fa-check-circle me-2"></i> Sua licena est ativa e vlida! A opo de renovao ser exibida 30 dias antes da data de expirao.
              </div>
            <?php } ?>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>

</html>
</file>

<file path="payisp/nfcom.licensa.reset.php">
<?php require_once 'init.php';?>
<?php 
@header('Content-type: application/json');
//reset da licena
echo json_encode(resetar_serial_nfcom_payisp());
exit;
?>
</file>

<file path="payisp/nfcom.php">
<?php require(dirname(__FILE__) . '/init.php'); ?>
<?PHP require(dirname(__FILE__) . '/src/certificado.php'); ?>
<?php $erro_list = array(); ?>
<?php $breadcrumbActual = 'Configuraes NFCom'; ?>
<?php include 'lay.header.php'; ?>
<?php
//config 
$dados_configuracoes = configuracoes_nfcom_payisp();
if (!isset($dados_configuracoes['id']) || empty($dados_configuracoes['serial_nfcom'])) {
    @header("Location: nfcom.ativar.php");
    exit;
}

//atualizar 
$tab = valor_antigo_payisp('tab', 'config');
$acao = valor_antigo_payisp('acao');
$erro_list = acoes_nfcom_payisp($dados_configuracoes, $acao, $tab);

//pega msg sucesso
if (isset($_GET['msg_sucesso'])) {
    $msg_sucesso = html_entity_decode(urldecode($_GET['msg_sucesso']));
}else {
    $msg_sucesso = '';
}

//pega servicos
$sql_servicos = "SELECT * FROM `payisp_servicos` ORDER BY `descricao` ASC;";
$mysqli_servicos = $mysqli->query($sql_servicos);
$total_servicos = $mysqli_servicos->num_rows;

//validade certificado
$validade_certificado = validade_certificado_nfcom_payisp($dados_configuracoes['cnpj']);

//re carrega
$dados_configuracoes = configuracoes_nfcom_payisp();
?>

<body>

    <div style="height: 15px;"></div>
    <?php include('../../topo.php'); ?>

    <!-- Novo Cabealho e Ttulo -->
    <div class="container-fluid pt-3">
        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
            <h2 class="h4 mb-0"><i class="fa fa-cog text-primary me-2"></i> Configuraes NFCom</h2>
            <span class="badge bg-secondary"><?php echo $nome_do_sistema; ?> (<?php echo $versao_publica_addon; ?>)</span>
        </div>

        <!-- Alerta de Modo de Operao (Homologao/Produo) -->
        <?php if ($dados_configuracoes['homologacao'] == '1') {
            $ambiente = $dados_configuracoes['endpoint'] == '' ? 'SVRS' : $dados_configuracoes['endpoint'];
        ?>
            <div class="alert alert-warning d-flex align-items-center" role="alert">
                <i class="fa fa-exclamation-triangle fa-2x me-3"></i>
                <div>
                    <strong>Modo de Homologao Ativo!</strong> As notas fiscais emitidas NO so vlidas para fins fiscais. Ambiente: <?php echo $ambiente; ?>.
                    <br>
                    <a href="javascript:abrirPopup_payisp('nfcom.status.php',600,600);" class="alert-link text-decoration-underline">Consulte o Status da API NFCom</a>.
                </div>
            </div>
        <?php } else {
            $ambiente = $dados_configuracoes['endpoint'] == '' ? 'SVRS' : $dados_configuracoes['endpoint'];
        ?>
            <div class="alert alert-success d-flex align-items-center" role="alert">
                <i class="fa fa-check-circle fa-2x me-3"></i>
                <div>
                    <strong>Modo de Produo Ativo.</strong> As notas fiscais emitidas so VLIDAS para fins fiscais. Ambiente: <?php echo $ambiente; ?>.
                    <br>
                    <a href="javascript:abrirPopup_payisp('nfcom.status.php',600,600);" class="alert-link text-decoration-underline">Consulte o Status da API NFCom</a>.
                </div>
            </div>
        <?php } ?>

        <?php echo exibir_aviso_payisp(); ?>

        <!-- Mensagens de Erro (Lista de erros) -->
        <?php if (count($erro_list) > 0) { ?>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <h5 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Erros de Validao:</h5>
                <ul class="mb-0">
                    <?php foreach ($erro_list as $erro) { ?>
                        <li><?php echo xss_input_protect_payisp($erro); ?></li>
                    <?php } ?>
                </ul>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <?php } ?>

        <!-- Mensagens de Sucesso -->
        <?php if (!empty($msg_sucesso) && count($erro_list) == 0) { ?>
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="fa fa-check-circle me-2"></i> <?php echo xss_input_protect_payisp($msg_sucesso); ?>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <?php } ?>


        <!-- Tabs de Navegao -->
        <ul id="tabs" class="nav nav-tabs nav-justified mt-4" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="config-tab" data-bs-toggle="tab" data-bs-target="#config-tab-pane"
                    type="button" role="tab" aria-controls="config-tab-pane"
                    aria-selected="true"><i class="fa fa-tools me-1"></i> Configuraes Gerais</button>
            </li>
            <?php
            $cert_status = '(Ausente/Expirado)';
            $cert_class = 'text-danger';
            if ($validade_certificado !== false && $validade_certificado >= 1) {
                $cert_status = '(Expira em ' . $validade_certificado . ' Dias)';
                $cert_class = ($validade_certificado <= 30) ? 'text-warning' : 'text-success';
            }
            ?>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="certificado-tab" data-bs-toggle="tab"
                    data-bs-target="#certificado-tab-pane" type="button" role="tab" aria-controls="certificado-tab-pane"
                    aria-selected="false"><i class="fa fa-certificate me-1"></i> Certificado Digital <span class="<?php echo $cert_class; ?> small"><?php echo $cert_status; ?></span></button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="servicos-tab" data-bs-toggle="tab"
                    data-bs-target="#servicos-tab-pane" type="button" role="tab" aria-controls="servicos-tab-pane"
                    aria-selected="false"><i class="fa fa-list-check me-1"></i> Servios (<?php echo $total_servicos; ?>)</button>
            </li>
        </ul>

        <!-- Formulrio e Contedo das Tabs -->
        <div class="card shadow-sm mb-5" style="border-radius: 0 0 8px 8px !important; border-top: none;">
            <div class="card-body">
                <form onsubmit="bloquear_tela_payisp();" id="configuracao" class="needs-validation" method="POST" action="nfcom.php" enctype="multipart/form-data" novalidate>
                    <input type="hidden" name="acao" value="atualizar">
                    <input type="hidden" name="tab" id="tab" value="<?php echo htmlspecialchars($tab); ?>">

                    <div class="tab-content">

                        <!-- TAB 1: Configuraes Gerais -->
                        <div class="tab-pane fade <?php echo ($tab == 'config' || $tab == '') ? 'show active' : ''; ?>" id="config-tab-pane" role="tabpanel" aria-labelledby="config-tab" tabindex="0">

                            <h5 class="mt-3 border-bottom pb-2">Dados da Licena</h5>



                            <div class="row mb-4">
                                <div class="col-md-3 mb-3">
                                    <label for="serial_nfcom" class="form-label">Licena NFCom</label>
                                    <span class="form-control-plaintext"><code><?php echo htmlspecialchars($dados_configuracoes['serial_nfcom']); ?></code></span>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="data_ativacao" class="form-label">Status</label>
                                    <span class="form-control-plaintext"><?php echo exibir_detalhes_geral_nfcom_payisp($dados_configuracoes); ?></span>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="data_ativacao" class="form-label">Licenciado para</label>
                                    <span class="form-control-plaintext"><?php echo nfcom_licenciado_para_payisp($dados_configuracoes['serial_nfcom']); ?></span>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="valido_ate" class="form-label">Vlido at</label>
                                    <span class="form-control-plaintext"><?php echo date('d/m/Y H:i:s', strtotime($dados_configuracoes['valido_ate'])); ?></span>
                                </div>
                            </div>

                            <h5 class="mt-4 border-bottom pb-2">Dados da Empresa e Operao</h5>

                            <div class="alert alert-info mt-3" role="alert">
                                <i class="fa fa-info-circle me-1"></i> 
                                Preencha corretamente as informaes da sua empresa para a emisso de notas fiscais eletrnicas via NFCom, caso j emita notas por um outro sistema fique atento ao nmero inicial para evitar duplicidade.
                            </div>

                            <div class="row">
                                <!-- Coluna 1 -->
                                <div class="col-md-3 mb-3">
                                    <label for="status" class="form-label">Ativar Uso NFCom <span class="text-danger">*</span></label>
                                    <select class="form-select" id="status" name="status" required>
                                        <option value="1" <?php if (valor_antigo_payisp('status', $dados_configuracoes['status']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Sim (Ativo)</option>
                                        <option value="0" <?php if (valor_antigo_payisp('status', $dados_configuracoes['status']) == '0') {
                                                                echo 'selected';
                                                            } ?>>No (Inativo)</option>
                                    </select>
                                    <div class="form-text text-muted">Ative ou desative a emisso de NFCom.</div>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="homologacao" class="form-label">Modo de Homologao <span class="text-danger">*</span></label>
                                    <select class="form-select" id="homologacao" name="homologacao" required>
                                        <option value="1" <?php if (valor_antigo_payisp('homologacao', $dados_configuracoes['homologacao']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Sim (Modo Teste)</option>
                                        <option value="0" <?php if (valor_antigo_payisp('homologacao', $dados_configuracoes['homologacao']) == '0') {
                                                                echo 'selected';
                                                            } ?>>No (Modo Produo)</option>
                                    </select>
                                    <div class="form-text text-muted">Use para testes sem emitir notas fiscais reais.</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="nome_social" class="form-label">Nome Social (Razo Social) <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: Empresa Teste LTDA" class="form-control" id="nome_social" name="nome_social" value="<?php echo valor_antigo_payisp('nome_social', $dados_configuracoes['nome_social']); ?>" required>
                                    <div class="form-text text-muted">Nome social conforme registrado na Receita Federal.</div>
                                </div>

                                <!-- Coluna 2 -->
                                <div class="col-md-3 mb-3">
                                    <label for="cnpj" class="form-label">CNPJ da Empresa <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="00.000.000/0000-00" class="form-control" id="cnpj" name="cnpj" value="<?php echo valor_antigo_payisp('cnpj', $dados_configuracoes['cnpj']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="nome_fantasia" class="form-label">Nome Fantasia <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: Empresa Teste" class="form-control" id="nome_fantasia" name="nome_fantasia" value="<?php echo valor_antigo_payisp('nome_fantasia', $dados_configuracoes['nome_fantasia']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="ie" class="form-label">Inscrio Estadual (IE) <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: 123456789" class="form-control" id="ie" name="ie" value="<?php echo valor_antigo_payisp('ie', $dados_configuracoes['ie']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="im" class="form-label">Inscrio Municipal (IM)</label>
                                    <input type="text" placeholder="Ex: 123456789" class="form-control" id="im" name="im" value="<?php echo valor_antigo_payisp('im', $dados_configuracoes['im']); ?>">
                                    <div class="form-text text-muted">Opcional, se no possuir.</div>
                                </div>

                                <!-- Coluna 3 -->
                                <div class="col-md-3 mb-3">
                                    <label for="regime" class="form-label">Regime Tributrio <span class="text-danger">*</span></label>
                                    <select class="form-select" id="regime" name="regime" required>
                                        <option value="1" <?php if (valor_antigo_payisp('regime', $dados_configuracoes['regime']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Simples Nacional</option>
                                        <!-- Opes Lucro Presumido/Real comentadas conforme original, mas mantidas por segurana de funcionalidade -->
                                        <!-- <option value="2" <?php if (valor_antigo_payisp('regime', $dados_configuracoes['regime']) == '2') {
                                                                    echo 'selected';
                                                                } ?>>Lucro Presumido</option>
                                        <option value="3" <?php if (valor_antigo_payisp('regime', $dados_configuracoes['regime']) == '3') {
                                                                echo 'selected';
                                                            } ?>>Lucro Real</option> -->
                                    </select>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="cnae" class="form-label">CNAE Principal <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: 6201500" class="form-control" id="cnae" name="cnae" value="<?php echo valor_antigo_payisp('cnae', $dados_configuracoes['cnae']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="serie" class="form-label">Srie da NFCom <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: 1" class="form-control" id="serie" name="serie" value="<?php echo valor_antigo_payisp('serie', $dados_configuracoes['serie']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="numero_inicial" class="form-label">Nmero Inicial da NFCom <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="Ex: 1" class="form-control" id="numero_inicial" name="numero_inicial" value="<?php echo valor_antigo_payisp('numero_inicial', $dados_configuracoes['numero_inicial']); ?>" required>
                                </div>

                                <!-- Coluna 4 (Impostos e Endpoints) -->
                                <div class="col-md-3 mb-3">
                                    <label for="fust_p_aliquota" class="form-label">Alquota FUST (%) <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="0.00" class="form-control dinheiro_format" id="fust_p_aliquota" name="fust_p_aliquota" value="<?php echo valor_antigo_payisp('fust_p_aliquota', $dados_configuracoes['fust_p_aliquota']); ?>" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="funttel_p_aliquota" class="form-label">Alquota FUNTTEL (%) <span class="text-danger">*</span></label>
                                    <input type="text" placeholder="0.00" class="form-control dinheiro_format" id="funttel_p_aliquota" name="funttel_p_aliquota" value="<?php echo valor_antigo_payisp('funttel_p_aliquota', $dados_configuracoes['funttel_p_aliquota']); ?>" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="endpoint" class="form-label">Endpoint de Servios NFCom <span class="text-danger">*</span></label>
                                    <select class="form-select" id="endpoint" name="endpoint" required>
                                        <option value="" disabled>Selecione o Endpoint</option>
                                        <?php foreach ($nfcomEndpoints as $key => $endpoint) { ?>
                                            <option value="<?php echo $key; ?>" <?php if (valor_antigo_payisp('endpoint', $dados_configuracoes['endpoint']) == $key) {
                                                                                    echo 'selected';
                                                                                } ?>><?php echo $key; ?></option>
                                        <?php } ?>
                                    </select>
                                    <div class="form-text text-muted">Selecione o ambiente correspondente ao seu estado (ou SVRS).</div>
                                </div>

                                <h5 class="mt-4 border-bottom pb-2">Configuraes de Faturamento e Documento</h5>

                                <!-- Coluna 5 (Bases e Opes de Pagamento) -->
                                <div class="col-md-4 mb-3">
                                    <label for="base_competencia" class="form-label">Data Base de Competncia <span class="text-danger">*</span></label>
                                    <select class="form-select" id="base_competencia" name="base_competencia" required>
                                        <option value="" disabled>Selecione a Base de Competncia</option>
                                        <option value="vencimento" <?php if (valor_antigo_payisp('base_competencia', $dados_configuracoes['base_competencia']) == 'vencimento') {
                                                                        echo 'selected';
                                                                    } ?>>Data de Vencimento da Fatura</option>
                                        <option value="pagamento" <?php if (valor_antigo_payisp('base_competencia', $dados_configuracoes['base_competencia']) == 'pagamento') {
                                                                        echo 'selected';
                                                                    } ?>>Data de Pagamento da Fatura</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="base_valor" class="form-label">Base de Clculo do Valor da NF-e <span class="text-danger">*</span></label>
                                    <select class="form-select" id="base_valor" name="base_valor" required>
                                        <option value="" disabled>Selecione a Base de Clculo do Valor</option>
                                        <option value="fatura" <?php if (valor_antigo_payisp('base_valor', $dados_configuracoes['base_valor']) == 'fatura') {
                                                                    echo 'selected';
                                                                } ?>>Valor Total da Fatura</option>
                                        <option value="servicos" <?php if (valor_antigo_payisp('base_valor', $dados_configuracoes['base_valor']) == 'servicos') {
                                                                        echo 'selected';
                                                                    } ?>>Valor Apenas dos Servios</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="exibir_danfecom_aberto" class="form-label">Exibir Barra/Pix na Danfe-COM <span class="text-danger">*</span></label>
                                    <select class="form-select" id="exibir_danfecom_aberto" name="exibir_danfecom_aberto" required>
                                        <option value="1" <?php if (valor_antigo_payisp('exibir_danfecom_aberto', $dados_configuracoes['exibir_danfecom_aberto']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Sim (Exibir)</option>
                                        <option value="0" <?php if (valor_antigo_payisp('exibir_danfecom_aberto', $dados_configuracoes['exibir_danfecom_aberto']) == '0') {
                                                                echo 'selected';
                                                            } ?>>No (Ocultar)</option>
                                    </select>
                                    <div class="form-text text-muted">Exibir cdigos de pagamento na Danfe-COM.</div>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="enviar_boleto" class="form-label">Incluir Boleto no Faturamento NFCom <span class="text-danger">*</span></label>
                                    <select class="form-select" id="enviar_boleto" name="enviar_boleto" required>
                                        <option value="1" <?php if (valor_antigo_payisp('enviar_boleto', $dados_configuracoes['enviar_boleto']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Sim</option>
                                        <option value="0" <?php if (valor_antigo_payisp('enviar_boleto', $dados_configuracoes['enviar_boleto']) == '0') {
                                                                echo 'selected';
                                                            } ?>>No</option>
                                    </select>
                                    <div class="form-text text-muted">Incluir a linha do boleto bancrio no grupo de faturamento (se existir).</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="enviar_pix" class="form-label">Incluir PIX no Faturamento NFCom <span class="text-danger">*</span></label>
                                    <select class="form-select" id="enviar_pix" name="enviar_pix" required>
                                        <option value="1" <?php if (valor_antigo_payisp('enviar_pix', $dados_configuracoes['enviar_pix']) == '1') {
                                                                echo 'selected';
                                                            } ?>>Sim</option>
                                        <option value="0" <?php if (valor_antigo_payisp('enviar_pix', $dados_configuracoes['enviar_pix']) == '0') {
                                                                echo 'selected';
                                                            } ?>>No</option>
                                    </select>
                                    <div class="form-text text-muted">Incluir dados do PIX no grupo de faturamento (se existir).</div>
                                </div>

                                <div class="col-12 mb-3">
                                    <label for="obs" class="form-label">Observaes Adicionais</label>
                                    <textarea class="form-control" id="obs" name="obs" rows="3"><?php echo valor_antigo_payisp('obs', $dados_configuracoes['obs']); ?></textarea>
                                    <div class="form-text text-muted">Observaes que sero includas nas notas fiscais eletrnicas.</div>
                                </div>
                            </div>

                            <button type="submit" onclick="document.getElementById('tab').value='config';" class="btn btn-primary mt-3">
                                <i class="fa fa-save"></i> Salvar Configuraes
                            </button>
                        </div>

                        <!-- TAB 2: Certificado Digital -->
                        <div class="tab-pane fade <?php echo ($tab == 'certificado') ? 'show active' : ''; ?>" id="certificado-tab-pane" role="tabpanel" aria-labelledby="certificado-tab" tabindex="1">

                            <div class="alert alert-info mt-3" role="alert">
                                <i class="fa fa-info-circle me-1"></i> Faa o upload do seu certificado digital A1 no formato .pfx ou .p12. Ele  essencial para assinar as notas fiscais eletrnicas.
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="formFile" class="form-label">Arquivo do Certificado (.pfx ou .p12)</label>
                                    <input class="form-control" type="file" id="formFile" name="certificado" accept=".pfx,.p12" required>
                                    <div class="invalid-feedback">Por favor, selecione um arquivo de certificado vlido.</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="senhaCertificado" class="form-label">Senha do Certificado</label>
                                    <input type="password" class="form-control" id="senhaCertificado" name="senha_certificado" value="<?php echo valor_antigo_payisp('senha_certificado', $dados_configuracoes['senha_pfx']); ?>" required>
                                    <div class="invalid-feedback">Por favor, insira a senha do certificado.</div>
                                </div>
                            </div>

                            <?php if (!empty($dados_configuracoes['certificado_pfx'])) {
                                // Determina classe de alerta baseado na validade
                                $cert_alert_class = 'alert-success';
                                if ($validade_certificado === false) {
                                    $cert_alert_class = 'alert-danger';
                                    $msg_validade = 'EXPIRADO ou Invlido';
                                } else if ($validade_certificado <= 30) {
                                    $cert_alert_class = 'alert-warning';
                                    $msg_validade = 'Vlido por apenas ' . $validade_certificado . ' dias';
                                } else {
                                    $msg_validade = 'Vlido por ' . $validade_certificado . ' dias';
                                }
                            ?>
                                <div class="alert <?php echo $cert_alert_class; ?> d-flex justify-content-between align-items-center mt-3" role="alert">
                                    <div>
                                        <i class="fa fa-check-circle me-2"></i> Certificado atual: <strong><?php echo htmlspecialchars($dados_configuracoes['certificado_pfx']); ?></strong>.
                                        <br>
                                        Validade: <span class="fw-bold"><?php echo $msg_validade; ?></span>.
                                    </div>

                                    <!-- Boto de Remover Certificado usando bootbox.confirm -->
                                    <button type="button"
                                        onclick="confirmarRemocaoCertificado('<?php echo htmlspecialchars($dados_configuracoes['certificado_pfx']); ?>');"
                                        class="btn btn-danger btn-sm">
                                        <i class="fa fa-trash"></i> Remover Certificado
                                    </button>
                                </div>
                            <?php } ?>

                            <button type="submit" onclick="document.getElementById('tab').value='certificado';" class="btn btn-primary mt-3">
                                <i class="fa fa-upload"></i> Enviar Certificado
                            </button>
                        </div>

                        <!-- TAB 3: Servios -->
                        <div class="tab-pane fade <?php echo ($tab == 'servicos') ? 'show active' : ''; ?>" id="servicos-tab-pane" role="tabpanel" aria-labelledby="servicos-tab" tabindex="3">

                            <div class="alert alert-info mt-3" role="alert">
                                <i class="fa fa-info-circle me-1"></i> Configure as regras fiscais para cada plano de servio.
                            </div>

                            <button type="button" class="btn btn-success mb-3" onclick="window.location.href='nfcom_novo_servico.php';">
                                <i class="fa fa-plus-circle"></i> Adicionar Novo Plano de Servio
                            </button>

                            <div class="table-responsive">
                                <table class="table table-striped table-hover table-sm align-middle">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Descrio</th>
                                            <th>Plano MK-Auth</th>
                                            <th class="text-center">Qtd. / Unidade</th>
                                            <th class="text-end">Valor (R$)</th>
                                            <th>Destino</th>
                                            <th>CFOP</th>
                                            <th>CClass</th>
                                            <th>ICMS CST</th>
                                            <th>ICMS Alq. (%)</th>
                                            <th class="text-center">Status</th>
                                            <th style="width: 150px;">Aes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <?php
                                        if ($total_servicos > 0) {
                                            while ($plano = $mysqli_servicos->fetch_assoc()) {
                                                $status_class = $plano['ativo'] == '1' ? 'badge bg-success' : 'badge bg-danger';
                                                $status_text = $plano['ativo'] == '1' ? 'Ativo' : 'Inativo';
                                                $plano_nome = !empty($plano['plano']) ? htmlspecialchars($plano['plano']) : 'Servio Geral';
                                                $unidade_medida = isset($unidadesNfcomDeMedida[$plano['unidade']]) ? $unidadesNfcomDeMedida[$plano['unidade']] : '';
                                        ?>
                                                <tr>
                                                    <td><?php echo htmlspecialchars($plano['descricao']); ?></td>
                                                    <td><?php echo $plano_nome; ?></td>
                                                    <td class="text-center"><?php echo $plano['quantidade'] . ' ' . $unidade_medida; ?></td>
                                                    <td class="text-end fw-bold">R$ <?php echo number_format($plano['valor_servico'], 2, ',', '.'); ?></td>
                                                    <td><?php echo htmlspecialchars($plano['uf_destino']); ?></td>
                                                    <td><?php echo htmlspecialchars($plano['id_cfop']); ?></td>
                                                    <td><?php echo htmlspecialchars($plano['cclass']); ?></td>
                                                    <td><?php echo htmlspecialchars($plano['icms_cst']); ?></td>
                                                    <td><?php echo htmlspecialchars($plano['icms_p_aliquota']); ?>%</td>
                                                    <td class="text-center"><span class="<?php echo $status_class; ?>"><?php echo $status_text; ?></span></td>
                                                    <td>
                                                        <a href="nfcom_editar_servico.php?id=<?php echo $plano['id']; ?>" class="btn btn-sm btn-outline-primary me-1" title="Editar Servio"><i class="fa fa-edit"></i></a>
                                                        <button type="button"
                                                            onclick="confirmarExclusaoServico('<?php echo $plano['id']; ?>', '<?php echo htmlspecialchars($plano['descricao']); ?>');"
                                                            class="btn btn-sm btn-outline-danger" title="Excluir Servio">
                                                            <i class="fa fa-trash"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            <?php }
                                        } else { ?>
                                            <tr>
                                                <td colspan="11" class="text-center py-3 text-muted">Nenhum servio cadastrado. Utilize o boto "Adicionar Novo Plano de Servio".</td>
                                            </tr>
                                        <?php } ?>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <?php include('lay.footer.php'); ?>

    <script>
        // JS para ativar a tab correta ao recarregar a pgina
        <?php if (!empty($tab)) { ?>
            document.addEventListener("DOMContentLoaded", function() {
                var tabElement = document.getElementById('<?php echo $tab; ?>-tab');
                if (tabElement) {
                    new bootstrap.Tab(tabElement).show();
                }
            });
        <?php } ?>

        // FUNO PARA REMOO DE CERTIFICADO (Substituindo o JS nativo)
        function confirmarRemocaoCertificado(nomeCertificado) {
            bootbox.confirm({
                title: "Remover Certificado Digital",
                message: "Tem certeza que deseja remover o certificado digital " + nomeCertificado + "? Essa ao exigir o reenvio para a emisso de NFCom.",
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> Cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-trash"></i> Sim, Remover',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        location.href = 'nfcom.php?tab=certificado&acao=remover_certificado';
                    }
                }
            });
        }

        // FUNO PARA EXCLUSO DE SERVIO (Substituindo o JS nativo)
        function confirmarExclusaoServico(id, descricao) {
            bootbox.confirm({
                title: "Excluir Servio de NFCom",
                message: "Voc tem certeza que deseja excluir o servio " + descricao + " (ID: " + id + ")? Esta ao  irreversvel.",
                buttons: {
                    cancel: {
                        label: '<i class="fa fa-times"></i> Cancelar',
                        className: 'btn-secondary'
                    },
                    confirm: {
                        label: '<i class="fa fa-trash"></i> Excluir',
                        className: 'btn-danger'
                    }
                },
                callback: function(result) {
                    if (result) {
                        bloquear_tela_payisp();
                        window.location.href = 'nfcom_excluir_servico.php?id=' + id;
                    }
                }
            });
        }
    </script>

</body>

</html>
</file>

<file path="payisp/nfcom.status.php">
<?php
require_once 'init.php';
include(dirname(__FILE__) . '/vendor/autoload.php');
include(dirname(__FILE__) . '/src/nfcom_engine.php');
include(dirname(__FILE__) . '/src/nfcom_xml.php');
include(dirname(__FILE__) . '/src/nfcom_cert.php');
include(dirname(__FILE__) . '/src/nfcom_tools.php');
?>
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status API NFCom - MK-Auth Pay ISP</title>
    <!-- Incluindo Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" xintegrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/toastr.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="../../scripts/jquery.js"></script>
    <script src="../../scripts/mk-auth.js"></script>
    <script src="../../menu.js.php"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/toastr.min.js"></script>
    <script src="js/jquery.blockUI.js"></script>
    <script src="js/bootbox.all.js"></script>
    <script src="js/scripts.js"></script>
</head>

<body>
    <div class="container py-4">
        
        <!-- Cabealho Principal -->
        <div class="mb-4 border-bottom pb-3">
            <h3 class="d-flex align-items-center">
                <i class="fa fa-tachometer-alt text-primary me-2"></i> Status da API NFCom
                <span class="badge bg-secondary ms-3"><?php echo $dados_configuracoes_nfcom['homologacao'] == '1' ? 'Homologao' : 'Produo'; ?></span>
            </h3>
            <p class="text-muted">Resultado da consulta de disponibilidade do Servio de Autorizao da NFCom junto  SEFAZ.</p>
        </div>

        <?php
        try {
            //pega o endpoint nfcom
            $endpoint = $dados_configuracoes_nfcom['endpoint'] == '' ? 'SVRS' : $dados_configuracoes_nfcom['endpoint'];
            if (!isset($nfcomEndpoints[$endpoint])) {
                throw new Exception("Endpoint NFCom invlido configurado: " . htmlspecialchars($endpoint));
            }
            
            //caminho do certificado e chave privada
            $caminho_crt = "/tmp/certificado-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".crt";
            $caminho_key = "/tmp/chave-nfcom-" . $dados_configuracoes_nfcom['cnpj'] . ".key";
            if (!file_exists($caminho_crt) || !file_exists($caminho_key)) {
                throw new Exception("Certificado ou chave privada NFCom no encontrados. Certifique-se de que os arquivos existam em: " . htmlspecialchars($caminho_crt) . " e " . htmlspecialchars($caminho_key));
            }
            
            //inicializa o cliente NFCom
            $nfcom = new NFComClient($nfcomEndpoints[$endpoint]);
            //carrega o certificado e chave privada
            $nfcom->setCertificados($caminho_crt, $caminho_key, '');
            // A varivel $tpAmb no  definida aqui, mas o cdigo original usa a lgica para determinar o ambiente
            $tpAmb_consulta = $dados_configuracoes_nfcom['homologacao'] == 1 ? 2 : 1; 
            $resposta = $nfcom->consultarStatus($tpAmb_consulta);
            
            // Determina as classes de cor e cone para o alerta
            $is_success = ($resposta->cStat == 107);
            $alert_class = $is_success ? 'alert-success' : 'alert-danger';
            $icon_class = $is_success ? 'fa-check-circle' : 'fa-exclamation-triangle';
        ?>
            
        <div class="card shadow-sm">
            <div class="card-body">
                <div class="alert <?php echo $alert_class; ?> d-flex align-items-center mb-0" role="alert">
                    <i class="fa <?php echo $icon_class; ?> fa-2x me-3"></i>
                    <div>
                        <h5 class="mb-1">
                            <?php echo ($is_success) ? 'Servio em Operao (Online)' : 'Servio com Problemas (Offline)'; ?>
                        </h5>
                        <p class="mb-0 text-muted">A conexo com o Endpoint: <?php echo htmlspecialchars($endpoint); ?> foi realizada.</p>
                    </div>
                </div>

                <div class="mt-4 p-3 bg-light rounded">
                    <h6 class="border-bottom pb-2 mb-3"><i class="fa fa-list me-2"></i> Detalhes da Resposta da SEFAZ</h6>
                    <dl class="row mb-0">
                        <dt class="col-sm-4 text-dark">Cdigo Status (cStat):</dt>
                        <dd class="col-sm-8"><code><?php echo htmlspecialchars($resposta->cStat); ?></code></dd>

                        <dt class="col-sm-4 text-dark">Motivo (xMotivo):</dt>
                        <dd class="col-sm-8"><?php echo htmlspecialchars($resposta->xMotivo); ?></dd>

                        <?php if (isset($resposta->dhRecbto)) { ?>
                            <dt class="col-sm-4 text-dark">Horrio do Recebimento:</dt>
                            <dd class="col-sm-8"><?php echo htmlspecialchars($resposta->dhRecbto); ?></dd>
                        <?php } ?>

                        <?php if (isset($resposta->tMed)) { ?>
                            <dt class="col-sm-4 text-dark">Tempo Mdio de Resposta (tMed):</dt>
                            <dd class="col-sm-8"><?php echo htmlspecialchars($resposta->tMed); ?> segundo(s)</dd>
                        <?php } ?>

                        <?php if (isset($resposta->dhRetorno)) { ?>
                            <dt class="col-sm-4 text-dark">Data e Hora do Retorno:</dt>
                            <dd class="col-sm-8"><?php echo htmlspecialchars($resposta->dhRetorno); ?></dd>
                        <?php } ?>
                    </dl>
                </div>
            </div>
        </div>
        
        <?php
        } catch (Exception $e) {
        ?>
            <!-- Bloco de Erro de Configurao/Conexo -->
            <div class="alert alert-danger shadow-sm" role="alert">
                <h4 class="alert-heading"><i class="fa fa-times-circle me-2"></i> Falha Crtica de Comunicao</h4>
                <p>Ocorreu um erro ao tentar verificar o status da API da NFCom. Verifique as configuraes de Endpoint e a presena dos arquivos de certificado.</p>
                <hr>
                <p class="mb-0"><strong>Detalhes do Erro:</strong> <?php echo $e->getMessage(); ?></p>
            </div>
        <?php
        }
        ?>
    </div>
    <!-- No h scripts JS de funcionalidade para manter neste arquivo, apenas includes -->
</body>

</html>
</file>

<file path="payisp/nfcom.xml.php">
<?php 
include("init.php");
//baixa o arquivo XML da NFCom
$titulo = valor_antigo_payisp('titulo');
$chave = valor_antigo_payisp('chave');
//busca os detalhes da NFCom
$nfcom = detalhes_nfcom_chave_payisp($titulo, $chave);
if(isset($nfcom['xml']) && !empty($nfcom['xml'])){
    header("Content-type: text/xml; charset=UTF-8");
    header("Content-Disposition: attachment; filename=\"NFCom_".$nfcom['titulo'].".xml\"");
    echo $nfcom['xml'];
    exit;
} else {
    die("Arquivo XML n&atilde;o encontrado para a NFCom #".$titulo.".");
}
?>
</file>

<file path="payisp/registro.manual.php">
<?php require_once 'init.php'; ?>
<!DOCTYPE html>
<?php
if (isset($_SESSION['MM_Usuario'])) {
	echo '<html lang="pt-BR">'; // Fix versao antiga MK-AUTH
} else {
	echo '<html lang="pt-BR" class="has-navbar-fixed-top">';
}
$atualizar = false;
$acao = valor_antigo_payisp('acao');
$cliente_uuid = valor_antigo_payisp('cliente_uuid');
//dados do cliente via uuid 
$cliente = dados_cliente_mkauth_payisp($cliente_uuid);
//funcao de registro manual 
function registro_manual_payisp($results, $banco_payisp, $banco_mk)
{
	global $mysqli;
	$sucesso = array();
	while ($row = $results->fetch_array()) {
		//class de registro do boleto 
		$obj = class_banco_payisp($banco_payisp['cod_banco']);
		if (is_object($obj) && method_exists($obj, 'registrar')) {
			//inclui adicionais ao total de registro
			$total_inicial = $row['valor'];
			$sql_adicionais = "SELECT * FROM `sis_mlanc` WHERE idlanc = " . (int)$row['titulo'] . "";
			$results_adicionais = $mysqli->query($sql_adicionais);
			while ($rowad = $results_adicionais->fetch_array()) {
				if (isset($rowad['valor']) && $rowad['valor'] > 0 && $rowad['tipo'] == 'desconto') {
					$total_inicial -= $rowad['valor'];
				} elseif (isset($rowad['valor']) && $rowad['valor'] > 0) {
					$total_inicial += $rowad['valor'];
				}
			}
			$row['valor'] = $total_inicial;
			//registra o boleto
			$resultado = $obj->registrar($row, $banco_payisp, $banco_mk);
			if (isset($resultado['erro']) && $resultado['erro'] == false) {
				//cria o pix 
				if (isset($resultado['qrcode']) && !empty($resultado['qrcode'])) {
					$sql = "INSERT INTO sis_qrpix SET titulo = '" . $row['uuid_lanc'] . "', qrcode = '" . $resultado['qrcode'] . "'";
					$mysqli->query($sql);
				}
				//atualiza o lancamento
				$sql = "UPDATE sis_lanc SET nossonum = '" . $resultado['nosso_numero'] . "', linhadig = '" . preg_replace('/\D/', '', $resultado['linha']) . "', num_recibos = 1, fcartaobandeira = '" . $resultado['tid'] . "', fcartaonumero = '" . $banco_payisp['cod_banco'] . "', id_empresa = '" . $resultado['nosso_numero'] . "', fchequenumero = 'registrado', fchequebanco = '" . preg_replace('/\D/', '', $resultado['linha']) . "', fchequeagcc = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
				$mysqli->query($sql);
				//codigo de barras 
				$sql = "UPDATE sis_lanc SET codigo_barras = '" . preg_replace('/\D/', '', $resultado['barras']) . "' WHERE uuid_lanc  = '" . $row['uuid_lanc'] . "' LIMIT 1";
				$mysqli->query($sql);
				//cria o registro individual
				$sql = "INSERT INTO payisp_faturas SET cod_banco = '" . $banco_payisp['cod_banco'] . "', nosso_numero = '" . $resultado['nosso_numero'] . "', linha = '" . preg_replace('/\D/', '', $resultado['linha']) . "', cod_barra = '" . preg_replace('/\D/', '', $resultado['barras']) . "', fatura_mkauth = '" . $row['titulo'] . "', valor_fatura = '" . number_format($row['valor'], 2, '.', '') . "', valor_desconto = '" . number_format($resultado['desconto'], 2, '.', '') . "', tipo_desconto = '" . $resultado['tipo_desconto'] . "', status = 'aberto', data_desconto = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_validade = '" . date('Y-m-d', strtotime($resultado['validade'])) . "', data_emissao = '" . date('Y-m-d') . "', pix = '" . $resultado['qrcode'] . "', txid = '" . $resultado['txid'] . "', cod = '" . $resultado['tid'] . "'";
				$mysqli->query($sql);
				$sucesso[] = $row['titulo'];
				//ok
?>
				<div class="alert alert-success" role="alert">
					<i class="fa-solid fa-circle-info"></i> <?php echo $resultado['log']; ?> (R$<?php echo $row['valor']; ?>)
				</div>
			<?php
			} else {
				//erro
			?>
				<div class="alert alert-warning" role="alert">
					<i class="fa-solid fa-circle-info"></i> <?php echo $resultado['log']; ?> (R$<?php echo $row['valor']; ?>)
				</div>
				<?php if ($banco_payisp['modo_debug']) { ?>
					<code><?php print_r($resultado); ?></code>
				<?php } ?>
			<?php
			}
		} else {
			?>
			<div class="alert alert-warning" role="alert">
				<i class="fa-solid fa-circle-info"></i> Banco sem m&eacute;todo de registro de boletos!
			</div>
<?php
		}
	}
	//log
	if (count($sucesso) > 0) {
		criar_log_mkauth_payisp('Titulo(s) ' . implode(',', $sucesso) . ' Registados Manual via PAY ISP [' . $banco_payisp['cod_banco'] . '].', 'admin');
	}
}
?>
<html lang="pt-BR">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="iso-8859-1">
	<title>Registrar Boletos Manualmente - PAY ISP</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/toastr.min.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">
	<script src="../../scripts/jquery.js"></script>
	<script src="../../scripts/mk-auth.js"></script>
	<script src="../../menu.js.php"></script>
	<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/toastr.min.js"></script>
	<script src="js/jquery.blockUI.js"></script>
	<script src="js/bootbox.all.js"></script>
	<script src="js/scripts.js"></script>
</head>

<body>
	<br>
	<div class="container-fluid">

		<?php
		//pega o banco padrao 
		$id_banco_bd_mkauth = id_banco_padrao_payisp();
		if ((int)$cliente['conta'] == 0 && $id_banco_bd_mkauth == 0) {
		?>
			<div class="alert alert-warning" role="alert">
				<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos, primeiro defina qual vai ser o banco de recebimento do cliente edite o mesmo e informe na aba financeiro ou defina um banco padr&atilde;o em seu PAY ISP.
			</div>
			<?php
		}
		$id_banco_bd_mkauth = ((int)$cliente['conta'] == 0) ? $id_banco_bd_mkauth : (int)$cliente['conta'];
		//dados de bancos e contas 
		$banco_mk = dados_banco_mkauth_payisp($id_banco_bd_mkauth);
		$banco_payisp = dados_banco_uuid_payisp($banco_mk['uuid_boleto']);
		//carnets
		if ($acao == 'carnet' && $id_banco_bd_mkauth > 0) {
			if (isset($_POST['carne'][0])) {
				//lista os titulos sem registro do carnet
				$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND (fcartaobandeira = '' OR fcartaobandeira IS NULL) AND (conta = 0 || conta = " . $id_banco_bd_mkauth . ") AND codigo_carne = '" . escape_payisp($_POST['carne'][0]) . "' LIMIT 50";
				$results = $mysqli->query($sql);
				if ($results->num_rows == 0) {
			?>
					<div class="alert alert-warning" role="alert">
						<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos pois no foi encontrado nenhum carnet/titulo(s) em aberto pendente de registro em sua requisio.
					</div>
				<?php
				} else {
					//registra titulos do carnet (todos)
					registro_manual_payisp($results, $banco_payisp, $banco_mk);
				}
			} elseif (isset($_POST['titulo'][0])) {
				$ids = implode(",", $_POST['titulo']);
				//lista os titulos sem registros
				$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND (fcartaobandeira = '' OR fcartaobandeira IS NULL) AND (conta = 0 || conta = " . $id_banco_bd_mkauth . ") AND FIND_IN_SET(titulo,'" . $ids . "') LIMIT 50";
				$results = $mysqli->query($sql);
				if ($results->num_rows == 0) {
				?>
					<div class="alert alert-warning" role="alert">
						<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos pois no foi encontrado nenhum titulo em aberto pendente de registro em sua requisio.
					</div>
				<?php
				} else {
					//registra titulos carnet especificos
					registro_manual_payisp($results, $banco_payisp, $banco_mk);
				}
			} else {
				?>
				<div class="alert alert-warning" role="alert">
					<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos pois no foi encontrado nenhum carnet/titulo(s) na requisio, verique se selecionou corretamente o carnet/titulo(s) qual deseja registrar.
				</div>
				<?php
			}
		}
		//avultos
		if ($acao == 'avulso' && $id_banco_bd_mkauth > 0) {
			if (isset($_POST['titulo'][0])) {
				$ids = implode(",", $_POST['titulo']);
				//lista os titulos sem registros
				$sql = "SELECT * FROM `vtab_titulos` WHERE deltitulo = 0 AND status = 'aberto' AND (fcartaobandeira = '' OR fcartaobandeira IS NULL) AND (conta = 0 || conta = " . $id_banco_bd_mkauth . ") AND FIND_IN_SET(titulo,'" . $ids . "') LIMIT 50";
				$results = $mysqli->query($sql);
				if ($results->num_rows == 0) {
				?>
					<div class="alert alert-warning" role="alert">
						<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos pois no foi encontrado nenhum titulo em aberto pendente de registro em sua requisio.
					</div>
				<?php
				} else {
					//registra titulos avulsos
					registro_manual_payisp($results, $banco_payisp, $banco_mk);
				}
			} else {
				?>
				<div class="alert alert-warning" role="alert">
					<i class="fa-solid fa-circle-info"></i> N&atilde;o foi possivel fazer o registro dos boletos pois no foi encontrado nenhum titulo na requisio, verique se selecionou corretamente o(s) titulo(s) qual deseja registrar.
				</div>
		<?php
			}
		}
		?>

		<script>
			self.opener.reloadAqui();
		</script>

	</div>
</body>

</html>
</file>

<file path="payisp/template_alerta.php">
<html lang="pt-BR">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title><?php echo $titulo;?></title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/admin/addons/payisp/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/addons/payisp/css/bootstrap.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/toastr.min.css" rel="stylesheet">
    <link href="/admin/addons/payisp/css/styles.css" rel="stylesheet">
	<script src="/admin/scripts/jquery.js"></script>
	<script src="/admin/scripts/mk-auth.js"></script>
	<script src="/admin/menu.js.php"></script>
	<script src="/admin/addons/payisp/js/bootstrap.bundle.min.js"></script>
	<script src="/admin/addons/payisp/js/toastr.min.js"></script>
	<script src="/admin/addons/payisp/js/jquery.blockUI.js"></script>
	<script src="/admin/addons/payisp/js/bootbox.all.js"></script>
	<script src="/admin/addons/payisp/js/scripts.js"></script>
</head>
<body>
<br>
<div class="container-fluid">
<div class="alert alert-<?php echo $tipo_alerta;?>" role="alert">
<i class="fa-solid fa-circle-info"></i> <?php echo $alerta;?>
</div>
</div>
</body>
</html>
</file>

<file path="payisp/template_log.php">
<html lang="pt-BR">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="iso-8859-1">
    <title><?php echo $titulo;?></title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/admin/addons/payisp/css/bootstrap-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/addons/payisp/css/bootstrap.min.css" rel="stylesheet">
	<link href="/admin/addons/payisp/css/toastr.min.css" rel="stylesheet">
    <link href="/admin/addons/payisp/css/styles.css" rel="stylesheet">
	<script src="/admin/scripts/jquery.js"></script>
	<script src="/admin/scripts/mk-auth.js"></script>
	<script src="/admin/menu.js.php"></script>
	<script src="/admin/addons/payisp/js/bootstrap.bundle.min.js"></script>
	<script src="/admin/addons/payisp/js/toastr.min.js"></script>
	<script src="/admin/addons/payisp/js/jquery.blockUI.js"></script>
	<script src="/admin/addons/payisp/js/bootbox.all.js"></script>
	<script src="/admin/addons/payisp/js/scripts.js"></script>
</head>
<body>
<br>
<div class="container-fluid">
<code>
<?php print_r($log);?>
</code>
</div>
</body>
</html>
</file>

<file path="payisp/whatsapp.php">
<?php 
require(dirname(__FILE__).'/init_cliente.php');
//dados 
$uuid = isset($_GET['uuid'])?$_GET['uuid']:'';
$titulo = isset($_GET['titulo'])?(int)$_GET['titulo']:'';
//dados do titulo
$sql = "SELECT * FROM `vtab_titulos` WHERE titulo = '".escape_payisp($titulo)."' AND uuid_lanc = '".escape_payisp($uuid)."' LIMIT 1";
$result = $mysqli->query($sql);
$fatura = $result->fetch_array(MYSQLI_ASSOC);
if(!isset($fatura['uuid_lanc'])){
	$titulo = 'Fatura No Encontrada';
	$alerta = 'O titulo do boleto selecionado n&atilde;o foi encontrado na base de dados.';
	$tipo_alerta = 'warning';
	require(dirname(__FILE__).'/template_alerta.php');
	die('');
}
//redir 
header("Location: /admin/addons/payisp/cliente.fatura.php?uuid=".$uuid."&sec=".sha1($fatura['uuid_lanc'].$fatura['titulo'].$fatura['titulo'])."");
die();
?>
</file>

<file path="addon_payisp.js">
//menu payisp
$('.navbar-start').append(`
    <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link is-size-7 has-text-weight-bold"><i class="fa fa-barcode is-hidden-desktop-only"></i>&nbsp; PAY ISP</a>
        <div class="navbar-dropdown">
			<a href="/admin/clientes.hhvm?tipo=todos" class="navbar-item"><i class="fa fa-plus"></i>&nbsp; Criar faturas</a>
			<div class="dropdown-divider"></div>
            <a href="/admin/addons/payisp/faturas.index.php" class="navbar-item"><i class="fa fa-search"></i>&nbsp; Todas Faturas&nbsp;(<span id="qtd_todas_payisp">0</span>)</a>
            <a href="/admin/addons/payisp/faturas.index.php?status=aberto" class="navbar-item"><i class="fa fa-minus"></i>&nbsp; Abertos&nbsp;(<span id="qtd_aberto_payisp">0</span>)</a>
			<a href="/admin/addons/payisp/faturas.index.php?status=pago" class="navbar-item"><i class="fa fa-minus"></i>&nbsp; Pagos&nbsp;(<span id="qtd_pago_payisp">0</span>)</a>
			<a href="/admin/addons/payisp/faturas.index.php?status=vencido" class="navbar-item"><i class="fa fa-minus"></i>&nbsp; Vencidos&nbsp;(<span id="qtd_vencido_payisp">0</span>)</a>
			<a href="/admin/addons/payisp/carnets.index.php" class="navbar-item"><i class="fa fa-list"></i>&nbsp; Carnets&nbsp;(<span id="qtd_carnets_payisp">0</span>)</a>
			<div class="dropdown-divider"></div>
			<a href="/admin/addons/payisp/bancos.index.php" class="navbar-item"><i class="fa fa-building"></i>&nbsp; Bancos&nbsp;(<span id="qtd_bancos_payisp">0</span>)</a>
			<a href="/admin/addons/payisp/configuracoes.php" class="navbar-item"><i class="fa fa-cog"></i>&nbsp; Configura&ccedil;&atilde;o</a>
			<div class="dropdown-divider"></div>
			<a href="/admin/addons/payisp/logs.php" class="navbar-item"><i class="fa fa-info-circle"></i>&nbsp; Logs APIs</a>
			<a target="_blank" href="https://www.mkauth-addons.com.br/knowledgebase.php?category=4" class="navbar-item"><i class="fa fa-envelope"></i>&nbsp; Ajuda</a>
        </div>
    </div>`);
//menu nfcom payisp
$('.navbar-start').append(`
    <div class="navbar-item has-dropdown is-hoverable exibir_opcao_nfcom_payisp">
        <a class="navbar-link is-size-7 has-text-weight-bold"><i class="fa fa-file is-hidden-desktop-only"></i>&nbsp; NFCOM ISP</a>
        <div class="navbar-dropdown">
			<a href="/admin/addons/payisp/nfcom.index.php" class="navbar-item"><i class="fa fa-file"></i>&nbsp; Notas NFCom&nbsp;(<span id="qtd_nfcom_payisp">0</span>)</a>
			<a href="/admin/addons/payisp/nfcom.index.php?status=emitida" class="navbar-item"><i class="fa fa-minus"></i>&nbsp; Emitidas&nbsp;(<span id="qtd_nfcom_payisp_emitidas">0</span>)</a>
			<a href="/admin/addons/payisp/nfcom.index.php?status=cancelada" class="navbar-item"><i class="fa fa-minus"></i>&nbsp; Canceladas&nbsp;(<span id="qtd_nfcom_payisp_canceladas">0</span>)</a>
			<div class="dropdown-divider"></div>
			<a href="/admin/addons/payisp/nfcom.php" class="navbar-item"><i class="fa fa-cogs"></i>&nbsp; Configurao</a>
			<div class="dropdown-divider"></div>
			<a href="/admin/addons/payisp/logs.php" class="navbar-item"><i class="fa fa-info-circle"></i>&nbsp; Logs APIs</a>
			<a target="_blank" href="https://www.mkauth-addons.com.br/knowledgebase.php?category=4" class="navbar-item"><i class="fa fa-envelope"></i>&nbsp; Ajuda</a>
        </div>
    </div>`);
//carrega javascritps e css custom 
jQuery('head').append( $('<link rel="stylesheet" type="text/css" />').attr('href', '/admin/addons/payisp/css/toastr.min.css') );
jQuery('head').append( $('<link rel="stylesheet" type="text/css" />').attr('href', '/admin/addons/payisp/css/toastr.min.css') );
jQuery('head').append( $('<script/>').attr('src', '/admin/addons/payisp/js/toastr.min.js') );
jQuery('head').append( $('<script/>').attr('src', '/admin/addons/payisp/js/scripts.js') );
jQuery('head').append( $('<script/>').attr('src', '/admin/addons/payisp/js/toastr.min.js') );
//funcoes 
function get_url_var_payisp(key) {
	var value = [];
	var query = String(document.location).split('?');
	if (query[1]) {
		var part = query[1].split('&');
		for (i = 0; i < part.length; i++) {
			var data = part[i].split('=');

			if (data[0] && data[1]) {
				value[data[0]] = data[1];
			}
		}
		if (value[key]) {
			return value[key];
		} else {
			return '';
		}
	}
}
function getCookie_payisp(k) {
    var cookies = " " + document.cookie;
    var key = " " + k + "=";
    var start = cookies.indexOf(key);
    if (start === -1) return null;
    var pos = start + key.length;
    var last = cookies.indexOf(";", pos);
    if (last !== -1) return cookies.substring(pos, last);
    return cookies.substring(pos);
}
function setCookie_payisp(k, v, expira, path) {
    if (!path) path = "/";
    var d = new Date();
    d.setTime(d.getTime() + (expira * 1000));
    document.cookie = encodeURIComponent(k) + "=" + encodeURIComponent(v) + "; expires=" + d.toUTCString() + "; path=" + path;
}

//acoes
if(typeof window.location.pathname !== 'undefined'){
	//onclick mais boletos 
	jQuery( document ).on( "ajaxComplete", function( event, xhr, settings ) {
	  if((settings.url).substring(0,15)=='mais_carne.hhvm'){
			//botoes boletos e carnets
			for (let element of document.querySelectorAll(`a[href]`)) {
				if(element.href !== 'undefined'){
					//boletos
					if (/prepara_boleto\.hhvm/.test(element.href)){
						var partes = (element.href).split('?');
						//custom
						element.setAttribute('href', "/admin/addons/payisp/custom/prepara_boleto.hhvm?"+partes[1]);
					}
					//titulos
					if (/titulo\.hhvm/.test(element.href)){
						var partes = (element.href).split('?');
						//custom
						element.setAttribute('href', "/admin/addons/payisp/custom/titulo.hhvm?"+partes[1]);
					}
				}
			}
	  }
	});
	//acoes em titulos
	if(window.location.pathname=='/admin/titulos.hhvm' || window.location.pathname=='/admin/titulos_receber.hhvm' || window.location.pathname=='/admin/titulos_vencidos.hhvm'){
		//botoes boletos e carnets
		for (let element of document.querySelectorAll(`a[href]`)) {
			if(element.href !== 'undefined'){
				//boletos
				if (/prepara_boleto\.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/prepara_boleto.hhvm?"+partes[1]);
				}
				//titulos
				if (/titulo\.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/titulo.hhvm?"+partes[1]);
				}
			}
		}
		//substitui os botoes imprimir titulo
		var botao_imprimir_carnet = document.querySelector('a[title="Imprimir titulos"]');
		if (botao_imprimir_carnet) {
			botao_imprimir_carnet.setAttribute('onclick', 'javascript:mk_auth_imprimir_carnet_titulos_payisp();');
			botao_imprimir_carnet.setAttribute('id', 'imprimir-botao-titulos');
		}
	}
	//acoes em receber titulos
	if(window.location.pathname=='/admin/titulos_rec.hhvm'){
		//botoes boletos e carnets
		for (let element of document.querySelectorAll(`a[href]`)) {
			if(element.href !== 'undefined'){
				//boletos
				if (/prepara_boleto\.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/prepara_boleto.hhvm?"+partes[1]);
				}
			}
		}
	}
	//acoes em carnets
	if(window.location.pathname=='/admin/carnes_abertos.hhvm' || window.location.pathname=='/admin/carnes_vencidos.hhvm'){
		//botoes boletos e carnets
		for (let element of document.querySelectorAll(`a[href]`)) {
			if(element.href !== 'undefined'){
				//carnets
				if (/prepara_carne\.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/prepara_carne.hhvm?"+partes[1]);
				}
			}
		}
		//substitui os botoes imprimir carnet 
		var botao_imprimir_carnet = document.querySelector('a[title="Imprimir carne"]');
		if (botao_imprimir_carnet) {
			botao_imprimir_carnet.setAttribute('onclick', 'javascript:mk_auth_imprimir_carnet_cliente_payisp();');
			botao_imprimir_carnet.setAttribute('id', 'imprimir-titulos-botao-carnet');
		}
	}
	//acoes em carnets em massa
	if(window.location.pathname=='/admin/carnes_impressao.hhvm'){
		//substitui os botoes imprimir carnet 
		var botao_imprimir_carnet = document.querySelector('form[name="form_gerar"]');
		if (botao_imprimir_carnet) {
			//custom
			botao_imprimir_carnet.setAttribute('action', '/admin/addons/payisp/custom/impressao_carnes.hhvm');
		}
	}
	//acoes em boletos em massa
	if(window.location.pathname=='/admin/titulos_impressao.hhvm'){
		//substitui os botoes imprimir carnet 
		var botao_imprimir_carnet = document.querySelector('form[name="form_gerar"]');
		if (botao_imprimir_carnet) {
			//custom
			botao_imprimir_carnet.setAttribute('action', '/admin/addons/payisp/custom/impressao_boletos.hhvm');
		}
	}
	//acoes ao emitir faturas e carnets 
	if(window.location.pathname=='/admin/cliente_det.hhvm'){
		//substitui os botoes imprimir carnet 
		var botao_imprimir_carnet = document.querySelector('a[title="Imprimir carne"]');
		if (botao_imprimir_carnet) {
			botao_imprimir_carnet.setAttribute('onclick', 'javascript:mk_auth_imprimir_carnet_cliente_payisp();');
			botao_imprimir_carnet.setAttribute('id', 'imprimir-payisp-carne');
		}
		//substitui os botoes imprimir titulo
		var botao_imprimir_carnet = document.querySelector('a[title="Imprimir titulos"]');
		if (botao_imprimir_carnet) {
			botao_imprimir_carnet.setAttribute('onclick', 'javascript:mk_auth_imprimir_carnet_titulos_payisp();');
			botao_imprimir_carnet.setAttribute('id', 'imprimir-payisp-titulos');
		}
		//botoes boletos e carnets
		for (let element of document.querySelectorAll(`a[href]`)) {
			if(element.href !== 'undefined'){
				//boletos
				if (/prepara_boleto\.hhvm\?titulo=/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/prepara_boleto.hhvm?"+partes[1]);
				}
				//carnets
				if (/prepara_carne\.hhvm\?carne=/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/prepara_carne.hhvm?"+partes[1]);
				}
				//titulos
				if (/titulo\.hhvm/.test(element.href)){
					var partes = (element.href).split('?');
					//custom
					element.setAttribute('href', "/admin/addons/payisp/custom/titulo.hhvm?"+partes[1]);
				}
			}
		}
		//botoes de registro manual 
		jQuery('nav > div[class="level-left"]:eq(0)').append("<div class='level-item'><a onclick='javascript:registrar_carnet_payisp();' title='Registrar Titulos' id='registrar-titulos'> <span class='icon has-text-danger'> <i class='fa fa-send fa-2x'></i></span></a></div>");
		jQuery('nav > div[class="level-left"]:eq(1)').append("<div class='level-item'><a onclick='javascript:registrar_avulso_payisp();' title='Registrar Titulos' id='registrar-titulos'> <span class='icon has-text-danger'> <i class='fa fa-send fa-2x'></i></span></a></div>");
		//registro automatico de boletos se ativado
		var cliente_uuid = get_url_var_payisp('uuid');
		if(cliente_uuid!=''){
			//registra os boletos
			jQuery.getJSON("/admin/addons/payisp/ajax.registrar.php?cliente_uuid="+cliente_uuid, function( data ) {
				console.log(data);
				jQuery(data.logs).each(function(index,value) {
					if(value.erro==true){
						toastr.error('[PAYISP] '+value.log);
					}else{
						toastr.success('[PAYISP] '+value.log);
					}
				});
				if(data.atualizar){
					reloadAqui();
				}
			});
		}
	}
}
//contador
jQuery.getJSON("/admin/addons/payisp/json.contador.php", function( data ) {
	console.log(data);
	jQuery(data).each(function(index,value) {
		jQuery('#'+value.id+'').html(value.qtd);
	});
});
//verifica se o addon foi atualizado
jQuery.getJSON("/admin/addons/payisp/json.atualizado.php", function( data ) {
	//verifica se teve atualizacao e exibe se menos de 24 hrs
	var avisado = getCookie_payisp('addons_payisp');
	if(typeof data.atualizado !== 'undefined' && avisado!='sim'){
		if(data.atualizado){
			toastr.success(''+data.addon+' ('+data.atual+') existe uma nova atualizao ('+data.nova+'), acesse https://www.mkauth-addons.com.br > PAY ISP e veja as instrues de atualizao.','ADDON ATUALIZADO');
			setCookie_payisp('addons_payisp', 'sim', 86400);
		}
	}
});
</file>

</files>
